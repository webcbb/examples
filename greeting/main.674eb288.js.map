{"version":3,"file":"main.674eb288.js","sources":["../../src/greeting/greeting-out.component.ts","../../src/greeting/greeting.component.ts","../../src/greeting/index.ts"],"sourcesContent":["import { nodeDocument } from '@frontmeans/dom-primitives';\nimport { StypProperties, stypRules, StypRules } from '@frontmeans/style-producer';\nimport { mapAfter } from '@proc7ts/fun-events';\nimport { FragmentRendererExecution, RenderFragment } from '@wesib/generic';\nimport { ProduceStyle, Theme } from '@wesib/generic/styp';\nimport { AttachShadow, Attribute, Component, ComponentContext } from '@wesib/wesib';\nimport { DefaultStyle, Examples__NS, FormThemeSettings, inStyle, readonlyInStyle, ThemeSettings } from '../common';\n\n@Component(['greeting-out', Examples__NS])\n@AttachShadow()\nexport class GreetingOutComponent {\n\n  @Attribute()\n  name?: string;\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n    return this._context.get(Theme).style(GreetingOutStyle);\n  }\n\n  @RenderFragment()\n  render({ content }: FragmentRendererExecution): void {\n\n    const doc = nodeDocument(content);\n\n    content.appendChild(doc.createTextNode(this._greeting()));\n  }\n\n  private _greeting(): string {\n\n    const name = this.name?.trim();\n\n    return name ? `Hello, ${name}!` : 'Hello!';\n  }\n\n}\n\nconst GreetingOut__qualifier = 'bex:greeting-out';\n\nfunction GreetingOutStyle(theme: Theme): StypRules {\n\n  const settings = theme.ref(ThemeSettings).read;\n  const formSettings = theme.ref(FormThemeSettings).read;\n  const { root: { rules } } = theme;\n\n  return stypRules(\n      rules.add(\n          { u: [':', 'host'], $: GreetingOut__qualifier },\n          formSettings.do(mapAfter(inStyle)),\n      )\n          .add(formSettings.do(mapAfter(readonlyInStyle)))\n          .add(settings.do(mapAfter(greetFieldStyle))),\n      theme.style(DefaultStyle),\n  );\n}\n\nexport function greetFieldStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: `${$fontSize.div(2)} 0 0 0`,\n  };\n}\n","import { inText, InValidation, requirePresent } from '@frontmeans/input-aspects';\nimport { StypProperties, stypRules, StypRules } from '@frontmeans/style-producer';\nimport { mapAfter, ValueSync } from '@proc7ts/fun-events';\nimport { Field, SharedField } from '@wesib/generic/forms';\nimport { ProduceStyle, Theme } from '@wesib/generic/styp';\nimport { BootstrapContext, Component, ComponentContext, ComponentSlot, trackAttribute } from '@wesib/wesib';\nimport { AppFeature, Examples__NS, FormStyle, ThemeSettings } from '../common';\nimport { greetFieldStyle, GreetingOutComponent } from './greeting-out.component';\n\n@Component(\n    ['greeting', Examples__NS],\n    {\n      feature: {\n        needs: [\n          GreetingOutComponent,\n          AppFeature,\n        ],\n      },\n    },\n)\nexport class GreetingComponent {\n\n  @SharedField()\n  name?: Field<string>;\n\n  constructor(private readonly _context: ComponentContext) {\n\n    const bsContext = _context.get(BootstrapContext);\n\n    _context.whenSettled(({ element }: { element: Element }) => {\n\n      const nameElement = element.querySelector('input')!;\n      const name = this.name = Field.by(\n          opts => inText(nameElement, opts)\n              .setup(InValidation, validation => validation.by(requirePresent)),\n      );\n\n      bsContext.whenDefined(GreetingOutComponent)(({ elementDef: { tagName: outName } }) => {\n\n        const outElement = element.querySelector(outName!)!;\n\n        ComponentSlot.of(outElement).whenReady(outCtx => {\n\n          const sync = new ValueSync<string | null>('');\n          const nameAttr = trackAttribute(outCtx, 'name');\n\n          sync.sync(nameAttr);\n          sync.sync('in', name, name => name && name.control);\n\n          _context.supply\n              .cuts(sync)\n              .cuts(nameAttr);\n        });\n      });\n    });\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n    return this._context.get(Theme).style(GreetingStyle);\n  }\n\n}\n\nconst Greeting__qualifier = 'bex:greeting';\n\nfunction GreetingStyle(theme: Theme): StypRules {\n\n  const settings = theme.ref(ThemeSettings).read;\n  const { root: { rules } } = theme;\n  const label = rules.add(\n      [{ u: [':', 'host'], $: Greeting__qualifier }, { e: 'label', $: Greeting__qualifier }],\n      settings.do(mapAfter(greetLabelStyle)),\n  );\n\n  return stypRules(\n      theme.style(FormStyle),\n      label,\n      label.rules.add(\n          { e: 'input', $: Greeting__qualifier },\n          settings.do(mapAfter(greetFieldStyle)),\n      ),\n  );\n}\n\nfunction greetLabelStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: 0,\n    padding: `${$fontSize.div(2)}`,\n  };\n}\n","import { examplesContext } from '../common';\nimport { GreetingComponent } from './greeting.component';\n\nexamplesContext.load(GreetingComponent);\n"],"names":["GreetingOutComponent","[object Object]","_context","this","get","Theme","style","GreetingOutStyle","content","doc","nodeDocument","appendChild","createTextNode","_greeting","name","trim","__decorate","Attribute","ProduceStyle","RenderFragment","Component","Examples__NS","AttachShadow","theme","settings","ref","ThemeSettings","read","formSettings","FormThemeSettings","root","rules","stypRules","add","u","$","do","mapAfter","inStyle","readonlyInStyle","greetFieldStyle","DefaultStyle","$fontSize","display","margin","div","GreetingComponent","bsContext","BootstrapContext","whenSettled","element","nameElement","querySelector","Field","by","opts","inText","setup","InValidation","validation","requirePresent","whenDefined","elementDef","tagName","outName","outElement","ComponentSlot","of","whenReady","outCtx","sync","ValueSync","nameAttr","trackAttribute","control","supply","cuts","GreetingStyle","SharedField","feature","needs","AppFeature","label","e","greetLabelStyle","FormStyle","padding","examplesContext","load"],"mappings":"6QAUA,IAAaA,EAAb,MAKEC,YAA6BC,GAAAC,cAAAD,EAI7BD,QACE,OAAOE,KAAKD,SAASE,IAAIC,GAAOC,MAAMC,GAIxCN,QAAOO,QAAEA,IAEP,MAAMC,EAAMC,EAAaF,GAEzBA,EAAQG,YAAYF,EAAIG,eAAeT,KAAKU,cAGtCZ,kBAEN,MAAMa,YAAOX,KAAKW,2BAAMC,OAExB,OAAOD,EAAO,UAAUA,KAAU,WAtBpCE,GADCC,gCAODD,GADCE,+BAMDF,GADCG,gCAbUnB,KAFZoB,EAAU,CAAC,eAAgBC,IAC3BC,KACYtB,GAgCb,SAASO,EAAiBgB,GAExB,MAAMC,EAAWD,EAAME,IAAIC,GAAeC,KACpCC,EAAeL,EAAME,IAAII,GAAmBF,MAC1CG,MAAMC,MAAEA,IAAYR,EAE5B,OAAOS,EACHD,EAAME,IACF,CAAEC,EAAG,CAAC,IAAK,QAASC,EAVC,oBAWrBP,EAAaQ,GAAGC,EAASC,KAExBL,IAAIL,EAAaQ,GAAGC,EAASE,KAC7BN,IAAIT,EAASY,GAAGC,EAASG,KAC9BjB,EAAMjB,MAAMmC,aAIFD,GACZE,UACEA,IAGJ,MAAO,CACLC,QAAS,QACTC,OAAQ,GAAGF,EAAUG,IAAI,YC9C7B,IAAaC,EAAb,MAKE7C,YAA6BC,GAAAC,cAAAD,EAE3B,MAAM6C,EAAY7C,EAASE,IAAI4C,GAE/B9C,EAAS+C,aAAY,EAAGC,QAAAA,MAEtB,MAAMC,EAAcD,EAAQE,cAAc,SACpCtC,EAAOX,KAAKW,KAAOuC,EAAMC,IAC3BC,GAAQC,EAAOL,EAAaI,GACvBE,MAAMC,GAAcC,GAAcA,EAAWL,GAAGM,OAGzDb,EAAUc,YAAY7D,EAAtB+C,EAA4C,EAAGe,YAAcC,QAASC,OAEpE,MAAMC,EAAaf,EAAQE,cAAcY,GAEzCE,EAAcC,GAAGF,GAAYG,WAAUC,IAErC,MAAMC,EAAO,IAAIC,EAAyB,IACpCC,EAAWC,EAAeJ,EAAQ,QAExCC,EAAKA,KAAKE,GACVF,EAAKA,KAAK,KAAMxD,GAAMA,GAAQA,GAAQA,EAAK4D,UAE3CxE,EAASyE,OACJC,KAAKN,GACLM,KAAKJ,YAOlBvE,QACE,OAAOE,KAAKD,SAASE,IAAIC,GAAOC,MAAMuE,KApCxC7D,GADC8D,gCAoCD9D,GADCE,+BArCU4B,KAXZ1B,EACG,CAAC,WAAYC,GACb,CACE0D,QAAS,CACPC,MAAO,CACLhF,EACAiF,OAKGnC,GA8Cb,SAAS+B,EAActD,GAErB,MAAMC,EAAWD,EAAME,IAAIC,GAAeC,MAClCG,MAAMC,MAAEA,IAAYR,EACtB2D,EAAQnD,EAAME,IAChB,CAAC,CAAEC,EAAG,CAAC,IAAK,QAASC,EAPC,gBAOyB,CAAEgD,EAAG,QAAShD,EAPvC,iBAQtBX,EAASY,GAAGC,EAAS+C,KAGzB,OAAOpD,EACHT,EAAMjB,MAAM+E,GACZH,EACAA,EAAMnD,MAAME,IACR,CAAEkD,EAAG,QAAShD,EAfI,gBAgBlBX,EAASY,GAAGC,EAASG,MAK/B,SAAS4C,GACL1C,UACEA,IAGJ,MAAO,CACLC,QAAS,QACTC,OAAQ,EACR0C,QAAS,GAAG5C,EAAUG,IAAI,MC1F9B0C,EAAgBC,KAAK1C"}