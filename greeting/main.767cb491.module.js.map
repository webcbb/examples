{"version":3,"file":"main.767cb491.module.js","sources":["../../src/greeting/greeting-out.component.ts","../../src/greeting/greeting.component.ts","../../src/greeting/index.ts"],"sourcesContent":["import { ProduceStyle, Theme } from '@wesib/generic';\nimport { AttachShadow, Attribute, BootstrapWindow, Component, ComponentContext, Render } from '@wesib/wesib';\nimport { StypRules } from 'style-producer';\nimport { BEX__NS, DefaultStyle } from '../common';\n\n@Component({\n  name: ['greeting-out', BEX__NS],\n})\n@AttachShadow()\nexport class GreetingOutComponent {\n\n  @Attribute()\n  name?: string;\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n    return this._context.get(Theme).style(DefaultStyle);\n  }\n\n  @Render()\n  render() {\n\n    const self = this;\n    const document = this._context.get(BootstrapWindow).document;\n    const content = document.createElement('span');\n\n    this._context.contentRoot.append(content);\n\n    return () => content.innerText = greetings();\n\n    function greetings() {\n\n      const name = self.name?.trim();\n\n      return name ? `Hello, ${name}!` : 'Hello!';\n    }\n  }\n\n}\n","import { ComponentNode, ComponentTreeSupport, ProduceStyle, Theme } from '@wesib/generic';\nimport { Component, ComponentContext, ComponentDef, DefaultNamespaceAliaser } from '@wesib/wesib';\nimport { ValueSync } from 'fun-events';\nimport { InCssClasses, inCssInfo, InGroup, inGroup, inText, InValidation, requirePresent } from 'input-aspects';\nimport { html__naming, QualifiedName } from 'namespace-aliaser';\nimport { StypProperties, stypRoot, stypRules, StypRules } from 'style-producer';\nimport { AppFeature, BEX__NS, InputStyle, inStyle, readonlyInStyle, ThemeSettings } from '../common';\nimport { FormThemeSettings } from '../common/theme';\nimport { GreetingOutComponent } from './greeting-out.component';\n\n@Component({\n  name: ['greeting', BEX__NS],\n  feature: {\n    needs: [\n      GreetingOutComponent,\n      ComponentTreeSupport,\n      AppFeature,\n    ],\n  },\n})\nexport class GreetingComponent {\n\n  private readonly _theme: Theme;\n  private readonly _outName: QualifiedName;\n\n  constructor(context: ComponentContext) {\n    this._theme = context.get(Theme);\n\n    const nsAlias = context.get(DefaultNamespaceAliaser);\n\n    this._outName = ComponentDef.of(GreetingOutComponent).name!;\n\n    const outSelector = html__naming.name(this._outName, nsAlias);\n\n    context.whenOn(supply => {\n\n      const node = context.get(ComponentNode);\n      const output = node.select(outSelector, { deep: true }).first;\n      const group = inGroup<GreetData>({ name: '' });\n\n      node.select('input', { all: true, deep: true }).first({\n            supply,\n            receive(_ctx, name) {\n              group.controls.set(\n                  'name',\n                  name && inText(name.element)\n                      .setup(InValidation, validation => validation.by(requirePresent))\n                      .setup(InCssClasses, classes => classes.add(inCssInfo())),\n              );\n            },\n          },\n      );\n\n      const nameSync = new ValueSync<string | null>('');\n\n      nameSync.sync(output, o => o?.attribute('name'));\n      nameSync.sync('in', group.controls, (controls: InGroup.Snapshot<GreetData>) => controls.get('name'));\n\n      supply.whenOff(() => nameSync.done());\n    });\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n\n    const settings = this._theme.ref(ThemeSettings).read.keep;\n    const formSettings = this._theme.ref(FormThemeSettings).read.keep;\n    const root = stypRoot();\n    const label = root.rules.add({ e: 'label' }, settings.thru(greetLabelStyle));\n\n    label.rules.add({ e: 'input' }, settings.thru(greetFieldStyle));\n    label.rules.add({ e: this._outName }, formSettings.thru(inStyle))\n        .add(formSettings.thru(readonlyInStyle))\n        .add(settings.thru(greetFieldStyle));\n\n    return stypRules(\n        this._theme.style(InputStyle),\n        root.rules,\n    );\n  }\n\n}\n\ninterface GreetData {\n  name: string;\n}\n\nfunction greetLabelStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: 0,\n    padding: `${$fontSize.div(2)}`,\n  };\n}\n\nfunction greetFieldStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: `${$fontSize.div(2)} 0 0 0`,\n  };\n}\n","import { noop } from 'call-thru';\nimport { examplesContext } from '../common';\nimport { GreetingComponent } from './greeting.component';\n\nexamplesContext.load(GreetingComponent)(noop).whenOff(reason => {\n  console.error('Failed to load greet-text example', reason);\n});\n"],"names":["GreetingOutComponent","[object Object]","_context","this","get","Theme","style","DefaultStyle","self","content","BootstrapWindow","document","createElement","contentRoot","append","innerText","name","trim","greetings","__decorate","Attribute","ProduceStyle","Render","Component","BEX__NS","AttachShadow","GreetingComponent","context","_theme","nsAlias","DefaultNamespaceAliaser","_outName","ComponentDef","of","outSelector","html__naming","whenOn","supply","node","ComponentNode","output","select","deep","first","group","inGroup","all","_ctx","controls","set","inText","element","setup","InValidation","validation","by","requirePresent","InCssClasses","classes","add","inCssInfo","nameSync","ValueSync","sync","o","attribute","whenOff","done","settings","ref","ThemeSettings","read","keep","formSettings","FormThemeSettings","root","stypRoot","label","rules","e","thru","greetLabelStyle","greetFieldStyle","inStyle","readonlyInStyle","stypRules","InputStyle","$fontSize","display","margin","padding","div","feature","needs","ComponentTreeSupport","AppFeature","examplesContext","load","noop","reason","console","error"],"mappings":"2WASA,IAAaA,EAAb,MAKEC,YAA6BC,GAAAC,cAAAD,EAI7BD,QACE,OAAOE,KAAKD,SAASE,IAAIC,GAAOC,MAAMC,GAIxCN,SAEE,MAAMO,EAAOL,KAEPM,EADWN,KAAKD,SAASE,IAAIM,GAAiBC,SAC3BC,cAAc,QAIvC,OAFAT,KAAKD,SAASW,YAAYC,OAAOL,GAE1B,IAAMA,EAAQM,UAErB,iBAEE,MAAMC,YAAOR,EAAKQ,2BAAMC,OAExB,OAAOD,EAAO,UAAUA,KAAU,SANHE,KAnBnCC,GADCC,gCAODD,GADCE,+BAMDF,GADCG,gCAbUtB,KAJZuB,EAAU,CACTP,KAAM,CAAC,eAAgBQ,KAExBC,KACYzB,GCWb,IAAa0B,EAAb,MAKEzB,YAAY0B,GACVxB,KAAKyB,OAASD,EAAQvB,IAAIC,GAE1B,MAAMwB,EAAUF,EAAQvB,IAAI0B,GAE5B3B,KAAK4B,SAAWC,EAAaC,GAAGjC,GAAsBgB,KAEtD,MAAMkB,EAAcC,EAAanB,KAAKb,KAAK4B,SAAUF,GAErDF,EAAQS,OAAOC,IAEb,MAAMC,EAAOX,EAAQvB,IAAImC,GACnBC,EAASF,EAAKG,OAAOP,EAAa,CAAEQ,MAAM,IAAQC,MAClDC,EAAQC,EAAmB,CAAE7B,KAAM,KAEzCsB,EAAKG,OAAO,QAAS,CAAEK,KAAK,EAAMJ,MAAM,IAAQC,MAAM,CAChDN,OAAAA,EACApC,QAAQ8C,EAAM/B,GACZ4B,EAAMI,SAASC,IACX,OACAjC,GAAQkC,EAAOlC,EAAKmC,SACfC,MAAMC,EAAcC,GAAcA,EAAWC,GAAGC,IAChDJ,MAAMK,EAAcC,GAAWA,EAAQC,IAAIC,UAM5D,MAAMC,EAAW,IAAIC,EAAyB,IAE9CD,EAASE,KAAKvB,EAAQwB,2BAAKA,wBAAGC,UAAU,UACxCJ,EAASE,KAAK,KAAMnB,EAAMI,SAAWA,GAA0CA,EAAS5C,IAAI,SAE5FiC,EAAO6B,QAAQ,IAAML,EAASM,UAKlClE,QAEE,MAAMmE,EAAWjE,KAAKyB,OAAOyC,IAAIC,GAAeC,KAAKC,KAC/CC,EAAetE,KAAKyB,OAAOyC,IAAIK,GAAmBH,KAAKC,KACvDG,EAAOC,IACPC,EAAQF,EAAKG,MAAMnB,IAAI,CAAEoB,EAAG,SAAWX,EAASY,KAAKC,IAO3D,OALAJ,EAAMC,MAAMnB,IAAI,CAAEoB,EAAG,SAAWX,EAASY,KAAKE,IAC9CL,EAAMC,MAAMnB,IAAI,CAAEoB,EAAG5E,KAAK4B,UAAY0C,EAAaO,KAAKG,IACnDxB,IAAIc,EAAaO,KAAKI,IACtBzB,IAAIS,EAASY,KAAKE,IAEhBG,EACHlF,KAAKyB,OAAOtB,MAAMgF,GAClBX,EAAKG,SAUb,SAASG,GACLM,UACEA,IAGJ,MAAO,CACLC,QAAS,QACTC,OAAQ,EACRC,QAAS,GAAGH,EAAUI,IAAI,MAI9B,SAAST,GACLK,UACEA,IAGJ,MAAO,CACLC,QAAS,QACTC,OAAQ,GAAGF,EAAUI,IAAI,YA3C3BxE,GADCE,+BA1CUK,KAVZH,EAAU,CACTP,KAAM,CAAC,WAAYQ,GACnBoE,QAAS,CACPC,MAAO,CACL7F,EACA8F,EACAC,OAIOrE,GChBbsE,EAAgBC,KAAKvE,EAArBsE,CAAwCE,GAAMhC,QAAQiC,IACpDC,QAAQC,MAAM,oCAAqCF"}