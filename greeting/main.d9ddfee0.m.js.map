{"version":3,"file":"main.d9ddfee0.m.js","sources":["../../src/greeting/greeting-out.component.ts","../../src/greeting/greeting.component.ts","../../src/greeting/index.ts"],"sourcesContent":["import { ProduceStyle, Theme } from '@wesib/generic';\nimport { AttachShadow, Attribute, BootstrapWindow, Component, ComponentContext, Render } from '@wesib/wesib';\nimport { StypRules } from 'style-producer';\nimport { BEX__NS, DefaultStyle } from '../common';\n\n@Component({\n  name: ['greeting-out', BEX__NS],\n})\n@AttachShadow()\nexport class GreetingOutComponent {\n\n  @Attribute()\n  name?: string;\n\n  constructor(private readonly _context: ComponentContext) {\n  }\n\n  @ProduceStyle()\n  style(): StypRules {\n    return this._context.get(Theme).style(DefaultStyle);\n  }\n\n  @Render()\n  render() {\n\n    const self = this;\n    const document = this._context.get(BootstrapWindow).document;\n    const content = document.createElement('span');\n\n    this._context.contentRoot.append(content);\n\n    return () => content.innerText = greetings();\n\n    function greetings() {\n\n      const name = self.name?.trim();\n\n      return name ? `Hello, ${name}!` : 'Hello!';\n    }\n  }\n\n}\n","import { ComponentNode, ElementNode, ProduceStyle, Theme } from '@wesib/generic';\nimport { BootstrapContext, Component, ComponentContext } from '@wesib/wesib';\nimport { afterThe, ValueSync } from 'fun-events';\nimport { InCssClasses, inCssInfo, InGroup, inGroup, inText, InValidation, requirePresent } from 'input-aspects';\nimport { StypProperties, stypRoot, stypRules, StypRules } from 'style-producer';\nimport {\n  AppFeature,\n  BEX__NS,\n  FormThemeSettings,\n  InElementComponent,\n  InputStyle,\n  inStyle,\n  readonlyInStyle,\n  ThemeSettings,\n} from '../common';\nimport { GreetingOutComponent } from './greeting-out.component';\n\n@Component({\n  name: ['greeting', BEX__NS],\n  feature: {\n    needs: [\n      GreetingOutComponent,\n      AppFeature,\n    ],\n  },\n})\nexport class GreetingComponent extends InElementComponent<InGroup<GreetData>> {\n\n  constructor(private readonly _context: ComponentContext) {\n    super(_context);\n    _context.whenOn(supply => {\n\n      const node = _context.get(ComponentNode);\n      const output = node.select(GreetingOutComponent, { deep: true }).first;\n      const sync = new ValueSync<string | null>('');\n\n      sync.sync(output, o => o?.attribute('name'));\n      sync.sync(\n          'in',\n          this.control.keep.dig_(\n              group => group ? group.controls.read : afterThe<[InGroup.Snapshot<GreetData>?]>(),\n          ),\n          controls => controls?.get('name'),\n      );\n\n      supply.whenOff(() => sync.done());\n    });\n  }\n\n  @ProduceStyle()\n  async style(): Promise<StypRules> {\n\n    const bsContext = this._context.get(BootstrapContext);\n    const { elementDef: { name: outName } } = await bsContext.whenDefined(GreetingOutComponent);\n    const theme = this._context.get(Theme);\n    const settings = theme.ref(ThemeSettings).read.keep;\n    const formSettings = theme.ref(FormThemeSettings).read.keep;\n    const root = stypRoot();\n    const label = root.rules.add({ e: 'label' }, settings.thru(greetLabelStyle));\n\n    label.rules.add({ e: 'input' }, settings.thru(greetFieldStyle));\n    label.rules.add({ e: outName }, formSettings.thru(inStyle))\n        .add(formSettings.thru(readonlyInStyle))\n        .add(settings.thru(greetFieldStyle));\n\n    return stypRules(\n        theme.style(InputStyle),\n        root.rules,\n    );\n  }\n\n  protected nodeControl(node: ElementNode): InGroup<GreetData> {\n\n    const group = inGroup<GreetData>({ name: '' });\n\n    group.controls.set(\n        'name',\n        inText(node.element)\n            .setup(InValidation, validation => validation.by(requirePresent))\n            .setup(InCssClasses, classes => classes.add(inCssInfo())),\n    );\n\n    return group;\n  }\n\n}\n\ninterface GreetData {\n  name: string;\n}\n\nfunction greetLabelStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: 0,\n    padding: `${$fontSize.div(2)}`,\n  };\n}\n\nfunction greetFieldStyle(\n    {\n      $fontSize,\n    }: ThemeSettings,\n): StypProperties {\n  return {\n    display: 'block',\n    margin: `${$fontSize.div(2)} 0 0 0`,\n  };\n}\n","import { examplesContext } from '../common';\nimport { GreetingComponent } from './greeting.component';\n\nexamplesContext.load(GreetingComponent);\n"],"names":["GreetingOutComponent","[object Object]","_context","this","get","Theme","style","DefaultStyle","self","content","BootstrapWindow","document","createElement","contentRoot","append","innerText","name","trim","greetings","__decorate","Attribute","ProduceStyle","Render","Component","BEX__NS","AttachShadow","GreetingComponent","InElementComponent","super","whenOn","supply","output","ComponentNode","select","deep","first","sync","ValueSync","o","attribute","control","keep","dig_","group","controls","read","afterThe","whenOff","done","bsContext","BootstrapContext","elementDef","outName","whenDefined","theme","settings","ref","ThemeSettings","formSettings","FormThemeSettings","root","stypRoot","label","rules","add","e","thru","greetLabelStyle","greetFieldStyle","inStyle","readonlyInStyle","stypRules","InputStyle","node","inGroup","set","inText","element","setup","InValidation","validation","by","requirePresent","InCssClasses","classes","inCssInfo","$fontSize","display","margin","padding","div","feature","needs","AppFeature","examplesContext","load"],"mappings":"8UASA,IAAaA,EAAb,MAKEC,YAA6BC,GAAAC,cAAAD,EAI7BD,QACE,OAAOE,KAAKD,SAASE,IAAIC,GAAOC,MAAMC,GAIxCN,SAEE,MAAMO,EAAOL,KAEPM,EADWN,KAAKD,SAASE,IAAIM,GAAiBC,SAC3BC,cAAc,QAIvC,OAFAT,KAAKD,SAASW,YAAYC,OAAOL,GAE1B,IAAMA,EAAQM,UAErB,iBAEE,MAAMC,YAAOR,EAAKQ,2BAAMC,OAExB,OAAOD,EAAO,UAAUA,KAAU,SANHE,KAnBnCC,GADCC,gCAODD,GADCE,+BAMDF,GADCG,gCAbUtB,KAJZuB,EAAU,CACTP,KAAM,CAAC,eAAgBQ,KAExBC,KACYzB,GCiBb,IAAa0B,EAAb,cAAuCC,EAErC1B,YAA6BC,GAC3B0B,MAAM1B,GADqBC,cAAAD,EAE3BA,EAAS2B,OAAOC,IAEd,MACMC,EADO7B,EAASE,IAAI4B,GACNC,OAAOjC,EAAsB,CAAEkC,MAAM,IAAQC,MAC3DC,EAAO,IAAIC,EAAyB,IAE1CD,EAAKA,KAAKL,EAAQO,2BAAKA,wBAAGC,UAAU,UACpCH,EAAKA,KACD,KACAjC,KAAKqC,QAAQC,KAAKC,KACdC,GAASA,EAAQA,EAAMC,SAASC,KAAOC,KAE3CF,2BAAYA,wBAAUxC,IAAI,UAG9B0B,EAAOiB,QAAQ,IAAMX,EAAKY,UAK9B/C,cAEE,MAAMgD,EAAY9C,KAAKD,SAASE,IAAI8C,IAC5BC,YAAcnC,KAAMoC,UAAoBH,EAAUI,YAAYrD,GAChEsD,EAAQnD,KAAKD,SAASE,IAAIC,GAC1BkD,EAAWD,EAAME,IAAIC,GAAeZ,KAAKJ,KACzCiB,EAAeJ,EAAME,IAAIG,GAAmBd,KAAKJ,KACjDmB,EAAOC,IACPC,EAAQF,EAAKG,MAAMC,IAAI,CAAEC,EAAG,SAAWV,EAASW,KAAKC,IAO3D,OALAL,EAAMC,MAAMC,IAAI,CAAEC,EAAG,SAAWV,EAASW,KAAKE,IAC9CN,EAAMC,MAAMC,IAAI,CAAEC,EAAGb,GAAWM,EAAaQ,KAAKG,IAC7CL,IAAIN,EAAaQ,KAAKI,IACtBN,IAAIT,EAASW,KAAKE,IAEhBG,EACHjB,EAAMhD,MAAMkE,GACZZ,EAAKG,OAID9D,YAAYwE,GAEpB,MAAM9B,EAAQ+B,EAAmB,CAAE1D,KAAM,KASzC,OAPA2B,EAAMC,SAAS+B,IACX,OACAC,EAAOH,EAAKI,SACPC,MAAMC,EAAcC,GAAcA,EAAWC,GAAGC,IAChDJ,MAAMK,EAAcC,GAAWA,EAAQpB,IAAIqB,OAG7C1C,IASX,SAASwB,GACLmB,UACEA,IAGJ,MAAO,CACLC,QAAS,QACTC,OAAQ,EACRC,QAAS,GAAGH,EAAUI,IAAI,MAI9B,SAAStB,GACLkB,UACEA,IAGJ,MAAO,CACLC,QAAS,QACTC,OAAQ,GAAGF,EAAUI,IAAI,YA5D3BvE,GADCE,+BAvBUK,KATZH,EAAU,CACTP,KAAM,CAAC,WAAYQ,GACnBmE,QAAS,CACPC,MAAO,CACL5F,EACA6F,OAIOnE,GCvBboE,EAAgBC,KAAKrE"}