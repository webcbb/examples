import{c as t,h as e,_ as n}from"./lib.05c728da.js";function r(t){const e=Array.from(t),{length:n}=e;if(n)return 1===n?e[0]:e}function s(t){return e=t,Array.isArray(e)?new Set(t):null!=t?new Set([t]):new Set;var e}function o(t,e){var n;return n=e,Array.isArray(n)?e.forEach(e=>t.add(e)):null!=e&&t.add(e),t}function i(t,e=(()=>!0)){const n=Object.getPrototypeOf(t.prototype);if(null==n)return;const r=n.constructor;return e(r)?r:i(r,e)}function u(t){return t}function c(t,e,n=((t,e)=>e)){return t?e?function(...r){return n(t.apply(this,r),e.apply(this,r))}:t:e}function a(){}function h(t){return()=>t}function l(...t){return()=>t}function d(t){let e=()=>(e=h(t()))();return()=>e()}function f(t){return null!=t}const p=Symbol("next-call");function g(t){const e=()=>e;return e[p]=(e,n)=>t(e,n),e}function y(t){return g((e,n)=>e.pass(n,t))}function _(...t){return g((e,n)=>e.call(n,t))}const m=g(t=>t.skip());function w(t){return t[Symbol.iterator]()}function*b(t){yield*t}function v(t,e){const n={[Symbol.iterator]:t};return e&&(n.reverse=e),n}function x(t){return v(()=>function(t){let e=0;return{next:()=>e<t.length?{value:t[e++]}:{done:!0}}}(t),()=>function(t){return v(()=>function(t){let e=t.length-1;return{next:()=>e<0?{done:!0}:{value:t[e--]}}}(t),()=>x(t))}(t))}function k(t,e){for(const n of t)e(n)}function $(t){return!!w(t).next().done}function S(t){const e=w(t).next();return e.done?void 0:e.value}function T(t,e,n){let r=n;for(const n of t)r=e(r,n);return r}function O(t,e){return{[Symbol.iterator](){const n=t[Symbol.iterator]();return{next(){for(;;){const t=n.next();if(t.done||e(t.value))return t}}}}}}function C(t,e=u){return{[Symbol.iterator](){const n=t[Symbol.iterator]();let r;return{next(){for(;;){if(!r){const t=n.next();if(t.done)return t;r=e(t.value)[Symbol.iterator]()}const t=r.next();if(!t.done)return t;r=void 0}}}}}}function A(t,e){return{[Symbol.iterator](){const n=t[Symbol.iterator]();return{next(){const t=n.next();return t.done?t:{value:e(t.value)}}}}}}const F={next:h({done:!0})},E={[Symbol.iterator]:h(F),reverse(){return this}};function D(t){return x(Reflect.ownKeys(t))}function R(t){const e=D(t),n=e=>A(e,e=>[e,t[e]]);return v(()=>w(n(e)),()=>n(e.reverse()))}const z=Symbol("context-key");class P{constructor(t){this.name=t}get[z](){return this}toString(){return`ContextKey(${this.name})`}}class U extends P{constructor(t){super(t.name+":seed")}get seedKey(){return this}grow(t){const{seeder:e,seed:n}=t;e.isEmpty(n)&&t.hasFallback||t.insert(n)}}class M extends Error{constructor(t,e="There is no value with key "+t){super(e),this.key=t}}function K(t){return"with"in t}class q{}class N{constructor(t){this._seeds=new Map,this._initial=null==t?a:"function"==typeof t?t:e=>t.get(e)}provide(t){const{a:{[z]:{seedKey:e}},by:n}=function(t){if(function(t){return"by"in t}(t)){if(!K(t))return t;const{a:e,by:n,with:r}=t;return{a:e,by:t=>n(...r.map(e=>t.get(e)))}}if(function(t){return"is"in t}(t)){const{a:e,is:n}=t;return{a:e,by:h(n)}}if(function(t){return"via"in t}(t)){const{a:e,via:n}=t;return{a:e,by:t=>t.get(n)}}if(function(t){return"as"in t}(t)){if(function(t){return!("a"in t)}(t)&&(t=function(t){return{...t,a:t.as}}(t)),!K(t)){const{as:e}=t;return{a:t.a,by:t=>new e(t)}}const{as:e,with:n}=t;return{a:t.a,by:t=>new e(...n.map(e=>t.get(e)))}}throw new TypeError("Malformed context value specifier: "+JSON.stringify(t))}(t),[r]=this._seeding(e);return r.provide(n)}_seeding(t){const e=this._seeds.get(t);if(e)return e;const n=t.seeder(),r=[n,e=>n.seed(e,this._initial(t,e))];return this._seeds.set(t,r),r}seed(t,e){const[,n]=this._seeding(e);return n(t)}seedIn(t,e){return this.newValues(e).get.bind(t)}newValues(t=!0){if(!t&&this._nonCachedValues)return this._nonCachedValues;const e=new Map,n=this;class r extends q{get({[z]:r},s){const o=e.get(r);if(null!=o)return o;const[i,u]=function(t,e,r={}){const[s,o]=function(t,e){const{seedKey:r}=e,[s,o]=n._seeding(r);if(r!==e)return[s,t.get(r)];return[s,o(t)]}(t,e);let i;const u="or"in r;let c=a;const h={context:t,key:e,seeder:s,seed:o,hasFallback:u,get or(){return r.or},insert(t){i=t},fillBy:t=>(t(h),i),setup(t){const e=c;c=n=>{e(n),t(n)}}};if(e.grow(h),null!=i)return[i,c];if(!u)throw new M(e);return[r.or]}(this,r,s);return t&&u&&(e.set(r,i),u({key:r,context:this,registry:n})),i}}return t?new r:this._nonCachedValues=new r}append(t){return new N((e,n)=>{const[r,s]=this._seeding(e);return r.combine(s(n),t.seed(n,e),n)})}}class L{constructor(){this._providers=[]}provide(t){return this._providers.push(t),()=>{const e=this._providers.indexOf(t);e>=0&&this._providers.splice(e,1)}}seed(t,e=function(){return E}()){return C([e,I(t,this._providers)])}isEmpty(t){return $(t)}combine(t,e){return C([t,e])}}class j extends U{seeder(){return new L}}class B extends P{constructor(t,{seedKey:e}={}){super(t),this.seedKey=e||new j(this)}}function I(t,e){return O(A(e.map(e=>d(e.bind(void 0,t))),t=>t()),f)}class W extends B{constructor(t,{seedKey:e,byDefault:n=l()}={}){super(t,e),this.byDefault=n}grow(t){const e=Array.from(t.seed);if(e.length)t.insert(e);else if(!t.hasFallback){const e=this.byDefault(t.context,this);e&&t.insert(Array.from(e))}}}class V{constructor(){this._providers=[]}provide(t){return this._providers.unshift(t),()=>{const e=this._providers.lastIndexOf(t);e>=0&&this._providers.splice(e,1)}}seed(t,e){const{length:n}=this._providers;if(!n)return e||a;const r=e=>d(e.bind(void 0,t));if(!e&&1===n)return r(this._providers[0]);const s=this._providers.map(r);return e&&s.push(e),G(s)}isEmpty(t){return null==t()}combine(t,e){return t===a?e:e===a?t:G([e,t])}}function G(t){return d(()=>{for(const e of t){const t=e();if(null!=t)return t}})}class H extends U{seeder(){return new V}}class Q extends P{constructor(t,{seedKey:e}={}){super(t),this.seedKey=e||new H(this)}}class J extends Q{constructor(t,{seedKey:e,byDefault:n=a}={}){super(t,{seedKey:e}),this.byDefault=n}grow(t){const e=t.seed();null!=e?t.insert(e):t.hasFallback||t.insert(this.byDefault(t.context,this))}}const Z=Symbol("after-event");function X(t){return Z in t}const Y=Symbol("events-supply");class tt{constructor(t=a){this._off=e=>{this._whenOff=t=>t(e),this._off=a,t(e)},this._whenOff=t=>{const e=this._off;this._off=n=>{e(n),t(n)}}}get isOff(){return this._off===a}get[Y](){return this}off(t){return this._off(t),this}whenOff(t){return this._whenOff(t),this}whenDone(){return new Promise((t,e)=>this.whenOff(n=>void 0===n?t():e(n)))}cuts(t){return et(t).needs(this),this}needs(t){return et(t).whenOff(t=>this._off(t)),this}}function et(t){return t[Y]}function nt(t){return new tt(t)}function rt(t){let e;return e="function"==typeof t?{supply:nt(),receive(e,...n){t(...n)}}:{supply:t.supply||nt(),receive(e,...n){this.supply.isOff||t.receive(e,...n)}},e.supply.whenOff(()=>e.receive=a),e}function st(t){let e=function n(r){let s=t;const o=[];e=t=>o.push(t);try{for(;;){s=ot(s,r);const t=o.shift();if(!t)break;r=t}}finally{e=n}};return(...t)=>e(t)}function ot(t,e){const n=[];for(const r of t){const t=n.length;n.push(r);const s={onRecurrent(e){n[t]=rt({supply:r.supply,receive(t,...n){e(...n)}})}};r.receive(s,...e)}return n}class it{constructor(){const t=this._rcs=new Set;this.send=st(t),this[Y]=nt(()=>{t.clear(),delete this._rcs})}get size(){return this._rcs?this._rcs.size:0}on(t){const e=rt(t),n=e.supply.needs(this),r=this._rcs;return r&&!n.isOff&&(r.add(e),n.whenOff(()=>r.delete(e))),n}done(t){return et(this).off(t),this}}const ut=Symbol("on-event");function ct(t){return ut in t}class at extends tt{get isOff(){return!0}off(){return this}whenOff(t){return t(),this}cuts(t){return et(t).off(),this}needs(){return this}}const ht=new at;function lt(){return ht}function dt(t){const e=rt(t);let n=st([e]);return e.supply.whenOff(()=>n=a),(...t)=>n(...t)}function ft(t){return e=>{t.to({supply:e.supply,receive:(t,...n)=>{e.receive(t,...n),e.supply.off()}})}}function pt(t){const e=new it;let n,r;return s=>{if(e.size||(r=[],n=nt(()=>r=void 0),t.to({supply:n,receive(t,...n){r&&(e.size?r=void 0:r.push(n)),e.send(...n)}})),s.supply.needs(n),e.on(s).whenOff(t=>{e.size||n.off(t)}),r){const t=dt(s);r.forEach(e=>t(...e))}}}function gt(t,e){return n=>{const r=[];t.to({supply:n.supply,receive(t,...s){const o=(s,i)=>{const u=s>=e.length;++s;const c=r[s];if(c){const t=c.supply;return c.supply=i,[c.chain,t]}const h=s<e.length?e[s]:a,l={chain:{call(t,e){d(t(...e),e)},pass(t,e){d(t(e),[e])},skip(){l.supply.off()},onEvent(t,e){const n=nt().needs(l.supply);e[ut]().to({supply:n,receive(e,...r){d(t(...r),r,n)}})}},supply:i};return r[s]=l,[l.chain,lt()];function d(e,r,i=l.supply){const[c,a]=o(s,nt().needs(i));try{"function"==typeof(d=e)&&p in d?e[p](c,h):u?n.receive(t,...r):c.pass(h,e)}finally{a.off()}var d}},[i,u]=o(0,nt().needs(n.supply));try{i.call(e[0],s)}finally{u.off()}}})}}function yt(t,e,n){return r=>{n?t.to({supply:nt().needs(e).cuts(n),receive:r.receive.bind(r)}):(r.supply.needs(e),t.to(r))}}function _t({supply:t}){t.off()}class mt{constructor(t){this._on=t}get F(){return this.to.bind(this)}[ut](){return this}to(t){if(!t)return this;const e=rt(t),{supply:n}=e;return n.isOff||this._on(e),n}then(t,e){return function(t,e,n){return new Promise((r,s)=>{ft(t)({supply:nt(n?t=>{try{r(n(t))}catch(t){s(t)}}:s),receive:e?(t,...n)=>{try{r(e(...n))}catch(t){s(t)}}:(t,e)=>r(e)})})}(this,t,e)}once(t){return(this.once=wt(ft(this)).F)(t)}tillOff(t,e){return wt(yt(this,t,e))}consume(t){let e=lt();const n=nt(t=>e.off(t));return this.to({supply:n,receive(n,...r){const s=e;try{e=et(t(...r)||lt())}finally{e!==s&&s.off()}}}),n}share(){return wt(pt(this))}thru(...t){return this.thru_(...t).share()}thru_(...t){return wt(gt(this,t))}}function wt(t){return new mt(t)}function bt(){throw new Error("No events to send")}class vt extends mt{constructor(t,e=bt){super(t),this._rcn=0,this._or=e}get F(){return this.to.bind(this)}[Z](){return this}to(t){if(!t)return this;let e=a;const n=rt(t);if(n.supply.isOff)return n.supply;const r=nt().needs(n.supply);let s=!1;return this._on({supply:r,receive:(t,...n)=>{s=!0,this._last=n,e(t,...n)}}),++this._rcn,r.isOff&&!s||(n.receive({onRecurrent(t){e=(e,...n)=>t(...n)}},...this._last||(this._last=this._or())),e=(t,...e)=>n.receive(t,...e)),r.whenOff(t=>{--this._rcn||(this._last=void 0),n.supply.off(t)}),r}once(t){return(this.once=xt(ft(this)).F)(t)}tillOff(t,e){return xt(yt(this,t,e))}share(){return xt(pt(this))}keepThru(...t){return this.keepThru_(...t).share()}keepThru_(...t){return xt(gt(this,t))}}function xt(t,e){return new vt(t,e)}function kt(t,e){return xt(e=>t[ut]().to(e),e)}function $t(t,e){return X(t)?t[Z]():kt(t,e)}function St(t){const e=Object.keys(t);return xt((function(n){const{supply:r}=n,s=dt(n);let o=a;const i={};e.forEach(e=>{r.needs(t[e][Z]().to((...t)=>{i[e]=t,o()}).needs(r))}),r.isOff||(o=()=>s(i))}),(function(){const n={};return e.forEach(e=>$t(t[e]).once((...t)=>n[e]=t)),[n]})).share()}function Tt(...t){return xt((function(e){const{supply:n}=e,r=dt(e);let s=a;const o=[];t.forEach((t,e)=>{n.needs(t[Z]().to((...t)=>{o[e]=t,s()}).needs(n))}),n.isOff||(s=()=>r(...o))}),(function(){const e=[];return t.forEach(t=>$t(t).once((...t)=>e.push(t))),e})).share()}function Ot(...t){return xt(a,h(t))}function Ct(t){return g((e,n)=>e.onEvent(n,$t(t)))}class At extends it{on(t){return(this.on=wt(t=>super.on(t)).F)(t)}[ut](){return this.on()}}const Ft=wt(_t);function Et(t){return ct(t)?t[ut]():t[Z]()}function Dt(...t){return t.length?wt(e=>{const{supply:n}=e;let r=t.length;const s=t=>{--r||n.off(t)},o=(t,...n)=>{e.receive(t,...n)};t.forEach(t=>Et(t).to({supply:nt(s).needs(n),receive:o}))}).share():Ft}function Rt(t){return wt(e=>{const{supply:n}=e,r=dt(e),s=nt();let o=0;const i=Et(t).tillOff(n,s).thru_(t=>(++o,y(t)));let u=[],c=1,a=0;s.whenOff(t=>{o||n.off(t)}),function(t){return wt(e=>{const{supply:n}=e,r=dt(e);let s=0;t[ut]().to({supply:n,receive(t,e){const o=++s;Promise.resolve().then(()=>e).then(t=>r(t,o),t=>n.off(t))}})})}(i).to({supply:n,receive(t,n,i){const h=i-c;if(u[h]=n,++a,a>h){let t;a===u.length?(t=u,u=[]):t=u.splice(0,h+1),c+=t.length,a-=t.length,o-=t.length,r(...t),!o&&s.isOff&&e.supply.needs(s)}}})})}function zt(t){let e=n=>{t.then(()=>e(n),()=>e(n))};return t.then(t=>{e=function(t){return e=>{try{dt(e)(t),e.supply.off()}catch(t){e.supply.off(t)}}}(t)}).catch(t=>{var n;n=t,e=({supply:t})=>t.off(n)}),wt(t=>e(t))}function Pt(t){return Array.isArray(t)?t:[t]}class Ut{constructor(t){this._drop=t,this.emitter=new At,this._nested=new Map,this.emitter.on((t,e,n)=>{const r=t[0],s=this._nested.get(r);s&&s.emitter.send(t.slice(1),e,n)})}on(t){const e=this.emitter.on(t);return nt(t=>{e.off(t),this._dropIfEmpty()}).needs(e)}nest(t,e){const n=this._nested.get(t);if(n||e)return n;const r=new Ut(()=>this._remove(t));return this._nested.set(t,r),r}done(t){for(const e of this._nested.values())e.done(t);this.emitter.done(t)}_remove(t){this._nested.delete(t),this._dropIfEmpty()}_dropIfEmpty(){!this._nested.size&&this.emitter.size<=1&&this._drop()}}class Mt{constructor(){this._root=new Ut(a)}on(t,e){return this._entry(t).on(e)}send(t,e,n){this._root.emitter.send(t,e,n)}done(t,e){const n=this._entry(t,!0);n&&n.done(e)}_entry(t,e){let n=this._root;for(const r of t){const t=n.nest(r,e);if(!t)return;n=t}return n}}class Kt{constructor(t,e){this._trackers=t,this._path=e,this.update=(t,e,n)=>{this._trackers.send([...this._path,...Pt(t)],e,n)}}get _tracker(){return this}onUpdate(t){return(this.onUpdate=wt(t=>this._trackers.on(this._path,t)).F)(t)}[ut](){return this.onUpdate()}track(t){return(t=Pt(t)).length?new Kt(this._trackers,[...this._path,...t]):this}done(t){this._trackers.done(this._path,t)}}class qt{constructor(){this._tracker=new Kt(new Mt,[])}onUpdate(t){return(this.onUpdate=this._tracker.onUpdate().F)(t)}[ut](){return this.onUpdate()}get update(){return this._tracker.update}track(t){const e=this._tracker.track(t);return e===this._tracker?this:e}done(t){this._tracker.done(t)}}class Nt{constructor(){this._by=lt()}read(t){return(this.read=xt(t=>{return this.on({supply:(e=t).supply,receive(t,n){e.receive({onRecurrent(e){t.onRecurrent(t=>e(t))}},n)}});var e},()=>[this.it]).F)(t)}[ut](){return this.on()}[Z](){return this.read()}by(t,e){const n=t=>(X(t)?t[Z]():t[ut]()).to(t=>this.it=t);if(this.byNone(),e){const r=t;this._by=Et(r).consume((...t)=>{const r=e(...t);if(r)return n(r)})}else{const e=t;this._by=n(e)}return this._by.whenOff(()=>this._by=lt()),this}byNone(t){return this._by.off(t),this}done(t){return et(this).off(t),this}}class Lt extends Nt{constructor(t){super(),this._it=t,this._on=new At}get[Y](){return et(this._on)}on(t){return(this.on=this._on.on().F)(t)}get it(){return this._it}set it(t){const e=this._it;e!==t&&(this._it=t,this._on.send(t,e))}}function jt(t){return new Lt(t)}class Bt extends Nt{constructor(t){super(),this._on=new At,this._it=t}on(t){return(this.on=this._on.on().F)(t)}get[Y](){return et(this._on)}get it(){return this._it}set it(t){const e=this.it;e!==t&&(this._it=t,this._on.send(t,e))}sync(t,e,n){let r,s,o=t=>c(this,t);"string"==typeof t?("in"===t&&(o=t=>c(t,this)),r=e,s=n):(r=t,s=e);const i=s;if(!i)return o(r);const u=r;return(X(u)?$t(u):Et(u)).consume((...t)=>{const e=i(...t);return e&&o(e)});function c(t,e){const n=t.read(t=>{e.it=t}),r=e.on(e=>{t.it=e});return nt(t=>{r.off(t),n.off(t)}).needs(n).needs(r)}}}class It{name(t,e){if("string"==typeof t)return t;const[n,r]=t;return r.name(e(r),n,this)}}class Wt extends It{applyAlias(t,e){return`${e}-${t}`}}const Vt=new Wt,Gt=new Wt;class Ht extends It{applyAlias(t,e){return`${e}:${t}`}}const Qt=new Ht;class Jt extends It{applyAlias(t,e){return`${t}@${e}`}}const Zt=new Jt;class Xt{constructor(t,...e){this.url=t,this.aliases=e}get alias(){return this.aliases[0]||"ns"}name(t,e,n=Vt){return n.applyAlias(e,t,this)}}function Yt(t){return"string"==typeof t||function(t){return Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&t[1]instanceof Xt}(t)}function te(t,e){if("string"==typeof t)return"string"==typeof e?ee(t,e):e[1].url?-1:ee(t,e[0]);const[n,{url:r}]=t;return"string"==typeof e?r?1:ee(n,e):ee(r,e[1].url)||ee(n,e[0])}function ee(t,e){return t<e?-1:t>e?1:0}function ne(){const t=new Map,e=new Map;return function(n){const r=t.get(n.url);if(r)return r;const s=n.alias;let o=0;for(const r of[s,...n.aliases]){const s=e.get(r);if(!s)return t.set(n.url,r),e.set(r,1),r;o||(o=s)}const i=`${s}${++o}`;return t.set(n.url,i),e.set(s,o),i}}class re extends mt{get F(){return this.to.bind(this)}to(t,e){if(!t)return this;const n=rt(t),{supply:r}=n;return r.isOff||this._on(n,e),r}once(t,e){return(this.once=se(ft(this)).F)(t,e)}tillOff(t,e){return se(yt(this,t,e))}capture(t,e){return(this.capture=se((t,e)=>null==e?this.to(t,!0):"object"==typeof e&&null==e.capture?this.to(t,{...e,capture:!0}):this.to(t,e)).F)(t,e)}instead(t,e){return(this.instead=se((t,e)=>{const n=rt(t);return this.to({supply:n.supply,receive(t,e){e.preventDefault(),n.receive(t,e)}},e)}).F)(t,e)}just(t,e){return(this.just=se((t,e)=>{const n=rt(t);return this.to({supply:n.supply,receive(t,e){e.stopPropagation(),n.receive(t,e)}},e)}).F)(t,e)}last(t,e){return(this.last=se((t,e)=>{const n=rt(t);return this.to({supply:n.supply,receive(t,e){e.stopImmediatePropagation(),n.receive(t,e)}},e)}).F)(t,e)}passive(t,e){return(this.passive=se((t,e)=>null==e?this.to(t,{passive:!0}):"boolean"==typeof e?this.to(t,{capture:e,passive:!0}):null==e.passive?this.to(t,{...e,passive:!0}):this.to(t,e)).F)(t,e)}}function se(t){return new re(t)}var oe;const ie={onRecurrent:a};class ue{constructor(t){this[oe]=nt(),this._target=t}on(t){return se((e,n)=>{const{supply:r}=e;if(r.needs(et(this)),!r.isOff){const r=t=>e.receive(ie,t);this._target.addEventListener(t,r,n),e.supply.whenOff(()=>this._target.removeEventListener(t,r))}})}dispatch(t){return!et(this).isOff&&this._target.dispatchEvent(t)}done(t){return et(this).off(t),this}}function ce(t){return()=>{throw null!=t?t:new TypeError("Context destroyed")}}oe=Y;class ae extends Q{constructor(){super("context-supply")}grow(t){t.insert(t.seed()||(t.hasFallback?t.or:null)||t.context[Y])}}const he=new ae;class le{constructor(){this._providers=jt([])}provide(t){return this._providers.it=[...this._providers.it,t],()=>{const e=this._providers.it,n=e.indexOf(t);n>=0&&(this._providers.it=e.slice(0,n).concat(e.slice(n+1)))}}seed(t,e=Ot()){return this.combine(e,function(t,e){return e.read().keepThru(e=>e.length?Ct(Tt(...A(A(x(e),e=>e(t)),de))):_(),fe)}(t,this._providers))}isEmpty(){return!1}combine(t,e){return Tt(t,e).keepThru(fe)}}function de(t){return null==t?Ot():function(t){return("object"==typeof t||"function"==typeof t)&&X(t)}(t)?$t(t):Ot(t)}function fe(...t){return _(...C(t))}class pe extends U{get upKey(){return this}seeder(){return new le}}class ge extends P{constructor(t,e){super(t.name+":up"),this._key=t,this.grow=t=>{const n=t.fillBy(e);if(n){const e=t.context.get(he,{or:null});e&&t.insert(n.tillOff(e))}}}get seedKey(){return this._key.seedKey}}class ye extends P{constructor(t,{seedKey:e}={}){super(t),this.seedKey=e||new pe(this)}createUpKey(t){return new ge(this,t)}}class _e extends ye{constructor(t,{seedKey:e,byDefault:n=a}={}){super(t,e),this.byDefault=(t,e)=>n(t,e)||(()=>{throw new M(this)}),this.upKey=this.createUpKey(t=>{t.insert(t.seed.keepThru((...e)=>e.length?e[e.length-1]:t.hasFallback&&t.or?Ct(t.or):Ct(Ot(this.byDefault(t.context,this)))))})}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Ot(t.or):t.or}:void 0).to(t=>e=t).whenOff(t=>e=ce(t)),t.insert((...t)=>e(...t))}}class me extends ye{constructor(t,{seedKey:e,byDefault:n=a}={}){super(t,e),this.byDefault=n}get upKey(){return this}grow(t){const e=t.seed.keepThru((...e)=>{if(e.length)return y(e[e.length-1]);let n;if(t.hasFallback)n=t.or;else{const e=this.byDefault(t.context,this);n=e&&Ot(e)}return Ct(null!=n?n:xt(()=>{throw new M(this)}))}),n=t.context.get(he,{or:null});t.insert(n?e.tillOff(n):e)}}const we={by(t={}){let e;return{get node(){return t.node},get window(){return e||(e=t.window||t.node&&((n=t.node).ownerDocument||n).defaultView||window);var n},error(...e){t&&t.error?t.error(...e):console.error(...e)}}}};const be=Symbol("render-q");class ve{constructor(t,e){this.q=t,this.schedule=this.doSchedule,this.ref=e||[this,this]}static by(t,e){return t[be]||(t[be]=new ve(t,e))}add(t){this.q.add(t)}doSchedule(t){this.schedule=()=>{};const e=[],n={get config(){return t},postpone(t){e.unshift(t)}};this.q.schedule(()=>{const t=this.reset();t.suspend(),this.exec(n),this.ref[1]=this.ref[0],e.forEach(t=>this.q.add(t)),n.postpone=t=>this.q.post(t),this.exec(n),t.resume()})}exec(t){for(;;){const e=this.q.pull();if(!e)break;e(t)}}reset(){return this.ref[0]=ve.by(this.q.reset(),this.ref)}suspend(){this.schedule=t=>{this.scheduled=t,this.schedule=()=>{}}}resume(){this.scheduled?this.doSchedule(this.scheduled):this.schedule=this.doSchedule}}function xe(t){return e=>{const n=we.by(e),r=ve.by(t.newQueue(n)).ref;let s=[];return t=>{const[e,,o]=s,[i,u]=r;let c=e||u;if(e===u&&!o||e===i)s[1]=t;else{const e=s=[c=o?i:u,t];c.add(t=>{e[2]=!0;try{e[1]({get config(){return n},postpone(e){t.postpone(e)}})}catch(t){n.error(t)}})}c.schedule(n)}}}const ke={by({schedule:t,replace:e=(()=>{})}){const n=[];return{schedule:t,add(t){n.push(t)},post(t){n.unshift(t)},pull:()=>n.shift(),reset(){const n=ke.by({schedule:t,replace:e});return e(n),n}}}},$e=new WeakMap,Se=t=>{const e=we.by(t);return t=>{const n=[],r={get config(){return e},postpone(t){n.push(t)}};for(s(t);;){const t=n.pop();if(!t)break;s(t)}function s(t){try{t(r)}catch(t){e.error(t)}}}};let Te=xe({newQueue({window:t}){const e=$e.get(t);if(e)return e;const n=ke.by({schedule:e=>t.requestAnimationFrame(e),replace:e=>$e.set(t,e)});return $e.set(t,n),n}});function Oe(t){return Te(t)}const Ce=new J("bootstrap-context");class Ae extends q{static get[z](){return Ce}}function Fe(t){return(e,n)=>{const r=e.get(Ae);return e===r?t(r,n):r.get(n)}}function Ee(t,e,n,r){const s=!n,o=r(n?function(t){if(function(t){return void 0===t.value&&void 0===t.writable}(t))return t;const e=Symbol("value"),n=t.value,r={...t,writable:void 0,value:void 0,get(){return e in this?this[e]:n}};return t.writable&&(r.set=function(t){this[e]=t}),delete r.writable,delete r.value,r}(n):function(t,e){const n=Symbol(String(e)+":value"),r=t[e];return{configurable:!0,enumerable:!0,get(){return n in this?this[n]:r},set(t){this[n]=t}}}(t,e));if(!s||!o)return o;Object.defineProperty(t,e,o)}function De(t){return t.nodeType===Node.ELEMENT_NODE}class Re{constructor(t){this.symbol=t}own(t){return t.hasOwnProperty(this.symbol)?t[this.symbol]:void 0}of(t){const e=this.own(t),n=i(t),r=n&&this.of(n);return e?r?this.merge([r,e]):e:r}define(t,e){const n=this.own(t),r=A(e,e=>this.meta(e,t)),s=this.merge(n?C([[n],r]):r);return Object.defineProperty(t,this.symbol,{configurable:!0,value:s}),t}}class ze{constructor(){this.promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}resolve(t){this._resolve(t)}reject(t){this._reject(t)}}const Pe=Symbol("feature-def");class Ue extends Re{constructor(){super(Pe)}merge(t){return T(t,(t,e)=>({needs:r(o(s(t.needs),e.needs)),has:r(o(s(t.has),e.has)),setup:c(t.setup,e.setup),init:c(t.init,e.init)}),{})}meta(t,e){const n=t[Pe];return null==n?t:this.meta("function"==typeof n?t[Pe](e):n,e)}}const Me=new Ue,Ke={[Pe]:()=>({})},qe={of:t=>Me.of(t)||{},for:(t,e)=>Me.meta(e,t),merge:(...t)=>Me.merge(t),all:(...t)=>T(t,(t,e)=>({[Pe]:n=>qe.merge(qe.for(n,t),qe.for(n,e))}),Ke),define:(t,...e)=>Me.define(t,e)};function Ne(...t){return e=>qe.define(e,...t)}const Le=new J("feature-context");class je extends Ae{static get[z](){return Le}whenDefined(t){return this.get(Ae).whenDefined(t)}load(t){return this.get(Ae).load(t)}}class Be extends Error{constructor(t){super("Circular feature needs: "+t.reduce((t,[e,n,r])=>(t||e.name)+` ${n} ${r.name}`,"")),this.needs=t}}class Ie{[Z](){return this.read()}}const We=Symbol("component-def");class Ve extends Re{constructor(){super(We)}merge(t){return T(t,(t,e)=>({...t,...e,setup:c(t.setup,e.setup),define:c(t.define,e.define),feature:t.feature?e.feature?qe.merge(t.feature,e.feature):t.feature:e.feature}),{})}meta(t,e){const n=t[We];return null!=n?this.meta("function"==typeof n?t[We](e):n,e):null!=t[Pe]?{feature:qe.for(e,t)}:Yt(t)?{name:t}:t}}const Ge=new Ve,He={[We]:()=>({})},Qe={of:t=>Ge.of(t)||{},for:(t,e)=>Ge.meta(e,t),merge:(...t)=>Ge.merge(t),all:(...t)=>T(t,(t,e)=>({[We]:n=>Qe.merge(Qe.for(n,t),Qe.for(n,e))}),He),define:(t,...e)=>Ge.define(t,e)};function Je(...t){const e=e=>Qe.define(e,...t);return e[We]=()=>Qe.all(...t),e}const Ze=new J("component-context"),Xe=new J("component-event-dispatcher",{byDefault(t){const e=t.get(Ze),n=new ue(e.element);return et(n).needs(e),{dispatch:t=>n.dispatch(t),on:t=>n.on(t)}}}),Ye=new J("content-root",{byDefault:t=>t.get(Ze).element});class tn extends ye{constructor(){super("state-updater"),this.upKey=this.createUpKey(t=>t.insert(t.seed.keepThru((...e)=>{if(e.length){const t=e.reduce((t,e)=>c(e,t),a);return(e,n,r)=>t(Pt(e),n,r)}return t.hasFallback&&t.or?Ct(t.or):a})))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Ot(t.or):t.or}:void 0).to(t=>e=t).whenOff(()=>e=a),t.insert((t,n,r)=>e(t,n,r))}}const en=new tn,nn=Symbol("component-context");class rn extends q{constructor(){super(),this.updateState=(t,e,n)=>{this.get(en)(t,e,n)}}static get[z](){return Ze}static of(t){const e=t[nn];if(!e)throw TypeError("No component context found in "+t);return e}get contentRoot(){return this.get(Ye)}on(t){return this.get(Xe).on(t)}dispatchEvent(t){this.get(Xe).dispatch(t)}}class sn extends Event{get context(){return rn.of(this.target)}}const on=Symbol("anonymous-component-property");function un(t){const e=({get:e,set:n},r=on,s)=>Je({[We](o){const i=t({type:o,key:r,readable:!0,writable:s,enumerable:!1,configurable:!1,get:t=>e(t,r),set:(t,e)=>n(t,e,r)});return i&&i.componentDef||{}}}),n=(t,n)=>e({get:(e,n)=>t(e,n)},n,!1),r=(e,n,r)=>Ee(e,n,r,r=>{const{get:s,set:o}=r,i=e.constructor,{get:u,set:c,configurable:a,enumerable:h,componentDef:l={}}=t({type:i,key:n,readable:!!r.get,writable:!!r.set,enumerable:!!r.enumerable,configurable:!!r.configurable,get:s?t=>s.call(t):cn(n),set:o?(t,e)=>o.call(t,e):an(n)})||{};Qe.define(i,l);const d={...r,configurable:null!=a?a:r.configurable,enumerable:null!=h?h:r.enumerable};return(u||c)&&(d.get=u&&function(){return u(this,n)},d.set=c&&function(t){c(this,t,n)}),d});return r.With=(t,n)=>e(t,n,!0),r.By=n,r.As=(t,e)=>n(h(t),e),r.Bind=(t,n=on)=>{const r=Symbol(String(n)+":accessor"),s=e=>{const s=e[r];if(s)return s;const o=t(e,n);return e[r]={get:o.get?o.get.bind(o):cn(n),set:o.set?o.set.bind(o):an(n)}};return e({get:t=>s(t).get(),set:(t,e)=>s(t).set(e)},n,!0)},r}function cn(t){return()=>{throw new TypeError(`"${String(t)}" is not readable`)}}function an(t){return()=>{throw new TypeError(`"${String(t)}" is not writable`)}}const hn=new J("bootstrap-context-registry");class ln extends N{constructor(){super(),this.provide({a:ln,is:this}),this.values=this.newValues()}static get[z](){return hn}static create(){return new ln}}const dn=new J("component-context-registry",{byDefault:Fe(()=>new fn)});class fn extends N{static get[z](){return dn}}const pn=new J("definition-context-registry",{byDefault:Fe(t=>new gn(t))});class gn extends N{static get[z](){return pn}}const yn=Symbol("post-def-setup");function _n(t){if(t.hasOwnProperty(yn))return t[yn];const e=jt(),n=new At,r=Dt(e.read().thru(t=>t?_(t):m()),n),s=i(t,t=>We in t);if(s){const t=_n(s);r.to(e=>t.send(e))}const o={on:r,send(t){n.send(t)},setup(t){e.it=t}};return Object.defineProperty(t,yn,{value:o}),o}const mn=new J("window",{byDefault:()=>window}),wn=new J("bootstrap-root",{byDefault:t=>t.get(mn).document.body}),bn=new J("default-namespace-aliaser");class vn extends ye{constructor(){super("default-render-scheduler"),this.upKey=this.createUpKey(t=>t.insert(t.seed.keepThru((...e)=>e.length?xn(t.context,e[e.length-1]):t.hasFallback&&t.or?Ct(t.or):xn(t.context,Oe))))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Ot(t.or):t.or}:void 0).to(n=>e=xn(t.context,n)).whenOff(t=>e=ce(t)),t.insert((...t)=>e(...t))}}function xn(t,e){return(n={})=>e({...n,window:n.window||t.get(mn)})}const kn=new vn;class $n extends ye{constructor(){super("element-adapter"),this.upKey=this.createUpKey(t=>t.insert(t.seed.keepThru((...e)=>{const n=e.reduce((t,e)=>n=>t(n)||e(n),Sn);return n!==Sn?n:t.hasFallback&&t.or?Ct(t.or):Sn})))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Ot(t.or):t.or}:void 0).to(t=>e=t).whenOff(t=>e=ce(t)),t.insert(t=>e(t))}}function Sn(t){return t[nn]}const Tn=new $n,On=new _e("element-observer",{byDefault:Fe(t=>{const e=t.get(Tn);class n extends MutationObserver{constructor(t){super(n=>{n.forEach(t=>{k(x(t.removedNodes),t=>{var e;return null===(e=function(t){var e;return null===(e=t[nn])||void 0===e?void 0:e.mount}(t))||void 0===e?void 0:e.checkConnected()}),k(O(x(t.addedNodes),De),t=>{var n,r;return null===(r=null===(n=e(t))||void 0===n?void 0:n.mount)||void 0===r?void 0:r.checkConnected()})}),t(n,this)})}observe(t,e){super.observe(t,{...e,childList:!0})}}return t=>new n(t)})});const Cn=Symbol("definition-context");function An(t){if(!t.hasOwnProperty(Cn))throw new TypeError("Component is not defined: "+t);return t[Cn]}const Fn=new J("custom-elements",{byDefault:Fe((function(t){const e=t.get(mn).customElements,n=t.get(bn);return new class extends En{define(t,r){if(Yt(t))return void e.define(Gt.name(t,n),r);const s=An(t),{name:o,extend:i}=s.elementDef;o?i&&i.name?e.define(Gt.name(o,n),r,{extends:i.name}):e.define(Gt.name(o,n),r):Rn(t).resolve(void 0)}whenDefined(t){if(Yt(t))return e.whenDefined(Gt.name(t,n));const r=An(t),{name:s}=r.elementDef;return s?e.whenDefined(Gt.name(s,n)):Rn(t).promise}}}))});class En{static get[z](){return Fn}}const Dn=Symbol("component-resolver");function Rn(t){return t.hasOwnProperty(Dn)?t[Dn]:t[Dn]=new ze}const zn=new J("definition-context"),Pn=new J("element-def",{byDefault(t){const e=t.get(zn).componentType,{name:n,extend:r}=Qe.of(e),s={get type(){return r&&r.type||t.get(mn).HTMLElement},get name(){return r&&r.name}};return{get name(){return n},get extend(){return s}}}});class Un extends q{static get[z](){return zn}get elementDef(){return this.get(Pn)}connectTo(t){const e=this.mountTo(t);return e.connect(),e}}class Mn extends rn{constructor(t,e){super(),this._definitionContext=t,this.element=e,this._status=jt(0);const n=t._newComponentRegistry();n.provide({a:rn,is:this}),this.get=n.newValues().get}get componentType(){return this._definitionContext.componentType}get component(){return this._component()}get settled(){return this._status.it>=3&&!et(this).isOff}get connected(){return this._status.it>=4&&!et(this).isOff}get[Y](){return et(this._status)}_component(){throw new TypeError("Component is not constructed yet. Consider to use a `whenReady()` callback")}whenReady(t){return(this.whenReady=this._status.read().thru_(t=>t?_(this):m()).once().F)(t)}settle(){2===this._status.it&&(this._status.it=3)}whenSettled(t){return(this.whenSettled=this._status.read().thru_(t=>t>=3?y(this):m()).once().F)(t)}whenConnected(t){return(this.whenConnected=this._status.read().thru_(t=>t>=4?y(this):m()).once().F)(t)}destroy(t){try{this._status.done(t)}finally{delete this.component[nn],delete this.element[nn],this._component=Kn,function(t){const{parentNode:e}=t;e&&e.removeChild(t)}(this.element)}}_createComponent(){const t=this._definitionContext._whenComponent;let e=0;this.element[nn]=this,t.readNotifier.once(t=>e=t(this,e)),this.whenConnected(()=>{t.readNotifier.to({supply:nt().needs(this),receive:(t,n)=>{e=n(this,e)}})}),this._definitionContext._elementBuilder.components.send(this);const n=function(t){const e=t.componentType,n=e.prototype,r=n[nn];n[nn]=t;try{const s=new e(t);return s[nn]=t,s}finally{n[nn]=r}}(this);return this._component=h(n),this._status.it=1,this}_connect(){this._status.it=4}_created(){this._status.it<2&&(this._status.it=2),this.whenConnected(()=>this.dispatchEvent(new sn("wesib:component",{bubbles:!0})))}}function Kn(){throw new TypeError("Component destroyed already")}class qn extends class{get component(){return this.context.component}get element(){return this.context.element}}{constructor(t){super(),this.context=t}get connected(){return this.context.connected}connect(){this.context._connect()}checkConnected(){const t=this.context.element,e=t.ownerDocument,n=null!=e&&e.contains(t);return n!==this.connected&&(n?this.connect():this.context.destroy()),n}}class Nn extends Mn{constructor(t,e){super(t,e),this.mount=this.mount=new qn(this)}}class Ln extends Mn{get mount(){}}class jn{constructor(){const t=jt(0),e=new At;this.onCreated=wt(n=>{const r=t.it+1;e.on({supply:n.supply,receive:(t,e,s)=>{s<r&&n.receive({onRecurrent(e){t.onRecurrent(t=>e(t))}},e)}}),++t.it}),this.readNotifier=t.read().keepThru_(t=>(n,r)=>(e.send(n,r),t))}}class Bn extends Un{constructor(t,e,n){var r,s;super(),this._bsContext=t,this._elementBuilder=e,this.componentType=n,this._whenComponent=new jn,this._ready=jt(!1),this._whenReady=this._ready.read().thru(t=>t?_():m()),this._def=Qe.of(n);const o=new gn(t.get(gn).seedIn(this));o.provide({a:Un,is:this}),this.get=o.newValues().get,this._perTypeRegistry=new fn(o.seedIn(this));const i=this.whenReady().F,u=this.whenComponent().F,c={get componentType(){return n},get whenReady(){return i},get whenComponent(){return u},perDefinition:t=>o.provide(t),perComponent:t=>this._perTypeRegistry.provide(t)};null===(s=(r=this._def).setup)||void 0===s||s.call(r,c),_n(n).setup(c)}get elementType(){return this._elementType()}whenReady(t){return(this.whenReady=this._whenReady.thru_(h(this)).once().F)(t)}mountTo(t){if(t[nn])throw new Error(`Element ${String(t)} already bound to component`);const e=new Nn(this,t);e._createComponent();const{mount:n}=e;return n.checkConnected(),e._created(),e.settle(),n}whenComponent(t){return(this.whenComponent=this._whenComponent.onCreated.F)(t)}perComponent(t){return this._perTypeRegistry.provide(t)}_newComponentRegistry(){return this._bsContext.get(fn).append(this._perTypeRegistry)}_elementType(){throw new Error("Custom element class is not constructed yet. Consider to use a `whenReady()` callback")}_define(){var t,e;null===(e=(t=this._def).define)||void 0===e||e.call(t,this),this._elementBuilder.definitions.send(this),this._elementType=h(function(t){const e=t.get(Pn);class n extends e.extend.type{constructor(){super();const e=new Ln(t,this);e._createComponent(),e._created()}connectedCallback(){var t;null===(t=super.connectedCallback)||void 0===t||t.call(this),this[nn]._connect()}disconnectedCallback(){var t;this[nn].destroy(),null===(t=super.disconnectedCallback)||void 0===t||t.call(this)}}return n}(this)),this.componentType[Cn]=this,this._ready.it=!0}}const In=new J("element-builder",{byDefault:Fe((function(t){return{definitions:new At,components:new At,buildElement(e){const n=new Bn(t,this,e);return n._define(),n}}}))});const Wn=h(a);class Vn{constructor(t){this._context=t,this._definitionQueue=[],t.whenReady(()=>{this._definitionQueue.forEach(t=>t()),delete this._definitionQueue})}get customElements(){return this._context.get(En)}define(t){this._definitionQueue.push(()=>{const e=this._context.get(In).buildElement(t);this.customElements.define(t,e.elementType)})}}class Gn extends je{constructor(t,e){super(),this._bsContext=t,this._loader=e,this._unloader=function(){const t=[];let e=e=>{const n=e();return t.push(n),n};return{supply:nt(()=>{e=Wn,k(x(t).reverse(),t=>t()),t.length=0}),add:t=>e(t)}}();const n=new N(t);n.provide({a:je,is:this}),this.get=n.newValues().get,this._componentRegistry=new Vn(this)}get feature(){return this._loader.request.feature}whenReady(t){return(this.whenReady=St({st:this._loader.state,bs:jt().by(this._bsContext.whenReady())}).thru(({st:[t],bs:[e]})=>e&&t?y(this):m()).once().F)(t)}onDefinition(t){return(this.onDefinition=this._bsContext.get(In).definitions.on().tillOff(this._unloader.supply).F)(t)}onComponent(t){return(this.onComponent=this._bsContext.get(In).components.on().tillOff(this._unloader.supply).F)(t)}provide(t){return this._unloader.add(()=>this._bsContext.get(ln).provide(t))}perDefinition(t){return this._unloader.add(()=>this._bsContext.get(gn).provide(t))}perComponent(t){return this._unloader.add(()=>this._bsContext.get(fn).provide(t))}setupDefinition(t){return function(t,e){const{on:n}=_n(t);return wt(t=>{n.to({supply:t.supply.needs(e.supply),receive(n,r){const s=r.whenReady().tillOff(e.supply).F,o=r.whenComponent().tillOff(e.supply).F;t.receive(n,{get componentType(){return r.componentType},get whenReady(){return s},get whenComponent(){return o},perDefinition:t=>e.add(()=>r.perDefinition(t)),perComponent:t=>e.add(()=>r.perComponent(t))})}})})}(t,this._unloader)}define(t){this._componentRegistry.define(t)}}const Hn=Symbol("feature-key");class Qn extends ye{static of(t){return t.hasOwnProperty(Hn)?t[Hn]:t[Hn]=new Qn(t)}get upKey(){return this}constructor(t){super("feature:"+t.name)}grow(t){var e,n;t.insert((e=t.context.get(Ae),n=t.seed.keepThru(Jn),xt(t=>{let r,s=Ot(),o=Promise.resolve("idle");return St({clause:n,deps:Zn(e,n)}).keepThru_(({clause:[t],deps:n})=>{if(!t)return _();const[i,,u]=t;if(i.feature===r)return Ct(s);if(r=i.feature,u!==r)return Ct(s=e.get(Qn.of(r)).keepThru_(t=>(t.to(o),o=t.stage,t)));const c=new Yn(e,i,n).to(o),a=Ot(c);return Ct(s=xt(t=>a.to(t).whenOff(()=>{o=c.unload()})).share())}).to(t)}).keepThru(function(){let t=null;return e=>t===e?m():(t=e,e?_(e):_())}())))}}function Jn(...t){let e,n=!1;for(const r of t)switch(r[1]){case"is":n=!0,e||(e=r);break;case"has":e=r;break;case"needs":n=!0}return n?e:void 0}function Zn(t,e){return e.keepThru_(e=>{if(!e)return _();const[{def:n}]=e,r=s(n.needs);return r.size?Ct(Tt(...A(r,e=>t.get(Qn.of(e)))).keepThru_(Xn)):_()})}function Xn(...t){return _(...O(A(t,t=>t[0]),f))}class Yn{constructor(t,e,n){this.bsContext=t,this.request=e,this.deps=n,this.state=jt(!1),this.down=new Promise(t=>this._down=t),this._stage=Promise.resolve(new er(this))}get stage(){return this._stage.then(t=>t.after)}get ready(){return this.state.it}to(t){const e=this._stage;return this._stage=t.then(t=>e.then(e=>e[t]())),this}async setup(){await(this._stage=this._stage.then(t=>t.setup()))}async init(){await(this._stage=this._stage.then(t=>t.init()))}async unload(){const t=this._stage;delete this._stage;const e=await t,n=await e.stop();return this._down(),n}}class tr{constructor(t,e=(()=>Promise.resolve())){this.loader=t,this._stop=e}idle(){return Promise.resolve(this)}stop(){return this._stop().then(()=>this.after)}perDep(t){const{deps:e}=this.loader;return Promise.all(e.map(e=>t(e)))}}class er extends tr{get after(){return"idle"}async setup(){var t;await this.perDep(t=>t.setup());const{bsContext:e,request:{def:n}}=this.loader,r=new Gn(e,this.loader),s=r._unloader.supply;return null===(t=n.setup)||void 0===t||t.call(n,r),new nr(this.loader,r,()=>Promise.resolve(s.off()))}init(){return this.setup().then(t=>t.init())}}class nr extends tr{constructor(t,e,n){super(t,n),this._context=e}get after(){return"setup"}setup(){return Promise.resolve(this)}async init(){var t;await this.perDep(t=>t.init());const{request:{def:e}}=this.loader;return null===(t=e.init)||void 0===t||t.call(e,this._context),new rr(this)}}class rr extends tr{get after(){return"init"}constructor(t){super(t.loader,()=>t.stop()),t.loader.state.it=!0}setup(){return Promise.resolve(this)}init(){return Promise.resolve(this)}}class sr{constructor(t,e,n){this._requester=t,this.feature=e,this._revoke=n,this._uses=0,this.def=function(t){let e=qe.of(t);if(We in t){e=qe.merge(e,{init(e){e.define(t)}});const{feature:n}=Qe.of(t);n&&(e=qe.merge(e,n))}return e}(e)}request(t){const e=this._requester,{registry:n}=e,r=[this,"is",this.feature];this._revokeBy(n.provide({a:Qn.of(this.feature),is:r}));for(const r of s(this.def.has)){const s=[this,"has",r];this._revokeBy(n.provide({a:Qn.of(r),is:s}));const o=e.request(r,[...t,s]);this._revokeBy(()=>o.unuse())}for(const r of s(this.def.needs)){const s=[this,"needs",r],o=e.request(r,[...t,s]);this._revokeBy(()=>o.unuse()),this._revokeBy(n.provide({a:Qn.of(r),is:s}))}return this._uses=1,this}reuse(t){if(!this._uses)throw new Be(t.map(([{feature:t},e,n])=>[t,e,n]));return++this._uses,this}unuse(){--this._uses||this._revoke()}_revokeBy(t){this._revoke=c(t,this._revoke)}}const or=new J("feature-requester",{byDefault:Fe(t=>new ir(t))});class ir{constructor(t){this._map=new Map,this.registry=t.get(ln)}static get[z](){return or}request(t,e=[]){const n=this._map.get(t);if(n)return n.reuse(e);const r=new sr(this,t,()=>this._map.delete(t));return this._map.set(t,r),r.request(e)}}const ur=Symbol("when-defined");const cr=Symbol("attribute");function ar(t){return[cr,t]}function hr(t,e=!0){if(!1===e)return a;if(!0===e||"function"==typeof e){const n=ar(t),r=!0===e?lr:e;return(t,e,s)=>r(t,n,e,s)}return(t,n,r)=>lr(t,e,n,r)}function lr(t,e,n,r){rn.of(t).updateState(e,n,r)}function dr(t){let e;for(let n=0;n<t.length;++n){const r=t[n];r<="Z"&&r>="A"?(e||(e=t.substring(0,n)),e+="-"+r.toLowerCase()):e&&(e+=r)}return e||t}const fr=new J("attribute-registry",{byDefault:t=>new pr(t.get(Un))});class pr{constructor(t){this._context=t,this.attrs=new Map,t.whenReady(({elementType:t})=>this.define(t)),t.whenComponent(({mount:t})=>{t&&this.mount(t)})}declareAttribute({name:t,change:e}){this.attrs.set(t,c(this.attrs.get(t),e))}define(t){const{attrs:e}=this;e.size&&(Object.defineProperty(t,"observedAttributes",{configurable:!0,enumerable:!0,value:gr(t,e.keys())}),Object.defineProperty(t.prototype,"attributeChangedCallback",{configurable:!0,enumerable:!0,value:yr(t,e)}))}mount(t){const{element:e}=t,{attrs:n}=this,r=Array.from(n.keys());if(!r.length)return;new(0,this._context.get(mn).MutationObserver)(t=>t.forEach(t=>{const r=t.attributeName;return n.get(r)(rn.of(e).component,e.getAttribute(r),t.oldValue)})).observe(e,{attributes:!0,attributeFilter:r,attributeOldValue:!0})}}function gr(t,e){const n=t.observedAttributes;if(Array.isArray(n)){const t=new Set(n);k(e,e=>t.add(e)),e=t}return Array.from(e)}function yr(t,e){const n=t.prototype.attributeChangedCallback;return n?function(t,r,s){const o=e.get(t);o?o(rn.of(this).component,s,r):n.call(this,t,r,s)}:function(t,n,r){e.get(t)(rn.of(this).component,r,n)}}function _r(t){return un(({type:e,key:n})=>{const r=function(t,e,n){let r,s;if("string"==typeof n)r=dr(n),s=hr(r);else{if(n&&n.name)r=dr(n.name);else{if("string"!=typeof e)throw new TypeError(`Attribute name is required as property key is not a string: ${t.constructor.name}.prototype.${String(e)}`);r=dr(e)}s=hr(r,n&&n.updateState)}return{name:r,change:s}}(e.prototype,n,t),{name:s}=r;return{componentDef:{define(t){t.get(fr).declareAttribute(r)}},get:t=>rn.of(t).element.getAttribute(s),set(t,e){const{element:n}=rn.of(t);null!=e?n.setAttribute(s,e):n.removeAttribute(s)}}})}function mr(...t){return Je({define(e){const n=e.get(fr);for(const e of t)if("string"==typeof e){const t=dr(e);n.declareAttribute({name:t,change:hr(t)})}else for(const[t,r]of Object.entries(e)){const e=dr(t);n.declareAttribute({name:e,change:hr(e,r)})}}})}class wr extends Q{constructor(){super("component-state")}grow(t){const e=t.seed();let n;if(null!=e)n=e,t.insert(n);else{if(t.hasFallback)return;n=new vr,et(t.context.get(rn)).whenOff(t=>n.done(t)),t.insert(n)}t.setup(({registry:t})=>{t.provide({a:en,is:n.update})})}}const br=new wr;class vr extends qt{static get[z](){return br}}var xr;class kr extends Nt{constructor(t,e,n){super(),this._context=t,this._name=e,this._path=n,this[xr]=nt()}get it(){return this._context.element.getAttribute(this._name)}set it(t){et(this).isOff||(null==t?this._context.element.removeAttribute(this._name):this._context.element.setAttribute(this._name,t))}on(t){return(this.on=this._context.get(vr).track(this._path).onUpdate().thru((t,e,n)=>_(e,n)).tillOff(this).F)(t)}}xr=Y;const $r=Symbol("dom-property");const Sr=Symbol("render"),Tr={spec:(t,e)=>function(t,...e){return"function"==typeof t?t(...e):t}(e,t),fulfill(t,e={}){const{on:n=e.on,error:r}=t;return{on:n,error:r?r.bind(t):e.error&&e.error.bind(e)}},trigger(t,e={}){const{on:n=[]}=e;if("object"==typeof n&&ct(n))return Et(n).tillOff(t);const r=t.get(vr).track(n).onUpdate().tillOff(t);return Array.isArray(n)&&!n.length?r.thru_(t=>t[0]===Sr?m:_()):r}};class Or{constructor(t){this._context=t,this._renders=new Set}renderBy(t,e={}){const n=Tr.spec(this._context,e),r=Tr.trigger(this._context,n),s=this._context.get(kn)({...Tr.fulfill(n),node:this._context.element}),o="connected"===n.when;let i=1;const u=o?()=>this._context.connected&&l():()=>this._context.settled&&l(),c=r.to(u).needs(this._context).whenOff((function(){2===i&&s(a);i=-1}));(o?this._context.whenConnected():this._context.whenSettled()).to(()=>i&&l());const h=Se();return this._renders.add(d),c.whenOff(()=>this._renders.delete(d));function l(){i=2,s(f)}function d(){h(f)}function f(e){if(i>0)for(i=0;;){const n=t(e);if(n===t||"function"!=typeof n)break;t=n}}}renderNow(){this._renders.forEach(t=>t())}}const Cr=new J("element-render-ctl",{byDefault:t=>new Or(t.get(rn))});const Ar=new J("element-render-scheduler",{byDefault:function(t){const e=t.get(Cr);return(t={})=>{const n=jt(a);return e.renderBy(t=>{n.it(t)},Tr.fulfill({on:n.on()},t)),t=>{n.it=e=>t(e)}}}});function Fr(t){return un(({get:e})=>({componentDef:{define(n){n.whenComponent(n=>{n.whenReady(()=>{const{component:r}=n,s=e(r).bind(r);n.get(Cr).renderBy(s,t)})})}}}))}const Er=new J("shadow-content-root");class Dr extends Event{get shadowRoot(){return this.target.shadowRoot}}const Rr=new _e("shadow-root-builder",{byDefault:()=>zr});function zr(t,e){const n=function(t,e){const n=t.shadowRoot;if(n)return n;if("attachShadow"in t)return t.attachShadow(e);return}(t.element,e);return n&&(n[nn]=t,t.whenConnected(()=>t.dispatchEvent(new Dr("wesib:shadowAttached",{bubbles:!0})))),n}const Pr={mode:"open"};function Ur(t=Pr){return Je({setup(e){e.perComponent({a:Er,by:e=>e.get(Rr)(e,t)}),e.perComponent({a:Ye,by:t=>t.get(Er,{or:null})})}})}const Mr=new Xt("https://wesib.github.io/ns","b","wesib");class Kr extends Set{constructor(t){super(),this._added=new Set(t),this._removed=new Set,this._added.forEach(t=>this.add(t))}add(t){return this.has(t)||(this._added.add(t),this._removed.delete(t),super.add(t)),this}delete(t){return!!super.delete(t)&&(this._added.delete(t),this._removed.add(t),!0)}clear(){this._added.clear(),this.forEach(t=>this._removed.add(t)),super.clear()}delta(t,e=[]){return qr(this)(t,e),this}redelta(t){return("function"==typeof t?t:qr(t))(Array.from(this._added),Array.from(this._removed)),this}undelta(){return this._added.clear(),this._removed.clear(),this}}function qr(t){return(e,n)=>{for(const e of n)t.delete(e);for(const n of e)t.add(n)}}const Nr=Symbol("in-aspect"),Lr={instance:null,convertTo:a};function jr(t,e,n,r,s){return void 0===r&&(r=n(t,s)),{instance:r,convertTo:r=>jr(r,e,n,void 0,t),attachTo:r=>jr(r,e,n,t.aspect(e)||n(r))}}function Br(t,e,n=null){return jr(t,e,h(null),n)}function Ir(t){return{instance:t,convertTo(){return this}}}const Wr=new Xt("https://surol.github.io/input-aspects/ns","inasp","input-aspects"),Vr={applyTo:()=>Ir(ne())},Gr={get[Nr](){return Vr},to:t=>({applyAspect:e=>e===Vr?Ir(t):void 0})},Hr={applyTo:()=>Ir(Oe)},Qr={get[Nr](){return Hr},to:t=>({applyAspect:e=>e===Hr?Ir(t):void 0})};function Jr(t,...e){if(!t)return Yr;const n=es(t);if(!e.length)return n;const r=A(e,es);return(t,e)=>{const s=n(t,e),o=T(C([[s],O(A(r,n=>n(t,e)),f)]),(t,e)=>e.applyAspect?n=>t(n)||e.applyAspect(n):t,a);return ts(s)?{applyAspect:o}:{set:s.set.bind(s),get:s.get.bind(s),applyAspect:o}}}function Zr(t){return t?(e=t,Array.isArray(e)?Jr(...t):Jr(t)):Jr();var e}const Xr={applyAspect(){}};function Yr(){return Xr}function ts(t){return!t.set}function es(t){return"function"==typeof t?t:h(t)}class ns extends Nt{constructor(){super(...arguments),this._aspects=new Map}aspect(t){return this._aspect(t[Nr]).instance}setup(t,e=a){return Nr in t?e(this.aspect(t),this):t(this),this}convert(t,...e){return new rs(this,Jr(t,...e))}_aspect(t){const e=this._aspects.get(t);if(e)return e;const n=this._applyAspect(t)||t.applyTo(this);return this._aspects.set(t,n),n}_applyAspect(t){}}class rs extends ns{constructor(t,e){super(),this._on=new At,this._supply=nt().needs(t);let n,r=0;const s=e(t,this);let o,i,c;ts(s)?(o=u,i=u,c=e=>{const n=t._aspect(e);return n.attachTo?n.attachTo(this):n.convertTo(this)}):(o=s.set,i=s.get,c=e=>t._aspect(e).convertTo(this)),this._applyAspect=t=>{var e;return(null===(e=s.applyAspect)||void 0===e?void 0:e.call(s,t))||c(t)},this._it=jt([o(t.it),0]),et(this._it).needs(this._supply),this._it.on(([t],[e])=>{t!==e&&this._on.send(t,e)}).cuts(this._on),t.on(t=>{t!==n&&(this._it.it=[o(t),++r])}).cuts(this),this._it.on(([e,s])=>{if(s!==r){r=s,n=i(e);try{t.it=n}finally{n=void 0}}})}get[Y](){return this._supply}get it(){return this._it.it[0]}set it(t){const[e,n]=this._it.it;t!==e&&(this._it.it=[t,n+1])}on(t){return(this.on=this._on.on().F)(t)}}class ss extends ns{constructor(t){super(),this._control=t}get[Y](){return this._supply||(this._supply=nt().needs(this._control))}get it(){return this._control.it}set it(t){this._control.it=t}on(t){return(this.on=this._control.on().F)(t)}}class os extends ns{constructor({aspects:t}){super(),this._aspectConversion=Zr(t)(new ss(this),this)}_applyAspect(t){return this._aspectConversion.applyAspect(t)||super._applyAspect(t)}}const is={applyTo:t=>Br(t,us)};class us extends os{static get[Nr](){return is}_applyAspect(t){return t===is?Br(this,us,this):super._applyAspect(t)}}class cs{[ut](){return this.on()}[Z](){return this.read()}}const as={applyTo:t=>Ir(new ls(t))};class hs{static get[Nr](){return as}[ut](){return this.on()}[Z](){return this.read()}}class ls extends hs{constructor(t){super(),this._control=t,this._map=new Map,this._on=new At,et(this._on).needs(this._control)}add(t){const e=this._map.get(t);if(e)return e;const n=nt(()=>{this._map.delete(t),this._on.send([],[t])});return this._map.set(t,n),this._on.send([t],[]),n.needs(this._control).needs(t.parent)}on(t){return(this.on=this._on.on().F)(t)}read(t){const e=()=>this._map.keys();return(this.read=kt(this.on().thru(e),()=>[e()]).F)(t)}}const ds={applyTo:t=>Br(t,fs)};class fs extends os{static get[Nr](){return ds}_applyAspect(t){return t===ds?Br(this,fs,this):super._applyAspect(t)}}const ps={applyTo:t=>jr(t,gs,t=>new ms(t))};class gs{static get[Nr](){return ps}[ut](){return this.on()}[Z](){return this.read()}static hasData(t){return"off"!==t&&"-"!==t[0]}done(t){return this.own.done(t),this}}class ys extends Nt{constructor(t){super(),this._tracker=jt(t?function(t){return null!=t.getAttribute("disabled")?"off":null!=t.getAttribute("readonly")?"ro":"on"}(t.element):"on")}get[Y](){return et(this._tracker)}get it(){return this._tracker.it}set it(t){switch(t){case"off":case"ro":case"-on":case"-ro":break;default:t="on"}this._tracker.it=t}on(t){return(this.on=this._tracker.on().F)(t)}}class _s{constructor(){this._all=new Set,this._on=new At;const t=kt(this._on.on().thru(()=>this._all),l(this._all));this.read=t.keepThru(t=>Ct(Tt(...t)),bs)}add(t){const e=nt(()=>{this._all.delete(t),this._on.send()});return this._all.add(t),this._on.send(),e}}class ms extends gs{constructor(t){super(),this._control=t,this._derived=new _s;const e=t.aspect(fs);this.own=new ys(e),et(this.own).needs(t),this.derive(t.aspect(hs).read().keepThru_(ws)),e&&this.read(t=>function(t,e){switch(e){case"off":t.setAttribute("disabled","");break;case"ro":case"-ro":t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly","");break;default:t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly",""),t.removeAttribute("readonly")}}(e.element,t))}read(t){let e="on";return(this.read=kt(St({derived:this._derived.read,own:this.own}).thru(({derived:[t],own:[n]})=>{let r;if("off"===n||"off"===t)r="off";else{let e=!1;"-"===n[0]&&(e=!0,n=n.substring(1)),"-"===t[0]&&(e=!0,t=t.substring(1)),r="ro"===t?"ro":n,e&&(r="-"+r)}return e===r?m():_(e=r)}),l(e)).F)(t)}on(t){let e="on";return(this.on=this.read().thru(t=>{const n=e;return n===t?m():_(e=t,n)}).F)(t)}derive(t){return this._derived.add($t(X(t)?t:t(this._control)).tillOff(this._control)).needs(this._control)}}function ws(t){const e=Array.from(t);if(!e.length)return _("on");return Ct(Tt(...e.map(({parent:t})=>t.aspect(gs))).keepThru_(bs))}function bs(...t){return function(...t){let e=!1,n=!1;for(const r of t)switch(r){case"off":return"off";case"ro":e=!0;break;case"-on":n=!0;break;case"-ro":n=!0,e=!0}return n?e?"-ro":"-on":e?"ro":"on"}(...C(t))}const vs={applyTo:t=>jr(t,xs,t=>St({value:t,mode:t.aspect(gs)}).keepThru(({value:[t],mode:[e]})=>gs.hasData(e)?_(t):_()))},xs={get[Nr](){return vs}},ks={applyTo:t=>Br(t,$s)};class $s extends us{static get[Nr](){return ks}_applyAspect(t){return t===ks?Br(this,$s,this):super._applyAspect(t)}}class Ss extends cs{remove(t){this.set(t,void 0)}}const Ts={};class Os{constructor(t){this._map=t}get(t){const e=this._map.get(t);return e&&e[0]}[Symbol.iterator](){return b(A(this._map.values(),([t])=>t))}entries(){return b(A(this._map.entries(),([t,[e]])=>[t,e]))}}class Cs{constructor(t){this._controls=t,this._supply=nt(),this._map=new Map}set(t,e,n,r){const s=this._map.get(t);let o;if(e){o=nt();const i=this.newEntry(t,e,o);let u=!0;s&&(s[0]===e?u=!1:r.push([t,s])),u?(this.modify().set(t,i),n.push([t,i])):this._map.set(t,i)}else o=lt(),s&&(r.push([t,s]),this.modify().delete(t));return s&&s[1].off(Ts),o}newEntry(t,e,n){return[e,nt(e=>{e!==Ts&&this._controls.remove(t)}).needs(this._supply).needs(n).whenOff(t=>n.off(t===Ts?void 0:t))]}modify(){if(this._shot){const t=new Map;k(this._map.entries(),([e,n])=>t.set(e,n)),this._shot=void 0,this._map=t}return this._map}snapshot(){return this._shot||(this._shot=new Os(this._map))}clear(){const t=[],e=[];return k(this._map.keys(),n=>this.set(n,void 0,t,e)),e}}class As extends Ss{constructor(t){super(),this._group=t,this._updates=new At;this._map=new Cs(this),this._map._supply.needs(t.read(t=>{this.read().once(e=>{const n=new Set;k(R(t),([t,r])=>{n.add(t);const s=e.get(t);s&&(s.it=r)}),k(e.entries(),([t,e])=>{n.has(t)||(e.it=void 0)})})}))}on(t){return(this.on=this._updates.on().thru((t,e)=>_(t.map(Fs),e.map(Fs))).F)(t)}read(t){return(this.read=kt(this._updates.on().thru(()=>this._map.snapshot()),()=>[this._map.snapshot()]).F)(t)}set(t,e){const n=this._group,r=[],s=[];let o;return"object"==typeof t?(o=nt(),k(R(t),([t,e])=>{this._map.set(t,e,r,s).needs(o)})):o=this._map.set(t,e,r,s),(r.length||s.length)&&(this._updates.send(r,s),r.length&&function(){let t;r.forEach(e=>{const[r,[s,o]]=e;s.aspect(hs).add({parent:n}).needs(o).cuts(o);const i=s.it;if(t)t[r]=i;else{const e=n.it;e[r]!==i&&(t={...e,[r]:i})}}),t&&(n.it=t);r.forEach(t=>{const[e,[r,s]]=t;r.read().tillOff(s).to(t=>{n.it[e]!==t&&(n.it={...n.it,[e]:t})}).cuts(s)})}()),o}clear(){const t=this._map.clear();t.length&&this._updates.send([],t)}}function Fs([t,[e]]){return[t,e]}class Es extends $s{constructor(t,e){super(e),this._model=jt(t),this.controls=new As(this),et(this).whenOff(()=>this.controls.clear())}get[Y](){return et(this._model)}get it(){return this._model.it}set it(t){this._model.it=t}on(t){return(this.on=this._model.on().F)(t)}_applyAspect(t){return t===xs[Nr]?{instance:(e=this,St({cs:e.controls,model:e,mode:e.aspect(gs)}).keepThru_(Ds)),convertTo:a}:super._applyAspect(t);var e}}function Ds({cs:[t],model:[e],mode:[n]}){if(!gs.hasData(n))return _();const r={};return k(t.entries(),([t,e])=>{r[t]=e.aspect(xs)}),Ct(St(r).keepThru(t=>{const n={...e};return k(R(t),t=>{const[e,[r]]=t;n[e]=r}),y(n)}))}function Rs(t,{aspects:e}={}){return new Es(t,{aspects:e})}const zs=Ot();function Ps(){return zs}function Us(t){return X(t)?h($t(t)):"function"==typeof t?e=>$t(t(e)):e=>e.read().keepThru(function(t,e){return()=>{const n=e.validate(t);return null==n?_():Array.isArray(n)?_(...n):_(n)}}(e,t))}const Ms={};class Ks{constructor(t){const e=new At,n=new Map,r=new Map;let s=a,o=a;this._messages=xt(t=>{const i=$t(e,l()).to(t).whenOff(()=>{s=a,o=a});o=(t,e)=>{const n=t.to((...e)=>{if(e.length)r.set(t,e);else if(!r.delete(t))return;s()}).needs(e).whenOff(n=>{n!==Ms&&e.off(n),r.delete(t)&&s()});i.whenOff(()=>n.off(Ms))},k(n.entries(),([t,e])=>o(t,e)),s=()=>{e.send(...C(r.values(),u))},r.size&&s()}).share().tillOff(t),this.from=e=>{const r=Us(e)(t),s=nt(()=>{n.delete(r)});return n.set(r,s),o(r,s),s.needs(t)}}[Z](){return this._messages}}const qs={applyTo:t=>jr(t,Ns,(t,e)=>{const n=new Is(t);if(e){const t=e.aspect(Ns);n.by(t.read().keepThru(t=>_(...t.messages())))}return n})};class Ns{static get[Nr](){return qs}[Z](){return this.read()}}const Ls={get ok(){return!0},messages:()=>[],has:()=>!1,hasBut:()=>!1,[Symbol.iterator]:()=>[][Symbol.iterator]()};class js{constructor(t){this._byCode=new Map,this._all=[],k(t,t=>{let e=!1;k(R(t),([n,r])=>{if(r){e=!0;const r=this._byCode.get(n);r?r.push(t):this._byCode.set(n,[t])}}),e&&this._all.push(t)})}get ok(){return!this._all.length}messages(t){return null==t?this._all:this._byCode.get(t)||[]}has(t){return null==t||this._byCode.has(t)}hasBut(...t){return this._all.some(e=>t.every(t=>!e[t]))}[Symbol.iterator](){return this._all[Symbol.iterator]()}}function Bs(...t){return t.length?new js(t):Ls}class Is extends Ns{constructor(t){super(),this._messages=new Ks(t);const e=t.aspect(us);e&&this._messages.from(function(t){return t.controls.read().keepThru(Ws,Vs)}(e))}by(...t){return this._messages.from(function(...t){const e=t.length;return 1===e?t[0]:e?e=>{const n=new Ks(e);return t.forEach(t=>n.from(t)),n}:Ps}(...t))}read(t){return(this.read=$t(this._messages).keepThru(Bs).F)(t)}}function Ws(t){return Ct(Tt(...A(t,t=>t.aspect(Ns))))}function Vs(...t){return _(...C(A(t,t=>t[0])))}function Gs(t){return t?t.read().keepThru(t=>t?_():{missing:"missing"}):Gs}class Hs extends fs{constructor(t,{aspects:e,get:n,set:r}){super({aspects:e}),this.element=t,this._input=new At;const s=this;this._get=n,this._set=r,this._value=this.it;const o=this._update=(t,e)=>i({value:t},e);function i(t,e){for(;;){let n;s._value=t.value,s._update=(e,r)=>{n=[{...t,value:e},r]};try{s._input.send(t,e)}finally{s._update=o}if(!n)break;[t,e]=n}}this.events=new ue(t),et(this.events).needs(this),this.listenForInput(t=>i(t,this._value))}get[Y](){return et(this._input)}get it(){return this._get()}set it(t){const e=this.it;t!==e&&(this._set(t),this._update(this._get(),e))}input(t){return(this.input=kt(this._input.on().thru(u),()=>[{value:this.it}]).F)(t)}on(t){return(this.on=this._input.on().thru(({value:t},e)=>t===e?m():_(t,e)).F)(t)}listenForInput(t){const e=e=>t({value:this.it,event:e});this.events.on("input").to(e),this.events.on("change").to(e)}}function Qs(t,{aspects:e}={}){return new Hs(t,{get(){return this.element.value},set(t){this.element.value=t},aspects:e})}const Js={applyTo:t=>jr(t,Zs,t=>{const e=t.aspect(fs);return e&&new Xs(e)})};class Zs extends Nt{static get[Nr](){return Js}}class Xs extends Zs{constructor(t){super();const{element:e,events:n}=t,r=e.getRootNode?e.getRootNode():e.ownerDocument;this._it=jt(r.activeElement===e),et(this).needs(t),n.on("focus").to(()=>this._it.it=!0),n.on("blur").to(()=>this._it.it=!1),this.on({receive(t,n){t.onRecurrent(a),n?e.focus():e.blur()}})}get[Y](){return et(this._it)}get it(){return this._it.it}set it(t){this._it.it=t}on(t){return(this.on=this._it.on().F)(t)}}const Ys={applyTo:t=>jr(t,to,t=>{const e=t.aspect(us);return null!=e?new ro(e):new no(t)})};class to{static get[Nr](){return Ys}[Z](){return this.read()}}const eo={hasFocus:!1,touched:!1,edited:!1};class no extends to{constructor(t){super(),this._flags=jt(eo),et(this._flags).needs(t),this._flags.by(function(t,e){const n=e.aspect(fs);return St({hasFocus:e.aspect(Zs)||Ot(!1),edited:n?n.input().keepThru(({event:t})=>!!t):Ot(!1)}).keepThru(({hasFocus:[e],edited:[n]})=>function(t,e,n){t=e?{...t,hasFocus:e,touched:!0}:{...t,hasFocus:e};n&&(t={...t,edited:n,touched:!0});return t}(t.it,e,n))}(this._flags,t))}read(t){return(this.read=this._flags.read().F)(t)}markTouched(t=!0){const e=this._flags.it;return t?e.touched||(this._flags.it={...e,touched:t}):e.touched&&(this._flags.it={...e,touched:e.hasFocus,edited:!1}),this}markEdited(t=!0){const e=this._flags.it;return t?e.edited||(this._flags.it={...e,touched:!0,edited:t}):e.edited&&(this._flags.it={...e,edited:t}),this}}class ro extends to{constructor(t){super(),this._container=t}read(t){return(this.read=(e=this._container,e.controls.read().tillOff(e).keepThru_(t=>Ct(Tt(...function(t){return A(t,t=>t.aspect(to))}(t))),so)).F)(t);var e}markEdited(t){return this._container.controls.read().once(e=>k(e,e=>e.aspect(to).markEdited(t))),this}markTouched(t){return this._container.controls.read().once(e=>k(e,e=>e.aspect(to).markTouched(t))),this}}function so(...t){const e={hasFocus:!1,touched:!1,edited:!1};return k(t,([{hasFocus:t,touched:n,edited:r}])=>{n&&(e.touched=!0),t&&(e.hasFocus=e.touched=!0),r&&(e.edited=e.touched=!0)}),e}const oo={applyTo(t){const e=t.aspect(fs);return e?Ir(e.element):Lr}},io={get[Nr](){return oo},to:(t=null)=>({applyAspect:e=>e===oo?Ir(t):void 0})},uo={applyTo:t=>({instance:new lo(t),convertTo:a})};class co{static get[Nr](){return uo}[Z](){return this.read()}}const ao=Symbol("reason");function ho(t){return t&&"object"==typeof t&&ao in t}class lo extends co{constructor(t){super(),this._control=t,this._sources=jt([new Map]);const e=t.aspect(io);e&&this.applyTo(e,this.schedule),et(t).whenOff(t=>this.done(t))}get schedule(){return this._schedule||(this._schedule=po(this._control,this._control.aspect(io)))}read(t){return(this.read=this._sources.read().tillOff(this._control).keepThru_(([t])=>Ct(Tt(...t.keys())),(...t)=>{const e={};return t.forEach(([t])=>fo(t,e)),e}).F)(t)}track(t){return(this.track=xt(t=>{t.supply.needs(this._control);const e=new Kr,n=new it;let r=!1;return n.on(t),this.read(t=>{const s=new Set(e),o=[];k(O(R(t),([,t])=>!!t),([t])=>{s.delete(t)||o.push(t)}),(!r||o.length||s.size)&&(e.delta(o,s),r=!0,e.redelta((t,e)=>n.send(t,e)).undelta())})}).F)(t)}specs(t){return $t(X(t)?t:t(this._control))}resolve(t){const e=this._control.aspect(Gr);return this.specs(t).keepThru((...t)=>{const n={};return t.forEach(t=>{Yt(t)?n[Zt.name(t,e)]=!0:fo(t,n)}),n})}add(t){const e=et(this._control);if(e.isOff)return e;const n=nt(),r=xt(e=>{const r=this.resolve(t).to({receive(t,...n){e.receive(t,...n)}});e.supply.whenOff(t=>{n.off({[ao]:t})}),n.needs(r).whenOff(t=>{ho(t)&&r.off(t[ao])})}).share(),[s]=this._sources.it;return s.set(r,n),n.whenOff(t=>{ho(t)||(s.delete(r),this._sources.it=[s])}),this._sources.it=[s],n.needs(e)}applyTo(t,e=po(this._control,t)){const{classList:n}=t,r=new Kr,s=()=>{r.redelta((t,e)=>{n.remove(...e),n.add(...t)}).undelta()};return this.track((t,n)=>{r.delta(t,n),e(s)}).whenOff(()=>{r.size&&(r.clear(),e(s))})}done(t){return k(this._sources.it[0].values(),e=>e.off(t)),this._sources.done(t),this}}function fo(t,e){k(R(t),([t,n])=>{null!=n&&(e[t]=n)})}function po(t,e){return t.aspect(Qr)({node:e})}const go=[["has-error",Wr]];function yo(t){return!t.ok}function _o({ns:t=Wr}={}){return e=>{const n=e=>[e,t];return St({md:e.aspect(gs),vl:e.aspect(Ns),st:e.aspect(to)}).keepThru(({md:[t],vl:[e],st:[{hasFocus:r,touched:s,edited:o}]})=>{const i=[];return gs.hasData(t)||i.push(n("disabled")),"ro"!==t&&"-ro"!==t||i.push(n("readonly")),e.ok||i.push(n("invalid")),e.has("missing")&&i.push(n("missing")),e.has("incomplete")&&i.push(n("incomplete")),r&&i.push(n("has-focus")),s&&i.push(n("touched")),o&&i.push(n("edited")),_(...i)})}}function mo(e){return t(e,{isIdentifier:!0})}function wo(t){return Array.isArray(t)}function bo(t){return!!t.length}class vo{constructor(t){this.priority=t&&t.priority||0}important(){return this.prioritize(1)}usual(){return this.prioritize(0)}}function xo(t,e){return t===e||("object"==typeof t?t.is(e):"object"==typeof e&&e.is(t))}class ko extends vo{}class $o extends ko{constructor(t,e){super(e),this.r=Oo(t.r,255),this.g=Oo(t.g,255),this.b=Oo(t.b,255),this.a=null!=t.a?Co(t.a,1):1}get type(){return"rgb"}get rgb(){return this}get hsl(){const{a:t}=this,e=100*this.r/255,n=100*this.g/255,r=100*this.b/255,s=Math.max(e,n,r),o=Math.min(e,n,r),i=Math.round((s+o)/2);if(s===o)return new So({h:0,s:0,l:i,a:t},this);const u=s-o,c=Math.round(i>50?100*u/(200-s-o):100*u/(s+o));let a;switch(s){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;default:a=(e-n)/u+4}return a*=60,a=Math.round(a),new So({h:a,s:c,l:i,a:t},this)}by(t){return To.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new $o(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{r:e=this.r,g:n=this.g,b:r=this.b,a:s=this.a}=t;return new $o({r:e,g:n,b:r,a:s},this)}toString(){const t=`${this.r}, ${this.g}, ${this.b}`;return 1===this.a?`rgb(${t})`:`rgba(${t}, ${this.a})`}}class So extends ko{constructor(t,e){var n;super(e),this.h=(n=t.h,(n%=360)<0?360+n:n),this.s=Co(t.s,100),this.l=Co(t.l,100),this.a=null!=t.a?Co(t.a,1):1}get type(){return"hsl"}get rgb(){const{a:t}=this,e=this.s/100,n=this.l/100;if(!e){const e=255*n;return new $o({r:e,g:e,b:e,a:t},this)}const r=n<.5?n*(1+e):n+e-n*e,s=2*n-r,o=this.h/360;return new $o({r:Ao(s,r,o+1/3),g:Ao(s,r,o),b:Ao(s,r,o-1/3),a:t},this)}get hsl(){return this}by(t){return To.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.h===this.h&&t.s===this.s&&t.l===this.l&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new So(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{h:e=this.h,s:n=this.s,l:r=this.l,a:s=this.a}=t;return new So({h:e,s:n,l:r,a:s},this)}toString(){const t=`${this.h}, ${this.s}%, ${this.l}%`;return 1===this.a?`hsl(${t})`:`hsla(${t}, ${this.a})`}}const To={by(t){if("object"==typeof t&&("rgb"===t.type||"hsl"===t.type))return t}};function Oo(t,e){return Co(Math.round(t),e)}function Co(t,e){return Math.max(Math.min(t,e),0)}function Ao(t,e,n){let r,s=n;return s<0?s+=1:s>1&&(s-=1),r=s<1/6?t+6*s*(e-t):s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t,255*r}function Fo(t,e,n){const r=2*n-1,s=t.rgb,o=e.rgb,i=s.a-o.a,u=((r*i==-1?r:(r+i)/(1+r*i))+1)/2,c=1-u;return new $o({r:s.r*u+o.r*c,g:s.g*u+o.g*c,b:s.b*u+o.b*c,a:s.a*n+o.a*(1-n)},t)}class Eo extends vo{constructor(t){super(t),this.dim=t.dim}by(t){return this.dim.by(t)||this}toString(){return this.toFormula()}}const Do={map(t,e){const n={},r={from:e,get(r){if(r in n)return n[r];const s=function(t){switch(typeof t){case"function":return t;case"object":return t.by.bind(t)}const e=typeof t;return n=>typeof n===e?n:t}(t[r])(e[r],this,r);return n[r]=s,s}};return k(D(t),t=>r.get(t)),n},by:t=>Do.map.bind(void 0,t)};function Ro(t){if(null==t)return[void 0,0];switch(typeof t){case"object":return[t,t.priority];case"string":if(t.endsWith("!important"))return[t.substring(0,t.length-"!important".length).trim(),1]}return[t,0]}class zo extends Eo{constructor(t,e,n){super(n),this.val=t,this.unit=e}get type(){return"dimension"}toDim(t){const e=this.dim;if(t===e||t===e.pt||t===("%"===this.unit?t.pt:e.noPt))return this}is(t){return t===this||"object"==typeof t&&t.type===this.type&&this.unit===t.unit&&this.val===t.val&&this.priority===t.priority}prioritize(t){return this.priority===t?this:new zo(this.val,this.unit,{dim:this.dim,priority:t})}add(t,e){return"number"==typeof t&&(t=Po(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?Po(this.val+t.val,this.unit,this):Ko(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=Po(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?Po(this.val-t.val,this.unit,this):Ko(this,"-",t)}mul(t){return 1===t?this:Po(this.val*t,this.unit,this)}div(t){return 1===t?this:Po(this.val/t,this.unit,this)}negate(){return Po(-this.val,this.unit,this)}toFormula(){return`${this.val}${this.unit}`}}function Po(t,e,n){return t?new zo(t,e,n):n.dim.zero.prioritize(n.priority||0)}class Uo extends Eo{constructor(t,e,n,r){super(r),this.left=t.usual(),this.op=e,this.right=n}get type(){return"calc"}is(t){return this===t||"object"==typeof t&&t.type===this.type&&(this.op===t.op&&this.left.is(t.left)&&xo(this.right,t.right)&&this.priority===t.priority)}add(t,e){return"number"==typeof t&&(t=Po(t,e,this)),Ko(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=Po(t,e,this)),Ko(this,"-",t)}mul(t){return No(this,t)}div(t){return Lo(this,t)}toString(){return"calc"+super.toString()}}class Mo extends Uo{constructor(t,e,n,r){super(t,e,n.usual(),r)}prioritize(t){return this.priority===t?this:new Mo(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(!e)return;const n=this.right.toDim(t);return n?e===this.left&&n===this.right?this:new Mo(e,this.op,n,{dim:t,priority:this.priority}):void 0}negate(){return"-"===this.op?new Mo(this.right,this.op,this.left,this):new Mo(this.left.negate(),"-",this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right.toFormula()})`}}function Ko(t,e,n){return n.type?new Mo(t,e,n,t):t}class qo extends Uo{prioritize(t){return this.priority===t?this:new qo(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(e)return e===this.left?this:new qo(e,this.op,this.right,{dim:t,priority:this.priority})}mul(t){return("*"===this.op?No(this.left,this.right*t):Lo(this.left,this.right/t)).prioritize(this.priority)}div(t){return("/"===this.op?Lo(this.left,this.right*t):No(this.left,this.right/t)).prioritize(this.priority)}negate(){return new qo(this.left,this.op,-this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right})`}}function No(t,e){return e?1===e?t.prioritize(t.priority):new qo(t,"*",e,t):t.dim.zero.prioritize(t.priority)}function Lo(t,e){return 1===e?t.prioritize(t.priority):new qo(t,"/",e,t)}class jo extends Eo{constructor(t,e){super(e),this._byPriority=t}get type(){return 0}toDim(t){return t.zero.prioritize(this.priority)}is(t){return this===t||("object"==typeof t?t.type===this.type&&t.priority===this.priority:0===t||"0"===t?0===this.priority:"0 !important"===t&&1===this.priority)}add(t,e){return"number"==typeof t&&(t=Po(t,e,this)),t.prioritize(this.priority)}sub(t,e){return"number"==typeof t&&(t=Po(t,e,this)),t.negate().prioritize(this.priority)}mul(){return this}div(){return this}negate(){return this}prioritize(t){return this._byPriority.get(t)}important(){return this._byPriority.important}usual(){return this._byPriority.usual}toFormula(){return"0"}}class Bo{constructor(t){this.dim=t,this.usual=new jo(this,{dim:t}),this.important=new jo(this,{dim:t,priority:1})}get(t){switch(t){case 0:return this.usual;case 1:return this.important}return new jo(this,{dim:this.dim,priority:t})}}function Io({pt:t,noPt:e}){const n={get zero(){return r},get pt(){return t()},get noPt(){return e()},of(t,e){return t?new zo(t,e,{dim:this}):r},by(t){if(function(t){return"object"==typeof t&&("dimension"===t.type||"calc"===t.type||0===t.type)}(t))return t.toDim(this)}},r=new Bo(n).usual;return n}const Wo=Io({pt:()=>Vo,noPt:()=>Wo}),Vo=Io({pt:()=>Vo,noPt:()=>Wo});class Go extends vo{constructor(t,e){super(e),this.url=t}get type(){return"url"}static by(t){switch(typeof t){case"string":{const[e,n]=Ro(t);return new Go(e,{priority:n})}case"object":if("url"===t.type)return t}}by(t){return Go.by(t)||this}prioritize(t){return t===this.priority?this:new Go(this.url,{priority:t})}is(t){return"object"==typeof t&&"url"===t.type&&t.url===this.url&&t.priority===this.priority}toString(){return`url('${t(this.url)}')`}}const Ho=Ot({});function Qo(){return Ho}function Jo(t,e){if(!e)return Ho;if("string"!=typeof e){if(X(e))return Xo(e);if(ct(e))return Xo(Zo(e));if("function"==typeof e){const n=e(t);if("string"!=typeof n){if(X(n))return Xo(n);if(ct(n))return Xo(Zo(n))}return Ot(Yo(n))}}return Ot(Yo(e))}function Zo(t){return $t(t,l({}))}function Xo(t){return $t(t).keepThru(Yo,function(){let t;return e=>t&&function(t,e){const n=w(ti(e));for(const[e,r]of ti(t)){const{value:t}=n.next();if(!t||e!==t[0]||!xo(r,t[1]))return!1}return!n.next().value}(e,t)?m():t={...e}}(),u)}function Yo(t){return"string"==typeof t?{$$css:t}:t}function ti(t){return O(R(t),f)}function ei(t,e){return Xo(St({base:t,addendum:e}).keepThru(({base:[t],addendum:[e]})=>function(t,e){return T(R(e),(t,[e,n])=>function(t,e,n){ni(t[e])<=ni(n)&&(delete t[e],t[e]=n);return t}(t,e,n),{...t})}(t,e)))}function ni(t){switch(typeof t){case"string":return t.endsWith("!important")?1:0;case"object":return t.priority;default:return 0}}function ri(t){return">"===t||"+"===t||"~"===t}function si(t){if(!wo(t))return[oi(t)];const e=[];let n;for(const r of t){const t=n;let s;if(n&&(e.push(n),n=void 0),ri(r)){if(n=r,!t)continue;s={}}else s=oi(r);e.push(s)}return n&&e.push(n,{}),e}function oi(t){return"string"==typeof t?t?{s:t}:{}:ii(t)}function ii(t){const e=t.ns||void 0,n=t.i||void 0,r=function(t){if(!t)return;if(Yt(t))return[t];const e=t.filter(t=>!!t);return bo(e)?e.sort(te):void 0}(t.c),s=function(t){if(!t)return;if(function(t){return"string"!=typeof t[0]}(t)){const e=t.map(ui);return bo(e)?e:void 0}return[ui(t)]}(t.u);return{ns:e,e:("*"!==t.e||!e&&!n&&!r&&s&&ci(s[0]))&&t.e||void 0,i:n,c:r,u:s,s:t.s||void 0,$:ai(t.$)}}function ui(t){if(!ci(t))return t;if(t.length<3)return t;const[e,n,...r]=t;return wo(r[0])?[e,n,...r.map(si)]:[e,n,si(r)]}function ci(t){return t.length>1&&(":"===t[0]||"::"===t[0])}function ai(t){if(t)return bo(t=wo(t)?Array.from(new Set(C(t,li))).sort():Array.from(li(t)))?t:void 0}const hi=new Set;function li(t){if(!t)return hi;const e=t.indexOf("="),n=e<0?t:t.substring(0,e),r=new Set;let s;for(const t of n.split(":"))s?s+=":"+t:s=t,r.add(s);return e>=0&&r.add(t),r}const di=[[]];function fi(t){if(!t.length)return di;let e,n=0;for(;;){const r=t[n++];if(ri(r)){e=r;continue}return[e?[e,r]:[r],t.slice(n)]}}const pi=[];function gi(t,e){return t&&e.every(e=>t.find(t=>function(t,e){if("string"==typeof t)return"string"==typeof e?t===e:!e[1].url&&e[0]===t;const[n,{url:r}]=t;return"string"==typeof e?!r&&n===e:n===e[0]&&r===e[1].url}(e,t)))}function yi(t){return si(t)}const _i={qualify:t=>"@"+mo(t)};function mi(t){return bi(t,_i)}const wi={};function bi(e,{qualify:n,nsAlias:r=ne()}=wi){const s={qualify:n,nsAlias:r};return e.reduce((e,n)=>ri(n)?e+n:(e&&!ri(e[e.length-1])&&(e+=" "),e+function(e,{qualify:n,nsAlias:r}){const{ns:s,e:o,i,c:u,s:c,u:a,$:h}=e;let l=!1,d="";i&&(l=!0,d+="#"+mo(Qt.name(i,r)));u&&(l=!0,d=u.reduce((t,e)=>`${t}.${mo(Zt.name(e,r))}`,d));if(a){l=!0;const e={nsAlias:r};d=a.reduce((n,r)=>function(e,n,r){if(ci(n)){e+=n[0]+n[1];if(n.length>2){e+="("+bi(n[2],r);for(let t=3;t<n.length;++t)e+=","+bi(n[t],r);e+=")"}return e}const[s,o,i,u]=n;e+="["+mo(s),o&&(e+=o+t(i,{quotes:"double",wrap:!0}));u&&(e+=" "+u);return e+"]"}(n,r,e),d)}c&&(l=!0,d+=c);n&&h&&(d=h.reduce((t,e)=>t+n(e),d));if(s){const t=function(t,e){return"string"==typeof t?t:t.url?e(t):void 0}(s,r);d=t?`${t}|${o||"*"}${d}`:f()}else d=f();return d;function f(){return l?`${o?Gt.name(o,r):""}${d}`:`${o?Gt.name(o,r):"*"}${d}`}}(n,s)),"")}class vi{constructor(t){this._rule=t}read(t){let e=this._rule.outer;for(;e;)t=ei(e.read().keepThru($i),t),e=e.outer;return t}render(t,e){const{selector:n}=t;let{writer:r}=t;if(!r.isGroup)return void t.render(e);let s=r;const o=function(t){const e=new Map,n=[];for(const r of t)ri(r)?n.push(r):n.push(Ti(r,e));if(!e.size)return;return[e,yi(n)]}(n);if(!o)return void t.render(e);const[i,u]=o;for(const t of i){const[n,o]=xi(e,t);if(!o){r=s.addStyle(n);break}r=s=s.addGroup(n,o)}t.render(e,{writer:r,selector:u})}}function xi(t,[e,[n,r]]){let s="";const o=t=>{t&&(s&&(s+=" and "),s+=t)};for(const e of n){const[n]=Ro(t[e]);o(n)}return o(r),s?[e,s]:[e]}const ki={order:-65535,create:t=>new vi(t)};function $i(t){return T(O(R(t),Si),(t,[e,n])=>(t[e]=n,t),{})}function Si(t){return"@"===String(t[0])[0]}function Ti(t,e){const n=t.$;if(!n)return t;const r=[];for(const t of n)"@"===t[0]?Oi(e,t):r.push(t);return r.length===n.length?t:bo(r)?{...t,$:r}:{...t,$:void 0}}function Oi(t,e){const n=e.indexOf("=");let r,s;n<0?r=e:(r=e.substring(0,n),s=e.substring(n+1));const o=r.indexOf(":"),i=o<0?r:r.substring(0,o),u=t.get(i);if(u){const[t,e]=u;t.add(r),s&&(u[1]=e?`${e} and ${s}`:s)}else t.set(i,[(new Set).add(r),s])}const Ci={order:-65534,needs:ki,render(t,e){const n=!t.rule.selector.length,{sheet:r}=t;let s=0,o=0;for(const[t,i]of R(e)){const e=String(t);if("@"===e[0]){const[t]=Ro(i),u=n?Ai(r,s,e,t):0;s+=u,o+=u;const c=Go.by(t);c&&(o+=Fi(r,o,e,c),o+=Ei(r,o,e,c))}}t.render(e)}};function Ai(t,e,n,r){if(!n.startsWith("@import:"))return 0;const s=new Go(n.substring("@import:".length));let o=String(s);return r&&(o+=" "+r),t.addGlobal("@import",o,e),1}function Fi(t,e,n,r){return"@namespace"!==n?0:(t.addGlobal("@namespace",String(r),e),1)}function Ei(t,e,n,r){if(!n.startsWith("@namespace:"))return 0;const s=n.substring("@namespace:".length);return t.addGlobal("@namespace",`${s} ${r}`,e),1}function Di(t,n){const r=t.addStyle();k(O(R(n),Ri),([t,n])=>{const[s,o]=Ro(n);r.set(e(t),""+s,o)}),t.render(n,{writer:r})}function Ri(t){const[e,n]=t;if(null==n)return!1;const r=String(e)[0];return r>="a"&&r<="z"||r>="A"&&r<="Z"}function zi(t,e){const n=e.$$css;if(n){const r=t.addStyle();r.replace(n),t.render(e,{writer:r})}else t.render(e)}const Pi={order:-65535,needs:Ci,render(t,e){const n=O(A(x(t.selector),t=>!ri(t)&&t.ns&&"string"!=typeof t.ns?t.ns:null),f);function r(e,n){return e["@namespace:"+t.nsAlias(n)]=new Go(n.url),e}t.render($(n)?e:T(n,r,{...e}))}};function Ui(t){if("function"==typeof t)return{create:()=>({render:t})};if(function(t){return"create"in t}(t))return{order:t.order,needs:t.needs,create:e=>function(t){return"function"==typeof t?{render:t}:t}(t.create(e))};const e=t.render.bind(t);return{order:t.order,needs:t.needs,create:()=>({render:e})}}function Mi(t,e){const n=t.order||0,r=e.order||0;return n>r?1:n<r?-1:0}function Ki(t,e=Oe){return(n={})=>{const{node:r=t,error:s}=n;return e({...n,node:r,error:s&&s.bind(n)})}}function qi(t){var e;null===(e=t.parentNode)||void 0===e||e.removeChild(t)}const Ni={indent:"  "},Li={nv:"",eol:"",pre:"",indent(){return this}};class ji{constructor(t,e=""){this._config=t,this.pre=e}get nv(){return" "}get eol(){return"\n"}indent(){return new ji(this._config,this.pre+this._config.indent)}}class Bi{constructor(t,e){this.f=t,this.selector=e,this.body="",this.nf=t.indent()}get isGroup(){return!1}set(t,e,n){const r=n>=1?" !important":"",{pre:s,nv:o,eol:i}=this.nf;this.body&&(this.body+=";"+i),this.body+=`${s}${t}:${o}${e}${r}`}replace(t){this.body=t.trim(),this.body.endsWith(";")&&(this.body=this.body.substr(0,this.body.length-1))}toString(){const{pre:t,nv:e,eol:n}=this.f;if(this.body){const r=n?";"+n:"";return`${t}${this.selector}${e}{${n}${this.body}${r}${t}}`}return""}}class Ii{constructor(t){this.nf=t,this._nested=[]}get isGroup(){return!0}addGroup(t,e,n){return this._add(new Wi(this.nf,t,e),n)}addStyle(t,e){return this._add(new Bi(this.nf,t),e)}toString(){let t="";for(const e of this._nested){const n=String(e);n&&(t&&(t+=this.nf.eol),t+=n)}return t}_add(t,e=this._nested.length){return this._nested.splice(e,0,t),t}}class Wi extends Ii{constructor(t,e,n){super(t.indent()),this.f=t,this.name=e,this.params=n}toString(){const t=super.toString();if(!t)return"";const{pre:e,nv:n,eol:r}=this.f;return`${e}${this.name} ${this.params}${n}{${r}${t}${r}${e}}`}}class Vi extends Ii{constructor(t,e,n){super(e),this.id=t,this.f=e,this.sender=n}addGlobal(t,e,n){this._add(`${this.f.pre}${t} ${e};`,n)}clear(){this._nested.length=0}remove(){this.clear(),this.sender.send({id:this.id})}done(){this.sender.send({id:this.id,css:this.toString()})}}function Gi(t={}){var e;const{document:n=(null===(e=t.parent)||void 0===e?void 0:e.ownerDocument)||window.document,parent:r=n.head}=t,s=function(t={}){const e=!0===t.pretty||null==t.pretty?Ni:t.pretty||!1,{scheduler:n=Se}=t,r=new At;let s=t=>(s=r.on().F)(t);const o=e?new ji(e):Li;let i=0;return{...t,pretty:e,scheduler:n,onSheet:s,addSheet:()=>new Vi(String(++i),o,r)}}(t),o=Ki(r,t.scheduler),i=o(),u=new Map,c=s.onSheet(({id:t,css:e})=>{let s=u.get(t);null==e?(u.delete(t),qi(s)):s?s.textContent=e:(s=n.createElement("style"),s.setAttribute("type","text/css"),s.textContent=e,r.appendChild(s),u.set(t,s),c.whenOff(()=>i(()=>qi(s))))});return{...t,scheduler:o,addSheet(t){return c.needs(t),this.addSheet=s.addSheet.bind(s),this.addSheet(t)}}}class Hi{constructor(t){this._target=t}get isGroup(){return!1}set(t,e,n){this._target.style.setProperty(t,e,n>=1?"important":void 0)}replace(t){this._target.style.cssText=t}}class Qi{constructor(t){this._target=t}get isGroup(){return!0}addGroup(t,e,n){return new Qi(this._add(`${t} ${e}{}`,n))}addStyle(t,e){return new Hi(this._add(t+"{}",e))}_add(t,e=this._target.cssRules.length){const n=this._target.insertRule(t,e);return this._target.cssRules[n]}}class Ji extends Qi{constructor(t){super(t.sheet),this._element=t}addGlobal(t,e,n){this._add(`${t} ${e};`,n)}clear(){const{cssRules:t}=this._target;for(;t.length;)this._target.deleteRule(t.length-1)}remove(){qi(this._element)}done(){}}function Zi(t,e){const{rootSelector:n={e:"body"},scheduler:r=Oe,nsAlias:s=ne()}=e,o=nt(),i={nsAlias:s},u=function(t){const e=new Map;return n(t.renderer),e.delete(Di),[...e.values(),Ui(Di)].sort(Mi);function n(t){t&&(wo(t)?t.forEach(r):r(t))}function r(t){if(e.has(t))return;const r=Ui(t);e.set(t,r),n(r.needs)}}(e),c=T(A(t,d),(t,e)=>nt().cuts(e).cuts(t),nt());const h=function(){const e=nt();return Et(t).to({supply:e,receive:(t,n)=>{n.forEach(t=>d(t).needs(e))}})}();return o.needs(c).needs(h).cuts(c).cuts(h);function l(t,e,n){return new class{get[Y](){return o}get rule(){return t}get sheet(){return n.sheet}get writer(){return n.writer}get selector(){return n.selector}nsAlias(t){return s(t)}render(r,s){e(s?l(t,e,{sheet:n.sheet,writer:s.writer||n.writer,selector:s.selector||n.selector}):this,r)}addStyle(t=n.selector){const{writer:e}=n;return e.isGroup?e.addStyle(function(t,e){return bi(yi(t),e)}(t,i)):e}}}function d(t){const[s,o]=function(t){const e=u.map(e=>e.create(t));return[e.reduce((t,e)=>e.read?$t(e.read(t)):t,t.read()),function t(n){return(r,s)=>{const o=n+1;let i;i=o===u.length?a:t(o);const c=l(r.rule,i,r);e[n].render(c,s)}}(0)]}(t);let i;const c=function(t){const e=t.selector;if(!e.length)return yi(n);if(ri(e[0]))return[...yi(n),...e];return e}(t),h=r();return s.to((function(n){h(()=>{null==i||i.clear();const r=l(t,o,{get sheet(){return i||(i=e.addSheet(r)),i},get writer(){return this.sheet},selector:c});r.render(n),null==i||i.done()})})).whenOff((function(){h(()=>{const t=i;if(t)return i=void 0,t.remove()})}))}}function Xi(t){const e=[ki,Pi,Ci,zi];return t&&(wo(t)?e.push(...t):e.push(t)),e}function Yi(t,e){return Zi(t,{...e,renderer:Xi(e.renderer)})}class tu{[Z](){return this.read()}add(t){return this.rules.add([],t)}clear(){return this.set()}}class eu{[Z](){return this.read()}[ut](){return this.onUpdate()}}class nu extends eu{}class ru extends eu{constructor(t,e){super(),this._list=t,e?(this._buildList=()=>O(t,e),this._filterArray=t=>t.filter(e)):(this._buildList=()=>t,this._filterArray=u)}read(t){return(this.read=kt(this.onUpdate().thru(h(this)),l(this)).F)(t)}onUpdate(t){return(this.onUpdate=wt(t=>{const e=this._ruleSet||(this._ruleSet=new Set(this._buildList()));Et(this._list).to({supply:t.supply.whenOff(()=>this._ruleSet=void 0),receive:(n,r,s)=>{r=this._filterArray(r),((s=this._filterArray(s)).length||r.length)&&(s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),t.receive(n,r,s))}})}).share().F)(t)}[Symbol.iterator](){return this._ruleSet?this._ruleSet.values():b(this._buildList())}grab(t){return su(this,t)}}function su(t,e){const n=function(t){return ii(t)}(e);return new ru(t,t=>function(t,e){if(!t.length)return!1;const n=t[t.length-1];return(!e.ns||n.ns===e.ns)&&((!e.e||n.e===e.e)&&((!e.i||n.i===e.i)&&(!(e.c&&!gi(n.c,e.c))&&!(e.$&&!gi(n.$,e.$)))))}(t.selector,n))}class ou extends nu{constructor(t,e){super(),this._root=t,this.nested=e,this._updates=new At,this.self=function(t,e){const n=new At,r=[t];e.onUpdate((e,s)=>{s[0]===t&&(r.length=0,n.send([],[t]))}).cuts(n);class s{[ut](){return n.on()}[Symbol.iterator](){return b(r)}}return new ru(new s)}(t,this)}read(t){return(this.read=kt(this._updates.on().thru(h(this)),l(this)).F)(t)}onUpdate(t){return(this.onUpdate=this._updates.on().F)(t)}[Symbol.iterator](){return uu(this._root)}grab(t){return su(this,t)}add(t,e){return function t(e,n,r,s){const[o,i]=fi(n);if(!i)return e._spec.it=function(t,e){const n=t._spec.it;if(!e)return n;if(t.empty)return t=>Jo(t,e);return t=>ei(n(t),Jo(t,e))}(e,r),e;const u=mi(o),c=e.rules.nested._rule(u);if(c)return t(c,i,r,s);const a=new au(e.root,[...e.selector,...o],o),h=t(a,i,r,!1);return e.rules.nested._add(u,a,s),h}(this._root,yi(t),e,!0)}get(t){return this._get(yi(t))}_get(t){const[e,n]=fi(t);if(!n)return this._root;const r=this.nested._rule(mi(e));return r?r.rules.get(n):void 0}watch(t){const e=yi(t);return xt(t=>{const n=jt({}),r=this.read().consume(()=>{const t=this._get(e);return t&&t.read(t=>n.it=t).whenOff(()=>n.it={})});return n.read(t).cuts(r)}).share()}_add(t,e){t.rules.onUpdate((t,e)=>this._updates.send(t,e)),e&&this._updates.send(iu(t),[])}_remove(t){const e=iu(this._root);this._updates.send([],e),e.forEach(e=>{e.rules._updates.done(t),e._spec.done(t)})}}function iu(t){return Array.from(uu(t))}function*uu(t){yield t;for(const e of t.rules.nested)yield*iu(e)}class cu extends eu{constructor(t){super(),this._updates=new At,this._byKey=new Map,this._all=new ou(t,this)}read(t){return(this.read=kt(this._updates.on().thru(h(this)),l(this)).F)(t)}onUpdate(t){return(this.onUpdate=this._updates.on().F)(t)}[Symbol.iterator](){return this._byKey.values()}grab(t){return su(this,t)}_rule(t){return this._byKey.get(t)}_add(t,e,n){this._byKey.set(t,e),e.rules.onUpdate((n,r)=>{r[0]===e&&(this._byKey.delete(t),this._updates.send([],[e]))}),n&&this._updates.send([e],[]),this._all._add(e,n)}}class au extends tu{constructor(t,e,n,r=Qo){super(),this._root=t||this,this._selector=e,this._key=n,this._spec=jt(r),this._nested=new cu(this)}get root(){return this._root}get outer(){if(void 0!==this._outer)return this._outer;const t=function(t){let e=t.length-1;if(e<=0)return e?void 0:pi;do{switch(--e,t[e]){case">":return t.slice(0,e);case"+":case"~":--e;continue;default:return t.slice(0,e+1)}}while(e>0)}(this.selector);return this._outer=t&&this.root.rules.get(t)||null}get selector(){return this._selector}get key(){return this._key}get empty(){return this._spec.it===Qo}get rules(){return this._nested._all}read(t){return(this.read=this._spec.read().keepThru(t=>Ct(t(this))).F)(t)}set(t){return this._spec.it=t?e=>Jo(e,t):Qo,this}remove(t){return this.rules._remove(t),this}}const hu=[];class lu{[Z](){return this.read()}clear(){return this.set()}}class du extends lu{constructor(t,e,n){super(),this._root=t,this._selector=e,this._map=n}read(t){return(this.read=St({ms:this._map(this._root),ps:this._root.rules.watch(this._selector)}).keepThru(({ms:[t],ps:[e]})=>y(Do.map(t,e))).F)(t)}add(t){return this._root.rules.add(this._selector,t),this}set(t){return this._root.rules.add(this._selector).set(t),this}}const fu={by(t,e){let n;return n="function"==typeof e?t=>pu(e(t)):h(pu(e)),e=>new du(e,t,n)}};function pu(t){return X(t)?t:Ot(t)}class gu{constructor(t){this.refs=t}static by(t,e){const n={};for(const r of Object.keys(t))n[r]=t[r](e);return new gu(n)}read(t){const e=St(this.refs);return(this.read=e.keepThru(yu).F)(t)}[Z](){return this.read()}}function yu(t){const e={};for(const n of Object.keys(t))e[n]=t[n][0];return e}const _u=new ru({[ut]:()=>Ft,[Symbol.iterator]:()=>[][Symbol.iterator]()});function mu(...t){return t.length?xu(t.map(wu)):_u}function wu(t){return"function"==typeof t?function(t){let e;const n=()=>e||(e=ku(t()));return{[Symbol.iterator]:()=>n()[Symbol.iterator](),[ut]:()=>n()[ut]()}}(t):ku(t)}function bu(...t){return t.length?xu(t.map(vu)):_u}function vu(t){return"function"==typeof t?function(t){const e=new Set,n=wt(n=>{const r=ku(t());$u(r,e,n),r[ut]().to({supply:n.supply.whenOff(()=>e.clear()),receive(t,r,s){s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),n.receive(t,r,s)}})}).share();return{[ut]:()=>n,[Symbol.iterator]:()=>e.values()}}(t):ku(t)}function xu(t){if(1===t.length){const e=t[0];return e instanceof eu?e:new ru(e)}return new ru({*[Symbol.iterator](){for(const e of t)yield*e},[ut]:()=>wt(e=>{t.forEach(t=>Et(t).to({supply:nt().needs(e.supply),receive(t,n,r){e.receive(t,n,r)}}))}).share()})}function ku(t){return t instanceof tu?t.rules.self:ct(t)?t:function(t){const e=new Set,n=wt(n=>{let r=lt();const{supply:s}=n;s.cuts(r).whenOff(()=>e.clear()),t.then(t=>{if(!s.isOff){const o=t instanceof tu?t.rules:t;$u(o,e,n),r=Et(o).to({receive(t,r,s){s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),n.receive(t,r,s)}}).needs(s)}}).catch(t=>s.off(t))}).share();return{[ut]:()=>n,[Symbol.iterator]:()=>e.values()}}(t)}function $u(t,e,n){const r=[];if(k(t,t=>{r.push(t),e.add(t)}),r.length){const t=new it;t.on(n),t.send(r,[])}}function Su({$:t,n:e,t:n,v:r,x:s=[],p:o={},pl:i=[]}){return{$:t,n:e,t:n,v:r,x:s,p:o,pl:i}}function Tu({p:t,pl:e},n){const r=n.n||n.v,s=t[r];(!s||!s.n&&n.n)&&(t[r]=n),e.push(n)}const Ou=()=>!1,Cu=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \d\d (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d\d\d\d \d\d:\d\d:\d\d GMT/;function Au({dateTime:t}){return t?Fu:Ou}function Fu(t,e){return t.s=t.s.substring(t.i),t.i=0,!!Cu.test(t.s)&&(e(t.s.substring(t.i,t.i+=29)),!0)}function Eu({delimiterOf:t}){return e=>{const n=e.s[e.i];return e.d=t(n),n}}function Du(t,{named:e=!0,tagged:n=!0,extra:r=!0,next:s=Eu(t)}={}){const o=function({delimiterOf:t}){return(e,n)=>{if(!(262144&t(e.s[e.i])))return!1;let r="";for(++e.i;e.i<e.s.length;){const n=e.s[e.i++];if(524288&t(n))break;r+=n}return n(r),!0}}(t),i=Au(t),u=function({delimiterOf:t}){return(e,n)=>{let r="";for(++e.i;e.i<e.s.length;++e.i){const s=e.s[e.i];if("\\"===s){const t=e.s[++e.i];r+=t||s}else{if(65536&t(s))return++e.i,void n(r);r+=s}}n(r)}}(t),c=r?Du(t,{next:s,tagged:!1,named:!1,extra:!1}):Ou;return(t,r)=>{let a,h,l,d="",f="raw";for(;t.i<t.s.length;){const r=s(t);if(t.d){if(12&t.d)break;if(null==h){if(16&t.d){h=d?"":r,++t.i;continue}if(65536&t.d){!n&&d||u(t,t=>{d?(f="tagged-string",a=d):f="quoted-string",d="",h=t});break}if(!d&&o(t,t=>{f="angle-bracketed-string",h=t}))break;h=d,d=""}else{if(65536&t.d){!n&&h||u(t,t=>{h?(f="tagged-string",a=h):f="quoted-string",h=t});break}if(!h&&o(t,t=>{f="angle-bracketed-string",h=t}))break}}if(null==h){if(!d&&i(t,t=>h=t)){f="date-time";break}e?d+=r:h=r}else{if(!h&&i(t,t=>h=t)){f="date-time";break}h+=r}++t.i}if(null==h){if(!d)return!1;l=Su({$:f,v:d})}else l=Su({$:f,n:d||void 0,t:a,v:h});for(;c(t,t=>l.x.push(t)););return r(l),!0}}function Ru({delimiterOf:t}){return e=>{let n=e.s[e.i];return"\\"!==n?(e.d=t(n),n):(++e.i,e.i<e.s.length?(n=e.s[e.i],e.d=t(n)?1:0):e.d=1,n)}}function zu({delimiterOf:t}){return e=>{const n=e.i;do{const n=e.s[e.i];if(!(2&t(n)))break;e.i++}while(e.i<e.s.length);return e.i!==n}}function Pu(t,e={}){const{delimiterOf:n}=t,r=zu(t),s=Du(t,{...e,tagged:!1});return(t,e)=>!!(8&n(t.s[t.i]))&&(++t.i,r(t),s(t,e))}const Uu={" ":7,"\t":7,",":5,";":9,'"':65569,"\\":33,"<":262145,">":524289,"=":17,"(":1,")":1,"/":1,":":1,"?":1,"@":1,"[":1,"]":1,"{":1,"}":1};function Mu({delimit:t,dateTime:e}={}){const n=t?{...Uu,...t}:Uu;return{dateTime:e,delimiterOf:t=>n[t]||(t>="\0"&&t<=" "||"\x7f"===t?1:0)}}const Ku=Mu(),qu=Mu({delimit:{":":17,"(":131105,")":37," ":3,"\t":3,"=":1,",":1}});function Nu(t){const e=t?Mu(t):Ku,n=function(t){const{delimiterOf:e}=t,n=zu(t);return t=>!!(4&e(t.s[t.i]))&&(t.i++,n(t),!0)}(e),r=Pu(e),s=Du(e),o=(null==t?void 0:t.comments)?function(t){const{delimiterOf:e}=t,n=zu(t),r={next:Ru(t)},s=Du(t,r),o=Pu(t,r);return(t,r)=>{if(!(131072&e(t.s[t.i])))return!1;let i;for(++t.i;n(t)||o(t,t=>{i||(i=Su({$:"raw",v:""})),Tu(i,t)})||s(t,t=>i=t););return++t.i,r(i||Su({$:"raw",v:""})),!0}}(qu):Ou;return t=>{const e=[],i={i:0,s:t};for(;i.i<i.s.length&&(n(i)||r(i,t=>{e.length||e.push(Su({$:"raw",v:""})),Tu(e[e.length-1],t)})||o(i,t=>e.push(t))||s(i,t=>e.push(t))););return e}}const Lu=Nu();function ju(t){if(!t)return'""';const{delimiterOf:e}=Ku;let n,r=!1;for(let s=0;s<t.length;++s){const o=t[s],i=e(o);i?(32&i&&(n||(n=t.substring(0,s)),n+="\\"+o),r=!0):n&&(n+=o)}return r?`"${n||t}"`:t}class Bu extends ye{constructor(t){super(t),this.upKey=this.createUpKey(t=>t.insert(t.seed.keepThru((...e)=>e.length?y(function(t){return(e,n)=>{const r=(n,s)=>{const o=t[n];return o?Et(o((t=s)=>r(n+1,t),s)):e(s)};return r(0,n)}}(e)):t.hasFallback&&t.or?Ct(t.or):Iu)))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Ot(t.or):t.or}:void 0).to(t=>e=t).whenOff(t=>e=ce(t)),t.insert((t,n)=>e(t,n))}}function Iu(t,e){return t(e)}const Wu=new Bu("http-fetch-agent"),Vu={};const Gu=new _e("http-fetch",{byDefault:Fe((function(t){const e=t.get(mn),n=t.get(Wu);return(t,e)=>n(r,new Request(t,e));function r(t){return wt(n=>{const r=new At;let s;if("AbortController"in e){const o=new e.AbortController,{signal:i}=o;s=nt(t=>{t===Vu&&o.abort()}),n.supply.whenOff(()=>s.off(Vu)).needs(s),r.on({supply:s,receive(t,e){n.receive(t,e)}});const u=t.signal;u&&(new ue(u).on("abort").once(()=>o.abort()),u.aborted&&o.abort()),t=new Request(t,{signal:i})}else s=r.on(n);e.fetch(t).then(t=>{r.send(t),s.off()}).catch(t=>s.off(t))})}}))});const Hu=new J("hierarchy-root",{byDefault:t=>{const e=t.get(wn);return new ue(e).on("wesib:component").to(({context:t})=>t.get(Ju).issue()),jt()}}),Qu=new J("hierarchy-updates",{byDefault:t=>new Ju(t.get(rn))});class Ju{constructor(t){const e=new At,n=t.get(Ae).get(Hu);this.on=e.on(),this.send=()=>e.send(t),this.issue=()=>{const e=Zu(t);e?e[0].get(Ju).send():n.it=t}}static get[z](){return Qu}}function Zu(t){const e=t.get(Ae).get(wn);let{element:n}=t,r=!0;if(n!==e)for(;;){const t=n.parentNode;if(!t)return;const s=t[nn];if(s)return[s,r];if(t===e)return;r=!1,n=t}}const Xu=new J("hierarchy-context",{byDefault:t=>new tc(t.get(rn))});class Yu extends q{static get[z](){return Xu}get[Y](){return et(this.context)}}class tc extends Yu{constructor(t){super(),this.context=t;const e=this._parent=jt();t.whenConnected(a).cuts(e);const n=this._registry=(r=this.up(),new N(t=>function(t){return"upKey"in t}(t)?r.keepThru(e=>e?Ct(e.get(t)):_()):void 0));var r;this.get=n.newValues().get}provide(t){const e=this._registry.provide(t);return et(this).whenOff(e),e}up(t){return(this.up=xt(t=>{const{supply:e}=t;e.needs(this);const n=jt();n.by(this._parent),e.cuts(n);const r=nt().needs(e),s=nt().needs(e),o=()=>{const t=Zu(this.context);if(t){const[e,o]=t;n.it=e.get(Yu),r.off(),o&&s.off()}else n.it=void 0};this.context.get(Ae).get(Hu).read({supply:r,receive:()=>this.context.connected&&o()}),n.read().tillOff(s).consume(t=>t&&t.context.get(Ju).on.to(o)),n.read(t),this.context.whenConnected({supply:nt().needs(e),receive:o})}).share().F)(t)}inside(t){return this._parent.it=t&&t.get(Yu),this}}class ec{[ut](){return this.onUpdate()}[Z](){return this.read()}}const nc={subtree:!0};function rc(t,e,n,r,{deep:s,all:o}){const i=new At,u=s?nc:void 0;let c,a,h=new Set;const d=s?sc:x;"string"==typeof n?a=n:t.whenDefined(n).then(({elementDef:{name:e}})=>{if(c=void 0,e&&(a=Gt.name(e,t.get(bn)),i.size)){const t=g();if(t.size){const e=Array.from(O(A(t,t=>r(t)),f));e.length&&i.send(e,[])}}}).catch(console.error),o||e.addEventListener("wesib:component",t=>{const e=t.target;if(h.has(e)){const t=r(e);i.send([t],[])}});class p extends ec{onUpdate(n){const r=t.get(On)(_);return(this.onUpdate=wt(t=>{const n=!i.size,s=i.on(t);return n&&(g(),r.observe(e,u)),s.whenOff(()=>{i.size||(r.disconnect(),c=void 0,h.clear())})}).F)(n)}read(t){return(this.read=kt(this.onUpdate().thru(()=>this),l(this)).F)(t)}track(t){const e=this.onUpdate();return(this.track=xt(t=>{const n=new At;n.on(t),n.send(Array.from(this),[]),e.to(t)}).F)(t)}first(t){return(this.first=$t(this.read()).keepThru(t=>y(S(t))).F)(t)}[Symbol.iterator](){return w(c||(c=O(A(i.size?h:g(),t=>r(t)),f)))}}return new p;function g(){c=void 0;const t=function(){const t=a;if(!t)return new Set;if(s)return new Set(x(e.querySelectorAll(t)));return new Set(O(x(e.children),e=>e.matches(t)))}();return i.size&&(h=t),t}function _(t){const e=[],n=[];t.forEach(t=>{k(O(A(d(t.removedNodes),b),f),t=>n.push(t)),k(O(A(d(t.addedNodes),m),f),t=>e.push(t))}),(e.length||n.length)&&i.send(e,n)}function m(t){if(De(t))return a&&t.matches(a)&&!h.has(t)?(h.add(t),r(t)):void 0}function b(t){if(De(t)&&h.delete(t))return r(t,!0)}}function sc(t){return C(x(t),t=>[t,...sc(t.childNodes)])}class oc{constructor(t,e){this._bs=t,this.element=e,this._emitters=new Map}get observer(){if(this._observer)return this._observer;const t=this._bs.get(mn).MutationObserver;return this._observer=new t(t=>this._update(t))}observe(t,e){const n=this,r=this.observer,s=this._emitter(t),o=rt(e),i=s.on({supply:nt(()=>{this._emitters.delete(t),r.disconnect(),this._emitters.size?u():this._observer=void 0}).needs(o.supply),receive:(t,e,n)=>o.receive(t,e,n)});return r.disconnect(),u(),i;function u(){n._update(r.takeRecords()),r.observe(n.element,{attributes:!0,attributeOldValue:!0,attributeFilter:Array.from(n._emitters.keys())})}}_update(t){t.forEach(t=>{const e=t.attributeName,n=this._emitters.get(e);n&&n.send(this.element.getAttribute(e),t.oldValue)})}_emitter(t){const e=new At;return this._emitters.set(t,e),e}}class ic extends Nt{constructor(t,e){super(),this._observer=t,this._name=e,this._updates=new At}get[Y](){return et(this._updates)}get it(){return this._observer.element.getAttribute(this._name)}set it(t){null!=t?this._observer.element.setAttribute(this._name,t):this._observer.element.removeAttribute(this._name)}on(t){let e=lt();return(this.on=wt(t=>{this._updates.size||(e=this._observer.observe(this._name,(t,e)=>this._updates.send(t,e))),t.supply.needs(e),this._updates.on(t).whenOff(t=>{this._updates.size||e.off(t)})}).F)(t)}}class uc{constructor(t,e){this._attrs=new Map,this._observer=new oc(t,e)}get(t){const e=this._attrs.get(t);if(e)return e;const n=new ic(this._observer,t);return this._attrs.set(t,n),n}}class cc extends Nt{constructor(t,e){super(),this._element=t,this._key=e,this._updates=new At}get[Y](){return et(this._updates)}get it(){return this._element[this._key]}set it(t){this._element[this._key]=t}on(t){return(this.on=this._updates.on().F)(t)}bind(t){var e;t.get(vr).track((e=this._key,[$r,e])).onUpdate().to({supply:et(this),receive:(t,e,n,r)=>this._updates.send(n,r)})}}class ac{constructor(t){this._element=t,this._props=new Map}bind(t){this._context=t,this._props.forEach(e=>e.bind(t))}get(t){const e=this._props.get(t);if(e)return e;const n=new cc(this._element,t);return this._context&&n.bind(this._context),this._props.set(t,n),n}}const hc=Symbol("element-node");class lc{constructor(t,e){this._bs=t,this.element=e,this._attrs=new uc(t,e),this._props=new ac(e),e[hc]=this;const n=e[nn];n?this._bind(n):e.addEventListener("wesib:component",t=>this._bind(t.context))}get context(){return this.element[nn]}get parent(){const t=this.element.parentNode;return t&&dc(this._bs,t)}select(t,e){return function(t,e,n,r={}){if(r.all)return rc(t,e,n,(e,n)=>dc(t,e,n),r);const s=t.get(Tn);return rc(t,e,n,(e,n)=>s(e)&&dc(t,e,n),r)}(this._bs,this.element,t,e)}attribute(t){return this._attrs.get(t)}property(t){return this._props.get(t)}_bind(t){this._props.bind(t)}}function dc(t,e,n){const r=e[hc];return r||n?r:new lc(t,e)}const fc=new J("component-node",{byDefault:t=>dc(t.get(Ae),t.get(rn).element)});function pc(t){return new URL(t.hash.substring(1),t.origin)}const gc=Symbol("page-param");class yc{get[gc](){return this}byDefault(t,e){}}class _c extends ye{constructor(t){super(t),this.upKey=this.createUpKey(t=>{const{document:e}=t.context.get(mn);t.insert(t.seed.keepThru((...n)=>n.length?function(t,r,s,o){return function o(i,u){const c=n[i];if(!c)return t(u);c(({url:t=u.url,title:n=u.title,data:r=u.data}=u)=>o(i+1,{url:new URL(String(t),e.baseURI),title:n,data:r,get visited(){return u.visited},get current(){return u.current},get:t=>u.get(t),put(t,e){u.put(t,e)}}),r,s,u)}(0,o)}:t.hasFallback&&t.or?Ct(t.or):mc))})}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Ot(t.or):t.or}:void 0).to(t=>e=t).whenOff(t=>e=ce(t)),t.insert((t,n,r,s)=>e(t,n,r,s))}}function mc(t,e,n,r){t(r)}const wc=new _c("navigation-agent");class bc extends q{}const vc=new J("nav-history",{byDefault:Fe(t=>new kc(t))});function xc(t){return null==t||"object"!=typeof t?{data:t}:t["wesib:navigation:data"]}class kc{constructor(t){this._context=t,this._entries=new Map,this._lastId=0;const e=t.get(mn);this._document=e.document,this._location=e.location,this._history=e.history,this._uid=btoa(String(Math.random()))}static get[z](){return vc}init(){const{data:t}=xc(this._history.state),e=this.newEntry({url:new URL(this._location.href),data:t,title:this._document.title});return this._entries.set(e.id,e),e.schedule(()=>{e.enter("init"),this._history.replaceState(this._historyState(e),"")}),e}newEntry(t){return new $c(this._context,++this._lastId,t)}open(t,e){const{page:{title:n="",url:r}}=t;this._history.pushState(this._historyState(t),n,r.href),this._enter("open",t,e)}_enter(t,e,n){const r=n.it;this._entries.set(e.id,e);try{for(let t=r.next;t;t=t.next)this._forget(t)}finally{e.prev=r,r.next=e,e.schedule(()=>{try{r.leave()}finally{e.enter(t)}}),n.it=e}}replace(t,e){const n=e.it,{page:{title:r="",url:s}}=t;this._history.replaceState(this._historyState(t),r,s.href),this._entries.set(t.id,t);const o=n.prev;o&&(t.prev=o,o.next=t),t.schedule(()=>{try{n.leave()}finally{try{this._forget(n)}finally{t.enter("replace")}}}),e.it=t}popState(t,e){const{state:n}=t;if(null==n)return null==this._history.state?this._changeHash(e):void 0;const r=e.it,{uid:s,data:o,id:i}=xc(n);let u;const c=s===this._uid&&null!=i?this._entries.get(i):void 0;return c?u=c:(u=this.newEntry({url:new URL(this._location.href),data:o,title:this._document.title}),r.transfer(u,"return"),this._entries.set(u.id,u),this._history.replaceState(this._historyState(u),"")),u.schedule(()=>{try{r.leave()}finally{u.enter("return")}}),e.it=u,u}hashChange(t){if(null==this._history.state)return this._changeHash(t)}update(t,e){const n=t.it,r=new $c(this._context,++this._lastId,{...n.page,url:e},n);return this._entries.set(r.id,r),this._history.replaceState(this._historyState(r),"",e.href),this._entries.delete(n.id),t.it=r}_changeHash(t){const e=t.it,n=this.newEntry({url:new URL(this._location.href),data:null,title:this._document.title});try{e.transfer(n,"enter")}finally{this._history.replaceState(this._historyState(n),""),this._enter("enter",n,t)}return n}_forget(t){this._entries.delete(t.id),t.forget()}_historyState({id:t,page:{data:e}}){return{"wesib:navigation:data":{uid:this._uid,id:t,data:e}}}}class $c{constructor(t,e,n,r){this._bsContext=t,this.id=e,this._status=0,this._update=a,this._params=r?r._params:new Map;const s=this;this.page={get url(){return n.url},get title(){return n.title},get data(){return n.data},get visited(){return!!s._status},get current(){return 2===s._status},get:t=>s.get(t),put(t,e){s.put(t,e)}}}get(t){const e=t[gc],n=this._params.get(e);if(n)return n.get();const r=e.byDefault(this.page,this._newContext());return r&&this._init(e,r)}put(t,e){const n=t[gc],r=this._params.get(n);return r?(r.put(e),r.get()):this._init(n,n.create(this.page,e,this._newContext()))}_newContext(){const t=new N(this._bsContext);return new class extends bc{constructor(){super(...arguments),this.get=t.newValues().get}}}_init(t,e){return this._params.set(t,e),this.page.current&&e.enter&&e.enter(this.page,"init"),e.get()}transfer(t,e){k(this._params.entries(),([n,r])=>{if(r.transfer){const s=r.transfer(t.page,e);s&&t._params.set(n,s)}})}stay(t){k(this._params.values(),e=>e.stay&&e.stay(t))}enter(t){this._status=2,k(this._params.values(),e=>e.enter&&e.enter(this.page,t))}leave(){this._status=1,k(this._params.values(),t=>t.leave&&t.leave())}forget(){k(this._params.values(),t=>t.forget&&t.forget()),this._params.clear()}schedule(t){this._update=t}apply(){const t=this._update;this._update=a,t()}}class Sc extends Event{constructor(t,e){super(t,{...e,cancelable:!1}),this.when=e.when,this.to=e.to}}class Tc extends Event{constructor(t,e){super(t,{...e,cancelable:!0}),this.when=e.when,this.from=e.from,this.to=e.to}}class Oc extends Event{constructor(t,e){super(t,{...e,cancelable:!0}),this.from=e.from,this.to=e.to,this.reason=e.reason}get when(){return"stay"}}const Cc=new J("navigation",{byDefault:Fe((function(t){const e=t.get(mn),{document:n,history:r}=e,s=new ue(e),o=t.get(kc),i=t.get(wc),u=jt(o.init());u.read(t=>t.apply());let h=Promise.resolve();s.on("popstate").to(t=>{const e=o.popState(t,u);e&&s.dispatch(new Sc("wesib:enterPage",{when:null!=t.state?"return":"enter",to:e.page}))}),s.on("hashchange").to(()=>{const t=o.hashChange(u);t&&s.dispatch(new Sc("wesib:enterPage",{when:"enter",to:t.page}))});return new class extends Ac{get page(){return u.it.page}get length(){return r.length}onEnter(t){return(this.onEnter=s.on("wesib:enterPage").F)(t)}onLeave(t){return(this.onLeave=s.on("wesib:leavePage").F)(t)}onStay(t){return(this.onStay=s.on("wesib:stayOnPage").F)(t)}on(t){return(this.on=Dt(this.onEnter(),this.onLeave(),this.onStay()).F)(t)}read(t){return(this.read=u.read().keepThru(t=>t.page).F)(t)}go(t){r.go(t)}open(t){return f("pre-open","open",t)}replace(t){return f("pre-replace","replace",t)}update(t){return o.update(u,l(t)).page}with(t,e){return function t(e){return{with:(n,r)=>t(c(e,t=>t.put(n,r))),open:t=>f("pre-open","open",t,e),replace:t=>f("pre-replace","replace",t,e),pretend(t,n=((t,e)=>e)){let r;"function"==typeof t?(n=t,r=void 0):r=t;const s=d(r),o=u.it,i=p("pretend",o,s,e);try{return g("pretend",o,s,i)?n(o.page,i.page):void 0}finally{i.stay(u.it.page)}}}}(n=>n.put(t,e))}};function l(t){return"string"==typeof t?new URL(t,n.baseURI):t||u.it.page.url}function d(t){return null==t||"string"==typeof t||t instanceof URL?{url:l(t)}:t.url instanceof URL?t:{...t,url:l(t.url)}}function f(t,e,n,r=a){const i=d(n),c=h=h.then(l,l);return c;function l(){let n=void 0;try{const a=function(){if(h!==c)return f();const e=u.it,n=p(t,e,i,r),o=new Tc("wesib:leavePage",{when:t,from:e.page,to:n.page});if(!s.dispatch(o)||h!==c||!g(t,e,i,n))return f(n);return n}();return a?(n=a,o[e](n,u),s.dispatch(new Sc("wesib:enterPage",{when:e,to:n.page})),n.page):a}catch(t){throw f(n,t),t}}function f(t,e){return t&&t.stay(u.it.page),s.dispatch(new Oc("wesib:stayOnPage",{from:u.it.page,to:i,reason:e})),null}}function p(t,e,n,r){const s=o.newEntry(n);try{e.transfer(s,t),r(s.page)}catch(t){throw s.stay(u.it.page),t}return s}function g(t,e,n,r){let s=!1;return i(({url:t,data:e,title:r})=>{s=!0,n.url=t,n.data=e,n.title=r},t,e.page,r.page),s}}))});class Ac{static get[z](){return Cc}[ut](){return this.on()}[Z](){return this.read()}back(){this.go(-1)}forward(){this.go(1)}reload(){this.go()}}function Fc(t={}){const{select:e="a",pick:n={all:!0,deep:!0}}=t;return Je({define(r){r.whenComponent(r=>{const s=function(t,e){const n=t.get(Ar),{render:r,active:s=Pc}=e,o=Zt.name(s,t.get(bn)),i=e.activate?e.activate.bind(e):a;return t=>{const{element:e}=t.node,s=e[zc]||(e[zc]=n(r)),u=e=>{s(()=>((t,{node:e})=>{const{element:n}=e,{classList:r}=n;t?r.add(o):r.remove(o)})(e,t)),i(e,t)};let c;return u(!0),{supply(){const t=c=nt(()=>{c===t&&u(!1)});return t}}}}(r,t),o=function(t){if(!t.weigh)return Ec;return e=>{const n=t.weigh(e);if("number"==typeof n)return Ot(e.node,n);let r=$t(n).keepThru_(t=>_(e.node,t));return xt(t=>{r.to({supply:nt().needs(t.supply).whenOff(()=>{r=Ot(e.node,0),r.to(t)}),receive:t.receive.bind(t)})})}}(t),i=r.get(Ac),u=r.get(fc);r.whenConnected(()=>{let t=new Map;i.read().tillOff(r).consume(i=>u.select(e,n).read().keepThru_(t=>Ct(Tt(...A(t,t=>o({node:t,context:r,page:i}))))).consume((...e)=>{const n=function(t){let e=0,n=[];return t.forEach(([t,r])=>{r>e?(e=r,n=[t]):r===e&&n.push(t)}),n}(e),o=new Map,u=nt();return n.forEach(e=>{let n;const c=t.get(e);c?(o.set(e,c),n=c):(n=s({node:e,context:r,page:i}),o.set(e,n)),n.supply().needs(u)}),t=o,u}))})})}})}function Ec({node:t,page:e}){const{element:n}=t,r=n.getAttribute("href");if(null==r)return Ot(t,-1);return Ot(t,function t(e,n){if(e.origin!==n.origin)return-1;const r=Dc(e),s=Dc(n);if(e.hash){if(r!==s)return-1;const o=Rc(e,n);return o<0||Rc(n,e)<0?-1:e.pathname.length+o+t(pc(e),pc(n))}const o=Rc(e,n);if(o)return o<0||r!==s?-1:e.pathname.length+o;if(!s.startsWith(r))return-1;return e.pathname.length}(new URL(r,n.ownerDocument.baseURI),e.url))}function Dc(t){const e=t.pathname;return e.endsWith("/")?e:e+"/"}function Rc({searchParams:t},{searchParams:e}){let n=0;return t.forEach((r,s)=>{if(!function(t){return t.startsWith("__")&&t.endsWith("__")}(s)){const r=new Set(e.getAll(s));n>=0&&(t.getAll(s).every(t=>r.has(t))?n+=1:n=-1)}}),n}const zc=Symbol("nav-link-render-schedule"),Pc=["active",Mr];function Uc(t={}){const e=t.handle?t.handle.bind(t):function(t){const e=t.href?t.href.bind(t):Mc;return({event:t,page:n,navigation:r})=>{const s=e(t);if(null==s)return;const o=t.target,i=n.url,u=new URL(s,o.ownerDocument.baseURI);u.origin===i.origin&&(t.preventDefault(),i.href!==u.href&&r.open(s).catch(console.error))}}(t),n=s(t.event||"click");return Je({define(t){t.whenComponent(t=>{t.whenConnected(()=>{const r=t.get(Ac);for(const s of n)t.on(s).to(n=>{r.read().once(s=>e({event:n,page:s,context:t,navigation:r}))})})})}})}function Mc(t){return t.target.getAttribute("href")}function Kc(t,e,n,r=qc){let s;"function"==typeof n?(r=n,s=null):s=n||null;const o=e.ownerDocument;if(De(t)){const n=o.createElement(t.tagName.toLowerCase());return t.getAttributeNames().forEach(e=>n.setAttribute(e,t.getAttribute(e))),r(t,n),e.insertBefore(n,s),n}const i=o.importNode(t,!1);return e.insertBefore(i,s),i}function qc(t,e){k(x(t.childNodes),t=>Kc(t,e))}function Nc(t){let e;return n=>{const r=function(t){return new URL("",t.url).href}(n);if(e){if(e.url===r)return e.on;e.sup.off()}let s;const o=nt().whenOff(()=>{e=void 0,s=void 0}),i=wt(e=>{if(!s){const e=t(n),r=jt(),i=e.to(t=>{r.it=t}).whenOff(t=>{null!=t&&o.off(t)});o.cuts(i).cuts(r),s={on:r.read().thru_(t=>t?_(t):m()),num:0}}const r=s;return++r.num,r.on.tillOff(o).to(e).whenOff(t=>{--r.num||Promise.resolve().then(()=>{r.num||r!==s||o.off(t)}).catch(console.error)})});return e={url:r,on:i,sup:o},i}}class Lc extends Error{}const jc=new class extends yc{create(t,e){return{get:()=>e,put:a}}};class Bc{constructor(t,e){this._navigation=t,this._loader=e,this._map=new Map}get fragments(){const t=[];for(const e of this){if(!e.fragment)return[];t.push(e.fragment)}return t}[Symbol.iterator](){return w(C(this._map.values()))}handle(){const t=this,e=nt();let n=lt();return{get(){},put(e){t._add(e)},transfer(e,n){if("pretend"===n)return;const r=t._transfer();return e.put(jc,r),r.handle()},enter(r,s){if("init"===s)return;n=nt().needs(e);const o=wt(e=>{const s=new At,o=s.on(e);return t._loader(r).tillOff(n).to(t=>s.send(t)).whenOff(t=>{void 0===t||t instanceof Lc||s.send({ok:!1,page:r,error:t})}),o}).share();k(t,({fragment:t,receiver:e})=>function(t,e){return e?t.thru_(t=>t.ok?{...t,fragment:(null!=e.tag?t.document.getElementsByTagName(e.tag)[0]:t.document.getElementById(e.id))||void 0}:t):t}(o,t).to({supply:nt().needs(e.supply),receive(t,n){e.receive(t,n)}}))},leave(){n.off(new Lc("page left"))},stay(){e.off(new Lc("navigation cancelled"))},forget(){e.off(new Lc("page forgotten"))}}}_add(t){const e={...t,receiver:rt(t.receiver)},{supply:n}=e.receiver,r=this._map.get(n);r?r.push(e):(this._map.set(n,[e]),n.whenOff(()=>this._map.delete(n)))}_transfer(){const t=new Bc(this._navigation,this._loader);for(const[e,n]of this._map.entries())t._map.set(e,Array.from(n));return t}}const Ic=new Bu("page-load-agent"),Wc=new _e("page-load-url",{byDefault:h(a)}),Vc=new J("page-loader",{byDefault:Fe((function(t){const e=t.get(mn),n=t.get(Gu),r=t.get(Wc),s=t.get(Ic),o=new e.DOMParser;return t=>{const e=new URL(t.url.href);r(e);const i=new Request(e.href,{mode:"same-origin",credentials:"same-origin",headers:new Headers({Accept:"text/html"})});return wt(t=>s(u,i).to(t));function u(r){return function(t,e){var n;const r=null===(n=t.get(jc))||void 0===n?void 0:n.fragments;r&&r.length&&e.headers.set("Accept-Fragment",T(r,(t,e)=>(t?t+", ":"")+(null!=e.tag?"tag="+ju(e.tag):"id="+ju(e.id)),""))}(t,r),wt(s=>{const i=new it;i.on(s),i.send({page:t}),Rt(n(r).thru_(t=>Promise.all([t,t.text()]))).thru_((...t)=>{return e=t,g((t,n)=>{for(const r of e)t.pass(n,r)});var e},([n,r])=>{if(!n.ok)return{ok:!1,page:t,response:n,error:n.status};try{return{ok:!0,page:t,response:n,document:Gc(o,e,n,r)}}catch(e){return{ok:!1,page:t,response:n,error:e}}}).to(s)})}}}))});function Gc(t,e,n,r){const s=t.parseFromString(r,Lu(n.headers.get("Content-Type")||"text/html")[0].v);if(s.head){const t=s.head.querySelector("base");if(t)t.href=new URL(t.getAttribute("href"),e).href;else{const t=s.createElement("base");t.href=e.href,s.head.appendChild(t)}}return s}class Hc extends yc{create(t,e,n){const r=new Bc(n.get(Ac),Nc(n.get(Vc))),s=r.handle();return t.put(jc,r),s.put(e),s}}const Qc=new Hc,Jc=new J("page-cache-buster",{byDefault:Fe(t=>new Zc(t))});class Zc{constructor(t){const e=Xc(t.get(mn).document);if(e){const n=t.get(Ac);this.urlModifier=Ot(t=>t.searchParams.set("__wesib_app_rev__",e)),this.agent=Ot((t,r)=>t(new Request(r.url,r)).thru_(t=>{if(t.ok){const r=Xc(t.document);if(r&&r!==e){const e=new URL(t.page.url.href);e.searchParams.set("__wesib_app_rev__",r),n.update(e),n.reload()}}return t}))}else this.urlModifier=Ot(),this.agent=Ot()}static get[z](){return Jc}}function Xc(t){var e;return null===(e=t.querySelector("meta[name=wesib-app-rev]"))||void 0===e?void 0:e.getAttribute("content")}function Yc(t){const e=t.get(mn).document;return t=>t().thru_(t=>{if(t.ok){const n=new Set(A(ta(e,x(e.scripts)),([t])=>t));k(O(ta(t.document,x(t.document.querySelectorAll("script"))),([t])=>!n.has(t)),([t,r])=>{Kc(r,e.head,(e,n)=>n.src=t),n.add(t)})}return t})}function ta(t,e){return A(O(e,t=>!!t.src),e=>[new URL(e.src,t.baseURI).href,e])}function ea(t){const e=t.get(mn).document;return t=>t().thru_(t=>{if(!t.ok)return t;const n=t.document.querySelectorAll("link[rel=stylesheet]");if(!n.length)return t;let r=e.head,s=null;const o=e.querySelectorAll("link[rel=stylesheet]"),i=new Map,u=o.item(0);return u&&(r=u.parentNode,s=u,k(x(o),t=>i.set(new URL(t.href,e.baseURI).href,t))),k(x(n),t=>{const n=new URL(t.href,e.baseURI).href,o=i.get(n);o?(S(i.keys())===n?(r=o.parentNode,s=o.nextSibling):r.insertBefore(o,s),i.delete(n)):Kc(t,r,s,(t,e)=>e.href=n)}),k(i.values(),t=>t.parentNode.removeChild(t)),t})}function na(t){const e=t.get(mn).document;return t=>t().thru_(t=>{if(t.ok){const n=t.document.getElementsByTagName("title").item(0);n&&n.textContent&&(e.title=n.textContent)}return t})}const ra={setup(t){t.provide({a:Wc,by:t=>t.urlModifier,with:[Zc]}),t.provide({a:Ic,by:t=>t.agent,with:[Zc]}),t.provide({a:Ic,by:Yc}),t.provide({a:Ic,by:ea}),t.provide({a:Ic,by:na})}};class sa{static get[Pe](){return ra}}function oa(t={}){const e=t.onResponse?t.onResponse.bind(t):a,n=t.contentKey?t.contentKey.bind(t):ia;return Je({feature:{needs:[sa]},define(r){r.whenComponent(r=>{const{fragment:s,render:o}=t,i=r.get(mn).document,u=r.get(Ar)(o),c=r.get(Ac);let a,l=n(c.page);a=s?h(s):()=>{const{element:{id:t,tagName:e}}=r;return t?{id:t}:{tag:e}},r.whenConnected(()=>{const t=i.createRange();t.selectNodeContents(r.contentRoot),c.read().once(s=>{s.put(Qc,{fragment:a(),receiver:{supply:nt().needs(r),receive:(s,o)=>function(s){const o=n(s.page);if(o===l)return;if(!s.ok)return void u(()=>e({context:r,range:t,response:s}));l=o,u(()=>{t.deleteContents();const n=i.createDocumentFragment(),{fragment:o}=s;o&&(qc(o,n),t.insertNode(n)),e({context:r,range:t,response:s})})}(o)}})})})})}})}function ia({url:t}){return new URL("",t).href}class ua extends ye{get upKey(){return this}constructor(){super("default-in-aspects")}grow(t){const e=t.context.get(bn),n=t.context.get(Ar);t.insert(t.seed.keepThru((...t)=>Jr(...t,Qr.to(n),Gr.to(e))).tillOff(t.context.get(he)))}}const ca=new ua,aa=new me("input-from-control",{byDefault:()=>({})});function ha(t,e){return nt(t.get(Yu).provide({a:aa,by:()=>({root:t,control:e})})).needs(t).needs(e)}const la=new J("component-style-producer",{byDefault:Fe(()=>Zi)});function da(t,e={},n){const{context:r}=t;return{...e,document:e.document||r.get(mn).document,parent:e.parent||r.contentRoot,rootSelector:[],scheduler:e.scheduler||fa(r,n),nsAlias:e.nsAlias||r.get(bn),renderer:t.renderer(e)}}function fa(t,e={}){const n=t.get(Ar);return(t={})=>n({...t,...e})}const pa=new W("component-styp-renderer"),ga=new Xt("https://wesib.github.io/ns/element-id-class","elic","element-id-class"),ya=new J("unique-element-class",{byDefault:function(t){const e=t.get(bn),n=t.get(rn),r=n.get(Pn),s=`${r.name?Gt.name(r.name,e):"component"}#${++_a}`,o=ga.name(e(ga),s,Zt);return n.element.classList.add(o),o}});let _a=0;const ma=new J("component-styp-format",{byDefault:t=>new xa(t.get(rn))});class wa{static get[z](){return ma}produce(t,e){const n=this.newProducer(t,e),r=nt();return this.context.whenSettled(()=>{n().needs(r).cuts(r)}),r}newProducer(t,e){const n=bu(t);let r;const s=et(this.context);return r=()=>this.context.get(la)(n,this.format(e)).needs(s),s.whenOff(()=>{r=h(s)}),()=>r()}renderer(t){const e=this.context.get(Er,{or:null}),{renderer:n}=t,i=o(s(n),this.context.get(pa)),u=t.hostSelector?yi(t.hostSelector)[0]:void 0;return i.add(e?function(t){return{order:-100,render(e,n){let{selector:r}=e;if(r.length){if(t){const[e,n]=ba(r);n&&(r=n.length?[{u:[[":","host",va(n,t)]]},...e]:[{u:[[":","host",[t]]]},...e])}}else r=[t||{u:[[":","host"]]}];e.render(n,{selector:r})}}}(u):function(t){return{order:-100,render(e,n){let{selector:r}=e;if(r.length){const[e,n]=ba(r);r=n&&n.length?[...va(n,t),...e]:[t,...e]}else r=[t];e.render(n,{selector:r})}}}(u||{c:[this.context.get(ya)]})),r(i)}}function ba(t){if("string"!=typeof t[0]){const[{ns:e,e:n,i:r,c:s,u:o,s:i,$:u},...c]=t;if(!e&&!n&&!r&&!s&&!i&&o){const[[t,e,...n]]=o;if(":"===t&&"host"===e){let t;return n.length?(t=Array.from(n[0]),t[0].$=u):t=u?[{$:u}]:[],[c,t]}}}return[t]}function va(t,{ns:e,e:n,i:r,c:s,u:o,s:i}){const[u,...c]=t;return[{ns:u.e||u.ns?u.ns:e,e:u.e||u.ns?u.e:n,i:u.i||r,c:u.c?s?[...u.c,...s]:u.c:s,u:u.u?o?[...u.u,...o]:u.u:o,s:(u.s||"")+(i||"")||void 0,$:u.$},...c]}class xa extends wa{constructor(t){super(),this.context=t}format(t){return function(t={}){const{parent:e=document.head}=t;return{...t,scheduler:Ki(e,t.scheduler),addSheet(){const t=document.createElement("style");return t.setAttribute("type","text/css"),t.append(document.createTextNode("")),e.appendChild(t),new Ji(t)}}}(this.config(t))}config(t){return da(this,t,{when:"connected"})}}class ka extends wa{constructor(t,{when:e="settled"}={}){super(),this.context=t,this.when=e}format(t){return Gi(this.config(t))}config(t){return da(this,t,{when:this.when})}}function $a(t){return un(({get:e})=>({componentDef:{define(n){n.whenComponent(n=>{n.whenReady(({component:r})=>{const s=e(r),o="function"==typeof s?s.bind(r):s;n.get(wa).produce(o,t)})})}}}))}const Sa={setup(t){t.provide({a:la,is:Yi})}};class Ta{static get[Pe](){return Sa}}class Oa extends B{constructor(){super("theme-style")}grow(t){const e=new Map;for(const n of t.seed){let t,r,s;"function"==typeof n?(t=r=n,s=!0):(t=n.style,r=n.provide.bind(n),s=!1);const o=e.get(t);if(o){const[n,i]=o;e.set(t,[s?Aa(r,n):Aa(n,r),s||i])}else e.set(t,[r,s])}!e.size&&t.hasFallback||t.insert((function(t){const n=e.get(t);if(!n)return t;const[r,s]=n;return s?r:Aa(t,r)}))}}const Ca=new Oa;function Aa(t,e){return n=>mu(t(n),e(n))}const Fa=new J("theme",{byDefault:Fe(t=>new Da(t.get(Ca)))});class Ea{static get[z](){return Fa}ref(t){return t(this.root)}}class Da extends Ea{constructor(t){var e;super(),this._styles=t,this.root=new au(void 0,hu,[],e?t=>Jo(t,e):void 0),this._rules=new Map}style(...t){const e=this;return bu(...t.reduce((function(t,n){const r=e._rules.get(n);if(r)t.push(r);else{const r=e._styles(n)(e);e._rules.set(n,r),t.push(r)}return t}),[]))}}const Ra=new Xt("https://wesib.github.io/examples","bex","wesib-examples"),za=fu.by({$:"settings"},{$color:new $o({r:161,g:185,b:142}),$bgColor:new $o({r:40,g:43,b:36}),$fontFace:"'Exo 2', sans-serif",$fontSize:Vo.of(1,"em"),$lineHeight:1.2,$fontWeight:"400",$linkFontWeight:"600",$layoutBreakpoint:Wo.of(576,"px")});function Pa({$layoutBreakpoint:t}){return{"@media:sm":`(max-width: ${t})`}}function Ua(t){const e=t.ref(za).read(),{root:{rules:n}}=t;return mu(n.add({e:"a"},e.keepThru(Ma)),n.add({e:"a",s:":visited"},e.keepThru(Ma)),n.add({e:"a",s:":hover"},{textDecoration:"underline"}),n.add({e:"a",s:":active"},{textDecoration:"underline dotted"}),n.add({e:"a",s:":focus"},{textDecoration:"underline dotted"}))}function Ma({$color:t,$linkFontWeight:e}){return{color:t,fontWeight:e,textDecoration:"none"}}function Ka(t){const e=t.ref(za).read();return mu(t.root.add(e.keepThru(qa)).add(e.keepThru(Pa)),t.style(Ua))}function qa({$color:t,$fontFace:e,$fontSize:n,$lineHeight:r,$fontWeight:s}){return{color:t,font:`normal ${s} ${n}/${r} ${e}`}}function Na(t){const e=t.ref(za).read(),{root:{rules:n}}=t;return mu(n.add({e:"html"},{height:"100%",margin:0,padding:0}),n.add({e:"body"},e.keepThru(La)),t.style(Ka))}function La({$bgColor:t}){return{backgroundColor:t,height:"100%",margin:0,padding:0}}const ja=fu.by({$:"settings:form"},t=>gu.by({global:za},t).read().keepThru(Ba));function Ba({global:{$color:t,$bgColor:e,$fontFace:n,$fontSize:r,$lineHeight:s,$fontWeight:o}}){return{$color:t,$bgColor:e.hsl.set(({l:t})=>({l:.8*t})),$roBgColor:e.hsl.set(({l:t})=>({l:.94*t})),$fontFace:n,$fontSize:r,$errorFontSize:r.mul(.8),$lineHeight:s,$fontWeight:o,$borderColor:e,$marginV:r.div(4),$marginH:r.div(4),$paddingV:r.div(2),$paddingH:r,$borderW:Wo.of(1,"px")}}let Ia=(()=>{let t=class{constructor(t){this._context=t}style(){return this._context.get(Ea).style(Va)}};var e;return n([$a()],t.prototype,"style",null),t=n([Je(["in-error",Ra],mr("code"),(e=({control:{control:t},aspects:e,context:n})=>function(t,e,n=ar(e)){return new kr(t,e,n)}(n,"code").read().keepThru_(t=>t?t.trim().split(/\s+/):[]).keepThru(r=>t.convert(io.to(n.element),e).setup(co,t=>{t.add(_o()),t.add(function({mark:t,when:e}={}){let n,r;return n=e?Array.isArray(e)?e.length?t=>e.every(e=>t.has(e)):yo:t=>t.has(e):yo,r=t?Array.isArray(t)?t.length?t:go:[t]:go,t=>t.aspect(Ns).read().keepThru(t=>n(t)?_(...r):_())}({when:r}))})),Je({define(t){t.whenComponent(t=>{const{up:n}=t.get(Yu);St({parent:n().keepThru_(t=>t?Ct(t.get(aa)):y({})),aspects:t.get(ca)}).keepThru_(({parent:[n],aspects:[r]})=>{if(n.control){const s=e({control:n,context:t,aspects:r});if(s)return s instanceof ns?_(s):Ct(s)}return _()}).consume((e,n)=>{if(!e)return;const r=ha(t,e);return(n||et(e)).needs(r),r})})}})))],t),t})();const Wa=["has-error",Wr];function Va(t){const e=t.ref(ja).read(),{root:{rules:n}}=t,r=Vo.of(4,"px");return mu(n.add({u:[":","host"],$:"bex:in-error"},e.keepThru(({$color:t,$errorFontSize:e})=>({display:"none",fontSize:e,padding:e.div(2),borderLeft:`${r} dotted ${t}`,paddingLeft:e.sub(r)}))),n.add({u:[":","host",{c:[Wa,["touched",Wr]],u:[":","not",{c:["has-focus",Wr]}]}],$:"bex:in-error"},{display:"block"}),n.add({u:[":","host",{c:Wa,u:[[":","not",{u:["code","~=","missing"]}],[":","not",{u:["code","~=","incomplete"]}]]}],$:"bex:in-error"},{display:"block"}))}let Ga=(()=>{let t=class{};return t=n([Ne({needs:[Ia]})],t),t})(),Ha=(()=>{let t=class{};return t=n([Je(["main",Ra],oa({onResponse({response:t,range:e}){t.ok||(e.deleteContents(),null==t.ok?e.insertNode(document.createTextNode("Loading...")):e.insertNode(document.createTextNode("Error. "+t.error)))}}))],t),t})();function Qa({$fontSize:t}){return{flex:"1 1 auto",padding:0,margin:"0 0 0 "+t.div(2)}}let Ja=(()=>{let t=class{constructor(t){this._theme=t.get(Ea)}style(){return this._theme.style(Za)}};return n([$a()],t.prototype,"style",null),t=n([Je(["nav",Ra],Uc(),Fc())],t),t})();function Za(t){const e=t.ref(za).read(),{root:{rules:n}}=t;return mu(n.add({u:[":","host"],$:"bex:nav"},e.keepThru(Xa)),n.add({u:[":","host"],$:"bex:nav"},e.keepThru(t=>({flex:"0 1 200px",height:"100%",background:Ya(t)}))),n.add({u:[":","host"],$:["bex:nav","@media:sm"]},{flex:"0 1 100%"}),n.add([{u:[":","host"],$:"bex:nav"},{e:"a",$:"bex:nav"}],e.keepThru(th)),n.add([{u:[":","host"],$:"bex:nav"},{e:"a",c:["active",Mr],$:"bex:nav"}],e.keepThru(eh)))}function Xa({$fontSize:t}){return{padding:0,margin:`0 ${t.div(2)} 0 0`}}function Ya({$bgColor:t}){return t.hsl.set(({l:t})=>({l:.8*t}))}function th(t){const{$fontSize:e}=t;return{display:"block",margin:0,padding:`${e.div(2)} ${e}`,border:0,outline:0,background:Ya(t)}}function eh({$fontSize:t,$color:e,$bgColor:n}){const r=Vo.of(4,"px");return{background:n,borderLeft:`${r} solid ${e}`,paddingLeft:t.sub(r)}}let nh=(()=>{let t=class{constructor(t){this._context=t}async style(){const{elementDef:{name:t}}=await this._context.get(Ae).whenDefined(Ha);return this._context.get(Ea).style(function(t){return e=>{const n=e.ref(za).read(),{root:{rules:r}}=e;return mu(r.add({u:[":","host"],$:"bex:container"},{height:"100%",display:"flex",flexFlow:"row wrap",alignItems:"stretch",alignContent:"flex-start"}).add(n.keepThru(Pa)),r.add({u:[":","host"],$:["bex:container","@media:sm"]},{height:"auto"}),r.add([{u:[":","host"],$:"bex:container"},{e:t,$:"bex:container"}],n.keepThru(Qa)))}}(t))}};return n([$a()],t.prototype,"style",null),t=n([Je({name:["container",Ra],feature:{needs:[Ha,Ja]}})],t),t})();let rh=(()=>{let t=class{};return t=n([Ne({needs:[nh,sa,Ta]})],t),t})(),sh=(()=>{let t=class{};return t=n([Ne({setup(t){t.perComponent({a:wa,as:ka})},init(t){t.whenReady(()=>{Zi(t.get(Ea).style(Na),Gi())})}})],t),t})(),oh=(()=>{let t=class{};return t=n([Ne({needs:[sh,Ga,rh]})],t),t})();function ih(t){const e=t.ref(ja).read(),{root:{rules:n}}=t;return mu(n.add({e:"input"},e.thru(uh)),n.add({e:"input",s:"[readonly]"},e.thru(ch)),n.add({e:"input",s:"[disabled]"},e.thru(ch)),n.add({e:"input",s:":focus"},e.thru(ah)),n.add({e:"input",c:[["invalid",Wr],["touched",Wr]]},e.keepThru(hh)),n.add({e:"input",c:[["missing",Wr],["touched",Wr]]},{outlineStyle:"dotted"}),n.add({e:"input",c:[["incomplete",Wr],["touched",Wr]]},{outlineStyle:"dotted"}))}function uh({$color:t,$fontFace:e,$fontSize:n,$lineHeight:r,$fontWeight:s,$marginV:o,$marginH:i,$paddingV:u,$paddingH:c,$bgColor:a,$borderColor:h,$borderW:l}){return{color:t,font:`normal ${s} ${n}/${r} ${e}`,padding:`${u} ${c}`,margin:`${o} ${i}`,backgroundColor:a,border:"0 none",outline:`${l} solid ${h}`,boxShadow:"inset 1px 1px 2px -2px black",boxSizing:"border-box",width:"100%"}}function ch({$roBgColor:t}){return{backgroundColor:t}}function ah({$color:t,$borderColor:e}){return{outlineColor:Fo(e,t,.5)}}function hh({$color:t,$borderW:e,$borderColor:n}){return{outline:`${e.mul(2)} dashed ${Fo(n,t,.25)}`}}const lh=function(...t){const e=ln.create(),{bootstrapContext:n,complete:r}=function(t){const e=jt(0),n=t.values;const r=new class extends Ae{constructor(){super(),this.get=n.get,t.provide({a:bn,by:ne}),t.provide({a:Ae,is:this})}whenDefined(t){return function(t,e){if(e.hasOwnProperty(ur))return e[ur];const n=zt(Promise.resolve(t.whenReady()).then(()=>t.get(En).whenDefined(e)).then(()=>An(e)));return e[ur]=n}(this,t)}whenReady(t){return(this.whenReady=e.read().thru(t=>t?_(this):m()).once().F)(t)}load(t){const e=xt(e=>{const n=r.get(ir).request(t),s=jt({status:{feature:t,ready:!1}});this.get(Qn.of(t)).to({supply:e.supply,receive(t,e){const n=e;s.it={status:{feature:n.request.feature,ready:n.ready},down:n.down},n.ready||n.init().then(()=>{s.it={status:{feature:n.request.feature,ready:!0},down:n.down}}).catch(console.error)}}).whenOff(()=>{n.unuse()}),s.read(e)}).share();let n;const s=e.to(({down:t})=>{n=t});return new class extends Ie{get down(){return n}read(t){return(this.read=e.tillOff(s).keepThru(t=>t.status).F)(t)}dismiss(t){return s.off(t),n}}}};return{bootstrapContext:r,complete(){e.it=1}}}(e),s=1===t.length?t[0]:(o=t,qe.define(class{},{needs:o}));var o;return n.get(ir).request(s),n.get(Qn.of(s)).to(t=>{t.init().then(r).catch(console.error)}),n}(oh);export{_r as A,mn as B,Je as C,Ka as D,Ra as E,ja as F,io as I,$a as P,Fr as R,Ea as T,Bt as V,Ur as a,za as b,fc as c,Rs as d,St as e,ca as f,Qs as g,Ns as h,uh as i,Gs as j,co as k,_o as l,ha as m,et as n,oh as o,ih as p,lh as q,ch as r,mu as s};//# sourceMappingURL=common.003d005a.js.map
