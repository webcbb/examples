import{_ as t}from"./lib.fa155c56.js";function e(t){return function(t){return Array.isArray(t)}(t)?t:null!=t?[t]:[]}function n(t){const e=Array.from(t),{length:n}=e;if(n)return 1===n?e[0]:e}function s(t){return e=t,Array.isArray(e)?new Set(t):null!=t?new Set([t]):new Set;var e}function r(t,e){var n;return n=e,Array.isArray(n)?e.forEach((e=>t.add(e))):null!=e&&t.add(e),t}function o(t,e=(()=>!0)){const n=Object.getPrototypeOf(t.prototype);if(null==n)return;const s=n.constructor;return e(s)?s:o(s,e)}function i(t){return t}function u(t,e,n=((t,e)=>e)){return t?e?function(...s){return n(t.apply(this,s),e.apply(this,s))}:t:e}function c(){}function a(t){return()=>t}function h(...t){return()=>t}function l(t){let e=()=>(e=a(t()))();return()=>e()}const d=Symbol("SupplyState"),f={isOff:!1,off(t,e){t[d]=y(e)},whenOff(t,e){t[d]=m(e)}},p={isOff:!0,off:g,whenOff(t,e){e()}};function y(t){return void 0===t?p:{isOff:!0,off:g,whenOff(e,n){n(t)}}}function g(t,e){}function m(t){return{isOff:!1,off(e,n){e[d]=y(n),t(n)},whenOff(e,n){const s=t;t=t=>{s(t),n(t)}}}}class _{constructor(t){this[d]=t?m(t):f}get supply(){return this}get isOff(){return this[d].isOff}off(t){return this[d].off(this,t),this}whenOff(t){return this[d].whenOff(this,t),this}whenDone(){return new Promise(((t,e)=>this.whenOff((n=>void 0===n?t():e(n)))))}cuts(t){return t.supply.needs(this),this}needs(t){return t.supply.whenOff((t=>this.off(t))),this}}class w extends _{get isOff(){return!1}off(t){return this}whenOff(t){return this}cuts(t){return this}needs(t){return this}}const b=new w;function v(){return b}function x(t){return t===b}class $ extends _{get isOff(){return!0}off(){return this}whenOff(t){return t(),this}cuts(t){return t.supply.off(),this}needs(t){return this}}const k=new $;function S(){return k}function C(t){return null!=t}function O(t){return void 0!==t}const A=Symbol("push-iterator");function D(t){return!!t[A]}function E(t){return t[Symbol.iterator]()}function R(t){return{[Symbol.iterator]:T,[A]:t}}function T(){return this[A]()}function P(t,e){return!t[A](e).isOver()}function z(t){let e=!1,n=s=>{s&&!t(s)&&(e=!0,n=N)};return{[Symbol.iterator]:F,[A](t){return n(t),this},next:M,isOver:()=>e}}function F(){return this}function M(){for(;;){let t;const e=!P(this,(e=>(t={value:e},!0)));if(t)return t;if(e)return{done:!0}}}function U(){return{done:!0}}function N(t){}const K={[Symbol.iterator]:F,[A](t){return this},next:()=>({done:!0}),isOver:()=>!0};function L(t,e){return t[A](e)}function j(t,e){return t[e]}function q(t){return e=t,n=j,t=>{let s=0;const r=t=>{if(s>=e.length)return!1;for(;;){const r=t(n(e,s++));if(s>=e.length||!1===r)return!1;if(!0===r)return!0}};if(t&&!r(t))return K;let o=!1,i=t=>{t&&!r(t)&&(o=!0,i=N,u=U)},u=()=>s<e.length?{value:n(e,s++)}:(o=!0,i=N,u=U,{done:!0});return{[Symbol.iterator]:F,[A](t){return i(t),this},next:()=>u(),isOver:()=>o}};var e,n}function B(t){return R(q(t))}function W(t,e){if(D(t))return P(t,e);const n=E(t);if(D(n))return P(n,e);for(;;){const t=n.next();if(t.done)return!1;const s=e(t.value);if("boolean"==typeof s)return s}}function I(t,e){W(t,(t=>{e(t)}))}const V=t=>t;function H(t,e=V){if(D(t))return G(t,e);const n=E(t);return D(n)?G(n,e):Array.from(t,e)}function G(t,e){const n=[];return P(t,(t=>{n.push(e(t))})),n}function J(t){let e=!0;return P(t,(t=>e=!1)),e}function Z(t){if(D(t))return Q(t);const e=E(t);return D(e)?Q(e):function(t){const e=t.next();return e.done?void 0:e.value}(e)}function Q(t){let e;return P(t,(t=>(e=t,!1))),e}function X(t,e){let n=!1,s=t=>{(n=!!t&&!e(t))&&(s=N,r=U)},r=()=>{const e=t.next();return e.done&&(n=!0,s=N,r=U),e};return{[Symbol.iterator]:F,[A](t){return s(t),this},next:()=>r(),isOver:()=>n}}function Y(t){return e=>{for(;;){const n=t.next();if(n.done)return!1;const s=e(n.value);if("boolean"==typeof s)return s}}}function tt(t,e){return D(t)?L(t,e):Array.isArray(t)?function(t,e){return t.length?q(t)(e):K}(t,e):function(t,e){const n=E(t);if(D(n))return L(n,e);const s=Y(n);return s(e)?X(n,s):K}(t,e)}function et(t){const e=E(t);return D(e)?e:X(e,Y(e))}function nt(t,e,n){let s=n;return W(t,(t=>{s=e(s,t)})),s}function st(){return K}function rt(t){return R(function(t){return e=>{const n=t();if(D(n))return n[A](e);const s=Y(n);return e&&!s(e)?st():X(n,s)}}(t))}function ot(...t){return t.length>1?R(function(t){return e=>{let n=0,s=t[0];const r=e=>{for(;;){let r;const o=tt(s,(t=>r=e(t)));if(o.isOver()){if(++n>=t.length)return!1;s=t[n]}else s=o;if("boolean"==typeof r)return r}};return e&&!r(e)?st():z(r)}}(t)):t.length?(e=t[0],Array.isArray(e)?B(e):rt((()=>E(e)))):st();var e}function it(t){return R(function(t){return e=>{if(e)return e(t),st();let n=!1;return{[Symbol.iterator]:F,[A](e){return n?st():e?(n=!0,e(t),st()):this},next:()=>n?{done:n}:(n=!0,{value:t}),isOver:()=>n}}}(t))}function ut(t){return B(Reflect.ownKeys(t))}function ct(t,e){return R(function(t,e,n){return s=>{let r=0;const o=s=>{for(;;){if(r>=t.length)return!1;const o=e(t,r++);if(n(o)){const t=s(o);if("boolean"==typeof t)return t}}};if(s&&!o(s))return st();let i=!1,u=t=>{t&&!o(t)&&(i=!0,u=N,c=U)},c=()=>{for(;;){if(r>=t.length)return i=!0,u=N,c=U,{done:!0};const s=e(t,r++);if(n(s))return{value:s}}};return{[Symbol.iterator]:F,[A](t){return u(t),this},next:()=>c(),isOver:()=>i}}}(t,j,e))}function at(t,e){return R((n=>{const s=D(t)?ht(t,e):function(t,e){const n=E(t);if(D(n))return ht(n,e);return t=>{for(;;){const s=n.next();if(s.done)return!1;const r=s.value;if(e(r)){const e=t(r);if("boolean"==typeof e)return e}}}}(t,e);return n&&!s(n)?st():z(s)}))}function ht(t,e){return n=>{const s=L(t,(t=>{if(e(t))return n(t)}));return t=s,!s.isOver()}}function lt(t,e){return R((n=t,s=e?(t,n)=>e(t[n]):dt,t=>{let e,r=0;const o=t=>{if(r>=n.length)return!1;for(e||(e=s(n,r));;){let o;const i=tt(e,(e=>o=t(e)));if(i.isOver()){if(++r>=n.length)return!1;e=s(n,r)}else e=i;if("boolean"==typeof o)return o}};return t&&!o(t)?st():z(o)}));var n,s}function dt(t,e){return t[e]}function ft(t,e=yt){return R((n=>{const s=D(t)?pt(t,e):function(t,e){const n=E(t);if(D(n))return pt(n,e);let s;return t=>{for(;;){if(!s){const t=n.next();if(t.done)return!1;s=e(t.value)}let r;const o=tt(s,(e=>r=t(e)));if(s=o.isOver()?void 0:o,"boolean"==typeof r)return r}}}(t,e);return n&&!s(n)?st():z(s)}))}function pt(t,e){let n,s=!1;return r=>{for(;;){for(;!n;){const r=L(t,(t=>(n=e(t),!0)));if(t=r,r.isOver()){if(!n)return!1;s=!0}}let o;const i=tt(n,(t=>o=r(t)));if(i.isOver()){if(n=void 0,s)return!1}else n=i;if("boolean"==typeof o)return o}}}function yt(t){return t}function gt(t,e){return R((n=>{const s=D(t)?mt(t,e):function(t,e){const n=E(t);if(D(n))return mt(n,e);return t=>{for(;;){const s=n.next();if(s.done)return!1;const r=t(e(s.value));if("boolean"==typeof r)return r}}}(t,e);return n&&!s(n)?st():z(s)}))}function mt(t,e){return n=>{const s=L(t,(t=>n(e(t))));return t=s,!s.isOver()}}function _t(t,e){return R((n=>{const s=D(t)?wt(t,e):function(t,e){const n=E(t);if(D(n))return wt(n,e);return t=>{for(;;){const s=n.next();if(s.done)return!1;const r=e(s.value);if(null!=r&&!1!==r){const e=t(r);if("boolean"==typeof e)return e}}}}(t,e);return n&&!s(n)?st():z(s)}))}function wt(t,e){return n=>{const s=L(t,(t=>{const s=e(t);if(null!=s&&!1!==s)return n(s)}));return t=s,!s.isOver()}}function bt(t){return gt(ut(t),(e=>[e,t[e]]))}const vt=Symbol("context-value-registrar"),xt=Symbol("context-key");class $t{constructor(t){this.name=t}get[xt](){return this}toString(){return`ContextKey(${this.name})`}}class kt extends $t{constructor(t){super(`${t.name}:seed`)}get seedKey(){return this}grow(t){const{seeder:e,seed:n}=t;e.isEmpty(n)&&t.hasFallback||t.insert(n)}}class St extends Error{constructor(t,e=`There is no value with key ${t}`){super(e),this.key=t}}class Ct{constructor(t){this._initial=t,this._issuers=new Map}issuer(t){const e=this._issuers.get(t);if(e)return e;const n=t.seeder(),s=[n,e=>n.seed(e,this._initial(t,e))];return this._issuers.set(t,s),s}newSeed(t,e){const{seedKey:n}=e,[s,r]=this.issuer(n);return n!==e?[s,t.get(n)]:[s,r(t)]}}function Ot(t){return"with"in t}class At{}class Dt{constructor(t,e,n,s={}){this.context=e,this.key=n,this._opts=s,this._constructed=null,this._setup=c;const[r,o]=t.newSeed(e,n);this.seeder=r,this.seed=o,this.hasFallback="or"in s}get or(){return this._opts.or}insert(t){this._constructed=t}fillBy(t){return t(this),this._constructed}setup(t){const e=this._setup;this._setup=n=>{e(n),t(n)}}_grow(){if(this.key.grow(this),null!=this._constructed)return[this._constructed,this._setup];if(!this.hasFallback)throw new St(this.key);return[this.or]}}class Et{constructor(t){this._seeders=new Ct(t?"function"==typeof t?t:e=>t.get(e):c)}provide(t){if(function(t){return"function"==typeof t[vt]}(t))return t[vt](this);const{a:{[xt]:{seedKey:e}},by:n}=function(t){if(function(t){return"by"in t}(t)){if(!Ot(t))return t;const{a:e,by:n,with:s}=t;return{a:e,by:t=>n(...s.map((e=>t.get(e))))}}if(function(t){return"is"in t}(t)){const{a:e,is:n}=t;return{a:e,by:a(n)}}if(function(t){return"via"in t}(t)){const{a:e,via:n}=t;return{a:e,by:t=>t.get(n)}}if(function(t){return"as"in t}(t)){if(function(t){return!("a"in t)}(t)&&(t=function(t){return{...t,a:t.as}}(t)),!Ot(t)){const{as:e}=t;return{a:t.a,by:t=>new e(t)}}const{as:e,with:n}=t;return{a:t.a,by:t=>new e(...n.map((e=>t.get(e))))}}throw new TypeError(`Malformed context value specifier: ${JSON.stringify(t)}`)}(t),[s]=this._seeders.issuer(e);return s.provide(n)}seed(t,e){const[,n]=this._seeders.issuer(e);return n(t)}seeds(){return(t,e)=>this.seed(e,t)}seedIn(t){return this.newValues().get.bind(t)}newValues(){return function(t,e){const n=new Map;return new class extends At{get({[xt]:s},r){const o=n.get(s);if(null!=o)return o;const[i,u]=new Dt(e,this,s,r)._grow();return u&&(n.set(s,i),u({key:s,context:this,registry:t})),i}}}(this,this._seeders)}append(t){const e="function"==typeof t?t:t.seeds();return new Et(((t,n)=>{const s=e(t,n),[r,o]=this._seeders.issuer(t),i=o(n);return s?r.combine(i,s,n):i}))}}class Rt{constructor(){this._providers=[]}provide(t){const e=[t];return this._providers.unshift(e),new _((()=>this._providers.splice(this._providers.lastIndexOf(e),1)))}seed(t,e){const{length:n}=this._providers;if(!n)return e||c;const s=([e])=>l(e.bind(void 0,t));if(!e&&1===n)return s(this._providers[0]);const r=this._providers.map(s);return e&&r.push(e),Tt(r)}isEmpty(t){return null==t()}combine(t,e){return t===c?e:e===c?t:Tt([e,t])}}function Tt(t){return l((()=>{for(const e of t){const t=e();if(null!=t)return t}}))}class Pt extends kt{seeder(){return new Rt}}class zt extends $t{constructor(t,{seedKey:e}={}){super(t),this.seedKey=e||new Pt(this)}}class Ft extends zt{constructor(){super("context-supply")}grow(t){t.insert(t.seed()||t.context.supply||(t.hasFallback?t.or:v()))}}const Mt=new Ft;class Ut{constructor(){this._providers=new Map}provide(t){const e=new _;return this._providers.set(e,t),e.whenOff((()=>this._providers.delete(e)))}seed(t,e=st()){return ot(e,function(t,e){return _t(H(rt((()=>e.values())),(e=>l(e.bind(void 0,t)))),(t=>t()))}(t,this._providers))}isEmpty(t){return function(t){if(D(t))return J(t);const e=E(t);return D(e)?J(e):!!e.next().done}(t)}combine(t,e){return ot(t,e)}}class Nt extends kt{seeder(){return new Ut}}class Kt extends $t{constructor(t,{seedKey:e}={}){super(t),this.seedKey=e||new Nt(this)}}class Lt extends Kt{constructor(t,{seedKey:e,byDefault:n=h()}={}){super(t,e),this.byDefault=n}grow(t){const e=H(t.seed);if(e.length)t.insert(e);else if(!t.hasFallback){const e=this.byDefault(t.context,this);e&&t.insert(Array.from(e))}}}class jt extends zt{constructor(t,{seedKey:e,byDefault:n=c}={}){super(t,{seedKey:e}),this.byDefault=n}grow(t){const e=t.seed();null!=e?t.insert(e):t.hasFallback||t.insert(this.byDefault(t.context,this))}}class qt{name(t,e){if("string"==typeof t)return t;const[n,s]=t;return s.name(e(s),n,this)}}class Bt extends qt{applyAlias(t,e){return`${e}-${t}`}}const Wt=new Bt,It=new Bt;class Vt extends qt{applyAlias(t,e){return`${e}:${t}`}}const Ht=new Vt;class Gt extends qt{applyAlias(t,e){return`${t}@${e}`}}const Jt=new Gt;class Zt{constructor(t,...e){this.url=t,this.aliases=e}get alias(){return this.aliases[0]||"ns"}name(t,e,n=Wt){return n.applyAlias(e,t,this)}}function Qt(t){return"string"==typeof t||function(t){return Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&t[1]instanceof Zt}(t)}function Xt(t,e){if("string"==typeof t)return"string"==typeof e?Yt(t,e):e[1].url?-1:Yt(t,e[0]);const[n,{url:s}]=t;return"string"==typeof e?s?1:Yt(n,e):Yt(s,e[1].url)||Yt(n,e[0])}function Yt(t,e){return t<e?-1:t>e?1:0}function te(){const t=new Map,e=new Map;return function(n){const s=t.get(n.url);if(s)return s;const r=n.alias;let o=0;for(const s of[r,...n.aliases]){const r=e.get(s);if(!r)return t.set(n.url,s),e.set(s,1),s;o||(o=r)}const i=`${r}${++o}`;return t.set(n.url,i),e.set(r,o),i}}const ee=Symbol("after-event");function ne(t){return ee in t}function se(t){let e;return e="function"==typeof t?{supply:new _,receive(e,...n){t(...n)}}:{supply:t.supply||new _,receive(e,...n){this.supply.isOff||t.receive(e,...n)}},e.supply.whenOff((()=>e.receive=c)),e}function re(t){let e=function n(s){let r=t;const o=[];e=t=>o.push(t);try{for(;;){r=oe(r,s);const t=o.shift();if(!t)break;s=t}}finally{e=n}};return(...t)=>e(t)}function oe(t,e){const n=[];for(const s of t){const t=n.length;n.push(s);const r={onRecurrent(e){n[t]=se({supply:s.supply,receive(t,...n){e(...n)}})}};s.receive(r,...e)}return n}class ie{constructor(){const t=this._rcs=new Set;this.send=re(t),this.supply=new _((()=>{t.clear(),delete this._rcs}))}get size(){return this._rcs?this._rcs.size:0}on(t){const e=se(t),n=e.supply.needs(this),s=this._rcs;return s&&!n.isOff&&(s.add(e),n.whenOff((()=>s.delete(e)))),n}}const ue=Symbol("on-event");function ce(t){return ue in t}function ae(t){const e=se(t);let n=re([e]);return e.supply.whenOff((()=>n=c)),(...t)=>n(...t)}function he(){throw new Error("No events to send")}function le(t,e){return n=>{let s=S();t({supply:n.supply,receive:(t,...r)=>{const o=s,i=e(...r);try{s=i?i({supply:(new _).needs(n.supply),receive(t,...e){n.receive(t,...e)}}):S()}finally{o.off()}}})}}function de(...t){return t.reduce(((t,e)=>e(t)),this)}function fe(){return this}function pe(t){return e=>{t({supply:e.supply,receive:(t,...n)=>{e.receive(t,...n),e.supply.off()}})}}function ye(t,e){return new Promise(((n,s)=>{pe(this)({supply:new _(e?t=>{try{n(e(t))}catch(t){s(t)}}:s),receive:t?(e,...r)=>{try{n(t(...r))}catch(t){s(t)}}:(t,e)=>n(e)})}))}function ge(t){const e=new ie;let n,s;return r=>{if(e.size||(s=[],n=new _((()=>s=void 0)),t({supply:n,receive(t,...n){s&&(e.size?s=void 0:s.push(n)),e.send(...n)}})),r.supply.needs(n),e.on(r).whenOff((t=>{e.size||n.off(t)})),s){const t=ae(r);s.forEach((e=>t(...e)))}}}function me(t,e,n){return s=>{n?t({supply:(new _).needs(e).cuts(n),receive:s.receive.bind(s)}):(s.supply.needs(e),t(s))}}function _e(t,e){return n=>{const s=ae(n);t({supply:n.supply,receive:(t,...n)=>{e(s,...n)}})}}function we({supply:t}){t.off()}function be(t,e=he){let n,s=0;const r=r=>{let o=c;const i=se(r);if(i.supply.isOff)return i.supply;const u=(new _).needs(i.supply);let a=!1;return t({supply:u,receive:(t,...e)=>{a=!0,n=e,o(t,...e)}}),++s,u.isOff&&!a||(i.receive({onRecurrent(t){o=(e,...n)=>t(...n)}},...n||(n=e())),o=(t,...e)=>i.receive(t,...e)),u.whenOff((t=>{--s||(n=void 0),i.supply.off(t)})),u};return r[ue]=fe,r.do=de,r.then=ye,r[ee]=fe,r}function ve(t){const e=Object.keys(t);return be(ge(be((n=>{const{supply:s}=n,r=ae(n);let o=c;const i={};e.forEach((e=>{s.needs(t[e][ee]()(((...t)=>{i[e]=t,o()})).needs(s))})),s.isOff||(o=()=>r(i))}),(()=>{const n={};return e.forEach((e=>pe(t[e][ee]())({supply:new _,receive:(t,...s)=>n[e]=s}))),[n]}))))}function xe(...t){return be(ge(be((e=>{const{supply:n}=e,s=ae(e);let r=c;const o=[];t.forEach(((t,e)=>{n.needs(t[ee]()(((...t)=>{o[e]=t,r()})).needs(n))})),n.isOff||(r=()=>s(...o))}),(()=>{const e=[];return t.forEach((t=>pe(t[ee]())({supply:new _,receive:(t,...n)=>e.push(n)}))),e}))))}function $e(t,e){return be((e=>t[ue]()(e)),e)}function ke(t,e){return ne(t)?t[ee]():$e(t,e)}function Se(...t){return be(c,a(t))}function Ce(t){const e=e=>{const n=se(e),{supply:s}=n;return s.isOff||t(n),s};return e[ue]=fe,e.do=de,e.then=ye,e}function Oe(t){return e=>{let n=S();const s=new _((t=>n.off(t)));return e({supply:s,receive(e,...s){const r=n;try{n=(t(...s)||S()).supply}finally{n!==r&&r.off()}}}),s}}function Ae(t){return be(ge(t))}function De(t){const e=Ee(t);return t=>Ae(e(t))}function Ee(t){const e=(...e)=>{const n=t(...e);return n&&ke(n)};return t=>be(le(t,e))}class Re extends ie{constructor(){super(...arguments),this.on=Ce((t=>super.on(t)))}[ue](){return this.on}}const Te=Ce(we);function Pe(t){return ce(t)?t[ue]():t[ee]()}function ze(...t){return t.length?Ce(ge(Ce((e=>{const{supply:n}=e;let s=t.length;const r=t=>{--s||n.off(t)},o=(t,...n)=>{e.receive(t,...n)};t.forEach((t=>Pe(t)({supply:new _(r).needs(n),receive:o})))})))):Te}function Fe(t){let e=n=>{t.then((()=>e(n)),(()=>e(n)))};return t.then((t=>{e=function(t){return e=>{try{ae(e)(t),e.supply.off()}catch(t){e.supply.off(t)}}}(t)})).catch((t=>{var n;n=t,e=({supply:t})=>t.off(n)})),Ce((t=>e(t)))}function Me(t){return Ce(ge(t))}function Ue(t){const e=(...e)=>{const n=t(...e);return n&&Pe(n)};return t=>Ce(le(t,e))}function Ne(t){const e=Ke(t);return t=>Me(e(t))}function Ke(t){return e=>Ce(_e(e,t))}function Le(t,e){const n=je(t,e);return t=>Ae(n(t))}function je(t,e){return n=>be(_e(n,((e,...n)=>e(t(...n)))),e&&(()=>[e()]))}function qe(t){const e=Be(t);return t=>Me(e(t))}function Be(t){return e=>Ce(_e(e,((e,...n)=>e(t(...n)))))}function We(t){return be(pe(t))}function Ie(t){return Ce(pe(t))}function Ve(t,e){return x(t.supply)?i:n=>Ce(me(n,t,e))}function He(t){return Ce((e=>{const{supply:n}=e,s=ae(e),r=new _;let o=0;const i=t.do(Ve(n,r),qe((t=>(++o,t))));let u=[],c=1,a=0;r.whenOff((t=>{o||n.off(t)})),function(t){return Ce((e=>{const{supply:n}=e,s=ae(e);let r=0;t({supply:n,receive(t,e){const o=++r;Promise.resolve().then((()=>e)).then((t=>s(t,o)),(t=>n.off(t)))}})}))}(i)({supply:n,receive(t,n,i){const h=i-c;if(u[h]=n,++a,a>h){let t;a===u.length?(t=u,u=[]):t=u.splice(0,h+1),c+=t.length,a-=t.length,o-=t.length,s(...t),!o&&r.isOff&&e.supply.needs(r)}}})}))}function Ge(t,e){return x(t.supply)?i:n=>be(me(n,t,e))}function Je(t,e){const n=Ze(t,e);return t=>Ae(n(t))}function Ze(t,e){return n=>be(_e(n,t),e)}function Qe(t){const e=Xe(t);return t=>Me(e(t))}function Xe(t){return Ke(((e,...n)=>{const s=t(...n);null!=s&&!1!==s&&e(s)}))}function Ye(t){return Array.isArray(t)?t:[t]}class tn{constructor(t){this._drop=t,this.emitter=new Re,this._nested=new Map,this.emitter.on(((t,e,n)=>{const s=t[0],r=this._nested.get(s);r&&r.emitter.send(t.slice(1),e,n)}))}on(t){const e=this.emitter.on(t);return new _((t=>{e.off(t),this._dropIfEmpty()})).needs(e)}nest(t,e){const n=this._nested.get(t);if(n||e)return n;const s=new tn((()=>this._remove(t)));return this._nested.set(t,s),s}done(t){for(const e of this._nested.values())e.done(t);this.emitter.supply.off(t)}_remove(t){this._nested.delete(t),this._dropIfEmpty()}_dropIfEmpty(){!this._nested.size&&this.emitter.size<=1&&this._drop()}}class en{constructor(){this._root=new tn(c)}on(t,e){return this._entry(t).on(e)}send(t,e,n){this._root.emitter.send(t,e,n)}done(t,e){const n=this._entry(t,!0);n&&n.done(e)}_entry(t,e){let n=this._root;for(const s of t){const t=n.nest(s,e);if(!t)return;n=t}return n}}class nn{constructor(t,e){this._trackers=t,this._path=e,this.onUpdate=Ce((t=>this._trackers.on(this._path,t))),this.update=(t,e,n)=>{this._trackers.send([...this._path,...Ye(t)],e,n)}}get _tracker(){return this}[ue](){return this.onUpdate}track(t){return(t=Ye(t)).length?new nn(this._trackers,[...this._path,...t]):this}done(t){this._trackers.done(this._path,t)}}class sn{constructor(){this._tracker=new nn(new en,[])}get onUpdate(){return this._tracker.onUpdate}[ue](){return this.onUpdate}get update(){return this._tracker.update}track(t){const e=this._tracker.track(t);return e===this._tracker?this:e}done(t){this._tracker.done(t)}}class rn{constructor(){this._by=S(),this.read=be((t=>{return this.on({supply:(e=t).supply,receive(t,n){e.receive({onRecurrent(e){t.onRecurrent((t=>e(t)))}},n)}});var e}),(()=>[this.it]))}[ue](){return this.on}[ee](){return this.read}by(t,e){const n=t=>(ne(t)?t[ee]():t[ue]())((t=>this.it=t));if(this.byNone(),e){const s=t;this._by=Pe(s).do(Oe(((...t)=>{const s=e(...t);if(s)return n(s)})))}else{const e=t;this._by=n(e)}return this._by.whenOff((()=>this._by=S())),this}byNone(t){return this._by.off(t),this}}class on extends rn{constructor(t){super(),this._it=t,this._on=new Re}get supply(){return this._on.supply}get on(){return this._on.on}get it(){return this._it}set it(t){const e=this._it;e!==t&&(this._it=t,this._on.send(t,e))}}function un(t){return new on(t)}class cn extends rn{constructor(t){super(),this._on=new Re,this._it=t}get on(){return this._on.on}get supply(){return this._on.supply}get it(){return this._it}set it(t){const e=this.it;e!==t&&(this._it=t,this._on.send(t,e))}sync(t,e,n){let s,r,o=t=>c(this,t);"string"==typeof t?("in"===t&&(o=t=>c(t,this)),s=e,r=n):(s=t,r=e);const i=r;if(!i)return o(s);const u=s;return(ne(u)?ke(u):Pe(u)).do(Oe(((...t)=>{const e=i(...t);return e&&o(e)})));function c(t,e){const n=t.read((t=>{e.it=t})),s=e.on((e=>{t.it=e}));return new _((t=>{s.off(t),n.off(t)})).needs(n).needs(s)}}}class an extends TypeError{constructor(t,e,n,s=t.workName(e)+(void 0!==n?` already terminated (${n})`:" already done")){super(s),this.workload=t,this.work=e,this.reason=n}}class hn{constructor(t,e){this.name=t,this.allocator=e}workName(t){return`The work of ${this.name}`}toString(){return`Workload(${this.name})`}}class ln{constructor(t){this._allotment=t,this._queues=new Map}runAfter(t,e){let n=this._queues.get(t);return n||(n=new dn(this._allotment),this._queues.set(t,n)),n.enqueue(e)}}class dn{constructor(t){this._allotment=t,this._tasks=[]}enqueue(t){return new Promise((e=>{const n={task:t,run:()=>{e(this._allotment.run(t).finally((()=>{this._tasks.shift(),this._runNext()})))}};this._tasks.push(n),1===this._tasks.length&&this._runNext()}))}_runNext(){const[t]=this._tasks;t&&t.run()}}class fn extends hn{constructor(){super("ordering",{start:t=>new ln(t)})}}fn.$=new fn;class pn extends hn{constructor(t,e={}){super(t,{start(t){const{workbench:n,workload:s,supply:r}=t,o=new yn(t,e);return{workbench:n,stage:s,supply:r,async run(t){return await o.run(this,t)}}}})}workName(t){return`The ${this.name} stage`}toString(){return`WorkStage(${this.name})`}}class yn{constructor(t,e){this.allotment=t,this.allocator=e,this._whenTaskDone=Promise.resolve();const{supply:n}=t;this._whenAllDone=new Promise((t=>this._end=t)).then((()=>n.off())).catch((t=>n.off(t))),n.whenOff((e=>{void 0===e?this._end():this._end(Promise.reject(e)),this.run=(n,s)=>Promise.reject(new an(t.workload,n,e))}))}run(t,e){const n=this._start(t).then((()=>this.allotment.run(e)));return this._addTask(n),n}_addTask(t){const e=this._whenTaskDone=Promise.all([this._whenTaskDone,t.catch(c)]);e.finally((()=>{e===this._whenTaskDone&&this._end(e)}))}_start(t){let e=this._awaitDeps();return this.allocator.start&&(e=e.then((async()=>{await this.allocator.start(t)}))),this._start=a(e),this._addTask(e),e}_awaitDeps(){const t=[],e=e=>{t.push(new Promise((t=>{this.allotment.workbench.work(fn.$).runAfter(e,(()=>(t(),this._whenAllDone))).catch(c)})))},{after:n}=this.allocator;return n&&e(n),e(this.allotment.workload),Promise.all(t)}}const gn=Symbol("Workbench.impl");class mn{constructor(t,e){this.workbench=t,this._works=new Map;const{supply:n=v(),run:s}=e;this.supply=new _((t=>{this.work=e=>{throw new an(e,void 0,t,"The workbench is stopped")}})).needs(n).cuts(n),this._run=s?s.bind(e):_n}work(t){if(this._works.has(t))return this._works.get(t);let e=c;const n=async(n,s)=>{const r=await this._run(s,n,t);return e(),r},s=(new _).needs(this.supply);let r,o,i;const u=new Promise((e=>{r=s=>(o=s,this._works.set(t,s),i=async t=>await n(s,t),e(s),s)}));return i=async t=>await n(await u,t),s.whenOff((n=>{i=e=()=>{throw new an(t,o,n)},this._works.delete(t)})),r(t.allocator.start({workbench:this.workbench,workload:t,supply:s,run:async t=>await i(t)}))}}async function _n(t,e,n){return await t()}class wn{constructor(t={}){this[gn]=new mn(this,t)}get supply(){return this[gn].supply}work(t){return this[gn].work(t)}}function bn(t=new TypeError("Context destroyed")){return()=>{throw t}}class vn extends Error{constructor(t,e=[],n=function(t,e){const n=e.reduce(((t,[e,n])=>(t?t+=", ":t=": ",t+=void 0!==n?`${e} failed to load (${n})`:`${e} not loaded`)),"");return`Failed to load ${t}${n}`}(t,e)){super(n),this.module=t,this.reasons=e,this.message=n}}class xn{constructor(t,e){this.module=e,this._useCounter=0,this._impl=un(),this._rev=un({status:{module:this.module,provided:!1,used:!1,settled:!1,ready:!1},supply:S()});const n=t.get(Mt);n.cuts(this._impl),n.cuts(this._rev),this._impl.read((t=>{const e=this._rev.it.supply;t&&this._load(t),e.off()}))}createHandle(){const t=this._rev.read.do(je((({status:t})=>t))),e={read:t,[ee]:a(t),use:t=>this._use(e,t)};return e}setup(t,e){this._setup=()=>{const n=this._rev.it,{status:{module:s},supply:r}=n;s!==this.module?t.get(s).use(r).read({supply:r,receive:(t,{settled:e,ready:s,error:r})=>{this._updateStatus(n,e,s,r)}}):async function(t,e,{status:{module:n},supply:s}){const r=new $n(n);return await n.setup({module:n,supply:s,get:e=>t.get(e),provide:t=>e.provide(t).needs(s),initBy(t){r.initBy(t)}}),r}(t,e,n).then((({whenReady:t})=>(this._updateStatus(n,!0,!1),t))).then((()=>this._updateStatus(n,!0,!0))).catch((t=>n.supply.off(t)))}}implementBy(t){this._impl.by(t)}_updateStatus(t,e,n,s){this._rev.it.supply!==t.supply?t.supply.off():this._rev.it=t={status:{module:t.status.module,provided:t.status.provided,used:!0,settled:e,ready:n,error:s},supply:t.supply}}_load(t){const e=(new _).needs(this._rev).whenOff((t=>{this._rev.it.supply===e&&(this._rev.it={status:{...this._rev.it.status,provided:!1,settled:!1,ready:!1,error:t},supply:e})})),n=!!this._useCounter;this._rev.it={status:{module:t,provided:!0,used:n,settled:!1,ready:!1},supply:e},n&&this._setup()}_use(t,e){const n=new _;e&&n.needs(e);const s=t.read.do(Ge(n)),r={...t,read:s,whenSettled:kn(s,Sn),whenReady:kn(s,Cn),supply:n};if(!n.isOff&&(n.whenOff((t=>{if(!--this._useCounter){const e=this._rev.it;this._rev.it={status:{...e.status,used:!1,settled:!1,ready:!1,error:t},supply:(new _).off(t)},e.supply.off(t)}})),!this._useCounter++)){const t=this._rev.it;this._rev.it={status:{...t.status,used:!0},supply:t.supply},this._setup()}return r}}class $n{constructor(t){this._module=t,this._whenDone=Promise.resolve(),this.whenReady=new Promise((t=>this._ready=t))}initBy(t){const e=this._whenDone=this._whenDone.then(t).finally((()=>this._done(e)))}_done(t){this._whenDone===t&&(this._ready(t),this.initBy=t=>{throw new TypeError(`${this._module} initialized already, and does not accept new initializers`)})}}function kn(t,e){return Ce((n=>t({supply:n.supply,receive:(t,s)=>{e(s)?(n.receive(t,s),n.supply.off()):s.error&&n.supply.off(s.error)}})))}function Sn({settled:t}){return t}function Cn({ready:t}){return t}const On=Je(((t,...e)=>t(...H(ot(...e)))));class An{constructor(){this._providers=un([new Map])}provide(t){const[e]=this._providers.it,n=new _;return e.set(n,t),this._providers.it=[e],n.whenOff((()=>{const[t]=this._providers.it;t.delete(n),this._providers.it=[t]}))}seed(t,e=Se()){return this.combine(e,function(t,e){return e.read.do(Ee((([e])=>e.size?xe(...gt(gt(rt((()=>e.values())),(e=>e(t))),Dn)):Se())),On)}(t,this._providers))}isEmpty(){return!1}combine(t,e){return xe(t,e).do(On)}}function Dn(t){return null==t?Se():function(t){return("object"==typeof t||"function"==typeof t)&&ne(t)}(t)?ke(t):Se(t)}class En extends kt{get upKey(){return this}seeder(){return new An}}class Rn extends $t{constructor(t,e){super(t.name+":up"),this._key=t,this.grow=t=>{const n=t.fillBy(e);null!=n&&t.insert(n[ee]().do(Ge(t.context.get(Mt))))}}get seedKey(){return this._key.seedKey}get upKey(){return this}}class Tn extends $t{constructor(t,{seedKey:e}={}){super(t),this.seedKey=e||new En(this)}createUpKey(t){return new Rn(this,t)}}class Pn extends Tn{constructor(t,e){super(t),this._module=e}get upKey(){return this}grow(t){const e=new xn(t.context,this._module);var n;t.insert(e.createHandle()),t.setup((({context:t,registry:n})=>e.setup(t,n))),e.implementBy((n=this._module,t.seed.do(je(((...t)=>{let e;for(let s=t.length-1;s>=0&&(e=t[s],e===n);--s);return e})))))}}const zn=Symbol("ContextModule.impl");class Fn{constructor(t,e,n){this.name=e,this.options=n,this.key=new Pn(`${e}:module`,t);const{needs:r,has:o,setup:i}=n;this.has=s(o).add(t),this.needs=s(r),this._setup=i?i.bind(n):c}replace(t,e,n){for(const s of t.has)s!==t&&e.provide({a:s,is:t}).needs(n)}async setup(t){const e=function(t){const{module:e,supply:n}=t;return H(_t(e.needs,(s=>s!==e&&t.provide(s).needs(n)&&{dep:s,use:t.get(s).use(t)})))}(t);await Mn(t,e,Un)&&(t.initBy((async()=>{await Mn(t,e,Nn)})),await this._setup(t))}}function Mn(t,e,n){const{module:s,supply:r}=t,o=a(!1),i=r.whenDone().then(o,o);return Promise.race([i,Promise.all(e.map((({dep:t,use:e})=>n(e).then(c,(e=>[t,e]))))).then((t=>{const e=t.filter(O);return!e.length||new vn(s,e)}))]).then((t=>"boolean"!=typeof t?Promise.reject(t):t))}function Un(t){return t.whenSettled}function Nn(t){return t.whenReady}class Kn{constructor(t,e={}){this[zn]=new Fn(this,t,e)}get[xt](){return this[zn].key}get name(){return this[zn].name}get needs(){return this[zn].needs}get has(){return this[zn].has}[vt](t){const e=t.provide({a:this,is:this});return this[zn].replace(this,t,e),e}setup(t){return this[zn].setup(t)}toString(){return`ContextModule(${this.name})`}}class Ln extends Tn{constructor(t,{seedKey:e,byDefault:n=c}={}){super(t,e),this.byDefault=(t,e)=>n(t,e)||(()=>{throw new St(this)}),this.upKey=this.createUpKey((t=>{t.insert(t.seed.do(De(((...e)=>e.length?Se(e[e.length-1]):t.hasFallback&&t.or?t.or:Se(this.byDefault(t.context,this))))))}))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Se(t.or):t.or}:void 0)((t=>e=t)).whenOff((t=>e=bn(t))),t.insert(((...t)=>e(...t)))}}class jn extends Tn{constructor(t,{seedKey:e,byDefault:n=c}={}){super(t,e),this.byDefault=n}get upKey(){return this}grow(t){const e=t.seed.do(De(((...e)=>{if(e.length)return Se(e[e.length-1]);let n;if(t.hasFallback)n=t.or;else{const e=this.byDefault(t.context,this);n=e&&Se(e)}return null!=n?n:be((()=>{throw new St(this)}))})));t.insert(e.do(Ge(t.context.get(Mt))))}}const qn=Ce(c);const Bn={onRecurrent:c};class Wn{constructor(t){this.supply=new _,this._target=t}on(t){return function(t){const e=(e,n)=>{const s=se(e),{supply:r}=s;return r.isOff||t(s,n),r};return e[ue]=qn[ue],e.do=qn.do,e.then=qn.then,e}(((e,n)=>{const{supply:s}=e;if(s.needs(this),!s.isOff){const s=t=>e.receive(Bn,t);this._target.addEventListener(t,s,n),e.supply.whenOff((()=>this._target.removeEventListener(t,s)))}}))}dispatch(t){return!this.supply.isOff&&this._target.dispatchEvent(t)}}const In={by(t={}){let e;return{get node(){return t.node},get window(){return e||(e=t.window||t.node&&((n=t.node).ownerDocument||n).defaultView||window);var n},error(...e){t&&t.error?t.error(...e):console.error(...e)}}}};const Vn=Symbol("render-q");class Hn{constructor(t,e){this.q=t,this.schedule=this.doSchedule,this.ref=e||[this,this]}static by(t,e){return t[Vn]||(t[Vn]=new Hn(t,e))}add(t){this.q.add(t)}doSchedule(t){this.schedule=()=>{};const e=[],n={get config(){return t},postpone(t){e.unshift(t)}};this.q.schedule((()=>{const t=this.reset();t.suspend(),this.exec(n),this.ref[1]=this.ref[0],e.forEach((t=>this.q.add(t))),n.postpone=t=>this.q.post(t),this.exec(n),t.resume()}))}exec(t){for(;;){const e=this.q.pull();if(!e)break;e(t)}}reset(){return this.ref[0]=Hn.by(this.q.reset(),this.ref)}suspend(){this.schedule=t=>{this.scheduled=t,this.schedule=()=>{}}}resume(){this.scheduled?this.doSchedule(this.scheduled):this.schedule=this.doSchedule}}function Gn(t){return e=>{const n=In.by(e),s=Hn.by(t.newQueue(n)).ref;let r=[];return t=>{const[e,,o]=r,[i,u]=s;let c=e||u;if(e===u&&!o||e===i)r[1]=t;else{const e=r=[c=o?i:u,t];c.add((t=>{e[2]=!0;try{e[1]({get config(){return n},postpone(e){t.postpone(e)}})}catch(t){n.error(t)}}))}c.schedule(n)}}}const Jn={by({schedule:t,replace:e=(()=>{})}){const n=[];return{schedule:t,add(t){n.push(t)},post(t){n.unshift(t)},pull:()=>n.shift(),reset(){const n=Jn.by({schedule:t,replace:e});return e(n),n}}}},Zn=new WeakMap,Qn=t=>{const e=In.by(t);return t=>{const n=[],s={get config(){return e},postpone(t){n.push(t)}};for(r(t);;){const t=n.pop();if(!t)break;r(t)}function r(t){try{t(s)}catch(t){e.error(t)}}}};let Xn=Gn({newQueue({window:t}){const e=Zn.get(t);if(e)return e;const n=Jn.by({schedule:e=>t.requestAnimationFrame(e),replace:e=>Zn.set(t,e)});return Zn.set(t,n),n}});function Yn(t){return Xn(t)}const ts=new jt("bootstrap-context");class es extends At{static get[xt](){return ts}}function ns(t){return(e,n)=>{const s=e.get(es);return e===s?t(s,n):s.get(n)}}function ss(t,e,n,s){const r=!n,o=s(n?function(t){if(function(t){return void 0===t.value&&void 0===t.writable}(t))return t;const e=Symbol("value"),n=t.value,s={...t,writable:void 0,value:void 0,get(){return e in this?this[e]:n}};return t.writable&&(s.set=function(t){this[e]=t}),delete s.writable,delete s.value,s}(n):function(t,e){const n=Symbol(`${String(e)}:value`),s=t[e];return{configurable:!0,enumerable:!0,get(){return n in this?this[n]:s},set(t){this[n]=t}}}(t,e));if(!r||!o)return o;Object.defineProperty(t,e,o)}function rs(t){return t.nodeType===Node.ELEMENT_NODE}class os{constructor(t){this.symbol=t}own(t){return t.hasOwnProperty(this.symbol)?t[this.symbol]:void 0}of(t){const e=this.own(t),n=o(t),s=n&&this.of(n);return e?s?this.merge([s,e]):e:s}define(t,e){const n=this.own(t),s=e.map((e=>this.meta(e,t))),r=this.merge(n?[n,...s]:s);return Object.defineProperty(t,this.symbol,{configurable:!0,value:r}),t}}function is(t,e,n,s){const r=e&&e.bind(t),o=s&&s.bind(n);return o?r?async(...t)=>{await r(...t),await o(...t)}:o:r}const us=Symbol("feature-def");class cs extends os{constructor(){super(us)}merge(t){return t.reduce(((t,e)=>({needs:n(r(s(t.needs),e.needs)),has:n(r(s(t.has),e.has)),setup:is(t,t.setup,e,e.setup),init:is(t,t.init,e,e.init)})),{})}meta(t,e){const n=t[us];return null==n?t:this.meta("function"==typeof n?t[us](e):n,e)}}const as=new cs,hs={[us]:()=>({})},ls={of:t=>as.of(t)||{},for:(t,e)=>as.meta(e,t),merge:(...t)=>as.merge(t),all:(...t)=>t.reduce(((t,e)=>({[us]:n=>ls.merge(ls.for(n,t),ls.for(n,e))})),hs),define:(t,...e)=>as.define(t,e)};function ds(...t){return e=>ls.define(e,...t)}const fs=new jt("feature-context");class ps extends es{static get[xt](){return fs}whenDefined(t){return this.get(es).whenDefined(t)}load(t,e){return this.get(es).load(t,e?(new _).needs(this).needs(e):this)}}const ys=new jt("bootstrap-workbench",{byDefault:ns((()=>new wn))}),gs=new pn("feature setup"),ms=new pn("feature init",{after:gs}),_s=new pn("component definition",{after:ms}),ws=Symbol("component-def");class bs extends os{constructor(){super(ws)}merge(t){return t.reduce(((t,e)=>({...t,...e,setup:u(t.setup,e.setup),define:u(t.define,e.define),feature:t.feature?e.feature?ls.merge(t.feature,e.feature):t.feature:e.feature})),{})}meta(t,e){const n=t[ws];return null!=n?this.meta("function"==typeof n?t[ws](e):n,e):null!=t[us]?{feature:ls.for(e,t)}:Qt(t)?{name:t}:t}}const vs=new bs,xs={[ws]:()=>({})},$s={of:t=>vs.of(t)||{},for:(t,e)=>vs.meta(e,t),merge:(...t)=>vs.merge(t),all:(...t)=>t.reduce(((t,e)=>({[ws]:n=>$s.merge($s.for(n,t),$s.for(n,e))})),xs),define:(t,...e)=>vs.define(t,e)};function ks(...t){const e=e=>$s.define(e,...t);return e[ws]=()=>$s.all(...t),e}const Ss=new jt("component-context"),Cs=new jt("component-event-dispatcher",{byDefault(t){const e=t.get(Ss),n=new Wn(e.element);return n.supply.needs(e),{dispatch:t=>n.dispatch(t),on:t=>n.on(t)}}}),Os=new jt("content-root",{byDefault:t=>t.get(Ss).element});class As extends Tn{constructor(){super("state-updater"),this.upKey=this.createUpKey((t=>t.insert(t.seed.do(De(((...e)=>{if(e.length){const t=e.reduce(((t,e)=>u(e,t)),c);return Se(((e,n,s)=>t(Ye(e),n,s)))}return t.hasFallback&&t.or?t.or:Se(c)}))))))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Se(t.or):t.or}:void 0)((t=>e=t)).whenOff((()=>e=c)),t.insert(((t,n,s)=>e(t,n,s)))}}const Ds=new As,Es=Symbol("component-context");class Rs extends At{constructor(){super(),this.updateState=(t,e,n)=>{this.get(Ds)(t,e,n)}}static get[xt](){return Ss}static of(t){if("function"!=typeof t[Es])throw new TypeError(`No component context found in ${String(t)}`);return t[Es]()}get contentRoot(){return this.get(Os)}on(t){return this.get(Cs).on(t)}dispatchEvent(t){this.get(Cs).dispatch(t)}}const Ts=Symbol("component-slot"),Ps={of(t){const e=t[Ts];return e||(t[Ts]=new zs)}};class zs{constructor(){this._ctx=un(),this.whenReady=this._ctx.read.do(Ue((t=>t&&t.whenReady)),Ie)}get context(){return this._ctx.it}get read(){return this._ctx.read}[ee](){return this._ctx.read}bind(t){this._ctx.it=t}unbind(){this._ctx.it=void 0}}class Fs extends Event{get context(){return Ps.of(this.target).context}}const Ms=Symbol("anonymous-component-property");function Us(t){const e=({get:e,set:n},s=Ms,r)=>ks({[ws](o){const i=t({type:o,key:s,readable:!0,writable:r,enumerable:!1,configurable:!1,get:t=>e(t,s),set:(t,e)=>n(t,e,s)});return i&&i.componentDef||{}}}),n=(t,n)=>e({get:(e,n)=>t(e,n)},n,!1),s=(e,n,s)=>ss(e,n,s,(s=>{const{get:r,set:o}=s,i=e.constructor,{get:u,set:c,configurable:a,enumerable:h,componentDef:l={}}=t({type:i,key:n,readable:!!s.get,writable:!!s.set,enumerable:!!s.enumerable,configurable:!!s.configurable,get:r?t=>r.call(t):Ns(n),set:o?(t,e)=>o.call(t,e):Ks(n)})||{};$s.define(i,l);const d={...s,configurable:null!=a?a:s.configurable,enumerable:null!=h?h:s.enumerable};return(u||c)&&(d.get=u&&function(){return u(this,n)},d.set=c&&function(t){c(this,t,n)}),d}));return s.With=(t,n)=>e(t,n,!0),s.By=n,s.As=(t,e)=>n(a(t),e),s.Bind=(t,n=Ms)=>{const s=Symbol(`${String(n)}:accessor`),r=e=>{const r=e[s];if(r)return r;const o=t(e,n);return e[s]={get:o.get?o.get.bind(o):Ns(n),set:o.set?o.set.bind(o):Ks(n)}};return e({get:t=>r(t).get(),set:(t,e)=>r(t).set(e)},n,!0)},s}function Ns(t){return()=>{throw new TypeError(`"${String(t)}" is not readable`)}}function Ks(t){return()=>{throw new TypeError(`"${String(t)}" is not writable`)}}const Ls=new jt("bootstrap-context-registry");class js extends Et{constructor(){super(),this.provide({a:js,is:this}),this.values=this.newValues()}static get[xt](){return Ls}static create(){return new js}}const qs=new jt("per-component-registry",{byDefault:ns((()=>new Bs))});class Bs extends Et{}const Ws=new jt("per-definition-registry",{byDefault:ns((t=>new Is(t)))});class Is extends Et{}const Vs=Symbol("post-def-setup");function Hs(t){if(t.hasOwnProperty(Vs))return t[Vs];const e=un(),n=new Re,s=ze(e.read.do(Qe(i)),n),r=o(t,(t=>ws in t));if(r){const t=Hs(r);s((e=>t.send(e)))}const u={on:s,send(t){n.send(t)},setup(t){e.it=t}};return Object.defineProperty(t,Vs,{value:u}),u}const Gs=new jt("window",{byDefault:()=>window}),Js=new jt("bootstrap-root",{byDefault:t=>t.get(Gs).document.body}),Zs=new jt("default-namespace-aliaser");class Qs extends Tn{constructor(){super("default-render-scheduler"),this.upKey=this.createUpKey((t=>t.insert(t.seed.do(De(((...e)=>e.length?Se(Xs(t.context,e[e.length-1])):t.hasFallback&&t.or?t.or:Se(Xs(t.context,Yn))))))))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Se(t.or):t.or}:void 0)((n=>e=Xs(t.context,n))).whenOff((t=>e=bn(t))),t.insert(((...t)=>e(...t)))}}function Xs(t,e){return(n={})=>e({...n,window:n.window||t.get(Gs)})}const Ys=new Qs;class tr extends Tn{constructor(){super("element-adapter"),this.upKey=this.createUpKey((t=>t.insert(t.seed.do(De(((...e)=>{if(0===e.length)return t.hasFallback&&t.or?t.or:Se(er);const n=t.context.get(Zs),s=new Map;for(const t of e){const e=It.name(t.to,n).toLowerCase(),r=s.get(e)||er;s.set(e,(e=>{const n=r(e);return n||(t.bind(e),er(e))}))}return Se((t=>(s.get(t.tagName.toLowerCase())||er)(t)))}))))))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Se(t.or):t.or}:void 0)((t=>e=t)).whenOff((t=>e=bn(t))),t.insert((t=>e(t)))}}function er(t){const e=t[Ts];return e&&e.context}const nr=new tr,sr=new Ln("element-observer",{byDefault:ns((t=>{const e=t.get(nr);class n extends MutationObserver{constructor(t){super((n=>{n.forEach((t=>{I(B(t.removedNodes),(t=>{var e;return null===(e=function(t){var e,n;return null===(n=null===(e=t[Ts])||void 0===e?void 0:e.context)||void 0===n?void 0:n.mount}(t))||void 0===e?void 0:e.checkConnected()})),I(ct(t.addedNodes,rs),(t=>{var n,s;return null===(s=null===(n=e(t))||void 0===n?void 0:n.mount)||void 0===s?void 0:s.checkConnected()}))})),t(n,this)}))}observe(t,e){super.observe(t,{...e,childList:!0})}}return t=>new n(t)}))});const rr=Symbol("definition-context");function or(t){if(!t.hasOwnProperty(rr))throw new TypeError(`Component is not defined: ${t}`);return t[rr]}const ir=new jt("custom-elements",{byDefault:ns((function(t){const e=t.get(Gs).customElements,n=t.get(Zs);return new class extends ur{define(t,s){if(Qt(t))return void e.define(It.name(t,n),s);const r=or(t),{name:o,extend:i}=r.elementDef;o?i&&i.name?e.define(It.name(o,n),s,{extends:i.name}):e.define(It.name(o,n),s):ar(t).resolve(void 0)}whenDefined(t){if(Qt(t))return e.whenDefined(It.name(t,n));const s=or(t),{name:r}=s.elementDef;return r?e.whenDefined(It.name(r,n)):ar(t).promise()}}}))});class ur{static get[xt](){return ir}}const cr=Symbol("component-resolver");function ar(t){return t.hasOwnProperty(cr)?t[cr]:t[cr]=function(){let t,e,n=l((()=>new Promise(((n,s)=>{t=n,e=s}))));const s=s=>{n=l(s),t=c,e=c};return t=t=>{s((()=>Promise.resolve(t)))},e=t=>{s((()=>Promise.reject(t)))},{resolve(e){t(e)},reject(t){e(t)},promise:()=>n()}}()}const hr=new jt("definition-context"),lr=new jt("element-def",{byDefault(t){const e=t.get(hr).componentType,{name:n,extend:s}=$s.of(e),r={get type(){return s&&s.type||t.get(Gs).HTMLElement},get name(){return s&&s.name}};return{get name(){return n},get extend(){return r}}}});class dr extends At{static get[xt](){return hr}get elementDef(){return this.get(lr)}connectTo(t){const e=this.mountTo(t);return e.connect(),e}}const fr=Symbol("newComponent");function pr(t){const e=t.componentType;return e[fr]||(e[fr]=function(t){const e=Symbol("component-context");let n;return t.prototype[Es]=function(){return this[e]||(this[e]=n)},function(t){const s=n;n=t;try{const r=new this(t);return r[e]=t,r}finally{n=s}}}(e)),e[fr](t)}class yr extends Rs{constructor(t,e){super(),this._definitionContext=t,this.element=e,this._status=un(0),this.whenReady=this._status.read.do(Xe((t=>!!t&&this)),Ie),this.whenSettled=this._status.read.do(Xe((t=>t>=3&&this)),Ie),this.whenConnected=this._status.read.do(Xe((t=>t>=4&&this)),Ie);const n=t._newComponentRegistry();n.provide({a:Rs,is:this}),this.get=n.newValues().get}get componentType(){return this._definitionContext.componentType}get component(){return this._component()}get settled(){return this._status.it>=3&&!this.supply.isOff}get connected(){return this._status.it>=4&&!this.supply.isOff}get supply(){return this._status.supply}_component(){throw new TypeError("Component is not constructed yet. Consider to use a `whenReady()` callback")}settle(){2===this._status.it&&(this._status.it=3)}destroy(t){try{this._status.supply.off(t)}finally{delete this.component[Es],this._component=gr,Ps.of(this.element).unbind(),function(t){const{parentNode:e}=t;e&&e.removeChild(t)}(this.element)}}_createComponent(){const t=this._definitionContext._whenComponent;let e=0;Ps.of(this.element).bind(this),t.readNotifier.do(Ie)((t=>e=t(this,e))),this.whenConnected((()=>{t.readNotifier({supply:(new _).needs(this),receive:(t,n)=>{e=n(this,e)}})})),this._definitionContext._elementBuilder.components.send(this);const n=pr(this);return this._component=a(n),this._status.it=1,this}_connect(){this._status.it=4}_created(){this._status.it<2&&(this._status.it=2),this.whenConnected((()=>this.dispatchEvent(new Fs("wesib:component",{bubbles:!0}))))}}function gr(){throw new TypeError("Component destroyed already")}class mr extends class{get component(){return this.context.component}get element(){return this.context.element}}{constructor(t){super(),this.context=t}get connected(){return this.context.connected}connect(){this.context._connect()}checkConnected(){const t=this.context.element,e=t.ownerDocument,n=null!=e&&e.contains(t);return n!==this.connected&&(n?this.connect():this.context.destroy()),n}}class _r extends yr{constructor(t,e){super(t,e),this.mount=this.mount=new mr(this)}}class wr extends yr{get mount(){}}class br{constructor(){const t=un(0),e=new Re;this.onCreated=Ce((n=>{const s=t.it+1;e.on({supply:n.supply,receive:(t,e,r)=>{r<s&&n.receive({onRecurrent(e){t.onRecurrent((t=>e(t)))}},e)}}),++t.it})),this.readNotifier=t.read.do(je((t=>(n,s)=>(e.send(n,s),t))))}}class vr extends dr{constructor(t,e,n){var s,r;super(),this._bsContext=t,this._elementBuilder=e,this.componentType=n,this._whenComponent=new br,this._ready=un(!1),this._whenReady=this._ready.read.do(Ne(((t,e)=>e&&t()))),this._def=$s.of(n);const o=new Is(t.get(Ws).seeds());o.provide({a:dr,is:this}),this.get=o.newValues().get;const i=t.get(qs).append((t=>this.get(t)));this._perComponentRegistry=new Bs(i.seeds()),this.whenReady=this._whenReady.do(Be(a(this)),Ie);const u={get componentType(){return n},whenReady:this.whenReady,whenComponent:this.whenComponent,perDefinition:t=>o.provide(t),perComponent:t=>this._perComponentRegistry.provide(t)};null===(r=(s=this._def).setup)||void 0===r||r.call(s,u),Hs(n).setup(u)}get elementType(){return this._elementType()}get whenComponent(){return this._whenComponent.onCreated}mountTo(t){if(Ps.of(t).context)throw new Error(`Element ${String(t)} already bound to component`);const e=new _r(this,t);e._createComponent();const{mount:n}=e;return n.checkConnected(),e._created(),e.settle(),n}perComponent(t){return this._perComponentRegistry.provide(t)}_newComponentRegistry(){return new Bs(this._perComponentRegistry.seeds())}_elementType(){throw new Error("Custom element class is not constructed yet. Consider to use a `whenReady()` callback")}_define(){var t,e;null===(e=(t=this._def).define)||void 0===e||e.call(t,this),this._elementBuilder.definitions.send(this),this._elementType=a(function(t){const e=t.get(lr);class n extends e.extend.type{constructor(){super();const e=new wr(t,this);e._createComponent(),e._created()}connectedCallback(){var t;null===(t=super.connectedCallback)||void 0===t||t.call(this),Ps.of(this).context._connect()}disconnectedCallback(){var t;Ps.of(this).context.destroy(),null===(t=super.disconnectedCallback)||void 0===t||t.call(this)}}return n}(this)),this.componentType[rr]=this,this._ready.it=!0}}const xr=new jt("element-builder",{byDefault:ns((function(t){return{definitions:new Re,components:new Re,buildElement(e){const n=new vr(t,this,e);return n._define(),n}}}))});class $r{constructor(t){this._setup=t,this._components=void 0}define(t){this._components?this._components.push(t):(this._components=[t],this._defineAll(this._components))}_defineAll(t){const e=this._setup.get(ys).work(_s).run((()=>{const e=this._setup.get(ur),n=this._setup.get(xr);t.forEach((t=>{const s=n.buildElement(t);e.define(t,s.elementType)})),this._components=void 0}));this._setup.initBy(a(e))}}class kr extends ps{constructor(t,e){super(),this.feature=t,this._setup=e,this._bsContext=e.get(es);const n=e.get(e.module),s=new Et(this._bsContext);s.provide({a:ps,is:this}),this.get=s.newValues().get,this.whenReady=n.read.do(Xe((({ready:t})=>t&&this)),Ie),this._componentRegistry=new $r(this._setup)}get supply(){return this._setup.supply}get onDefinition(){return this._onDefinition||(this._onDefinition=this._setup.get(xr).definitions.on.do(Ve(this)))}get onComponent(){return this._onComponent||(this._onComponent=this._setup.get(xr).components.on.do(Ve(this)))}provide(t){return this._bsContext.get(js).provide(t).needs(this)}perDefinition(t){return this._bsContext.get(Ws).provide(t).needs(this)}perComponent(t){return this._bsContext.get(qs).provide(t).needs(this)}setupDefinition(t){return function(t,e){const{on:n}=Hs(t);return Ce((t=>{n({supply:t.supply.needs(e),receive(n,s){const r=s.whenReady.do(Ve(e)),o=s.whenComponent.do(Ve(e));t.receive(n,{get componentType(){return s.componentType},get whenReady(){return r},get whenComponent(){return o},perDefinition:t=>s.perDefinition(t).needs(e),perComponent:t=>s.perComponent(t).needs(e)})}})}))}(t,this.supply)}define(t){this._componentRegistry.define(t)}}const Sr=Symbol("feature-module");class Cr extends Kn{constructor(t){super(t.name,function(t){const e=function(t){let e=ls.of(t);if(ws in t){e=ls.merge(e,{init(e){e.define(t)}});const{feature:n}=$s.of(t);n&&(e=ls.merge(e,n))}return e}(t),n=[],r=[];for(const t of s(e.has))n.push(Cr.of(t));for(const t of s(e.needs))r.push(Cr.of(t));return{needs:r,has:n,async setup(n){var s;const r=n.get(ys),o=new kr(t,n);if(e.init){const t=r.work(ms).run((async()=>{await e.init(o)}));n.initBy(a(t))}await(null===(s=e.setup)||void 0===s?void 0:s.call(e,o))}}}(t)),this.feature=t}static of(t){return Object.prototype.hasOwnProperty.call(t,Sr)?t[Sr]:t[Sr]=new Cr(t)}async setup(t){const e=t.get(ys);await e.work(gs).run((()=>super.setup(t)))}}const Or=Symbol("when-defined");const Ar=Symbol("attribute");function Dr(t){return[Ar,t]}function Er(t,e=!0){if(!1===e)return c;if(!0===e||"function"==typeof e){const n=Dr(t),s=!0===e?Rr:e;return(t,e,r)=>s(t,n,e,r)}return(t,n,s)=>Rr(t,e,n,s)}function Rr(t,e,n,s){Rs.of(t).updateState(e,n,s)}function Tr(t){let e;for(let n=0;n<t.length;++n){const s=t[n];s<="Z"&&s>="A"?(e||(e=t.substring(0,n)),e+="-"+s.toLowerCase()):e&&(e+=s)}return e||t}const Pr=new jt("attribute-registry",{byDefault:t=>new zr(t.get(dr))});class zr{constructor(t){this._context=t,this.attrs=new Map,t.whenReady((({elementType:t})=>this.define(t))),t.whenComponent((({mount:t})=>{t&&this.mount(t)}))}declareAttribute({name:t,change:e}){this.attrs.set(t,u(this.attrs.get(t),e))}define(t){const{attrs:e}=this;e.size&&(Object.defineProperty(t,"observedAttributes",{configurable:!0,enumerable:!0,value:Fr(t,[...e.keys()])}),Object.defineProperty(t.prototype,"attributeChangedCallback",{configurable:!0,enumerable:!0,value:Mr(t,e)}))}mount(t){const{element:e}=t,{attrs:n}=this,s=[...n.keys()];if(!s.length)return;new(0,this._context.get(Gs).MutationObserver)((s=>s.forEach((s=>{const r=s.attributeName;return n.get(r)(t.context.component,e.getAttribute(r),s.oldValue)})))).observe(e,{attributes:!0,attributeFilter:s,attributeOldValue:!0})}}function Fr(t,e){const n=t.observedAttributes;if(Array.isArray(n)){const t=new Set(n);e.forEach((e=>t.add(e))),e=[...t]}return e}function Mr(t,e){const n=t.prototype.attributeChangedCallback;return n?function(t,s,r){const o=e.get(t);o?Ps.of(this).whenReady((({component:t})=>o(t,r,s))):n.call(this,t,s,r)}:function(t,n,s){Ps.of(this).whenReady((({component:r})=>{e.get(t)(r,s,n)}))}}function Ur(t){return Us((({type:e,key:n})=>{const s=function(t,e,n){let s,r;if("string"==typeof n)s=Tr(n),r=Er(s);else{if(n&&n.name)s=Tr(n.name);else{if("string"!=typeof e)throw new TypeError(`Attribute name is required as property key is not a string: ${t.constructor.name}.prototype.${String(e)}`);s=Tr(e)}r=Er(s,n&&n.updateState)}return{name:s,change:r}}(e.prototype,n,t),{name:r}=s;return{componentDef:{define(t){t.get(Pr).declareAttribute(s)}},get:t=>Rs.of(t).element.getAttribute(r),set(t,e){const{element:n}=Rs.of(t);null!=e?n.setAttribute(r,e):n.removeAttribute(r)}}}))}class Nr extends zt{constructor(){super("component-state")}grow(t){const e=t.seed();let n;if(null!=e)n=e,t.insert(n);else{if(t.hasFallback)return;n=new Lr,t.context.get(Rs).supply.whenOff((t=>n.done(t))),t.insert(n)}t.setup((({registry:t})=>{t.provide({a:Ds,is:n.update})}))}}const Kr=new Nr;class Lr extends sn{static get[xt](){return Kr}}class jr extends rn{constructor(t,e,n){super(),this._context=t,this._name=e,this.supply=new _,this.on=this._context.get(Lr).track(n).onUpdate.do(Ne(((t,e,n,s)=>t(n,s))),Ve(this))}get it(){return this._context.element.getAttribute(this._name)}set it(t){this.supply.isOff||(null==t?this._context.element.removeAttribute(this._name):this._context.element.setAttribute(this._name,t))}}const qr=Symbol("dom-property");const Br=Symbol("render"),Wr={spec:(t,e)=>function(t,...e){return"function"==typeof t?t(...e):t}(e,t),fulfill(t,e={}){const{on:n=e.on,error:s}=t;return{on:n,error:s?s.bind(t):e.error&&e.error.bind(e)}},trigger(t,e={}){const{on:n=[]}=e;if(("object"==typeof n||"function"==typeof n)&&ce(n))return Pe(n).do(Ve(t));const s=t.get(Lr).track(n).onUpdate.do(Ve(t));return Array.isArray(n)&&!n.length?s.do(Ke(((t,e)=>e[0]!==Br&&t()))):s}};class Ir{constructor(t){this._context=t,this._renders=new Set}renderBy(t,e={}){const n=Wr.spec(this._context,e),s=Wr.trigger(this._context,n),r=this._context.get(Ys)({...Wr.fulfill(n),node:this._context.element}),o="connected"===n.when;let i=1;const u=s(o?()=>this._context.connected&&h():()=>this._context.settled&&h()).needs(this._context).whenOff((function(){2===i&&r(c);i=-1}));(o?this._context.whenConnected:this._context.whenSettled)((()=>i&&h()));const a=Qn();return this._renders.add(l),u.whenOff((()=>this._renders.delete(l)));function h(){i=2,r(d)}function l(){a(d)}function d(e){if(i>0)for(i=0;;){const n=t(e);if(n===t||"function"!=typeof n)break;t=n}}}renderNow(){this._renders.forEach((t=>t()))}}const Vr=new jt("element-render-ctl",{byDefault:t=>new Ir(t.get(Rs))});const Hr=new jt("element-render-scheduler",{byDefault:function(t){const e=t.get(Vr);return(t={})=>{const n=un(c);return e.renderBy((t=>{n.it(t)}),Wr.fulfill({on:n.on},t)),t=>{n.it=e=>t(e)}}}});function Gr(t){return Us((({get:e})=>({componentDef:{define(n){n.whenComponent((n=>{n.whenReady((()=>{const{component:s}=n,r=e(s).bind(s);n.get(Vr).renderBy(r,t)}))}))}}})))}const Jr=new jt("shadow-content-root");class Zr extends Event{get shadowRoot(){return this.target.shadowRoot}}const Qr=new Ln("shadow-root-builder",{byDefault:()=>Xr});function Xr(t,e){const n=function(t,e){const n=t.shadowRoot;if(n)return n;if("attachShadow"in t)return t.attachShadow(e);return}(t.element,e);return n&&t.whenConnected((()=>t.dispatchEvent(new Zr("wesib:shadowAttached",{bubbles:!0})))),n}const Yr={mode:"open"};function to(t=Yr){return ks({setup(e){e.perComponent({a:Jr,by:e=>e.get(Qr)(e,t)}),e.perComponent({a:Os,by:t=>t.get(Jr,{or:null})})}})}const eo=new Zt("https://wesib.github.io/ns","b","wesib");class no extends Set{constructor(t){super(),this._added=new Set(t),this._removed=new Set,this._added.forEach((t=>this.add(t)))}add(t){return this.has(t)||(this._added.add(t),this._removed.delete(t),super.add(t)),this}delete(t){return!!super.delete(t)&&(this._added.delete(t),this._removed.add(t),!0)}clear(){this._added.clear(),this.forEach((t=>this._removed.add(t))),super.clear()}delta(t,e=[]){return so(this)(t,e),this}redelta(t){return("function"==typeof t?t:so(t))([...this._added],[...this._removed]),this}undelta(){return this._added.clear(),this._removed.clear(),this}}function so(t){return(e,n)=>{for(const e of n)t.delete(e);for(const n of e)t.add(n)}}const ro=Symbol("in-aspect"),oo={instance:null,convertTo:c};function io(t,e,n,s,r){return void 0===s&&(s=n(t,r)),{instance:s,convertTo:s=>io(s,e,n,void 0,t),attachTo:s=>io(s,e,n,t.aspect(e)||n(s))}}function uo(t,e,n=null){return io(t,e,a(null),n)}function co(t){return{instance:t,convertTo(){return this}}}const ao=new Zt("https://surol.github.io/input-aspects/ns","inasp","input-aspects"),ho={applyTo:()=>co(te())},lo={get[ro](){return ho},to:t=>({applyAspect:e=>e===ho?co(t):void 0})},fo={applyTo:()=>co(Yn)},po={get[ro](){return fo},to:t=>({applyAspect:e=>e===fo?co(t):void 0})};function yo(t,...e){if(!t)return _o;const n=wo(t);if(!e.length)return n;const s=e.map(wo);return(t,e)=>{const r=n(t,e),o=nt(ot([r],ct(s.map((n=>n(t,e))),C)),((t,e)=>e.applyAspect?n=>t(n)||e.applyAspect(n):t),c);return function(t){return!t.set}(r)?{applyAspect:o}:{set:r.set.bind(r),get:r.get.bind(r),applyAspect:o}}}function go(t){return t?(e=t,Array.isArray(e)?yo(...t):yo(t)):yo();var e}const mo={applyAspect(){}};function _o(){return mo}function wo(t){return"function"==typeof t?t:a(t)}class bo extends rn{constructor(){super(...arguments),this._aspects=new Map}aspect(t){return this._aspect(t[ro]).instance}setup(t,e=c){return ro in t?e(this.aspect(t),this):t(this),this}convert(t,...e){return new vo(this,yo(t,...e))}_aspect(t){const e=this._aspects.get(t);if(e)return e;const n=this._applyAspect(t)||t.applyTo(this);return this._aspects.set(t,n),n}_applyAspect(t){}}class vo extends bo{constructor(t,e){super(),this._on=new Re,this.supply=(new _).needs(t);let n,s=0;const r=e(t,this);let o,u,c;!function(t){return!t.set}(r)?(o=r.set,u=r.get,c=e=>t._aspect(e).convertTo(this)):(o=i,u=i,c=e=>{const n=t._aspect(e);return n.attachTo?n.attachTo(this):n.convertTo(this)}),this._applyAspect=t=>{var e;return(null===(e=r.applyAspect)||void 0===e?void 0:e.call(r,t))||c(t)},this._it=un([o(t.it),0]),this._it.supply.needs(this.supply),this._it.on((([t],[e])=>{t!==e&&this._on.send(t,e)})).cuts(this._on),t.on((t=>{t!==n&&(this._it.it=[o(t),++s])})).cuts(this),this._it.on((([e,r])=>{if(r!==s){s=r,n=u(e);try{t.it=n}finally{n=void 0}}}))}get it(){return this._it.it[0]}set it(t){const[e,n]=this._it.it;t!==e&&(this._it.it=[t,n+1])}get on(){return this._on.on}}class xo extends bo{constructor(t){super(),this._control=t}get supply(){return this._supply||(this._supply=(new _).needs(this._control))}get it(){return this._control.it}set it(t){this._control.it=t}get on(){return this._control.on}}class $o extends bo{constructor({aspects:t}){super(),this._aspectConversion=go(t)(new xo(this),this)}_applyAspect(t){return this._aspectConversion.applyAspect(t)||super._applyAspect(t)}}const ko={applyTo:t=>uo(t,So)};class So extends $o{static get[ro](){return ko}_applyAspect(t){return t===ko?uo(this,So,this):super._applyAspect(t)}}class Co{[ue](){return this.on}[ee](){return this.read}}const Oo={applyTo:t=>co(new Do(t))};class Ao{static get[ro](){return Oo}[ue](){return this.on}[ee](){return this.read}}class Do extends Ao{constructor(t){super(),this._control=t,this._map=new Map,this._on=new Re,this._on.supply.needs(this._control);const e=()=>this._map.keys();this.read=this.on.do(Le(e,e))}add(t){const e=this._map.get(t);if(e)return e;const n=new _((()=>{this._map.delete(t),this._on.send([],[t])}));return this._map.set(t,n),this._on.send([t],[]),n.needs(this._control).needs(t.parent)}get on(){return this._on.on}}const Eo={applyTo:t=>uo(t,Ro)};class Ro extends $o{static get[ro](){return Eo}_applyAspect(t){return t===Eo?uo(this,Ro,this):super._applyAspect(t)}}const To={applyTo:t=>io(t,Po,(t=>new Mo(t)))};class Po{static get[ro](){return To}[ue](){return this.on}[ee](){return this.read}static hasData(t){return"off"!==t&&"-"!==t[0]}done(t){return this.own.supply.off(t),this}}class zo extends rn{constructor(t){super(),this._tracker=un(t?function(t){return null!=t.getAttribute("disabled")?"off":null!=t.getAttribute("readonly")?"ro":"on"}(t.element):"on")}get supply(){return this._tracker.supply}get it(){return this._tracker.it}set it(t){switch(t){case"off":case"ro":case"-on":case"-ro":break;default:t="on"}this._tracker.it=t}get on(){return this._tracker.on}}class Fo{constructor(){this._all=new Set,this._on=new Re;const t=$e(this._on.on.do(qe((()=>this._all))),h(this._all));this.read=t.do(Ee((t=>xe(...t))),Le(No))}add(t){const e=new _((()=>{this._all.delete(t),this._on.send()}));return this._all.add(t),this._on.send(),e}}class Mo extends Po{constructor(t){super(),this._control=t,this._derived=new Fo;const e=t.aspect(Ro);this.own=new zo(e),this.own.supply.needs(t),this.derive(t.aspect(Ao).read.do(De(Uo)));let n="on";this.read=ve({derived:this._derived.read,own:this.own}).do(Je(((t,{derived:[e],own:[s]})=>{let r;if("off"===s||"off"===e)r="off";else{let t=!1;"-"===s[0]&&(t=!0,s=s.substring(1)),"-"===e[0]&&(t=!0,e=e.substring(1)),r="ro"===e?"ro":s,t&&(r="-"+r)}n!==r&&t(n=r)}),h(n)));let s="on";this.on=this.read.do(Ne(((t,e)=>{const n=s;n!==e&&t(s=e,n)}))),e&&this.read((t=>function(t,e){switch(e){case"off":t.setAttribute("disabled","");break;case"ro":case"-ro":t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly","");break;default:t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly",""),t.removeAttribute("readonly")}}(e.element,t)))}derive(t){return this._derived.add(ke(ne(t)?t:t(this._control)).do(Ge(this._control))).needs(this._control)}}function Uo(t){const e=H(t);if(!e.length)return Se("on");return xe(...e.map((({parent:t})=>t.aspect(Po)))).do(Le(No))}function No(...t){return function(...t){let e=!1,n=!1;for(const s of t)switch(s){case"off":return"off";case"ro":e=!0;break;case"-on":n=!0;break;case"-ro":n=!0,e=!0}return n?e?"-ro":"-on":e?"ro":"on"}(...ot(...t))}const Ko={applyTo:t=>io(t,Lo,(t=>ve({value:t,mode:t.aspect(Po)}).do(Le((({value:[t],mode:[e]})=>Po.hasData(e)?t:void 0)))))},Lo={get[ro](){return Ko}},jo={applyTo:t=>uo(t,qo)};class qo extends So{static get[ro](){return jo}_applyAspect(t){return t===jo?uo(this,qo,this):super._applyAspect(t)}}class Bo extends Co{remove(t){this.set(t,void 0)}}const Wo={};class Io{constructor(t){this._map=t,this._it=gt(rt((()=>this._map.values())),(([t])=>t)),this._entriesIt=gt(this._map,(([t,[e]])=>[t,e]))}get(t){const e=this._map.get(t);return e&&e[0]}[Symbol.iterator](){return this[A]()}[A](t){return this._it[A](t)}entries(){return E(this._entriesIt)}}class Vo{constructor(t){this._controls=t,this._supply=new _,this._map=new Map}set(t,e,n,s){const r=this._map.get(t);let o;if(e){o=new _;const i=this.newEntry(t,e,o);let u=!0;r&&(r[0]===e?u=!1:s.push([t,r])),u?(this.modify().set(t,i),n.push([t,i])):this._map.set(t,i)}else o=S(),r&&(s.push([t,r]),this.modify().delete(t));return r&&r[1].off(Wo),o}newEntry(t,e,n){return[e,new _((e=>{e!==Wo&&this._controls.remove(t)})).needs(this._supply).needs(n).whenOff((t=>n.off(t===Wo?void 0:t)))]}modify(){if(this._shot){const t=new Map;I(this._map.entries(),(([e,n])=>t.set(e,n))),this._shot=void 0,this._map=t}return this._map}snapshot(){return this._shot||(this._shot=new Io(this._map))}clear(){const t=[],e=[];return I(this._map.keys(),(n=>this.set(n,void 0,t,e))),e}}class Ho extends Bo{constructor(t){super(),this._group=t,this._updates=new Re;this._map=new Vo(this),this.on=this._updates.on.do(Ne(((t,e,n)=>t(e.map(Go),n.map(Go)))));const e=this._map.snapshot.bind(this._map);this.read=this._updates.on.do(Le(e,e)),this._map._supply.needs(t.read((t=>{this.read.do(We)((e=>{const n=new Set;I(bt(t),(([t,s])=>{n.add(t);const r=e.get(t);r&&(r.it=s)})),I(e.entries(),(([t,e])=>{n.has(t)||(e.it=void 0)}))}))})))}set(t,e){const n=this._group,s=[],r=[];let o;return"object"==typeof t?(o=new _,I(bt(t),(([t,e])=>{this._map.set(t,e,s,r).needs(o)}))):o=this._map.set(t,e,s,r),(s.length||r.length)&&(this._updates.send(s,r),s.length&&function(){let t;s.forEach((e=>{const[s,[r,o]]=e;r.aspect(Ao).add({parent:n}).needs(o).cuts(o);const i=r.it;if(t)t[s]=i;else{const e=n.it;e[s]!==i&&(t={...e,[s]:i})}})),t&&(n.it=t);s.forEach((t=>{const[e,[s,r]]=t;s.read.do(Ge(r))((t=>{n.it[e]!==t&&(n.it={...n.it,[e]:t})})).cuts(r)}))}()),o}clear(){const t=this._map.clear();t.length&&this._updates.send([],t)}}function Go([t,[e]]){return[t,e]}class Jo extends qo{constructor(t,e){super(e),this._model=un(t),this.controls=new Ho(this),this.supply.whenOff((()=>this.controls.clear()))}get supply(){return this._model.supply}get it(){return this._model.it}set it(t){this._model.it=t}get on(){return this._model.on}_applyAspect(t){return t===Lo[ro]?{instance:(e=this,ve({cs:e.controls,model:e,mode:e.aspect(Po)}).do(Ee(Zo))),convertTo:c}:super._applyAspect(t);var e}}function Zo({cs:[t],model:[e],mode:[n]}){if(!Po.hasData(n))return Se();const s={};return I(t.entries(),(([t,e])=>{s[t]=e.aspect(Lo)})),ve(s).do(Le((t=>{const n={...e};return I(bt(t),(t=>{const[e,[s]]=t;n[e]=s})),n})))}function Qo(t,{aspects:e}={}){return new Jo(t,{aspects:e})}const Xo=Se();function Yo(){return Xo}const ti={};class ei{constructor(t){const n=new Re,s=new Map,r=new Map;let o=c,i=c;this._messages=be((t=>{const e=ke(n,h())(t).whenOff((()=>{o=c,i=c}));i=(t,n)=>{const s=t(((...e)=>{if(e.length)r.set(t,e);else if(!r.delete(t))return;o()})).needs(n).whenOff((e=>{e!==ti&&n.off(e),r.delete(t)&&o()}));e.whenOff((()=>s.off(ti)))},I(s.entries(),(([t,e])=>i(t,e))),o=()=>{n.send(...ft(r.values()))},r.size&&o()})).do(Ae,Ge(t)),this.from=n=>{const r=function(t){return ne(t)?a(ke(t)):"function"==typeof t?e=>ke(t(e)):n=>n.read.do(Je((s=>s(...e(t.validate(n))))))}(n)(t),o=new _((()=>{s.delete(r)}));return s.set(r,o),i(r,o),o.needs(t)}}[ee](){return this._messages}}const ni={applyTo:t=>io(t,si,((t,e)=>{const n=new ui(t);return e&&n.by(e.aspect(si).read.do(Je(((t,e)=>t(...e.messages()))))),n}))};class si{static get[ro](){return ni}[ee](){return this.read}}const ri={get ok(){return!0},messages:()=>[],has:()=>!1,hasBut:()=>!1,[Symbol.iterator]:()=>st(),[A]:t=>st()};class oi{constructor(t){this._byCode=new Map,this._all=[],this._it=B(this._all),t.forEach((t=>{let e=!1;I(bt(t),(([n,s])=>{if(s){e=!0;const s=this._byCode.get(n);s?s.push(t):this._byCode.set(n,[t])}})),e&&this._all.push(t)}))}get ok(){return!this._all.length}messages(t){return null==t?this._all:this._byCode.get(t)||[]}has(t){return null==t||this._byCode.has(t)}hasBut(...t){return this._all.some((e=>t.every((t=>!e[t]))))}[Symbol.iterator](){return this[A]()}[A](t){return this._it[A](t)}}function ii(...t){return t.length?new oi(t):ri}class ui extends si{constructor(t){super(),this._messages=new ei(t),this.read=ke(this._messages).do(Le(ii));const e=t.aspect(So);e&&this._messages.from(function(t){return t.controls.read.do(Ee((t=>xe(...gt(t,(t=>t.aspect(si)))))),Je(((t,...e)=>t(...lt(e,(([t])=>t))))))}(e))}by(...t){return this._messages.from(function(...t){const e=t.length;return 1===e?t[0]:e?e=>{const n=new ei(e);return t.forEach((t=>n.from(t))),n}:Yo}(...t))}}function ci(t){return t?t.read.do(Je(((t,e)=>e?t():t({missing:"missing"})))):ci}class ai extends Ro{constructor(t,{aspects:e,get:n,set:s}){super({aspects:e}),this.element=t,this._input=new Re;const r=this;this._get=n,this._set=s,this._value=this.it;const o=this._update=(t,e)=>u({value:t},e);function u(t,e){for(;;){let n;r._value=t.value,r._update=(e,s)=>{n=[{...t,value:e},s]};try{r._input.send(t,e)}finally{r._update=o}if(!n)break;[t,e]=n}}this.events=new Wn(t),this.events.supply.needs(this),this.listenForInput((t=>u(t,this._value))),this.on=this._input.on.do(Ne(((t,{value:e},n)=>e!==n&&t(e,n)))),this.input=this._input.on.do(Le(i,(()=>({value:this.it}))))}get supply(){return this._input.supply}get it(){return this._get()}set it(t){const e=this.it;t!==e&&(this._set(t),this._update(this._get(),e))}listenForInput(t){const e=e=>t({value:this.it,event:e});this.events.on("input")(e),this.events.on("change")(e)}}function hi(t,{aspects:e}={}){return new ai(t,{get(){return this.element.value},set(t){this.element.value=t},aspects:e})}const li={applyTo:t=>io(t,di,(t=>{const e=t.aspect(Ro);return e&&new fi(e)}))};class di extends rn{static get[ro](){return li}}class fi extends di{constructor(t){super();const{element:e,events:n}=t,s=e.getRootNode?e.getRootNode():e.ownerDocument;this._it=un(s.activeElement===e),this.supply.needs(t),n.on("focus")((()=>this._it.it=!0)),n.on("blur")((()=>this._it.it=!1)),this.on({receive(t,n){t.onRecurrent(c),n?e.focus():e.blur()}})}get supply(){return this._it.supply}get it(){return this._it.it}set it(t){this._it.it=t}get on(){return this._it.on}}const pi={applyTo:t=>io(t,yi,(t=>{const e=t.aspect(So);return null!=e?new _i(e):new mi(t)}))};class yi{static get[ro](){return pi}[ee](){return this.read}}const gi={hasFocus:!1,touched:!1,edited:!1};class mi extends yi{constructor(t){super(),this._flags=un(gi),this._flags.supply.needs(t),this._flags.by(function(t,e){const n=e.aspect(Ro);return ve({hasFocus:e.aspect(di)||Se(!1),edited:n?n.input.do(Le((({event:t})=>!!t))):Se(!1)}).do(Le((({hasFocus:[e],edited:[n]})=>function(t,e,n){t=e?{...t,hasFocus:e,touched:!0}:{...t,hasFocus:e};n&&(t={...t,edited:n,touched:!0});return t}(t.it,e,n))))}(this._flags,t))}get read(){return this._flags.read}markTouched(t=!0){const e=this._flags.it;return t?e.touched||(this._flags.it={...e,touched:t}):e.touched&&(this._flags.it={...e,touched:e.hasFocus,edited:!1}),this}markEdited(t=!0){const e=this._flags.it;return t?e.edited||(this._flags.it={...e,touched:!0,edited:t}):e.edited&&(this._flags.it={...e,edited:t}),this}}class _i extends yi{constructor(t){var e;super(),this._container=t,this.read=(e=this._container).controls.read.do(Ge(e),Ee((t=>xe(...function(t){return gt(t,(t=>t.aspect(yi)))}(t)))),Le(wi))}markEdited(t){return this._container.controls.read.do(We)((e=>I(e,(e=>e.aspect(yi).markEdited(t))))),this}markTouched(t){return this._container.controls.read.do(We)((e=>I(e,(e=>e.aspect(yi).markTouched(t))))),this}}function wi(...t){const e={hasFocus:!1,touched:!1,edited:!1};return I(t,(([{hasFocus:t,touched:n,edited:s}])=>{n&&(e.touched=!0),t&&(e.hasFocus=e.touched=!0),s&&(e.edited=e.touched=!0)})),e}const bi={applyTo(t){const e=t.aspect(Ro);return e?co(e.element):oo}},vi={get[ro](){return bi},to:(t=null)=>({applyAspect:e=>e===bi?co(t):void 0})},xi={applyTo:t=>({instance:new Ci(t),convertTo:c})};class $i{static get[ro](){return xi}[ee](){return this.read}}const ki=Symbol("reason");function Si(t){return t&&"object"==typeof t&&ki in t}class Ci extends $i{constructor(t){super(),this._control=t,this._sources=un([new Map]),t.supply.whenOff((t=>this.done(t))),this.read=this._sources.read.do(Ge(this._control),Ee((([t])=>xe(...t.keys()))),je(((...t)=>{const e={};return t.forEach((([t])=>Oi(t,e))),e}))),this.track=be((t=>{t.supply.needs(this._control);const e=new no,n=new ie;let s=!1;return n.on(t),this.read((t=>{const r=new Set(e),o=[];I(at(bt(t),(([,t])=>!!t)),(([t])=>{r.delete(t)||o.push(t)})),(!s||o.length||r.size)&&(e.delta(o,r),s=!0,e.redelta(((t,e)=>n.send(t,e))).undelta())}))}));const e=t.aspect(vi);e&&this.applyTo(e,this.schedule)}get schedule(){return this._schedule||(this._schedule=Ai(this._control,this._control.aspect(vi)))}specs(t){return ke(ne(t)?t:t(this._control))}resolve(t){const e=this._control.aspect(lo);return this.specs(t).do(Le(((...t)=>{const n={};return t.forEach((t=>{Qt(t)?n[Jt.name(t,e)]=!0:Oi(t,n)})),n})))}add(t){const e=this._control.supply;if(e.isOff)return e;const n=new _,s=be((e=>{const s=this.resolve(t)({receive(t,...n){e.receive(t,...n)}});e.supply.whenOff((t=>{n.off({[ki]:t})})),n.needs(s).whenOff((t=>{Si(t)&&s.off(t[ki])}))})).do(Ae),[r]=this._sources.it;return r.set(s,n),n.whenOff((t=>{Si(t)||(r.delete(s),this._sources.it=[r])})),this._sources.it=[r],n.needs(e)}applyTo(t,e=Ai(this._control,t)){const{classList:n}=t,s=new no,r=()=>{s.redelta(((t,e)=>{n.remove(...e),n.add(...t)})).undelta()};return this.track(((t,n)=>{s.delta(t,n),e(r)})).whenOff((()=>{s.size&&(s.clear(),e(r))}))}done(t){return I(this._sources.it[0].values(),(e=>e.off(t))),this._sources.supply.off(t),this}}function Oi(t,e){I(bt(t),(([t,n])=>{null!=n&&(e[t]=n)}))}function Ai(t,e){return t.aspect(po)({node:e})}function Di({mark:t,when:n}={}){let s;return s=n?Array.isArray(n)?n.length?t=>n.every((e=>t.has(e))):Ei:t=>t.has(n):Ei,n=>n.aspect(si).read.do(Je(((n,r)=>s(r)?n(...function(t){if(!t)return Ri;const n=e(t);return n.length?n:Ri}(t)):n())))}function Ei(t){return!t.ok}const Ri=[["has-error",ao]];function Ti({ns:t=ao}={}){return e=>{const n=e=>[e,t];return ve({md:e.aspect(Po),vl:e.aspect(si),st:e.aspect(yi)}).do(Je(((t,{md:[e],vl:[s],st:[{hasFocus:r,touched:o,edited:i}]})=>{const u=[];Po.hasData(e)||u.push(n("disabled")),"ro"!==e&&"-ro"!==e||u.push(n("readonly")),s.ok||u.push(n("invalid")),s.has("missing")&&u.push(n("missing")),s.has("incomplete")&&u.push(n("incomplete")),r&&u.push(n("has-focus")),o&&u.push(n("touched")),i&&u.push(n("edited")),t(...u)})))}}function Pi(t){const e=t.length,n=t.charCodeAt(0);let s="",r=0;if(45===n){const n=t.charCodeAt(1);if(n>47&&n<58?(s+=`-\\${n.toString(16)} `,r=2):(s="-",r=1),1===e)return"\\-"}else n>47&&n<58&&(s+=`\\${n.toString(16)} `,r=1);for(;r<e;++r){const e=t.charCodeAt(r);s+=e>96&&e<123||45===e||95===e||e>47&&e<58||e>64&&e<91?t[r]:e>126?127===e?`\\${e.toString(16)} `:t[r]:e<32?e?`\\${e.toString(16)} `:"\ufffd":`\\${t[r]}`}return s}function zi(t){let e="";const n=t.length;for(let s=0;s<n;++s){const n=t.charCodeAt(s);e+=n<32||127===n?n?`\\${n.toString(16)} `:"\ufffd":34===n||92===n?`\\${t[s]}`:t[s]}return e}const Fi=/[A-Z]+/g;function Mi(t,e,n){const s=t.toLowerCase();return s.length>1&&e+s.length<n.length?`-${s.slice(0,-1)}-${s.slice(-1)}`:"-"+s}const Ui=new Map;function Ni(t){const e=Ui.get(t);if(e)return e;let n=function(t){return t.replace(Fi,Mi)}(t);return n.startsWith("ms-")&&(n="-"+n),Ui.set(t,n),n}function Ki(t){return Array.isArray(t)}function Li(t){return!!t.length}class ji{constructor(t){this.priority=t&&t.priority||0}important(){return this.prioritize(1)}usual(){return this.prioritize(0)}}function qi(t,e){return t===e||("object"==typeof t?t.is(e):"object"==typeof e&&e.is(t))}class Bi extends ji{}class Wi extends Bi{constructor(t,e){super(e),this.r=Hi(t.r,255),this.g=Hi(t.g,255),this.b=Hi(t.b,255),this.a=null!=t.a?Gi(t.a,1):1}get type(){return"rgb"}get rgb(){return this}get hsl(){const{a:t}=this,e=100*this.r/255,n=100*this.g/255,s=100*this.b/255,r=Math.max(e,n,s),o=Math.min(e,n,s),i=Math.round((r+o)/2);if(r===o)return new Ii({h:0,s:0,l:i,a:t},this);const u=r-o,c=Math.round(i>50?100*u/(200-r-o):100*u/(r+o));let a;switch(r){case e:a=(n-s)/u+(n<s?6:0);break;case n:a=(s-e)/u+2;break;default:a=(e-n)/u+4}return a*=60,a=Math.round(a),new Ii({h:a,s:c,l:i,a:t},this)}by(t){return Vi.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new Wi(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{r:e=this.r,g:n=this.g,b:s=this.b,a:r=this.a}=t;return new Wi({r:e,g:n,b:s,a:r},this)}toString(){const t=`${this.r}, ${this.g}, ${this.b}`;return 1===this.a?`rgb(${t})`:`rgba(${t}, ${this.a})`}}class Ii extends Bi{constructor(t,e){var n;super(e),this.h=(n=t.h,(n%=360)<0?360+n:n),this.s=Gi(t.s,100),this.l=Gi(t.l,100),this.a=null!=t.a?Gi(t.a,1):1}get type(){return"hsl"}get rgb(){const{a:t}=this,e=this.s/100,n=this.l/100;if(!e){const e=255*n;return new Wi({r:e,g:e,b:e,a:t},this)}const s=n<.5?n*(1+e):n+e-n*e,r=2*n-s,o=this.h/360;return new Wi({r:Ji(r,s,o+1/3),g:Ji(r,s,o),b:Ji(r,s,o-1/3),a:t},this)}get hsl(){return this}by(t){return Vi.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.h===this.h&&t.s===this.s&&t.l===this.l&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new Ii(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{h:e=this.h,s:n=this.s,l:s=this.l,a:r=this.a}=t;return new Ii({h:e,s:n,l:s,a:r},this)}toString(){const t=`${this.h}, ${this.s}%, ${this.l}%`;return 1===this.a?`hsl(${t})`:`hsla(${t}, ${this.a})`}}const Vi={by(t){if("object"==typeof t&&("rgb"===t.type||"hsl"===t.type))return t}};function Hi(t,e){return Gi(Math.round(t),e)}function Gi(t,e){return Math.max(Math.min(t,e),0)}function Ji(t,e,n){let s,r=n;return r<0?r+=1:r>1&&(r-=1),s=r<1/6?t+6*r*(e-t):r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t,255*s}function Zi(t,e,n){const s=2*n-1,r=t.rgb,o=e.rgb,i=r.a-o.a,u=((s*i==-1?s:(s+i)/(1+s*i))+1)/2,c=1-u;return new Wi({r:r.r*u+o.r*c,g:r.g*u+o.g*c,b:r.b*u+o.b*c,a:r.a*n+o.a*(1-n)},t)}class Qi extends ji{constructor(t){super(t),this.dim=t.dim}by(t){return this.dim.by(t)||this}toString(){return this.toFormula()}}const Xi={map(t,e){const n={},s={from:e,get(s){if(s in n)return n[s];const r=function(t){switch(typeof t){case"function":return t;case"object":return t.by.bind(t)}const e=typeof t;return n=>typeof n===e?n:t}(t[s])(e[s],this,s);return n[s]=r,r}};return I(ut(t),(t=>s.get(t))),n},by:t=>Xi.map.bind(void 0,t)};function Yi(t){if(null==t)return[void 0,0];switch(typeof t){case"object":return[t,t.priority];case"string":if(t.endsWith("!important"))return[t.substring(0,t.length-"!important".length).trim(),1]}return[t,0]}class tu extends Qi{constructor(t,e,n){super(n),this.val=t,this.unit=e}get type(){return"dimension"}toDim(t){const e=this.dim;if(t===e||t===e.pt||t===("%"===this.unit?t.pt:e.noPt))return this}is(t){return t===this||"object"==typeof t&&t.type===this.type&&this.unit===t.unit&&this.val===t.val&&this.priority===t.priority}prioritize(t){return this.priority===t?this:new tu(this.val,this.unit,{dim:this.dim,priority:t})}add(t,e){return"number"==typeof t&&(t=eu(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?eu(this.val+t.val,this.unit,this):ru(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=eu(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?eu(this.val-t.val,this.unit,this):ru(this,"-",t)}mul(t){return 1===t?this:eu(this.val*t,this.unit,this)}div(t){return 1===t?this:eu(this.val/t,this.unit,this)}negate(){return eu(-this.val,this.unit,this)}toFormula(){return`${this.val}${this.unit}`}}function eu(t,e,n){return t?new tu(t,e,n):n.dim.zero.prioritize(n.priority||0)}class nu extends Qi{constructor(t,e,n,s){super(s),this.left=t.usual(),this.op=e,this.right=n}get type(){return"calc"}is(t){return this===t||"object"==typeof t&&t.type===this.type&&(this.op===t.op&&this.left.is(t.left)&&qi(this.right,t.right)&&this.priority===t.priority)}add(t,e){return"number"==typeof t&&(t=eu(t,e,this)),ru(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=eu(t,e,this)),ru(this,"-",t)}mul(t){return iu(this,t)}div(t){return uu(this,t)}toString(){return"calc"+super.toString()}}class su extends nu{constructor(t,e,n,s){super(t,e,n.usual(),s)}prioritize(t){return this.priority===t?this:new su(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(!e)return;const n=this.right.toDim(t);return n?e===this.left&&n===this.right?this:new su(e,this.op,n,{dim:t,priority:this.priority}):void 0}negate(){return"-"===this.op?new su(this.right,this.op,this.left,this):new su(this.left.negate(),"-",this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right.toFormula()})`}}function ru(t,e,n){return n.type?new su(t,e,n,t):t}class ou extends nu{prioritize(t){return this.priority===t?this:new ou(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(e)return e===this.left?this:new ou(e,this.op,this.right,{dim:t,priority:this.priority})}mul(t){return("*"===this.op?iu(this.left,this.right*t):uu(this.left,this.right/t)).prioritize(this.priority)}div(t){return("/"===this.op?uu(this.left,this.right*t):iu(this.left,this.right/t)).prioritize(this.priority)}negate(){return new ou(this.left,this.op,-this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right})`}}function iu(t,e){return e?1===e?t.prioritize(t.priority):new ou(t,"*",e,t):t.dim.zero.prioritize(t.priority)}function uu(t,e){return 1===e?t.prioritize(t.priority):new ou(t,"/",e,t)}class cu extends Qi{constructor(t,e){super(e),this._byPriority=t}get type(){return 0}toDim(t){return t.zero.prioritize(this.priority)}is(t){return this===t||("object"==typeof t?t.type===this.type&&t.priority===this.priority:0===t||"0"===t?0===this.priority:"0 !important"===t&&1===this.priority)}add(t,e){return"number"==typeof t&&(t=eu(t,e,this)),t.prioritize(this.priority)}sub(t,e){return"number"==typeof t&&(t=eu(t,e,this)),t.negate().prioritize(this.priority)}mul(){return this}div(){return this}negate(){return this}prioritize(t){return this._byPriority.get(t)}important(){return this._byPriority.important}usual(){return this._byPriority.usual}toFormula(){return"0"}}class au{constructor(t){this.dim=t,this.usual=new cu(this,{dim:t}),this.important=new cu(this,{dim:t,priority:1})}get(t){switch(t){case 0:return this.usual;case 1:return this.important}return new cu(this,{dim:this.dim,priority:t})}}function hu({pt:t,noPt:e}){const n={get zero(){return s},get pt(){return t()},get noPt(){return e()},of(t,e){return t?new tu(t,e,{dim:this}):s},by(t){if(function(t){return"object"==typeof t&&("dimension"===t.type||"calc"===t.type||0===t.type)}(t))return t.toDim(this)}},s=new au(n).usual;return n}const lu=hu({pt:()=>du,noPt:()=>lu}),du=hu({pt:()=>du,noPt:()=>lu});class fu extends ji{constructor(t,e){super(e),this.url=t}get type(){return"url"}static by(t){switch(typeof t){case"string":{const[e,n]=Yi(t);return new fu(e,{priority:n})}case"object":if("url"===t.type)return t}}by(t){return fu.by(t)||this}prioritize(t){return t===this.priority?this:new fu(this.url,{priority:t})}is(t){return"object"==typeof t&&"url"===t.type&&t.url===this.url&&t.priority===this.priority}toString(){return`url("${zi(this.url)}")`}}const pu=Se({});function yu(){return pu}function gu(t,e){if(!e)return pu;if("string"!=typeof e){if(ne(e))return _u(e);if(ce(e))return _u(mu(e));if("function"==typeof e){const n=e(t);if("string"!=typeof n){if(ne(n))return _u(n);if(ce(n))return _u(mu(n))}return Se(wu(n))}}return Se(wu(e))}function mu(t){return ke(t,h({}))}function _u(t){return ke(t).do(je(wu),Je(function(){let t;return(e,n)=>{t&&function(t,e){const n=et(bu(e));for(const[e,s]of bu(t)){const{value:t}=n.next();if(!t||e!==t[0]||!qi(s,t[1]))return!1}return!n.next().value}(n,t)||e(t={...n})}}()))}function wu(t){return"string"==typeof t?{$$css:t}:t}function bu(t){return at(bt(t),(([,t])=>C(t)))}function vu(t,e){return _u(ve({base:t,addendum:e}).do(Le((({base:[t],addendum:[e]})=>function(t,e){return nt(bt(e),((t,[e,n])=>function(t,e,n){xu(t[e])<=xu(n)&&(delete t[e],t[e]=n);return t}(t,e,n)),{...t})}(t,e)))))}function xu(t){switch(typeof t){case"string":return t.endsWith("!important")?1:0;case"object":return t.priority;default:return 0}}function $u(t){return">"===t||"+"===t||"~"===t}function ku(t){if(!Ki(t))return[Su(t)];const e=[];let n;for(const s of t){const t=n;let r;if(n&&(e.push(n),n=void 0),$u(s)){if(n=s,!t)continue;r={}}else r=Su(s);e.push(r)}return n&&e.push(n,{}),e}function Su(t){return"string"==typeof t?t?{s:t}:{}:Cu(t)}function Cu(t){const e=t.ns||void 0,n=t.i||void 0,s=function(t){if(!t)return;if(Qt(t))return[t];const e=t.filter((t=>!!t));return Li(e)?e.sort(Xt):void 0}(t.c),r=function(t){if(!t)return;if(function(t){return"string"!=typeof t[0]}(t)){const e=t.map(Ou);return Li(e)?e:void 0}return[Ou(t)]}(t.u);return{ns:e,e:("*"!==t.e||!e&&!n&&!s&&r&&Au(r[0]))&&t.e||void 0,i:n,c:s,u:r,s:t.s||void 0,$:Du(t.$)}}function Ou(t){if(!Au(t))return t;if(t.length<3)return t;const[e,n,...s]=t;return Ki(s[0])?[e,n,...s.map(ku)]:[e,n,ku(s)]}function Au(t){return t.length>1&&(":"===t[0]||"::"===t[0])}function Du(t){if(t)return Li(t=Ki(t)?[...new Set(ft(t,Ru))].sort():[...Ru(t)])?t:void 0}const Eu=new Set;function Ru(t){if(!t)return Eu;const e=t.indexOf("="),n=e<0?t:t.substring(0,e),s=new Set;let r;for(const t of n.split(":"))r?r+=":"+t:r=t,s.add(r);return e>=0&&s.add(t),s}const Tu=[[]];function Pu(t){if(!t.length)return Tu;let e,n=0;for(;;){const s=t[n++];if($u(s)){e=s;continue}return[e?[e,s]:[s],t.slice(n)]}}const zu=[];function Fu(t,e){return t&&e.every((e=>t.find((t=>function(t,e){if("string"==typeof t)return"string"==typeof e?t===e:!e[1].url&&e[0]===t;const[n,{url:s}]=t;return"string"==typeof e?!s&&n===e:n===e[0]&&s===e[1].url}(e,t)))))}function Mu(t){return ku(t)}const Uu={qualify:t=>`@${Pi(t)}`};function Nu(t){return Lu(t,Uu)}const Ku={};function Lu(t,{qualify:e,nsAlias:n=te()}=Ku){const s={qualify:e,nsAlias:n};return t.reduce(((t,e)=>$u(e)?t+e:(t&&!$u(t[t.length-1])&&(t+=" "),t+function(t,{qualify:e,nsAlias:n}){const{ns:s,e:r,i:o,c:i,s:u,u:c,$:a}=t;let h=!1,l="";o&&(h=!0,l+=`#${Pi(Ht.name(o,n))}`);i&&(h=!0,l=i.reduce(((t,e)=>`${t}.${Pi(Jt.name(e,n))}`),l));if(c){h=!0;const t={nsAlias:n};l=c.reduce(((e,n)=>function(t,e,n){if(Au(e)){t+=e[0]+e[1];if(e.length>2){t+="("+Lu(e[2],n);for(let s=3;s<e.length;++s)t+=","+Lu(e[s],n);t+=")"}return t}const[s,r,o,i]=e;t+="["+Pi(s),r&&(t+=`${r}"${zi(o)}"`);i&&(t+=" "+i);return t+"]"}(e,n,t)),l)}u&&(h=!0,l+=u);e&&a&&(l=a.reduce(((t,n)=>t+e(n)),l));if(s){const t=function(t,e){return"string"==typeof t?t:t.url?e(t):void 0}(s,n);l=t?`${t}|${r||"*"}${l}`:d()}else l=d();return l;function d(){return h?`${r?It.name(r,n):""}${l}`:`${r?It.name(r,n):"*"}${l}`}}(e,s))),"")}class ju{constructor(t){this._rule=t}read(t){let e=this._rule.outer;for(;e;)t=vu(e.read.do(Le(Wu)),t),e=e.outer;return t}render(t,e){const{selector:n}=t;let{writer:s}=t;if(!s.isGroup)return void t.render(e);let r=s;const o=function(t){const e=new Map,n=[];for(const s of t)$u(s)?n.push(s):n.push(Vu(s,e));if(!e.size)return;return[e,Mu(n)]}(n);if(!o)return void t.render(e);const[i,u]=o;for(const t of i){const[n,o]=qu(e,t);if(!o){s=r.addStyle(n);break}s=r=r.addGroup(n,o)}t.render(e,{writer:s,selector:u})}}function qu(t,[e,[n,s]]){let r="";const o=t=>{t&&(r&&(r+=" and "),r+=t)};for(const e of n){const[n]=Yi(t[e]);o(n)}return o(s),r?[e,r]:[e]}const Bu={order:-65535,create:t=>new ju(t)};function Wu(t){return nt(at(bt(t),Iu),((t,[e,n])=>(t[e]=n,t)),{})}function Iu(t){return"@"===String(t[0])[0]}function Vu(t,e){const n=t.$;if(!n)return t;const s=[];for(const t of n)"@"===t[0]?Hu(e,t):s.push(t);return s.length===n.length?t:Li(s)?{...t,$:s}:{...t,$:void 0}}function Hu(t,e){const n=e.indexOf("=");let s,r;n<0?s=e:(s=e.substring(0,n),r=e.substring(n+1));const o=s.indexOf(":"),i=o<0?s:s.substring(0,o),u=t.get(i);if(u){const[t,e]=u;t.add(s),r&&(u[1]=e?`${e} and ${r}`:r)}else t.set(i,[(new Set).add(s),r])}const Gu={order:-65534,needs:Bu,render(t,e){const n=!t.rule.selector.length,{sheet:s}=t;let r=0,o=0;for(const[t,i]of bt(e)){const e=String(t);if("@"===e[0]){const[t]=Yi(i),u=n?Ju(s,r,e,t):0;r+=u,o+=u;const c=fu.by(t);c&&(o+=Zu(s,o,e,c),o+=Qu(s,o,e,c))}}t.render(e)}};function Ju(t,e,n,s){if(!n.startsWith("@import:"))return 0;const r=new fu(n.substring("@import:".length));let o=String(r);return s&&(o+=` ${s}`),t.addGlobal("@import",o,e),1}function Zu(t,e,n,s){return"@namespace"!==n?0:(t.addGlobal("@namespace",String(s),e),1)}function Qu(t,e,n,s){if(!n.startsWith("@namespace:"))return 0;const r=n.substring("@namespace:".length);return t.addGlobal("@namespace",`${r} ${s}`,e),1}function Xu(t,e){const n=t.addStyle();I(at(bt(e),Yu),(([t,e])=>{const[s,r]=Yi(e);n.set(Ni(t),`${s}`,r)})),t.render(e,{writer:n})}function Yu(t){const[e,n]=t;if(null==n)return!1;const s=String(e)[0];return s>="a"&&s<="z"||s>="A"&&s<="Z"}function tc(t,e){const n=e.$$css;if(n){const s=t.addStyle();s.replace(n),t.render(e,{writer:s})}else t.render(e)}const ec={order:-65535,needs:Gu,render(t,e){const n=t.selector.map((t=>!$u(t)&&t.ns&&"string"!=typeof t.ns?t.ns:null)).filter(C);if(n.length){const s=(e,n)=>(e[`@namespace:${t.nsAlias(n)}`]=new fu(n.url),e);t.render(n.reduce(s,{...e}))}else t.render(e)}};function nc(t){if("function"==typeof t)return{create:()=>({render:t})};if(function(t){return"create"in t}(t))return{order:t.order,needs:t.needs,create:e=>function(t){return"function"==typeof t?{render:t}:t}(t.create(e))};const e=t.render.bind(t);return{order:t.order,needs:t.needs,create:()=>({render:e})}}function sc(t,e){const n=t.order||0,s=e.order||0;return n>s?1:n<s?-1:0}function rc(t,e=Yn){return(n={})=>{const{node:s=t,error:r}=n;return e({...n,node:s,error:r&&r.bind(n)})}}function oc(t){var e;null===(e=t.parentNode)||void 0===e||e.removeChild(t)}const ic={indent:"  "},uc={nv:"",eol:"",pre:"",indent(){return this}};class cc{constructor(t,e=""){this._config=t,this.pre=e}get nv(){return" "}get eol(){return"\n"}indent(){return new cc(this._config,this.pre+this._config.indent)}}class ac{constructor(t,e){this.f=t,this.selector=e,this.body="",this.nf=t.indent()}get isGroup(){return!1}set(t,e,n){const s=n>=1?" !important":"",{pre:r,nv:o,eol:i}=this.nf;this.body&&(this.body+=`;${i}`),this.body+=`${r}${t}:${o}${e}${s}`}replace(t){this.body=t.trim(),this.body.endsWith(";")&&(this.body=this.body.substr(0,this.body.length-1))}toString(){const{pre:t,nv:e,eol:n}=this.f;if(this.body){const s=n?`;${n}`:"";return`${t}${this.selector}${e}{${n}${this.body}${s}${t}}`}return""}}class hc{constructor(t){this.nf=t,this._nested=[]}get isGroup(){return!0}addGroup(t,e,n){return this._add(new lc(this.nf,t,e),n)}addStyle(t,e){return this._add(new ac(this.nf,t),e)}toString(){let t="";for(const e of this._nested){const n=String(e);n&&(t&&(t+=this.nf.eol),t+=n)}return t}_add(t,e=this._nested.length){return this._nested.splice(e,0,t),t}}class lc extends hc{constructor(t,e,n){super(t.indent()),this.f=t,this.name=e,this.params=n}toString(){const t=super.toString();if(!t)return"";const{pre:e,nv:n,eol:s}=this.f;return`${e}${this.name} ${this.params}${n}{${s}${t}${s}${e}}`}}class dc extends hc{constructor(t,e,n){super(e),this.id=t,this.f=e,this.sender=n}addGlobal(t,e,n){this._add(`${this.f.pre}${t} ${e};`,n)}clear(){this._nested.length=0}remove(){this.clear(),this.sender.send({id:this.id})}done(){this.sender.send({id:this.id,css:this.toString()})}}function fc(t={}){var e;const{document:n=(null===(e=t.parent)||void 0===e?void 0:e.ownerDocument)||window.document,parent:s=n.head}=t,r=function(t={}){const e=!0===t.pretty||null==t.pretty?ic:t.pretty||!1,{scheduler:n=Qn}=t,s=new Re,r=e?new cc(e):uc;let o=0;return{...t,pretty:e,scheduler:n,onSheet:s.on,addSheet:()=>new dc(String(++o),r,s)}}(t),o=rc(s,t.scheduler),i=o(),u=new Map,c=r.onSheet((({id:t,css:e})=>{let r=u.get(t);null==e?(u.delete(t),oc(r)):r?r.textContent=e:(r=n.createElement("style"),r.setAttribute("type","text/css"),r.textContent=e,s.appendChild(r),u.set(t,r),c.whenOff((()=>i((()=>oc(r))))))}));return{...t,scheduler:o,addSheet(t){return c.needs(t),this.addSheet=r.addSheet.bind(r),this.addSheet(t)}}}class pc{constructor(t){this._target=t}get isGroup(){return!1}set(t,e,n){this._target.style.setProperty(t,e,n>=1?"important":void 0)}replace(t){this._target.style.cssText=t}}class yc{constructor(t){this._target=t}get isGroup(){return!0}addGroup(t,e,n){return new yc(this._add(`${t} ${e}{}`,n))}addStyle(t,e){return new pc(this._add(`${t}{}`,e))}_add(t,e=this._target.cssRules.length){const n=this._target.insertRule(t,e);return this._target.cssRules[n]}}class gc extends yc{constructor(t){super(t.sheet),this._element=t}addGlobal(t,e,n){this._add(`${t} ${e};`,n)}clear(){const{cssRules:t}=this._target;for(;t.length;)this._target.deleteRule(t.length-1)}remove(){oc(this._element)}done(){}}function mc(t,e){const{rootSelector:n={e:"body"},scheduler:s=Yn,nsAlias:r=te()}=e,o=new _,i={nsAlias:r},u=function(t){const e=new Map;return n(t.renderer),e.delete(Xu),[...e.values(),nc(Xu)].sort(sc);function n(t){t&&(Ki(t)?t.forEach(s):s(t))}function s(t){if(e.has(t))return;const s=nc(t);e.set(t,s),n(s.needs)}}(e),a=nt(gt(t,d),((t,e)=>(new _).cuts(e).cuts(t)),new _);const h=function(){const e=new _;return Pe(t)({supply:e,receive:(t,n)=>{n.forEach((t=>d(t).needs(e)))}})}();return o.needs(a).needs(h).cuts(a).cuts(h);function l(t,e,n){return new class{get supply(){return o}get rule(){return t}get sheet(){return n.sheet}get writer(){return n.writer}get selector(){return n.selector}nsAlias(t){return r(t)}render(s,r){e(r?l(t,e,{sheet:n.sheet,writer:r.writer||n.writer,selector:r.selector||n.selector}):this,s)}addStyle(t=n.selector){const{writer:e}=n;return e.isGroup?e.addStyle(function(t,e){return Lu(Mu(t),e)}(t,i)):e}}}function d(t){const[r,o]=function(t){const e=u.map((e=>e.create(t)));return[e.reduce(((t,e)=>e.read?ke(e.read(t)):t),t.read),n(0)];function n(t){return(s,r)=>{const o=t+1;let i;i=o===u.length?c:n(o);const a=l(s.rule,i,s);e[t].render(a,r)}}}(t);let i;const a=function(t){const e=t.selector;if(!e.length)return Mu(n);if($u(e[0]))return[...Mu(n),...e];return e}(t),h=s();return r((function(n){h((()=>{null==i||i.clear();const s=l(t,o,{get sheet(){return i||(i=e.addSheet(s)),i},get writer(){return this.sheet},selector:a});s.render(n),null==i||i.done()}))})).whenOff((function(){h((()=>{const t=i;if(t)return i=void 0,t.remove()}))}))}}function _c(t){const e=[Bu,ec,Gu,tc];return t&&(Ki(t)?e.push(...t):e.push(t)),e}function wc(t,e){return mc(t,{...e,renderer:_c(e.renderer)})}class bc{[ee](){return this.read}add(t){return this.rules.add([],t)}clear(){return this.set()}}class vc{[ee](){return this.read}[ue](){return this.onUpdate}}class xc extends vc{}class $c extends vc{constructor(t,e){let n;super(),this._list=t,e?(this._buildList=()=>at(t,e),n=t=>t.filter(e)):(this._buildList=a(t),n=i),this.onUpdate=Ce((t=>{const e=this._ruleSet||(this._ruleSet=new Set(this._buildList()));Pe(this._list)({supply:t.supply.whenOff((()=>this._ruleSet=void 0)),receive:(s,r,o)=>{r=n(r),((o=n(o)).length||r.length)&&(o.forEach((t=>e.delete(t))),r.forEach((t=>e.add(t))),t.receive(s,r,o))}})})).do(Me);const s=a(this);this.read=this.onUpdate.do(Le(s,s))}[Symbol.iterator](){return this._ruleSet?this._ruleSet.values():et(this._buildList())}grab(t){return kc(this,t)}}function kc(t,e){const n=function(t){return Cu(t)}(e);return new $c(t,(t=>function(t,e){if(!t.length)return!1;const n=t[t.length-1];return!(e.ns&&n.ns!==e.ns||e.e&&n.e!==e.e||e.i&&n.i!==e.i||e.c&&!Fu(n.c,e.c)||e.$&&!Fu(n.$,e.$))}(t.selector,n)))}class Sc extends xc{constructor(t,e){super(),this._root=t,this.nested=e,this._updates=new Re,this.self=function(t,e){const n=new Re,s=[t];e.onUpdate(((e,r)=>{r[0]===t&&(s.length=0,n.send([],[t]))})).cuts(n);class r{[ue](){return n.on}[Symbol.iterator](){return et(s)}}return new $c(new r)}(t,this),this._it=l((()=>Cc(t)));const n=a(this);this.read=this._updates.on.do(Le(n,n))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return this[A]()}[A](t){return this._it()[A](t)}grab(t){return kc(this,t)}add(t,e){return Dc(this._root,Mu(t),e,!0)}get(t){return this._get(Mu(t))}_get(t){const[e,n]=Pu(t);if(!n)return this._root;const s=this.nested._rule(Nu(e));return s?s.rules.get(n):void 0}watch(t){const e=Mu(t);return be((t=>{const n=un({}),s=this.read.do(Oe((()=>{const t=this._get(e);return t&&t.read((t=>n.it=t)).whenOff((()=>n.it={}))})));return n.read(t).cuts(s)})).do(Ae)}_add(t,e){t.rules.onUpdate(((t,e)=>this._updates.send(t,e))),e&&this._updates.send(H(t.rules),[])}_remove(t){const e=H(this);this._updates.send([],e),e.forEach((e=>{e.rules._updates.supply.off(t),e._spec.supply.off(t)}))}}function Cc(t){return ot(it(t),ft(t.rules.nested,(t=>Cc(t))))}class Oc extends vc{constructor(t){super(),this._updates=new Re,this._byKey=new Map,this._all=new Sc(t,this);const e=a(this);this.read=this._updates.on.do(Le(e,e))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return this._byKey.values()}grab(t){return kc(this,t)}_rule(t){return this._byKey.get(t)}_add(t,e,n){this._byKey.set(t,e),e.rules.onUpdate(((n,s)=>{s[0]===e&&(this._byKey.delete(t),this._updates.send([],[e]))})),n&&this._updates.send([e],[]),this._all._add(e,n)}}class Ac extends bc{constructor(t,e,n,s=yu){super(),this._root=t||this,this._selector=e,this._key=n,this._spec=un(s),this.read=this._spec.read.do(De((t=>t(this)))),this._nested=new Oc(this)}get root(){return this._root}get outer(){if(void 0!==this._outer)return this._outer;const t=function(t){let e=t.length-1;if(e<=0)return e?void 0:zu;do{switch(--e,t[e]){case">":return t.slice(0,e);case"+":case"~":--e;continue;default:return t.slice(0,e+1)}}while(e>0)}(this.selector);return this._outer=t&&this.root.rules.get(t)||null}get selector(){return this._selector}get key(){return this._key}get empty(){return this._spec.it===yu}get rules(){return this._nested._all}set(t){return this._spec.it=t?e=>gu(e,t):yu,this}remove(t){return this.rules._remove(t),this}}function Dc(t,e,n,s){const[r,o]=Pu(e);if(!o)return t._spec.it=function(t,e){const n=t._spec.it;if(!e)return n;if(t.empty)return t=>gu(t,e);return t=>vu(n(t),gu(t,e))}(t,n),t;const i=Nu(r),u=t.rules.nested._rule(i);if(u)return Dc(u,o,n,s);const c=new Ac(t.root,[...t.selector,...r],r),a=Dc(c,o,n,!1);return t.rules.nested._add(i,c,s),a}const Ec=[];class Rc{[ee](){return this.read}clear(){return this.set()}}class Tc extends Rc{constructor(t,e,n){super(),this._root=t,this._selector=e,this._map=n,this.read=ve({ms:this._map(this._root),ps:this._root.rules.watch(this._selector)}).do(Le((({ms:[t],ps:[e]})=>Xi.map(t,e))))}add(t){return this._root.rules.add(this._selector,t),this}set(t){return this._root.rules.add(this._selector).set(t),this}}const Pc={by(t,e){let n;return n="function"==typeof e?t=>zc(e(t)):a(zc(e)),e=>new Tc(e,t,n)}};function zc(t){return ne(t)?t:Se(t)}class Fc{constructor(t){this.refs=t;const e=ve(this.refs);this.read=e.do(Le(Mc))}static by(t,e){const n={};for(const s of Object.keys(t))n[s]=t[s](e);return new Fc(n)}[ee](){return this.read}}function Mc(t){const e={};for(const n of Object.keys(t))e[n]=t[n][0];return e}const Uc=new $c({[ue]:()=>Te,[Symbol.iterator]:()=>[][Symbol.iterator]()});function Nc(...t){return t.length?qc(t.map(Kc)):Uc}function Kc(t){return"function"==typeof t?function(t){let e;const n=()=>e||(e=Bc(t()));return{[Symbol.iterator]:()=>n()[Symbol.iterator](),[ue]:()=>n()[ue]()}}(t):Bc(t)}function Lc(...t){return t.length?qc(t.map(jc)):Uc}function jc(t){return"function"==typeof t?function(t){const e=new Set,n=Ce((n=>{const s=Bc(t());Wc(s,e,n),s[ue]()({supply:n.supply.whenOff((()=>e.clear())),receive(t,s,r){r.forEach((t=>e.delete(t))),s.forEach((t=>e.add(t))),n.receive(t,s,r)}})})).do(Me);return{[ue]:()=>n,[Symbol.iterator]:()=>e.values()}}(t):Bc(t)}function qc(t){if(1===t.length){const e=t[0];return e instanceof vc?e:new $c(e)}return new $c({*[Symbol.iterator](){for(const e of t)yield*e},[ue]:()=>Ce((e=>{t.forEach((t=>Pe(t)({supply:(new _).needs(e.supply),receive(t,n,s){e.receive(t,n,s)}})))})).do(Me)})}function Bc(t){return t instanceof bc?t.rules.self:ce(t)?t:function(t){const e=new Set,n=Ce((n=>{let s=S();const{supply:r}=n;r.cuts(s).whenOff((()=>e.clear())),t.then((t=>{if(!r.isOff){const o=t instanceof bc?t.rules:t;Wc(o,e,n),s=Pe(o)({receive(t,s,r){r.forEach((t=>e.delete(t))),s.forEach((t=>e.add(t))),n.receive(t,s,r)}}).needs(r)}})).catch((t=>r.off(t)))})).do(Me);return{[ue]:()=>n,[Symbol.iterator]:()=>e.values()}}(t)}function Wc(t,e,n){const s=[];if(I(t,(t=>{s.push(t),e.add(t)})),s.length){const t=new ie;t.on(n),t.send(s,[])}}function Ic({$:t="raw",n:e,t:n,v:s,x:r=[],p:o={},pl:i=[]}){return e&&(o[e]={$:t,n:e,v:s,x:[],p:{},pl:[]}),{$:t,n:e,t:n,v:s,x:r,p:o,pl:i}}function Vc({p:t,pl:e},n){const s=n.n||n.v,r=t[s];(!r||!r.n&&n.n)&&(t[s]=n),e.push(n)}const Hc=()=>!1,Gc=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \d\d (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d\d\d\d \d\d:\d\d:\d\d GMT/;function Jc({dateTime:t}){return t?Zc:Hc}function Zc(t,e){return t.s=t.s.substring(t.i),t.i=0,!!Gc.test(t.s)&&(e(t.s.substring(t.i,t.i+=29)),!0)}function Qc({delimiterOf:t}){return e=>{const n=e.s[e.i];return e.d=t(n),n}}function Xc(t,{named:e=!0,tagged:n=!0,extra:s=!0,next:r=Qc(t)}={}){const o=function({delimiterOf:t}){return(e,n)=>{if(!(262144&t(e.s[e.i])))return!1;let s="";for(++e.i;e.i<e.s.length;){const n=e.s[e.i++];if(524288&t(n))break;s+=n}return n(s),!0}}(t),i=Jc(t),u=function({delimiterOf:t}){return(e,n)=>{let s="";for(++e.i;e.i<e.s.length;++e.i){const r=e.s[e.i];if("\\"===r){s+=e.s[++e.i]||r}else{if(65536&t(r))return++e.i,void n(s);s+=r}}n(s)}}(t),c=s?Xc(t,{next:r,tagged:!1,named:!1,extra:!1}):Hc;return(t,s)=>{let a,h,l,d="",f="raw";for(;t.i<t.s.length;){const s=r(t);if(t.d){if(12&t.d)break;if(null==h){if(16&t.d){h=d?"":s,++t.i;continue}if(65536&t.d){!n&&d||u(t,(t=>{d?(f="tagged-string",a=d):f="quoted-string",d="",h=t}));break}if(!d&&o(t,(t=>{f="angle-bracketed-string",h=t})))break;h=d,d=""}else{if(65536&t.d){!n&&h||u(t,(t=>{h?(f="tagged-string",a=h):f="quoted-string",h=t}));break}if(!h&&o(t,(t=>{f="angle-bracketed-string",h=t})))break}}if(null==h){if(!d&&i(t,(t=>h=t))){f="date-time";break}e?d+=s:h=s}else{if(!h&&i(t,(t=>h=t))){f="date-time";break}h+=s}++t.i}if(null==h){if(!d)return!1;l=Ic({$:f,v:d})}else l=Ic({$:f,n:d||void 0,t:a,v:h});for(;c(t,(t=>l.x.push(t))););return s(l),!0}}function Yc({delimiterOf:t}){return e=>{let n=e.s[e.i];return"\\"!==n?(e.d=t(n),n):(++e.i,e.i<e.s.length?(n=e.s[e.i],e.d=t(n)?1:0):e.d=1,n)}}function ta({delimiterOf:t}){return e=>{const n=e.i;do{const n=e.s[e.i];if(!(2&t(n)))break;e.i++}while(e.i<e.s.length);return e.i!==n}}function ea(t,e={}){const{delimiterOf:n}=t,s=ta(t),r=Xc(t,{...e,tagged:!1});return(t,e)=>!!(8&n(t.s[t.i]))&&(++t.i,s(t),r(t,e))}const na={" ":7,"\t":7,",":5,";":9,'"':65569,"\\":33,"<":262145,">":524289,"=":17,"(":1,")":1,"/":1,":":1,"?":1,"@":1,"[":1,"]":1,"{":1,"}":1};function sa({delimit:t,dateTime:e}={}){const n=t?{...na,...t}:na;return{dateTime:e,delimiterOf:t=>n[t]||(t>="\0"&&t<=" "||"\x7f"===t?1:0)}}const ra=sa(),oa=sa({delimit:{":":17,"(":131105,")":37," ":3,"\t":3,"=":1,",":1}});function ia(t){const e=t?sa(t):ra,n=function(t){const{delimiterOf:e}=t,n=ta(t);return t=>!!(4&e(t.s[t.i]))&&(t.i++,n(t),!0)}(e),s=ea(e),r=Xc(e),o=(null==t?void 0:t.comments)?function(t){const{delimiterOf:e}=t,n=ta(t),s={next:Yc(t)},r=Xc(t,s),o=ea(t,s);return(t,s)=>{if(!(131072&e(t.s[t.i])))return!1;let i;for(++t.i;n(t)||o(t,(t=>{i||(i=Ic({$:"raw",v:""})),Vc(i,t)}))||r(t,(t=>i=t)););return++t.i,s(i||Ic({$:"raw",v:""})),!0}}(oa):Hc;return t=>{const e=[],i={i:0,s:t};for(;i.i<i.s.length&&(n(i)||s(i,(t=>{e.length||e.push(Ic({$:"raw",v:""})),Vc(e[e.length-1],t)}))||o(i,(t=>e.push(t)))||r(i,(t=>e.push(t)))););return e}}const ua=ia();function ca(t){if(!t)return'""';const{delimiterOf:e}=ra;let n,s=!1;for(let r=0;r<t.length;++r){const o=t[r],i=e(o);i?(32&i&&(n||(n=t.substring(0,r)),n+="\\"+o),s=!0):n&&(n+=o)}return s?`"${n||t}"`:t}class aa extends Tn{constructor(t){super(t),this.upKey=this.createUpKey((t=>t.insert(t.seed.do(De(((...e)=>e.length?Se(function(t){return(e,n)=>{const s=(n,r)=>{const o=t[n];return o?Pe(o(((t=r)=>s(n+1,t)),r)):e(r)};return s(0,n)}}(e)):t.hasFallback&&t.or?t.or:Se(ha)))))))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Se(t.or):t.or}:void 0)((t=>e=t)).whenOff((t=>e=bn(t))),t.insert(((t,n)=>e(t,n)))}}function ha(t,e){return t(e)}const la=new aa("http-fetch-agent"),da={};const fa=new Ln("http-fetch",{byDefault:ns((function(t){const e=t.get(Gs),n=t.get(la);return(t,e)=>n(s,new Request(t,e));function s(t){return Ce((n=>{const s=new Re;let r;if("AbortController"in e){const o=new e.AbortController,{signal:i}=o;r=new _((t=>{t===da&&o.abort()})),n.supply.whenOff((()=>r.off(da))).needs(r),s.on({supply:r,receive(t,e){n.receive(t,e)}});const u=t.signal;u&&(new Wn(u).on("abort").do(Ie)((()=>o.abort())),u.aborted&&o.abort()),t=new Request(t,{signal:i})}else r=s.on(n);e.fetch(t).then((t=>{s.send(t),r.off()})).catch((t=>r.off(t)))}))}}))});const pa=new jt("hierarchy-root",{byDefault:t=>{const e=t.get(Js);return new Wn(e).on("wesib:component")((({context:t})=>t.get(ga).issue())),un()}}),ya=new jt("hierarchy-updates",{byDefault:t=>new ga(t.get(Rs))});class ga{constructor(t){const e=new Re,n=t.get(es).get(pa);this.on=e.on,this.send=()=>e.send(t),this.issue=()=>{const e=ma(t);e?e[0].get(ga).send():n.it=t}}static get[xt](){return ya}}function ma(t){var e;const n=t.get(es).get(Js);let{element:s}=t,r=!0;if(s!==n)for(;;){const t=s.parentNode||s.getRootNode().host;if(!t)return;const o=null===(e=t[Ts])||void 0===e?void 0:e.context;if(o)return[o,r];if(t===n)return;r=!1,s=t}}const _a=new jt("hierarchy-context",{byDefault:t=>new ba(t.get(Rs))});class wa extends At{static get[xt](){return _a}get supply(){return this.context.supply}}class ba extends wa{constructor(t){super(),this.context=t,this.up=be((t=>{const{supply:e}=t;e.needs(this);const n=un();n.by(this._parent),e.cuts(n);const s=(new _).needs(e),r=(new _).needs(e),o=()=>{const t=ma(this.context);if(t){const[e,o]=t;n.it=e.get(wa),s.off(),o&&r.off()}else n.it=void 0};this.context.get(es).get(pa).read({supply:s,receive:()=>this.context.connected&&o()}),n.read.do(Ge(r),Oe((t=>t&&t.context.get(ga).on(o)))),n.read(t),this.context.whenConnected({supply:(new _).needs(e),receive:o})})).do(Ae);const e=this._parent=un();t.whenConnected(c).cuts(e);const n=this._registry=(s=this.up,new Et((t=>function(t){return"upKey"in t}(t)?s.do(De((e=>e?e.get(t):Se()))):void 0)));var s;this.get=n.newValues().get}provide(t){return this._registry.provide(t).needs(this)}inside(t){return this._parent.it=t&&t.get(wa),this}}class va{[ue](){return this.onUpdate}[ee](){return this.read}}const xa={subtree:!0};function $a(t,e,n,s,{deep:r,all:o}){const i=new Re,u=r?xa:void 0;let c,h=new Set;const l=r?ka:B;"string"==typeof n?c=n:t.whenDefined(n).then((({elementDef:{name:e}})=>{if(e&&(c=It.name(e,t.get(Zs)),i.size)){const t=p();if(t.size){const e=H(at(gt(t,(t=>s(t))),C));e.length&&i.send(e,[])}}})).catch(console.error),o||e.addEventListener("wesib:component",(t=>{const e=t.target;if(h.has(e)){const t=s(e);i.send([t],[])}}));const d=at(gt(rt((function(){return E(i.size?h:p())})),(t=>s(t))),C);class f extends va{constructor(){super();const n=t.get(sr)(y);this.onUpdate=Ce((t=>{const s=!i.size,r=i.on(t);s&&(p(),n.observe(e,u)),r.whenOff((()=>{i.size||(n.disconnect(),h.clear())})).needs(t.supply)}));const s=a(this);this.read=this.onUpdate.do(Le(s,s)),this.track=be((t=>{const e=new Re;e.on(t),e.send(H(this),[]),this.onUpdate(t)})),this.first=ke(this.read).do(Je(((t,e)=>t(Z(e)))))}[Symbol.iterator](){return this[A]()}[A](t){return d[A](t)}}return new f;function p(){const t=function(){const t=c;if(!t)return new Set;if(r)return new Set(B(e.querySelectorAll(t)));return new Set(ct(e.children,(e=>e.matches(t))))}();return i.size&&(h=t),t}function y(t){const e=[],n=[];t.forEach((t=>{I(at(gt(l(t.removedNodes),m),C),(t=>n.push(t))),I(at(gt(l(t.addedNodes),g),C),(t=>e.push(t)))})),(e.length||n.length)&&i.send(e,n)}function g(t){if(rs(t))return c&&t.matches(c)&&!h.has(t)?(h.add(t),s(t)):void 0}function m(t){if(rs(t)&&h.delete(t))return s(t,!0)}}function ka(t){return lt(t,(t=>B([t,...ka(t.childNodes)])))}class Sa{constructor(t,e){this._bs=t,this.element=e,this._emitters=new Map}get observer(){if(this._observer)return this._observer;const t=this._bs.get(Gs).MutationObserver;return this._observer=new t((t=>this._update(t)))}observe(t,e){const n=this,s=this.observer,r=this._emitter(t),o=se(e),i=r.on({supply:new _((()=>{this._emitters.delete(t),s.disconnect(),this._emitters.size?u():this._observer=void 0})).needs(o.supply),receive:(t,e,n)=>o.receive(t,e,n)});return s.disconnect(),u(),i;function u(){n._update(s.takeRecords()),s.observe(n.element,{attributes:!0,attributeOldValue:!0,attributeFilter:[...n._emitters.keys()]})}}_update(t){t.forEach((t=>{const e=t.attributeName,n=this._emitters.get(e);n&&n.send(this.element.getAttribute(e),t.oldValue)}))}_emitter(t){const e=new Re;return this._emitters.set(t,e),e}}class Ca extends rn{constructor(t,e){super(),this._observer=t,this._name=e,this._updates=new Re;let n=S();this.on=Ce((t=>{this._updates.size||(n=this._observer.observe(this._name,((t,e)=>this._updates.send(t,e)))),t.supply.needs(n),this._updates.on(t).whenOff((t=>{this._updates.size||n.off(t)}))}))}get supply(){return this._updates.supply}get it(){return this._observer.element.getAttribute(this._name)}set it(t){null!=t?this._observer.element.setAttribute(this._name,t):this._observer.element.removeAttribute(this._name)}}class Oa{constructor(t,e){this._attrs=new Map,this._observer=new Sa(t,e)}get(t){const e=this._attrs.get(t);if(e)return e;const n=new Ca(this._observer,t);return this._attrs.set(t,n),n}}class Aa extends rn{constructor(t,e){super(),this._element=t,this._updates=new Re,this._key=e}get supply(){return this._updates.supply}get it(){return this._element[this._key]}set it(t){this._element[this._key]=t}get on(){return this._updates.on}bind(t){var e;t.get(Lr).track((e=this._key,[qr,e])).onUpdate({supply:this.supply,receive:(t,e,n,s)=>this._updates.send(n,s)})}}class Da{constructor(t){this._element=t,this._props=new Map}bind(t){this._context=t,this._props.forEach((e=>e.bind(t)))}get(t){const e=this._props.get(t);if(e)return e;const n=new Aa(this._element,t);return this._context&&n.bind(this._context),this._props.set(t,n),n}}const Ea=Symbol("element-node");class Ra{constructor(t,e){this._bs=t,this.element=e,this._attrs=new Oa(t,e),this._props=new Da(e),e[Ea]=this;const n=this.context;n?this._bind(n):e.addEventListener("wesib:component",(t=>this._bind(t.context)))}get context(){var t;return null===(t=this.element[Ts])||void 0===t?void 0:t.context}get parent(){const t=this.element.parentNode;return t&&Ta(this._bs,t)}select(t,e){return function(t,e,n,s={}){if(s.all)return $a(t,e,n,((e,n)=>Ta(t,e,n)),s);const r=t.get(nr);return $a(t,e,n,((e,n)=>r(e)&&Ta(t,e,n)),s)}(this._bs,this.element,t,e)}attribute(t){return this._attrs.get(t)}property(t){return this._props.get(t)}_bind(t){this._props.bind(t)}}function Ta(t,e,n){const s=e[Ea];return s||n?s:new Ra(t,e)}const Pa=new jt("component-node",{byDefault:t=>Ta(t.get(es),t.get(Rs).element)});function za(t){return new URL(t.hash.substring(1),t.origin)}const Fa=Symbol("page-param");class Ma{get[Fa](){return this}byDefault(t,e){}}class Ua extends Tn{constructor(t){super(t),this.upKey=this.createUpKey((t=>{const{document:e}=t.context.get(Gs);t.insert(t.seed.do(De(((...n)=>n.length?Se((function(t,s,r,o){return i(0,o);function i(o,u){const c=n[o];if(!c)return t(u);c((({url:t=u.url,title:n=u.title,data:s=u.data}=u)=>i(o+1,{url:new URL(String(t),e.baseURI),title:n,data:s,get visited(){return u.visited},get current(){return u.current},get:t=>u.get(t),put(t,e){u.put(t,e)}})),s,r,u)}})):t.hasFallback&&t.or?t.or:Se(Na)))))}))}grow(t){let e;t.context.get(this.upKey,t.hasFallback?{or:null!=t.or?Se(t.or):t.or}:void 0)((t=>e=t)).whenOff((t=>e=bn(t))),t.insert(((t,n,s,r)=>e(t,n,s,r)))}}function Na(t,e,n,s){t(s)}const Ka=new Ua("navigation-agent");class La extends At{}const ja=new jt("nav-history",{byDefault:ns((t=>new Ba(t)))});function qa(t){return null==t||"object"!=typeof t?{data:t}:t["wesib:navigation:data"]}class Ba{constructor(t){this._context=t,this._entries=new Map,this._lastId=0;const e=t.get(Gs);this._document=e.document,this._location=e.location,this._history=e.history,this._uid=btoa(String(Math.random()))}static get[xt](){return ja}init(){const{data:t}=qa(this._history.state),e=this.newEntry({url:new URL(this._location.href),data:t,title:this._document.title});return this._entries.set(e.id,e),e.schedule((()=>{e.enter("init"),this._history.replaceState(this._historyState(e),"")})),e}newEntry(t){return new Wa(this._context,++this._lastId,t)}open(t,e){const{page:{title:n="",url:s}}=t;this._history.pushState(this._historyState(t),n,s.href),this._enter("open",t,e)}_enter(t,e,n){const s=n.it;this._entries.set(e.id,e);try{for(let t=s.next;t;t=t.next)this._forget(t)}finally{e.prev=s,s.next=e,e.schedule((()=>{try{s.leave()}finally{e.enter(t)}})),n.it=e}}replace(t,e){const n=e.it,{page:{title:s="",url:r}}=t;this._history.replaceState(this._historyState(t),s,r.href),this._entries.set(t.id,t);const o=n.prev;o&&(t.prev=o,o.next=t),t.schedule((()=>{try{n.leave()}finally{try{this._forget(n)}finally{t.enter("replace")}}})),e.it=t}popState(t,e){const{state:n}=t;if(null==n)return null==this._history.state?this._changeHash(e):void 0;const s=e.it,{uid:r,data:o,id:i}=qa(n);let u;const c=r===this._uid&&null!=i?this._entries.get(i):void 0;return c?u=c:(u=this.newEntry({url:new URL(this._location.href),data:o,title:this._document.title}),s.transfer(u,"return"),this._entries.set(u.id,u),this._history.replaceState(this._historyState(u),"")),u.schedule((()=>{try{s.leave()}finally{u.enter("return")}})),e.it=u,u}hashChange(t){if(null==this._history.state)return this._changeHash(t)}update(t,e){const n=t.it,s=new Wa(this._context,++this._lastId,{...n.page,url:e},n);return this._entries.set(s.id,s),this._history.replaceState(this._historyState(s),"",e.href),this._entries.delete(n.id),t.it=s}_changeHash(t){const e=t.it,n=this.newEntry({url:new URL(this._location.href),data:null,title:this._document.title});try{e.transfer(n,"enter")}finally{this._history.replaceState(this._historyState(n),""),this._enter("enter",n,t)}return n}_forget(t){this._entries.delete(t.id),t.forget()}_historyState({id:t,page:{data:e}}){return{"wesib:navigation:data":{uid:this._uid,id:t,data:e}}}}class Wa{constructor(t,e,n,s){this._bsContext=t,this.id=e,this._status=0,this._update=c,this._params=s?s._params:new Map;const r=this;this.page={get url(){return n.url},get title(){return n.title},get data(){return n.data},get visited(){return!!r._status},get current(){return 2===r._status},get:t=>r.get(t),put(t,e){r.put(t,e)}}}get(t){const e=t[Fa],n=this._params.get(e);if(n)return n.get();const s=e.byDefault(this.page,this._newContext());return s&&this._init(e,s)}put(t,e){const n=t[Fa],s=this._params.get(n);return s?(s.put(e),s.get()):this._init(n,n.create(this.page,e,this._newContext()))}_newContext(){const t=new Et(this._bsContext);return new class extends La{constructor(){super(...arguments),this.get=t.newValues().get}}}_init(t,e){return this._params.set(t,e),this.page.current&&e.enter&&e.enter(this.page,"init"),e.get()}transfer(t,e){I(this._params.entries(),(([n,s])=>{if(s.transfer){const r=s.transfer(t.page,e);r&&t._params.set(n,r)}}))}stay(t){I(this._params.values(),(e=>e.stay&&e.stay(t)))}enter(t){this._status=2,I(this._params.values(),(e=>e.enter&&e.enter(this.page,t)))}leave(){this._status=1,I(this._params.values(),(t=>t.leave&&t.leave()))}forget(){I(this._params.values(),(t=>t.forget&&t.forget())),this._params.clear()}schedule(t){this._update=t}apply(){const t=this._update;this._update=c,t()}}class Ia extends Event{constructor(t,e){super(t,{...e,cancelable:!1}),this.when=e.when,this.to=e.to}}class Va extends Event{constructor(t,e){super(t,{...e,cancelable:!0}),this.when=e.when,this.from=e.from,this.to=e.to}}class Ha extends Event{constructor(t,e){super(t,{...e,cancelable:!0}),this.from=e.from,this.to=e.to,this.reason=e.reason}get when(){return"stay"}}const Ga=new jt("navigation",{byDefault:ns((function(t){const e=t.get(Gs),{document:n,history:s}=e,r=new Wn(e),o=t.get(Ba),i=t.get(Ka),a=un(o.init());a.read((t=>t.apply()));let h=Promise.resolve();r.on("popstate")((t=>{const e=o.popState(t,a);e&&r.dispatch(new Ia("wesib:enterPage",{when:null!=t.state?"return":"enter",to:e.page}))})),r.on("hashchange")((()=>{const t=o.hashChange(a);t&&r.dispatch(new Ia("wesib:enterPage",{when:"enter",to:t.page}))}));return new class extends Ja{constructor(){super(),this.onEnter=r.on("wesib:enterPage"),this.onLeave=r.on("wesib:leavePage"),this.onStay=r.on("wesib:stayOnPage"),this.on=ze(Pe(this.onEnter),Pe(this.onLeave),Pe(this.onStay)),this.read=a.read.do(Le((({page:t})=>t)))}get page(){return a.it.page}get length(){return s.length}go(t){s.go(t)}open(t){return p("pre-open","open",t)}replace(t){return p("pre-replace","replace",t)}update(t){return o.update(a,d(t)).page}with(t,e){return l((n=>n.put(t,e)))}};function l(t){return{with:(e,n)=>l(u(t,(t=>t.put(e,n)))),open:e=>p("pre-open","open",e,t),replace:e=>p("pre-replace","replace",e,t),pretend(e,n=((t,e)=>e)){let s;"function"==typeof e?(n=e,s=void 0):s=e;const r=f(s),o=a.it,i=y("pretend",o,r,t);try{return g("pretend",o,r,i)?n(o.page,i.page):void 0}finally{i.stay(a.it.page)}}}}function d(t){return"string"==typeof t?new URL(t,n.baseURI):t||a.it.page.url}function f(t){return null==t||"string"==typeof t||t instanceof URL?{url:d(t)}:t.url instanceof URL?t:{...t,url:d(t.url)}}function p(t,e,n,s=c){const i=f(n),u=h=h.then(l,l);return u;function l(){let n;try{const c=function(){if(h!==u)return d();const e=a.it,n=y(t,e,i,s),o=new Va("wesib:leavePage",{when:t,from:e.page,to:n.page});if(!r.dispatch(o)||h!==u||!g(t,e,i,n))return d(n);return n}();return c?(n=c,o[e](n,a),r.dispatch(new Ia("wesib:enterPage",{when:e,to:n.page})),n.page):c}catch(t){throw d(n,t),t}}function d(t,e){return t&&t.stay(a.it.page),r.dispatch(new Ha("wesib:stayOnPage",{from:a.it.page,to:i,reason:e})),null}}function y(t,e,n,s){const r=o.newEntry(n);try{e.transfer(r,t),s(r.page)}catch(t){throw r.stay(a.it.page),t}return r}function g(t,e,n,s){let r=!1;return i((({url:t,data:e,title:s})=>{r=!0,n.url=t,n.data=e,n.title=s}),t,e.page,s.page),r}}))});class Ja{static get[xt](){return Ga}[ue](){return this.on}[ee](){return this.read}back(){this.go(-1)}forward(){this.go(1)}reload(){this.go()}}function Za({node:t,page:e}){const{element:n}=t,s=n.getAttribute("href");if(null==s)return Se(t,-1);return Se(t,Qa(new URL(s,n.ownerDocument.baseURI),e.url))}function Qa(t,e){if(t.origin!==e.origin)return-1;const n=Xa(t),s=Xa(e);if(t.hash){if(n!==s)return-1;const r=Ya(t,e);return r<0||Ya(e,t)<0?-1:t.pathname.length+r+Qa(za(t),za(e))}const r=Ya(t,e);return r?r<0||n!==s?-1:t.pathname.length+r:s.startsWith(n)?t.pathname.length:-1}function Xa(t){const e=t.pathname;return e.endsWith("/")?e:e+"/"}function Ya({searchParams:t},{searchParams:e}){let n=0;return t.forEach(((t,s)=>{(function(t){return t.startsWith("__")&&t.endsWith("__")})(s)||n>=0&&(e.getAll(s).includes(t)?n+=1:n=-1)})),n}const th=Symbol("nav-link-render-schedule"),eh=["active",eo];function nh(t){return t.target.getAttribute("href")}function sh(t,e,n,s=rh){let r;"function"==typeof n?(s=n,r=null):r=n||null;const o=e.ownerDocument;if(rs(t)){const n=o.createElement(t.tagName.toLowerCase());return t.getAttributeNames().forEach((e=>n.setAttribute(e,t.getAttribute(e)))),s(t,n),e.insertBefore(n,r),n}const i=o.importNode(t,!1);return e.insertBefore(i,r),i}function rh(t,e){I(B(t.childNodes),(t=>sh(t,e)))}function oh(t){let e;return n=>{const s=function(t){return new URL("",t.url).href}(n);if(e){if(e.url===s)return e.on;e.sup.off()}let r;const o=new _((()=>{e=void 0,r=void 0})),u=Ce((e=>{if(!r){const e=t(n),s=un(),u=e((t=>{s.it=t})).whenOff((t=>{null!=t&&o.off(t)}));o.cuts(u).cuts(s),r={on:s.read.do(Xe(i)),num:0}}const s=r;return++s.num,s.on.do(Ve(o))(e).whenOff((t=>{--s.num||Promise.resolve().then((()=>{s.num||s!==r||o.off(t)})).catch(console.error)}))}));return e={url:s,on:u,sup:o},u}}class ih extends Error{}const uh=new class extends Ma{create(t,e){return{get:()=>e,put:c}}};class ch{constructor(t,e){this._navigation=t,this._loader=e,this._map=new Map,this._requests=ft(rt((()=>this._map.values())))}get fragments(){const t=[];return function(t,e){let n=!0;return W(t,(t=>{if(n=!!e(t),!n)return!1})),n}(this._requests,(e=>!!e.fragment&&(t.push(e.fragment),!0)))?t:[]}handle(){const t=this,e=new _;let n=S();return{get(){},put(e){t._add(e)},transfer(e,n){if("pretend"===n)return;const s=t._transfer();return e.put(uh,s),s.handle()},enter(s,r){if("init"===r)return;n=(new _).needs(e);const o=Ce((e=>{const r=new Re,o=r.on(e);return t._loader(s).do(Ve(n))((t=>r.send(t))).whenOff((t=>{void 0===t||t instanceof ih||r.send({ok:!1,page:s,error:t})})),o})).do(Me);I(t._requests,(({fragment:t,receiver:e})=>function(t,e){return e?t.do(Be((t=>t.ok?{...t,fragment:(null!=e.tag?t.document.getElementsByTagName(e.tag)[0]:t.document.getElementById(e.id))||void 0}:t))):t}(o,t)({supply:(new _).needs(e.supply),receive(t,n){e.receive(t,n)}})))},leave(){n.off(new ih("page left"))},stay(){e.off(new ih("navigation cancelled"))},forget(){e.off(new ih("page forgotten"))}}}_add(t){const e={...t,receiver:se(t.receiver)},{supply:n}=e.receiver,s=this._map.get(n);s?s.push(e):(this._map.set(n,[e]),n.whenOff((()=>this._map.delete(n))))}_transfer(){const t=new ch(this._navigation,this._loader);for(const[e,n]of this._map.entries())t._map.set(e,n.slice());return t}}const ah=new aa("page-load-agent"),hh=new Ln("page-load-url",{byDefault:a(c)}),lh=new jt("page-loader",{byDefault:ns((function(t){const e=t.get(Gs),n=t.get(fa),s=t.get(hh),r=t.get(ah),o=new e.DOMParser;return t=>{const e=new URL(t.url.href);s(e);const i=new Request(e.href,{mode:"same-origin",credentials:"same-origin",headers:new Headers({Accept:"text/html"})});return Ce((t=>r(u,i)(t)));function u(s){return function(t,e){var n;const s=null===(n=t.get(uh))||void 0===n?void 0:n.fragments;s&&s.length&&e.headers.set("Accept-Fragment",s.reduce(((t,e)=>(t?t+", ":"")+(null!=e.tag?"tag="+ca(e.tag):"id="+ca(e.id))),""))}(t,s),Ce((r=>{const i=new ie;i.on(r),i.send({page:t}),n(s).do(Be((t=>Promise.all([t,t.text()]))),He,Ue(((...t)=>Se(...t))),Be((([n,s])=>{if(!n.ok)return{ok:!1,page:t,response:n,error:n.status};try{return{ok:!0,page:t,response:n,document:dh(o,e,n,s)}}catch(e){return{ok:!1,page:t,response:n,error:e}}})))(r)}))}}}))});function dh(t,e,n,s){const r=t.parseFromString(s,ua(n.headers.get("Content-Type")||"text/html")[0].v);if(r.head){const t=r.head.querySelector("base");if(t)t.href=new URL(t.getAttribute("href"),e).href;else{const t=r.createElement("base");t.href=e.href,r.head.appendChild(t)}}return r}class fh extends Ma{create(t,e,n){const s=new ch(n.get(Ja),oh(n.get(lh))),r=s.handle();return t.put(uh,s),r.put(e),r}}const ph=new fh,yh=new jt("page-cache-buster",{byDefault:ns((t=>new gh(t)))});class gh{constructor(t){const e=mh(t.get(Gs).document);if(e){const n=t.get(Ja);this.urlModifier=Se((t=>t.searchParams.set("__wesib_app_rev__",e))),this.agent=Se(((t,s)=>t(new Request(s.url,s)).do(Be((t=>{if(t.ok){const s=mh(t.document);if(s&&s!==e){const e=new URL(t.page.url.href);e.searchParams.set("__wesib_app_rev__",s),n.update(e),n.reload()}}return t})))))}else this.urlModifier=Se(),this.agent=Se()}static get[xt](){return yh}}function mh(t){var e;return null===(e=t.querySelector("meta[name=wesib-app-rev]"))||void 0===e?void 0:e.getAttribute("content")}function _h(t){const e=t.get(Gs).document;return t=>t().do(Be((t=>{if(t.ok){const n=new Set(gt(wh(e,e.scripts),(([t])=>t)));I(at(wh(t.document,t.document.querySelectorAll("script")),(([t])=>!n.has(t))),(([t,s])=>{sh(s,e.head,((e,n)=>n.src=t)),n.add(t)}))}return t})))}function wh(t,e){return gt(ct(e,(({src:t})=>!!t)),(e=>[new URL(e.src,t.baseURI).href,e]))}function bh(t){const e=t.get(Gs).document;return t=>t().do(Be((t=>{if(!t.ok)return t;const n=t.document.querySelectorAll("link[rel=stylesheet]");if(!n.length)return t;let s=e.head,r=null;const o=e.querySelectorAll("link[rel=stylesheet]"),i=new Map,u=o.item(0);return u&&(s=u.parentNode,r=u,I(B(o),(t=>i.set(new URL(t.href,e.baseURI).href,t)))),I(B(n),(t=>{const n=new URL(t.href,e.baseURI).href,o=i.get(n);o?(Z(i.keys())===n?(s=o.parentNode,r=o.nextSibling):s.insertBefore(o,r),i.delete(n)):sh(t,s,r,((t,e)=>e.href=n))})),I(i.values(),(t=>t.parentNode.removeChild(t))),t})))}function vh(t){const e=t.get(Gs).document;return t=>t().do(Be((t=>{if(t.ok){const n=t.document.getElementsByTagName("title").item(0);n&&n.textContent&&(e.title=n.textContent)}return t})))}const xh={setup(t){t.provide({a:hh,by:t=>t.urlModifier,with:[gh]}),t.provide({a:ah,by:t=>t.agent,with:[gh]}),t.provide({a:ah,by:_h}),t.provide({a:ah,by:bh}),t.provide({a:ah,by:vh})}};class $h{static get[us](){return xh}}function kh({url:t}){return new URL("",t).href}class Sh extends Tn{get upKey(){return this}constructor(){super("default-in-aspects")}grow(t){const e=t.context.get(Zs),n=t.context.get(Hr);t.insert(t.seed.do(Le(((...t)=>yo(...t,po.to(n),lo.to(e)))),Ge(t.context.get(Mt))))}}const Ch=new Sh,Oh=new jn("input-from-control",{byDefault:()=>({})});function Ah(t,e){return t.get(wa).provide({a:Oh,by:()=>({root:t,control:e})}).needs(t).needs(e)}const Dh=new jt("component-style-producer",{byDefault:ns((()=>mc))});function Eh(t,e={},n){const{context:s}=t;return{...e,document:e.document||s.get(Gs).document,parent:e.parent||s.contentRoot,rootSelector:[],scheduler:e.scheduler||Rh(s,n),nsAlias:e.nsAlias||s.get(Zs),renderer:t.renderer(e)}}function Rh(t,e={}){const n=t.get(Hr);return(t={})=>n({...t,...e})}const Th=new Lt("component-styp-renderer"),Ph=new Zt("https://wesib.github.io/ns/element-id-class","elic","element-id-class"),zh=new jt("unique-element-class",{byDefault:function(t){const e=t.get(Zs),n=t.get(Rs),s=n.get(lr),r=`${s.name?It.name(s.name,e):"component"}#${++Fh}`,o=Ph.name(e(Ph),r,Jt);return n.element.classList.add(o),o}});let Fh=0;const Mh=new jt("component-styp-format",{byDefault:t=>new Lh(t.get(Rs))});class Uh{static get[xt](){return Mh}produce(t,e){const n=this.newProducer(t,e),s=new _;return this.context.whenSettled((()=>{n().needs(s).cuts(s)})),s}newProducer(t,e){const n=Lc(t);let s;const r=this.context.supply;return s=()=>this.context.get(Dh)(n,this.format(e)).needs(r),r.whenOff((()=>{s=a(r)})),()=>s()}renderer(t){const e=this.context.get(Jr,{or:null}),{renderer:o}=t,i=r(s(o),this.context.get(Th)),u=t.hostSelector?Mu(t.hostSelector)[0]:void 0;return i.add(e?function(t){return{order:-100,render(e,n){let{selector:s}=e;if(s.length){if(t){const[e,n]=Nh(s);n&&(s=n.length?[{u:[[":","host",Kh(n,t)]]},...e]:[{u:[[":","host",[t]]]},...e])}}else s=[t||{u:[[":","host"]]}];e.render(n,{selector:s})}}}(u):function(t){return{order:-100,render(e,n){let{selector:s}=e;if(s.length){const[e,n]=Nh(s);s=n&&n.length?[...Kh(n,t),...e]:[t,...e]}else s=[t];e.render(n,{selector:s})}}}(u||{c:[this.context.get(zh)]})),n(i)}}function Nh(t){if("string"!=typeof t[0]){const[{ns:e,e:n,i:s,c:r,u:o,s:i,$:u},...c]=t;if(!e&&!n&&!s&&!r&&!i&&o){const[[t,e,...n]]=o;if(":"===t&&"host"===e){let t;return n.length?(t=n[0].slice(),t[0].$=u):t=u?[{$:u}]:[],[c,t]}}}return[t]}function Kh(t,{ns:e,e:n,i:s,c:r,u:o,s:i}){const[u,...c]=t;return[{ns:u.e||u.ns?u.ns:e,e:u.e||u.ns?u.e:n,i:u.i||s,c:u.c?r?[...u.c,...r]:u.c:r,u:u.u?o?[...u.u,...o]:u.u:o,s:(u.s||"")+(i||"")||void 0,$:u.$},...c]}class Lh extends Uh{constructor(t){super(),this.context=t}format(t){return function(t={}){const{parent:e=document.head}=t;return{...t,scheduler:rc(e,t.scheduler),addSheet(){const t=document.createElement("style");return t.setAttribute("type","text/css"),t.append(document.createTextNode("")),e.appendChild(t),new gc(t)}}}(this.config(t))}config(t){return Eh(this,t,{when:"connected"})}}class jh extends Uh{constructor(t,{when:e="settled"}={}){super(),this.context=t,this.when=e}format(t){return fc(this.config(t))}config(t){return Eh(this,t,{when:this.when})}}function qh(t){return Us((({get:e})=>({componentDef:{define(n){n.whenComponent((n=>{n.whenReady((({component:s})=>{const r=e(s),o="function"==typeof r?r.bind(s):r;n.get(Uh).produce(o,t)}))}))}}})))}const Bh={setup(t){t.provide({a:Dh,is:wc})}};class Wh extends Kt{constructor(){super("theme-style")}grow(t){const e=new Map;I(t.seed,(t=>{let n,s,r;"function"==typeof t?(n=s=t,r=!0):(n=t.style,s=t.provide.bind(t),r=!1);const o=e.get(n);if(o){const[t,i]=o;e.set(n,[r?Vh(s,t):Vh(t,s),r||i])}else e.set(n,[s,r])})),!e.size&&t.hasFallback||t.insert((function(t){const n=e.get(t);if(!n)return t;const[s,r]=n;return r?s:Vh(t,s)}))}}const Ih=new Wh;function Vh(t,e){return n=>Nc(t(n),e(n))}const Hh=new jt("theme",{byDefault:ns((t=>new Jh(t.get(Ih))))});class Gh{static get[xt](){return Hh}ref(t){return t(this.root)}}class Jh extends Gh{constructor(t){var e;super(),this._styles=t,this.root=new Ac(void 0,Ec,[],e?t=>gu(t,e):void 0),this._rules=new Map}style(...t){const e=this;return Lc(...t.reduce((function(t,n){const s=e._rules.get(n);if(s)t.push(s);else{const s=e._styles(n)(e);e._rules.set(n,s),t.push(s)}return t}),[]))}}const Zh=new Zt("https://wesib.github.io/examples","bex","wesib-examples"),Qh=Pc.by({$:"settings"},{$color:new Wi({r:161,g:185,b:142}),$bgColor:new Wi({r:40,g:43,b:36}),$fontFace:"'Exo 2', sans-serif",$fontSize:du.of(1,"em"),$lineHeight:1.2,$fontWeight:"400",$linkFontWeight:"600",$layoutBreakpoint:lu.of(576,"px")});function Xh({$layoutBreakpoint:t}){return{"@media:sm":`(max-width: ${t})`}}function Yh(t){const e=t.ref(Qh).read,{root:{rules:n}}=t;return Nc(n.add({e:"a"},e.do(Le(tl))),n.add({e:"a",s:":visited"},e.do(Le(tl))),n.add({e:"a",s:":hover"},{textDecoration:"underline"}),n.add({e:"a",s:":active"},{textDecoration:"underline dotted"}),n.add({e:"a",s:":focus"},{textDecoration:"underline dotted"}))}function tl({$color:t,$linkFontWeight:e}){return{color:t,fontWeight:e,textDecoration:"none"}}function el(t){const e=t.ref(Qh).read;return Nc(t.root.add(e.do(Le(nl))).add(e.do(Le(Xh))),t.style(Yh))}function nl({$color:t,$fontFace:e,$fontSize:n,$lineHeight:s,$fontWeight:r}){return{color:t,font:`normal ${r} ${n}/${s} ${e}`}}function sl(t){const e=t.ref(Qh).read,{root:{rules:n}}=t;return Nc(n.add({e:"html"},{height:"100%",margin:0,padding:0}),n.add({e:"body"},e.do(Le(rl))),t.style(el))}function rl({$bgColor:t}){return{backgroundColor:t,height:"100%",margin:0,padding:0}}const ol=Pc.by({$:"settings:form"},(t=>Fc.by({global:Qh},t).read.do(Le(il))));function il({global:{$color:t,$bgColor:e,$fontFace:n,$fontSize:s,$lineHeight:r,$fontWeight:o}}){return{$color:t,$bgColor:e.hsl.set((({l:t})=>({l:.8*t}))),$roBgColor:e.hsl.set((({l:t})=>({l:.94*t}))),$fontFace:n,$fontSize:s,$errorFontSize:s.mul(.8),$lineHeight:r,$fontWeight:o,$borderColor:e,$marginV:s.div(4),$marginH:s.div(4),$paddingV:s.div(2),$paddingH:s,$borderW:lu.of(1,"px")}}let ul=class{constructor(t){this._context=t}style(){return this._context.get(Gh).style(hl)}};var cl;t([qh()],ul.prototype,"style",null),ul=t([ks(["in-error",Zh],function(...t){return ks({define(e){const n=e.get(Pr);for(const e of t)if("string"==typeof e){const t=Tr(e);n.declareAttribute({name:t,change:Er(t)})}else for(const[t,s]of Object.entries(e)){const e=Tr(t);n.declareAttribute({name:e,change:Er(e,s)})}}})}("code"),(cl=({control:{control:t},aspects:e,context:n})=>function(t,e,n=Dr(e)){return new jr(t,e,n)}(n,"code").read.do(je((t=>t?t.trim().split(/\s+/):[]))).do(Le((s=>t.convert(vi.to(n.element),e).setup($i,(t=>{t.add(Ti()),t.add(Di({when:s}))}))))),ks({define(t){t.whenComponent((t=>{const{up:e}=t.get(wa);ve({parent:e.do(Ee((t=>t?t.get(Oh):Se({})))),aspects:t.get(Ch)}).do(Ee((({parent:[e],aspects:[n]})=>{if(e.control){const s=cl({control:e,context:t,aspects:n});if(s)return s instanceof bo?Se(s):s}return Se()})),Oe(((e,n)=>{if(!e)return;const s=Ah(t,e);return(n||e.supply).needs(s),s})))}))}})))],ul);const al=["has-error",ao];function hl(t){const e=t.ref(ol).read,{root:{rules:n}}=t,s=du.of(4,"px");return Nc(n.add({u:[":","host"],$:"bex:in-error"},e.do(Le((({$color:t,$errorFontSize:e})=>({display:"none",fontSize:e,padding:e.div(2),borderLeft:`${s} dotted ${t}`,paddingLeft:e.sub(s)}))))),n.add({u:[":","host",{c:[al,["touched",ao]],u:[":","not",{c:["has-focus",ao]}]}],$:"bex:in-error"},{display:"block"}),n.add({u:[":","host",{c:al,u:[[":","not",{u:["code","~=","missing"]}],[":","not",{u:["code","~=","incomplete"]}]]}],$:"bex:in-error"},{display:"block"}))}let ll=class{};ll=t([ds({needs:[ul]})],ll);let dl=class{};function fl({$fontSize:t}){return{flex:"1 1 auto",padding:0,margin:`0 0 0 ${t.div(2)}`}}dl=t([ks(["main",Zh],function(t={}){const e=t.onResponse?t.onResponse.bind(t):c,n=t.contentKey?t.contentKey.bind(t):kh;return ks({feature:{needs:[$h]},define(s){s.whenComponent((s=>{const{fragment:r,render:o}=t,i=s.get(Gs).document,u=s.get(Hr)(o),c=s.get(Ja);let h,l=n(c.page);h=r?a(r):()=>{const{element:{id:t,tagName:e}}=s;return t?{id:t}:{tag:e}},s.whenConnected((()=>{const t=i.createRange();t.selectNodeContents(s.contentRoot),c.read.do(We)((r=>{r.put(ph,{fragment:h(),receiver:{supply:(new _).needs(s),receive:(r,o)=>function(r){const o=n(r.page);if(o===l)return;if(!r.ok)return void u((()=>e({context:s,range:t,response:r})));l=o,u((()=>{t.deleteContents();const n=i.createDocumentFragment(),{fragment:o}=r;o&&(rh(o,n),t.insertNode(n)),e({context:s,range:t,response:r})}))}(o)}})}))}))}))}})}({onResponse({response:t,range:e}){t.ok||(e.deleteContents(),null==t.ok?e.insertNode(document.createTextNode("Loading...")):e.insertNode(document.createTextNode(`Error. ${t.error}`)))}}))],dl);let pl=class{constructor(t){this._theme=t.get(Gh)}style(){return this._theme.style(yl)}};t([qh()],pl.prototype,"style",null),pl=t([ks(["nav",Zh],function(t={}){const e=t.handle?t.handle.bind(t):function(t){const e=t.href?t.href.bind(t):nh;return({event:t,page:n,navigation:s})=>{const r=e(t);if(null==r)return;const o=t.target,i=n.url,u=new URL(r,o.ownerDocument.baseURI);u.origin===i.origin&&(t.preventDefault(),i.href!==u.href&&s.open(r).catch(console.error))}}(t),n=s(t.event||"click");return ks({define(t){t.whenComponent((t=>{t.whenConnected((()=>{const s=t.get(Ja);for(const r of n)t.on(r)((n=>{s.read.do(We)((r=>e({event:n,page:r,context:t,navigation:s})))}))}))}))}})}(),function(t={}){const{select:e="a",pick:n={all:!0,deep:!0}}=t;return ks({define(s){s.whenComponent((s=>{const r=function(t,e){const n=t.get(Hr),{render:s,active:r=eh}=e,o=Jt.name(r,t.get(Zs)),i=e.activate?e.activate.bind(e):c,u=(t,{node:e})=>{const{element:n}=e,{classList:s}=n;t?s.add(o):s.remove(o)};return t=>{const{element:e}=t.node,r=e[th]||(e[th]=n(s)),o=e=>{r((()=>u(e,t))),i(e,t)};let c;return o(!0),{supply(){const t=c=new _((()=>{c===t&&o(!1)}));return t}}}}(s,t),o=function(t){if(!t.weigh)return Za;return e=>{const n=t.weigh(e);if("number"==typeof n)return Se(e.node,n);let s=ke(n).do(Ze(((t,n)=>t(e.node,n))));return be((t=>{s({supply:(new _).needs(t.supply).whenOff((()=>{s=Se(e.node,0),s(t)})),receive:t.receive.bind(t)})}))}}(t),i=s.get(Ja),u=s.get(Pa);s.whenConnected((()=>{let t=new Map;i.read.do(Ge(s),Oe((i=>u.select(e,n).read.do(Ee((t=>xe(...gt(t,(t=>o({node:t,context:s,page:i})))))),Oe(((...e)=>{const n=function(t){let e=0,n=[];return t.forEach((([t,s])=>{s>e?(e=s,n=[t]):s===e&&n.push(t)})),n}(e),o=new Map,u=new _;return n.forEach((e=>{let n;const c=t.get(e);c?(o.set(e,c),n=c):(n=r({node:e,context:s,page:i}),o.set(e,n)),n.supply().needs(u)})),t=o,u}))))))}))}))}})}())],pl);function yl(t){const e=t.ref(Qh).read,{root:{rules:n}}=t;return Nc(n.add({u:[":","host"],$:"bex:nav"},e.do(Le(gl))),n.add({u:[":","host"],$:"bex:nav"},e.do(Le((t=>({flex:"0 1 200px",height:"100%",background:ml(t)}))))),n.add({u:[":","host"],$:["bex:nav","@media:sm"]},{flex:"0 1 100%"}),n.add([{u:[":","host"],$:"bex:nav"},{e:"a",$:"bex:nav"}],e.do(Le(_l))),n.add([{u:[":","host"],$:"bex:nav"},{e:"a",c:["active",eo],$:"bex:nav"}],e.do(Le(wl))))}function gl({$fontSize:t}){return{padding:0,margin:`0 ${t.div(2)} 0 0`}}function ml({$bgColor:t}){return t.hsl.set((({l:t})=>({l:.8*t})))}function _l(t){const{$fontSize:e}=t;return{display:"block",margin:0,padding:`${e.div(2)} ${e}`,border:0,outline:0,background:ml(t)}}function wl({$fontSize:t,$color:e,$bgColor:n}){const s=du.of(4,"px");return{background:n,borderLeft:`${s} solid ${e}`,paddingLeft:t.sub(s)}}let bl=class{constructor(t){this._context=t}async style(){const{elementDef:{name:t}}=await this._context.get(es).whenDefined(dl);return this._context.get(Gh).style(function(t){return e=>{const n=e.ref(Qh).read,{root:{rules:s}}=e;return Nc(s.add({u:[":","host"],$:"bex:container"},{height:"100%",display:"flex",flexFlow:"row wrap",alignItems:"stretch",alignContent:"flex-start"}).add(n.do(Le(Xh))),s.add({u:[":","host"],$:["bex:container","@media:sm"]},{height:"auto"}),s.add([{u:[":","host"],$:"bex:container"},{e:t,$:"bex:container"}],n.do(Le(fl))))}}(t))}};t([qh()],bl.prototype,"style",null),bl=t([ks({name:["container",Zh],feature:{needs:[dl,pl]}})],bl);let vl=class{};vl=t([ds({needs:[bl,$h,class{static get[us](){return Bh}}]})],vl);let xl=class{};xl=t([ds({setup(t){t.perComponent({a:Uh,as:jh})},init(t){t.whenReady((()=>{mc(t.get(Gh).style(sl),fc())}))}})],xl);let $l=class{};function kl(t){const e=t.ref(ol).read,{root:{rules:n}}=t;return Nc(n.add({e:"input"},e.do(Le(Sl))),n.add({e:"input",s:"[readonly]"},e.do(Le(Cl))),n.add({e:"input",s:"[disabled]"},e.do(Le(Cl))),n.add({e:"input",s:":focus"},e.do(Le(Ol))),n.add({e:"input",c:[["invalid",ao],["touched",ao]]},e.do(Le(Al))),n.add({e:"input",c:[["missing",ao],["touched",ao]]},{outlineStyle:"dotted"}),n.add({e:"input",c:[["incomplete",ao],["touched",ao]]},{outlineStyle:"dotted"}))}function Sl({$color:t,$fontFace:e,$fontSize:n,$lineHeight:s,$fontWeight:r,$marginV:o,$marginH:i,$paddingV:u,$paddingH:c,$bgColor:a,$borderColor:h,$borderW:l}){return{color:t,font:`normal ${r} ${n}/${s} ${e}`,padding:`${u} ${c}`,margin:`${o} ${i}`,backgroundColor:a,border:"0 none",outline:`${l} solid ${h}`,boxShadow:"inset 1px 1px 2px -2px black",boxSizing:"border-box",width:"100%"}}function Cl({$roBgColor:t}){return{backgroundColor:t}}function Ol({$color:t,$borderColor:e}){return{outlineColor:Zi(e,t,.5)}}function Al({$color:t,$borderW:e,$borderColor:n}){return{outline:`${e.mul(2)} dashed ${Zi(n,t,.25)}`}}$l=t([ds({needs:[xl,ll,vl]})],$l);const Dl=function(...t){const e=js.create(),{bootstrapContext:n,complete:s}=function(t){const e=un(0),n=t.values;class s extends es{constructor(){super(),this.get=n.get,this.whenReady=e.read.do(Qe((t=>!!t&&this)),Ie),t.provide({a:Zs,by:te}),t.provide({a:es,is:this})}whenDefined(t){return function(t,e){if(e.hasOwnProperty(Or))return e[Or];const n=Fe(Promise.resolve(t.whenReady).then((()=>t.get(ur).whenDefined(e))).then((()=>or(e))));return e[Or]=n}(this,t)}load(e,n){const s=Cr.of(e),r=t.provide(s);n?r.needs(n):n=r;const o=function(t,e){const n=un({feature:t,ready:!1});return e.read((({module:t,ready:e})=>{const s=t.feature,r=n.it;r&&r.feature===s&&r.ready===e||(n.it={feature:s,ready:e})})).needs(e),n.supply.needs(e),n.read}(e,this.get(s).use(n));return{read:o,whenReady:o.do(Xe((t=>t.ready&&t)),Ie),[ee]:a(o),supply:r}}}return{bootstrapContext:new s,complete(){e.it=1}}}(e),r=1===t.length?t[0]:(o=t,ls.define(class{},{needs:o}));var o;return n.load(r).read.do(Xe((({ready:t})=>t)),Ie).then(s).catch(console.error),n}($l);export{Ur as A,Gs as B,ks as C,el as D,Zh as E,ol as F,vi as I,qh as P,Gr as R,Gh as T,cn as V,to as a,Qh as b,Pa as c,Qo as d,ve as e,Ch as f,Ge as g,Oe as h,Sl as i,hi as j,si as k,ci as l,Le as m,$i as n,Ti as o,Ah as p,$l as q,Cl as r,Nc as s,kl as t,Dl as u};//# sourceMappingURL=common.bb52b1ff.js.map
