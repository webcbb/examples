function t(t){return t}function e(){}function s(t){return null!=t}function r(t){return()=>t}function n(...t){return()=>t}const i=Symbol("next-call");function o(t){const e=()=>e;return e[i]=(e,s)=>t(e,s),e}function u(t){return"function"==typeof t&&i in t}function c(t){return o((e,s)=>e.pass(s,t))}function h(...t){return o((e,s)=>e.call(s,t))}function a(t){return o((e,s)=>{for(const r of t)e.pass(s,r)})}const l=o(t=>t.skip());function f(t){return"length"in t}function d(t){return"reverse"in t}function p(t){return t[Symbol.iterator]()}function y(t){return function*(){yield*t}()}function g(t,e){const s={[Symbol.iterator]:t};if(!e)return s;const r=s;return r.reverse=e,r}function _(t){if(f(t))return m(t);if(d(t)){const e=t.reverse();return g(()=>p(e))}return m(Array.from(t))}function m(t){return g((function*(){for(let e=t.length-1;e>=0;--e)yield t[e]}))}function b(t,e){for(const s of t)e(s)}function v(t){return!!p(t).next().done}function w(t){return p(t).next().value}function O(t,e,s){let r=s;for(const s of t)r=e(r,s);return r}function k(t,e){return g((function*(){for(const s of t)e(s)&&(yield s)}))}function x(e,s=t){return g((function*(){for(const t of e)yield*s(t)}))}function A(t,e){return g((function*(){for(const s of t)yield e(s)}))}function S(s,...r){let n=[];const o=t=>{const s=t>=r.length,c=++t<r.length?r[t]:e,h=(e,r)=>{u(e)?e[i](o(t),c):s?n.push([r]):o(t).pass(c,e)};return{call(t,e){h(t(...e),e)},pass(t,e){h(t(e),e)},skip(){},iterate(t,e){n.push({*[Symbol.iterator](){for(const s of e){const e=n,r=[];try{n=r,h(t(s),s)}finally{n=e}for(const t of r)yield*t}}})}}};return o(0).iterate(r[0],s),x(n,t)}const $=["every","filter","flatMap","forEach","map","reduce","reverse","some"];class F{static none(){return T}static is(t){return $.every(e=>e in t)}static of(t){return F.is(t)?t:F.from(t)}static from(t){return E(()=>t,()=>_(t))}every(t){return function(t,e){for(const s of t)if(!e(s))return!1;return!0}(this,t)}filter(t){return E(()=>k(this,t),()=>k(this.reverse(),t))}flatMap(t){return E(()=>x(this,t),()=>x(this.reverse(),e=>_(t(e))))}forEach(t){b(this,t)}map(t){return E(()=>A(this,t),()=>A(this.reverse(),t))}reduce(t,e){return O(this,t,e)}reverse(){return E(()=>m(Array.from(this)),()=>this)}some(t){return function(t,e){for(const s of t)if(e(s))return!0;return!1}(this,t)}thru(...t){const e=S;return E(()=>e(this,...t))}}class j extends F{*[Symbol.iterator](){}reverse(){return this}}const T=new j;function E(t,e){return new class extends F{[Symbol.iterator](){return p(t())}reverse(){return e?F.from(g(()=>p(e()),()=>this)):super.reverse()}}}function D(t){return g((function*(){for(let e=0;e<t.length;++e)yield t[e]}),()=>m(t))}const z={*[Symbol.iterator](){},reverse(){return this}};function M(t){return D(Reflect.ownKeys(t))}function R(t){const e=M(t);function s(e){return A(e,e=>[e,t[e]])}return g(()=>p(s(e)),()=>s(e.reverse()))}const K=Symbol("context-key");class U{constructor(t){this.name=t}get[K](){return this}toString(){return`ContextKey(${this.name})`}}class q extends U{constructor(t){super(`${t.name}:seed`)}get seedKey(){return this}grow(t){const{seeder:e,seed:s}=t;return e.isEmpty(s)?t.byDefault(()=>s):s}}class C extends Error{constructor(t,e=`There is no value with key ${t}`){super(e),this.key=t}}function P(t){if(function(t){return"by"in t}(t)){if(!I(t))return t;const{a:e,by:s,with:r}=t;return{a:e,by:t=>s(...r.map(e=>t.get(e)))}}if(function(t){return"is"in t}(t)){const{a:e,is:s}=t;return{a:e,by:r(s)}}if(function(t){return"via"in t}(t)){const{a:e,via:s}=t;return{a:e,by:t=>t.get(s)}}if(function(t){return"as"in t}(t)){if(function(t){return!("a"in t)}(t)&&(t=function(t){return Object.assign(Object.assign({},t),{a:t.as})}(t)),!I(t)){const{as:e}=t;return{a:t.a,by:t=>new e(t)}}const{as:e,with:s}=t;return{a:t.a,by:t=>new e(...s.map(e=>t.get(e)))}}throw new TypeError(`Malformed context value specifier: ${t}`)}function I(t){return"with"in t}class L{}class N{constructor(t){this._seeds=new Map,this._initial=null==t?e:"function"==typeof t?t:e=>t.get(e)}provide(t){const{a:{[K]:{seedKey:e}},by:s}=P(t),[r]=this._seeding(e);return r.provide(s)}_seeding(t){const e=this._seeds.get(t);if(e)return e;const s=t.seeder(),r=[s,e=>s.seed(e,this._initial(t,e))];return this._seeds.set(t,r),r}seed(t,e){const[,s]=this._seeding(e);return s(t)}seedIn(t,e){return this.newValues(e).get.bind(t)}newValues(t=!0){if(!t&&this._nonCachedValues)return this._nonCachedValues;const e=new Map,s=this;class r extends L{get({[K]:r},n){const i=e.get(r);if(null!=i)return i;const[o,u]=function(t,e,r){const[n,i]=function(t,e){const{seedKey:r}=e,[n,i]=s._seeding(r);if(r!==e)return[n,t.get(r)];return[n,i(t)]}(t,e);let o=!1;const u={context:t,seeder:n,seed:i,byDefault:r&&"or"in r?()=>(o=!0,r.or):t=>{const s=t();if(null==s)throw new C(e);return s}};r&&"or"in r&&(u.or=r.or);return[e.grow(u),o]}(this,r,n);return t&&!u&&e.set(r,o),o}}return t?new r:this._nonCachedValues=new r}append(t){return new N((e,s)=>{const[r,n]=this._seeding(e);return r.combine(n(s),t.seed(s,e),s)})}}class V{constructor(){this._providers=[]}provide(t){return this._providers.push(t),()=>{const e=this._providers.indexOf(t);e>=0&&this._providers.splice(e,1)}}seed(e,s=F.from(z)){return F.from([s,Z(e,this._providers)]).flatMap(t)}isEmpty(t){return v(t)}combine(e,s){return F.from([e,s]).flatMap(t)}}class W extends q{seeder(){return new V}}class B extends U{constructor(t,e){super(t),this.seedKey=e||new W(this)}}class J extends B{constructor(t,{seedKey:s,byDefault:r=e}={}){super(t,s),this.byDefault=r}grow(t){const e=function(t){if(f(t))return t[t.length-1];if(d(t))return w(t.reverse());let e;for(const s of t)e=s;return e}(t.seed);return null!=e?e:t.byDefault(()=>this.byDefault(t.context,this))}}class Q extends B{constructor(t,{seedKey:e,byDefault:s=n()}={}){super(t,e),this.byDefault=s}grow(t){const e=Array.from(t.seed);return e.length?e:t.byDefault(()=>{const e=this.byDefault(t.context,this);if(e)return Array.from(e)})}}function Z(t,e){return F.from(D(e.map(t=>[t]))).map(e=>{if(e.length>1)return e[1];const s=e[0](t);return e.push(s),s}).filter(s)}const G=Symbol("after-event");function H(t){return G in t}const X=Symbol("events-supply");class Y{constructor(t=e){this._off=s=>{this._whenOff=t=>t(s),this._off=e,t(s)},this._whenOff=t=>{const e=this._off;this._off=s=>{e(s),t(s)}}}get isOff(){return this._off===e}get[X](){return this}off(t){return this._off(t),this}whenOff(t){return this._whenOff(t),this}cuts(t){return tt(t).needs(this),this}needs(t){return tt(t).whenOff(t=>this._off(t)),this}}function tt(t){return t[X]}function et(t){return new Y(t)}function st(t){let s;return s="function"==typeof t?{supply:et(),receive(e,...s){t(...s)}}:{supply:t.supply||et(),receive(e,...s){this.supply.isOff||t.receive(e,...s)}},s.supply.whenOff(()=>s.receive=e),s}function rt(t){let e=function s(r){let n=t;const i=[];e=t=>i.push(t);try{for(;;){n=nt(n,r);const t=i.shift();if(!t)break;r=t}}finally{e=s}};return(...t)=>e(t)}function nt(t,e){const s=[];for(const r of t){const t=s.length;s.push(r);const n={onRecurrent(e){s[t]=st({supply:r.supply,receive(t,...s){e(...s)}})}};r.receive(n,...e)}return s}class it{constructor(){const t=this._rcs=new Set;this.send=rt(t),this[X]=et(()=>{t.clear(),delete this._rcs})}get size(){return this._rcs?this._rcs.size:0}on(t){const e=st(t),s=e.supply.needs(this),{_rcs:r}=this;return r&&!s.isOff&&(r.add(e),s.whenOff(()=>r.delete(e))),s}done(t){return tt(this).off(t),this}}const ot=Symbol("on-event");function ut(t){return ot in t}class ct extends Y{get isOff(){return!0}off(){return this}whenOff(t){return t(),this}cuts(t){return tt(t).off(),this}needs(){return this}}const ht=new ct;function at(){return ht}function lt(t){const s=st(t);let r=rt([s]);return s.supply.whenOff(()=>r=e),(...t)=>r(...t)}function ft(t){return e=>t.to({supply:e.supply,receive:(t,...s)=>{e.receive(t,...s),e.supply.off()}})}function dt(t){const e=new it;let s,r;return n=>{if(e.size||(r=[],s=et(()=>r=void 0),t.to({supply:s,receive(t,...s){r&&(e.size?r=void 0:r.push(s)),e.send(...s)}})),n.supply.needs(s),e.on(n).whenOff(t=>{e.size||s.off(t)}),r){const t=lt(n);r.forEach(e=>t(...e))}}}function pt(t,s){return r=>{const n=[];t.to({supply:r.supply,receive(t,...o){const c=(o,h)=>{const a=o>=s.length;++o;const l=n[o];if(l){const t=l.supply;return l.supply=h,[l.chain,t]}const f=o<s.length?s[o]:e,d={chain:{call(t,e){p(t(...e),e)},pass(t,e){p(t(e),[e])},skip(){d.supply.off()},onEvent(t,e){const s=et().needs(d.supply);e[ot]().to({supply:s,receive(e,...r){p(t(...r),r,s)}})}},supply:h};return n[o]=d,[d.chain,at()];function p(e,s,n=d.supply){const[h,l]=c(o,et().needs(n));try{u(e)?e[i](h,f):a?r.receive(t,...s):h.pass(f,e)}finally{l.off()}}},[h,a]=c(0,et().needs(r.supply));try{h.call(s[0],o)}finally{a.off()}}})}}function yt(t,e,s){return r=>{s?t.to({supply:et().needs(e).cuts(s),receive:r.receive.bind(r)}):(r.supply.needs(e),t.to(r))}}function gt({supply:t}){t.off()}class _t{constructor(t){this._on=t}get F(){return this.to.bind(this)}[ot](){return this}to(t){if(!t)return this;const e=st(t),{supply:s}=e;return s.isOff||this._on(e),s}then(t,e){return function(t,e,s){return new Promise((r,n)=>{ft(t)({supply:et(s?t=>{try{r(s(t))}catch(t){n(t)}}:n),receive:e?(t,...s)=>{try{r(e(...s))}catch(t){n(t)}}:(t,e)=>r(e)})})}(this,t,e)}once(t){return(this.once=mt(ft(this)).F)(t)}tillOff(t,e){return mt(yt(this,t,e))}consume(t){let e=at();const s=et(t=>e.off(t));return this.to({supply:s,receive(s,...r){const n=e;try{e=tt(t(...r)||at())}finally{e!==n&&n.off()}}}),s}share(){return mt(dt(this))}thru(...t){return this.thru_(...t).share()}thru_(...t){return mt(pt(this,t))}}function mt(t){return new _t(t)}function bt(){throw new Error("No events to send")}class vt extends _t{constructor(t,e=bt){super(t),this._rcn=0,this._or=e}get F(){return this.to.bind(this)}[G](){return this}to(t){if(!t)return this;let s=e;const r=st(t);if(r.supply.isOff)return r.supply;const n=et().needs(r.supply);let i=!1;return this._on({supply:n,receive:(t,...e)=>{i=!0,this._last=e,s(t,...e)}}),++this._rcn,n.isOff&&!i||(r.receive({onRecurrent(t){s=(e,...s)=>t(...s)}},...this._last||(this._last=this._or())),s=(t,...e)=>r.receive(t,...e)),n.whenOff(t=>{--this._rcn||(this._last=void 0),r.supply.off(t)}),n}once(t){return(this.once=wt(ft(this)).F)(t)}tillOff(t,e){return wt(yt(this,t,e))}share(){return wt(dt(this))}keepThru(...t){return this.keepThru_(...t).share()}keepThru_(...t){return wt(pt(this,t))}}function wt(t,e){return new vt(t,e)}function Ot(t,e){return wt(e=>t[ot]().to(e),e)}function kt(t,e){return H(t)?t[G]():Ot(t,e)}function xt(t){const s=Object.keys(t);return wt((function(r){const{supply:n}=r,i=lt(r);let o=e;const u={};s.forEach(e=>{n.needs(t[e][G]().to((...t)=>{u[e]=t,o()}).needs(n))}),n.isOff||(o=()=>i(u))}),(function(){const e={};return s.forEach(s=>kt(t[s]).once((...t)=>e[s]=t)),[e]})).share()}function At(...t){return wt((function(s){const{supply:r}=s,n=lt(s);let i=e;const o=[];t.forEach((t,e)=>{r.needs(t[G]().to((...t)=>{o[e]=t,i()}).needs(r))}),r.isOff||(i=()=>n(...o))}),(function(){const e=[];return t.forEach(t=>kt(t).once((...t)=>e.push(t))),e})).share()}function St(...t){return wt(e,r(t))}function $t(t){return o((e,s)=>e.onEvent(s,kt(t)))}class Ft extends it{on(t){return(this.on=mt(t=>super.on(t)).F)(t)}[ot](){return this.on()}}const jt=mt(gt);function Tt(t){return ut(t)?t[ot]():t[G]()}function Et(...t){return t.length?mt(e=>{const{supply:s}=e;let r=t.length;const n=t=>{--r||s.off(t)},i=(t,...s)=>{e.receive(t,...s)};t.forEach(t=>Tt(t).to({supply:et(n).needs(s),receive:i}))}).share():jt}function Dt(t){return mt(e=>{const{supply:s}=e,r=lt(e),n=et();let i=0;const o=Tt(t).tillOff(s,n).thru_(t=>(++i,c(t)));let u=[],h=1,a=0;n.whenOff(t=>{i||s.off(t)}),function(t){return mt(e=>{const{supply:s}=e,r=lt(e);let n=0;t[ot]().to({supply:s,receive(t,e){const i=++n;Promise.resolve().then(()=>e).then(t=>r(t,i),t=>s.off(t))}})})}(o).to({supply:s,receive(t,s,o){const c=o-h;if(u[c]=s,++a,a>c){let t;a===u.length?(t=u,u=[]):t=u.splice(0,c+1),h+=t.length,a-=t.length,i-=t.length,r(...t),!i&&n.isOff&&e.supply.needs(n)}}})})}function zt(t){return Array.isArray(t)?t:[t]}class Mt{constructor(t){this._drop=t,this.emitter=new Ft,this._nested=new Map,this.emitter.on((t,e,s)=>{const r=(t=zt(t))[0],n=this._nested.get(r);n&&n.emitter.send(t.slice(1),e,s)})}on(t){const e=this.emitter.on(t);return et(t=>{e.off(t),this._dropIfEmpty()}).needs(e)}nest(t,e){const s=this._nested.get(t);if(s||e)return s;const r=new Mt(()=>this._remove(t));return this._nested.set(t,r),r}done(t){for(const e of this._nested.values())e.done(t);this.emitter.done(t)}_remove(t){this._nested.delete(t),this._dropIfEmpty()}_dropIfEmpty(){!this._nested.size&&this.emitter.size<=1&&this._drop()}}class Rt{constructor(){this._root=new Mt(e)}on(t,e){return this._entry(t).on(e)}send(t,e,s){this._root.emitter.send(t,e,s)}done(t,e){const s=this._entry(t,!0);s&&s.done(e)}_entry(t,e){let s=this._root;for(const r of t){const t=s.nest(r,e);if(!t)return;s=t}return s}}class Kt{constructor(t,e){this._trackers=t,this._path=e,this.update=(t,e,s)=>{this._trackers.send([...this._path,...zt(t)],e,s)}}get _tracker(){return this}onUpdate(t){return(this.onUpdate=mt(t=>this._trackers.on(this._path,t)).F)(t)}[ot](){return this.onUpdate()}track(t){return(t=zt(t)).length?new Kt(this._trackers,[...this._path,...t]):this}done(t){this._trackers.done(this._path,t)}}class Ut{constructor(){this._tracker=new Kt(new Rt,[])}onUpdate(t){return(this.onUpdate=this._tracker.onUpdate().F)(t)}[ot](){return this.onUpdate()}get update(){return this._tracker.update}track(t){const e=this._tracker.track(t);return e===this._tracker?this:e}done(t){this._tracker.done(t)}}class qt{constructor(){this._by=at()}read(t){return(this.read=wt(t=>{return this.on({supply:(e=t).supply,receive(t,s){e.receive({onRecurrent(e){t.onRecurrent(t=>e(t))}},s)}});var e},()=>[this.it]).F)(t)}[ot](){return this.on()}[G](){return this.read()}by(t,e){const s=t=>(H(t)?t[G]():t[ot]()).to(t=>this.it=t);if(this.byNone(),e){const r=t;this._by=Tt(r).consume((...t)=>{const r=e(...t);if(r)return s(r)})}else{const e=t;this._by=s(e)}return this._by.whenOff(()=>this._by=at()),this}byNone(t){return this._by.off(t),this}done(t){return tt(this).off(t),this}}class Ct extends qt{constructor(t){super(),this._it=t,this._on=new Ft}get[X](){return tt(this._on)}on(t){return(this.on=this._on.on().F)(t)}get it(){return this._it}set it(t){const e=this._it;e!==t&&(this._it=t,this._on.send(t,e))}}function Pt(t){return new Ct(t)}class It extends qt{constructor(t){super(),this._on=new Ft,this._it=t}on(t){return(this.on=this._on.on().F)(t)}get[X](){return tt(this._on)}get it(){return this._it}set it(t){const e=this.it;e!==t&&(this._it=t,this._on.send(t,e))}sync(t,e,s){let r,n,i=t=>c(this,t);"string"==typeof t?("in"===t&&(i=t=>c(t,this)),r=e,n=s):(r=t,n=e);const o=n;if(!o)return i(r);const u=r;return(H(u)?kt(u):Tt(u)).consume((...t)=>{const e=o(...t);return e&&i(e)});function c(t,e){const s=t.read(t=>{e.it=t}),r=e.on(e=>{t.it=e});return et(t=>{r.off(t),s.off(t)}).needs(s).needs(r)}}}class Lt{name(t,e){if("string"==typeof t)return t;const[s,r]=t;return r.name(e(r),s,this)}}class Nt extends Lt{applyAlias(t,e){return`${e}-${t}`}}const Vt=new Nt,Wt=new Nt;class Bt extends Lt{applyAlias(t,e){return`${e}:${t}`}}const Jt=new Bt;class Qt extends Lt{applyAlias(t,e){return`${t}@${e}`}}const Zt=new Qt;class Gt{constructor(t,...e){this.url=t,this.aliases=e}get alias(){return this.aliases[0]||"ns"}name(t,e,s=Vt){return s.applyAlias(e,t,this)}}function Ht(t){return"string"==typeof t||function(t){return Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&t[1]instanceof Gt}(t)}function Xt(t,e){if("string"==typeof t)return"string"==typeof e?Yt(t,e):e[1].url?-1:Yt(t,e[0]);const[s,{url:r}]=t;return"string"==typeof e?r?1:Yt(s,e):Yt(r,e[1].url)||Yt(s,e[0])}function Yt(t,e){return t<e?-1:t>e?1:0}function te(){const t=new Map,e=new Map;return function(s){const r=t.get(s.url);if(r)return r;const n=s.alias;let i=0;for(const r of[n,...s.aliases]){const n=e.get(r);if(!n)return t.set(s.url,r),e.set(r,1),r;i||(i=n)}const o=n+ ++i;return t.set(s.url,o),e.set(n,i),o}}class ee{constructor(){this._providers=Pt([])}provide(t){return this._providers.it=[...this._providers.it,t],()=>{const e=this._providers.it,s=e.indexOf(t);s>=0&&(this._providers.it=e.slice(0,s).concat(e.slice(s+1)))}}seed(t,e=St()){return this.combine(e,function(t,e){return e.read().keepThru(e=>e.length?$t(At(...A(A(D(e),e=>e(t)),se))):h(),re)}(t,this._providers))}isEmpty(){return!1}combine(t,e){return At(t,e).keepThru(re)}}function se(t){return null==t?St():function(t){return("object"==typeof t||"function"==typeof t)&&H(t)}(t)?kt(t):St(t)}function re(...t){return h(...x(t))}class ne extends q{seeder(){return new ee}}class ie extends U{constructor(t,e){super(t.name+":up"),this._key=t,this.grow=e}get seedKey(){return this._key.seedKey}}class oe extends U{constructor(t,e){super(t),this.seedKey=e||new ne(this)}createUpKey(t){return new ie(this,t)}}class ue extends oe{constructor(t,{seedKey:s,byDefault:r=e}={}){super(t,s),this.byDefault=r}get upKey(){return this}grow(t){return t.seed.keepThru((...e)=>{if(e.length)return c(e[e.length-1]);const s=t.byDefault(()=>{const e=this.byDefault(t.context,this);return e&&St(e)});return $t(null!=s?s:wt(()=>{throw new C(this)}))})}}class ce extends oe{constructor(t,{seedKey:s,byDefault:r=e}={}){super(t,s),this.byDefault=(t,e)=>r(t,e)||(()=>{throw new C(this)}),this.upKey=this.createUpKey(t=>t.seed.keepThru((...e)=>{if(e.length)return e[e.length-1];const s=()=>St(this.byDefault(t.context,this));return $t(t.byDefault(s)||s())}))}grow(t){let e;return t.context.get(this.upKey,"or"in t?{or:null!=t.or?St(t.or):t.or}:void 0).to(t=>e=t),(...t)=>e(...t)}}const he={by(t={}){let e;return{get node(){return t.node},get window(){return e||(e=t.window||t.node&&((s=t.node).ownerDocument||s).defaultView||window);var s},error(...e){t&&t.error?t.error(...e):console.error(...e)}}}};const ae=Symbol("render-q");class le{constructor(t,e){this.q=t,this.schedule=this.doSchedule,this.ref=e||[this,this]}static by(t,e){return t[ae]||(t[ae]=new le(t,e))}add(t){this.q.add(t)}doSchedule(t){this.schedule=()=>{};const e=[],s={get config(){return t},postpone(t){e.push(t)}};this.q.schedule(()=>{const t=this.reset();t.suspend(),this.exec(s),this.ref[1]=this.ref[0],e.forEach(s.postpone=t=>this.q.add(t)),this.exec(s),t.resume()})}exec(t){for(;;){const e=this.q.pull();if(!e)break;e(t)}}reset(){return this.ref[0]=le.by(this.q.reset(),this.ref)}suspend(){this.schedule=t=>{this.scheduled=t,this.schedule=()=>{}}}resume(){this.scheduled?this.doSchedule(this.scheduled):this.schedule=this.doSchedule}}function fe(t){return e=>{const s=he.by(e),r=le.by(t.newQueue(s)).ref;let n=[];return t=>{const[e,,i]=n,[o,u]=r;let c=e||u;if(e===u&&!i||e===o)n[1]=t;else{const e=n=[c=i?o:u,t];c.add(t=>{e[2]=!0;try{e[1]({get config(){return s},postpone(e){t.postpone(e)}})}catch(t){s.error(t)}})}c.schedule(s)}}}const de={by({schedule:t,replace:e=(()=>{})}){const s=[];return{schedule:t,add(t){s.push(t)},pull:()=>s.shift(),reset(){const s=de.by({schedule:t,replace:e});return e(s),s}}}},pe=new WeakMap;let ye=fe({newQueue({window:t}){const e=pe.get(t);if(e)return e;const s=de.by({schedule:e=>t.requestAnimationFrame(e),replace:e=>pe.set(t,e)});return pe.set(t,s),s}});function ge(t){return ye(t)}class _e extends _t{get F(){return this.to.bind(this)}to(t,e){if(!t)return this;const s=st(t),{supply:r}=s;return r.isOff||this._on(s,e),r}once(t,e){return(this.once=me(ft(this)).F)(t,e)}tillOff(t,e){return me(yt(this,t,e))}capture(t,e){return(this.capture=me((t,e)=>null==e?this.to(t,!0):"object"==typeof e&&null==e.capture?this.to(t,Object.assign(Object.assign({},e),{capture:!0})):this.to(t,e)).F)(t,e)}instead(t,e){return(this.instead=me((t,e)=>{const s=st(t);return this.to({supply:s.supply,receive(t,e){e.preventDefault(),s.receive(t,e)}},e)}).F)(t,e)}just(t,e){return(this.just=me((t,e)=>{const s=st(t);return this.to({supply:s.supply,receive(t,e){e.stopPropagation(),s.receive(t,e)}},e)}).F)(t,e)}last(t,e){return(this.last=me((t,e)=>{const s=st(t);return this.to({supply:s.supply,receive(t,e){e.stopImmediatePropagation(),s.receive(t,e)}},e)}).F)(t,e)}passive(t,e){return(this.passive=me((t,e)=>null==e?this.to(t,{passive:!0}):"boolean"==typeof e?this.to(t,{capture:e,passive:!0}):null==e.passive?this.to(t,Object.assign(Object.assign({},e),{passive:!0})):this.to(t,e)).F)(t,e)}}function me(t){return new _e(t)}var be;const ve={onRecurrent:e};class we{constructor(t){this[be]=et(),this._target=t}on(t){return me((e,s)=>{const{supply:r}=e;if(r.needs(tt(this)),!r.isOff){const r=t=>e.receive(ve,t);this._target.addEventListener(t,r,s),e.supply.whenOff(()=>this._target.removeEventListener(t,r))}})}dispatch(t){return!tt(this).isOff&&this._target.dispatchEvent(t)}done(t){return tt(this).off(t),this}}function Oe(t,e,s,r){var n,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,r);else for(var u=t.length-1;u>=0;u--)(n=t[u])&&(o=(i<3?n(o):i>3?n(e,s,o):n(e,s))||o);return i>3&&o&&Object.defineProperty(e,s,o),o}function ke({$:t,n:e,t:s,v:r,x:n=[],p:i={},pl:o=[]}){return{$:t,n:e,t:s,v:r,x:n,p:i,pl:o}}function xe({p:t,pl:e},s){const r=s.n||s.v,n=t[r];(!n||!n.n&&s.n)&&(t[r]=s),e.push(s)}function Ae(t){return e=>{const s=e.s[e.i];return e.d=t.delimiterOf(s),s}}be=X;const Se=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \d\d (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d\d\d\d \d\d:\d\d:\d\d GMT/;function $e(t,e){return t.s=t.s.substring(t.i),t.i=0,!!t.s.match(Se)&&(e(t.s.substring(t.i,t.i+=29)),!0)}const Fe=()=>!1;function je(t,{named:e=!0,tagged:s=!0,extra:r=!0,next:n=Ae(t)}={}){const i=function(t){return(e,s)=>{let r="";for(++e.i;e.i<e.s.length;++e.i){const n=e.s[e.i];if("\\"===n){const t=e.s[++e.i];r+=t||n}else{if(65536&t.delimiterOf(n))return++e.i,void s(r);r+=n}}s(r)}}(t),o=function(t){return(e,s)=>{if(!(262144&t.delimiterOf(e.s[e.i])))return!1;let r="";for(++e.i;e.i<e.s.length;){const s=e.s[e.i++];if(524288&t.delimiterOf(s))break;r+=s}return s(r),!0}}(t),u=r?je(t,{next:n,tagged:!1,named:!1,extra:!1}):Fe;return(t,r)=>{let c,h,a,l="",f="raw";for(;t.i<t.s.length;){const r=n(t);if(t.d){if(12&t.d)break;if(null==h){if(16&t.d){h=l?"":r,++t.i;continue}if(65536&t.d){!s&&l||i(t,t=>{l?(f="tagged-string",c=l):f="quoted-string",l="",h=t});break}if(!l&&o(t,t=>{f="angle-bracketed-string",h=t}))break;h=l,l=""}else{if(65536&t.d){!s&&h||i(t,t=>{h?(f="tagged-string",c=h):f="quoted-string",h=t});break}if(!h&&o(t,t=>{f="angle-bracketed-string",h=t}))break}}if(null==h){if(!l&&$e(t,t=>h=t)){f="date-time";break}e?l+=r:h=r}else{if(!h&&$e(t,t=>h=t)){f="date-time";break}h+=r}++t.i}if(null==h){if(!l)return!1;a=ke({$:f,v:l})}else a=ke({$:f,n:l||void 0,t:c,v:h});for(;u(t,t=>a.x.push(t)););return r(a),!0}}function Te(t){return e=>{let s=e.s[e.i];return"\\"!==s?(e.d=t.delimiterOf(s),s):(++e.i,e.i<e.s.length?(s=e.s[e.i],e.d=t.delimiterOf(s)?1:0):e.d=1,s)}}function Ee(t){return e=>{const s=e.i;do{const s=e.s[e.i];if(!(2&t.delimiterOf(s)))break;e.i++}while(e.i<e.s.length);return e.i!==s}}function De(t,e={}){const s=Ee(t),r=je(t,Object.assign(Object.assign({},e),{tagged:!1}));return(e,n)=>!!(8&t.delimiterOf(e.s[e.i]))&&(++e.i,s(e),r(e,n))}const ze={" ":7,"\t":7,",":5,";":9,'"':65569,"\\":33,"<":262145,">":524289,"=":17,"(":1,")":1,"/":1,":":1,"?":1,"@":1,"[":1,"]":1,"{":1,"}":1};function Me({delimit:t}={}){const e=t?Object.assign(Object.assign({},ze),t):ze;return{delimiterOf:t=>e[t]||(t>="\0"&&t<=" "||"\x7f"===t?1:0)}}const Re=Me(),Ke=Me({delimit:{":":17,"(":131105,")":37," ":3,"\t":3,"=":1,",":1}});function Ue(t){var e;const s=t?Me(t):Re,r=function(t){const e=Ee(t);return s=>!!(4&t.delimiterOf(s.s[s.i]))&&(s.i++,e(s),!0)}(s),n=De(s),i=je(s),o=(null===(e=t)||void 0===e?void 0:e.comments)?function(t){const e=Ee(t),s={next:Te(t)},r=je(t,s),n=De(t,s);return(s,i)=>{if(!(131072&t.delimiterOf(s.s[s.i])))return!1;let o;for(++s.i;e(s)||n(s,t=>{o||(o=ke({$:"raw",v:""})),xe(o,t)})||r(s,t=>o=t););return++s.i,i(o||ke({$:"raw",v:""})),!0}}(Ke):Fe;return t=>{const e=[],s={i:0,s:t};for(;s.i<s.s.length&&(r(s)||n(s,t=>{e.length||e.push(ke({$:"raw",v:""})),xe(e[e.length-1],t)})||o(s,t=>e.push(t))||i(s,t=>e.push(t))););return e}}const qe=Ue();function Ce(t){if(!t)return'""';let e,s=!1;for(let r=0;r<t.length;++r){const n=t[r],i=Re.delimiterOf(n);i?(32&i&&(e||(e=t.substring(0,r)),e+="\\"+n),s=!0):e&&(e+=n)}return s?`"${e||t}"`:t}var Pe={}.hasOwnProperty,Ie=/[ -,\.\/:-@\[-\^`\{-~]/,Le=/[ -,\.\/:-@\[\]\^`\{-~]/,Ne=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,Ve=function t(e,s){"single"!=(s=function(t,e){if(!t)return e;var s={};for(var r in e)s[r]=Pe.call(t,r)?t[r]:e[r];return s}(s,t.options)).quotes&&"double"!=s.quotes&&(s.quotes="single");for(var r="double"==s.quotes?'"':"'",n=s.isIdentifier,i=e.charAt(0),o="",u=0,c=e.length;u<c;){var h=e.charAt(u++),a=h.charCodeAt(),l=void 0;if(a<32||a>126){if(a>=55296&&a<=56319&&u<c){var f=e.charCodeAt(u++);56320==(64512&f)?a=((1023&a)<<10)+(1023&f)+65536:u--}l="\\"+a.toString(16).toUpperCase()+" "}else l=s.escapeEverything?Ie.test(h)?"\\"+h:"\\"+a.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(h)?"\\"+a.toString(16).toUpperCase()+" ":"\\"==h||!n&&('"'==h&&r==h||"'"==h&&r==h)||n&&Le.test(h)?"\\"+h:h;o+=l}return n&&(/^-[-\d]/.test(o)?o="\\-"+o.slice(1):/\d/.test(i)&&(o="\\3"+i+" "+o.slice(1))),o=o.replace(Ne,(function(t,e,s){return e&&e.length%2?t:(e||"")+s})),!n&&s.wrap?r+o+r:o};Ve.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},Ve.version="3.0.0";var We=Ve,Be=/[A-Z]/g,Je=/^ms-/,Qe={};function Ze(t){return"-"+t.toLowerCase()}function Ge(t){return We(t,{isIdentifier:!0})}function He(t){return Array.isArray(t)}function Xe(t){return!!t.length}class Ye{constructor(t){this.priority=t&&t.priority||0}important(){return this.prioritize(1)}usual(){return this.prioritize(0)}}function ts(t,e){return t===e||("object"==typeof t?t.is(e):"object"==typeof e&&e.is(t))}class es extends Ye{}class ss extends es{constructor(t,e){super(e),this.r=is(t.r,255),this.g=is(t.g,255),this.b=is(t.b,255),this.a=null!=t.a?os(t.a,1):1}get type(){return"rgb"}get rgb(){return this}get hsl(){const{a:t}=this,e=100*this.r/255,s=100*this.g/255,r=100*this.b/255,n=Math.max(e,s,r),i=Math.min(e,s,r),o=Math.round((n+i)/2);if(n===i)return new rs({h:0,s:0,l:o,a:t},this);const u=n-i,c=Math.round(o>50?100*u/(200-n-i):100*u/(n+i));let h;switch(n){case e:h=(s-r)/u+(s<r?6:0);break;case s:h=(r-e)/u+2;break;default:h=(e-s)/u+4}return h*=60,h=Math.round(h),new rs({h,s:c,l:o,a:t},this)}by(t){return ns.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new ss(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{r:e=this.r,g:s=this.g,b:r=this.b,a:n=this.a}=t;return new ss({r:e,g:s,b:r,a:n},this)}toString(){const t=`${this.r}, ${this.g}, ${this.b}`;return 1===this.a?`rgb(${t})`:`rgba(${t}, ${this.a})`}}class rs extends es{constructor(t,e){var s;super(e),this.h=(s=t.h,(s%=360)<0?360+s:s),this.s=os(t.s,100),this.l=os(t.l,100),this.a=null!=t.a?os(t.a,1):1}get type(){return"hsl"}get rgb(){const{a:t}=this,e=this.s/100,s=this.l/100;if(!e){const e=255*s;return new ss({r:e,g:e,b:e,a:t},this)}const r=s<.5?s*(1+e):s+e-s*e,n=2*s-r,i=this.h/360;return new ss({r:us(n,r,i+1/3),g:us(n,r,i),b:us(n,r,i-1/3),a:t},this)}get hsl(){return this}by(t){return ns.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.h===this.h&&t.s===this.s&&t.l===this.l&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new rs(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{h:e=this.h,s=this.s,l:r=this.l,a:n=this.a}=t;return new rs({h:e,s,l:r,a:n},this)}toString(){const t=`${this.h}, ${this.s}%, ${this.l}%`;return 1===this.a?`hsl(${t})`:`hsla(${t}, ${this.a})`}}const ns={by(t){if("object"==typeof t&&("rgb"===t.type||"hsl"===t.type))return t}};function is(t,e){return os(Math.round(t),e)}function os(t,e){return Math.max(Math.min(t,e),0)}function us(t,e,s){let r,n=s;return n<0?n+=1:n>1&&(n-=1),r=n<1/6?t+6*n*(e-t):n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t,255*r}function cs(t,e,s){const r=2*s-1,n=t.rgb,i=e.rgb,o=n.a-i.a,u=((r*o==-1?r:(r+o)/(1+r*o))+1)/2,c=1-u;return new ss({r:n.r*u+i.r*c,g:n.g*u+i.g*c,b:n.b*u+i.b*c,a:n.a*s+i.a*(1-s)},t)}class hs extends Ye{constructor(t){super(t),this.dim=t.dim}by(t){return this.dim.by(t)||this}toString(){return this.toFormula()}}const as={map(t,e){const s={},r={from:e,get(r){if(r in s)return s[r];const n=function(t){switch(typeof t){case"function":return t;case"object":return t.by.bind(t)}const e=typeof t;return s=>typeof s===e?s:t}(t[r])(e[r],this,r);return s[r]=n,n}};return b(M(t),t=>r.get(t)),s},by:t=>as.map.bind(void 0,t)};function ls(t){if(null==t)return[void 0,0];switch(typeof t){case"object":return[t,t.priority];case"string":if(t.endsWith("!important"))return[t.substring(0,t.length-"!important".length).trim(),1]}return[t,0]}class fs extends hs{constructor(t,e,s){super(s),this.val=t,this.unit=e}get type(){return"dimension"}toDim(t){const e=this.dim;if(t===e||t===e.pt||t===("%"===this.unit?t.pt:e.noPt))return this}is(t){return t===this||"object"==typeof t&&t.type===this.type&&this.unit===t.unit&&this.val===t.val&&this.priority===t.priority}prioritize(t){return this.priority===t?this:new fs(this.val,this.unit,{dim:this.dim,priority:t})}add(t,e){return"number"==typeof t&&(t=ds(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?ds(this.val+t.val,this.unit,this):gs(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=ds(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?ds(this.val-t.val,this.unit,this):gs(this,"-",t)}mul(t){return 1===t?this:ds(this.val*t,this.unit,this)}div(t){return 1===t?this:ds(this.val/t,this.unit,this)}negate(){return ds(-this.val,this.unit,this)}toFormula(){return this.val+this.unit}}function ds(t,e,s){return t?new fs(t,e,s):s.dim.zero.prioritize(s.priority||0)}class ps extends hs{constructor(t,e,s,r){super(r),this.left=t.usual(),this.op=e,this.right=s}get type(){return"calc"}is(t){return this===t||"object"==typeof t&&t.type===this.type&&(this.op===t.op&&this.left.is(t.left)&&ts(this.right,t.right)&&this.priority===t.priority)}add(t,e){return"number"==typeof t&&(t=ds(t,e,this)),gs(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=ds(t,e,this)),gs(this,"-",t)}mul(t){return ms(this,t)}div(t){return bs(this,t)}toString(){return"calc"+super.toString()}}class ys extends ps{constructor(t,e,s,r){super(t,e,s.usual(),r)}prioritize(t){return this.priority===t?this:new ys(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(!e)return;const s=this.right.toDim(t);return s?e===this.left&&s===this.right?this:new ys(e,this.op,s,{dim:t,priority:this.priority}):void 0}negate(){return"-"===this.op?new ys(this.right,this.op,this.left,this):new ys(this.left.negate(),"-",this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right.toFormula()})`}}function gs(t,e,s){return s.type?new ys(t,e,s,t):t}class _s extends ps{prioritize(t){return this.priority===t?this:new _s(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(e)return e===this.left?this:new _s(e,this.op,this.right,{dim:t,priority:this.priority})}mul(t){return("*"===this.op?ms(this.left,this.right*t):bs(this.left,this.right/t)).prioritize(this.priority)}div(t){return("/"===this.op?bs(this.left,this.right*t):ms(this.left,this.right/t)).prioritize(this.priority)}negate(){return new _s(this.left,this.op,-this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right})`}}function ms(t,e){return e?1===e?t.prioritize(t.priority):new _s(t,"*",e,t):t.dim.zero.prioritize(t.priority)}function bs(t,e){return 1===e?t.prioritize(t.priority):new _s(t,"/",e,t)}class vs extends hs{constructor(t,e){super(e),this._byPriority=t}get type(){return 0}toDim(t){return t.zero.prioritize(this.priority)}is(t){return this===t||("object"==typeof t?t.type===this.type&&t.priority===this.priority:0===t||"0"===t?0===this.priority:"0 !important"===t&&1===this.priority)}add(t,e){return"number"==typeof t&&(t=ds(t,e,this)),t.prioritize(this.priority)}sub(t,e){return"number"==typeof t&&(t=ds(t,e,this)),t.negate().prioritize(this.priority)}mul(){return this}div(){return this}negate(){return this}prioritize(t){return this._byPriority.get(t)}important(){return this._byPriority.important}usual(){return this._byPriority.usual}toFormula(){return"0"}}class ws{constructor(t){this.dim=t,this.usual=new vs(this,{dim:t}),this.important=new vs(this,{dim:t,priority:1})}get(t){switch(t){case 0:return this.usual;case 1:return this.important}return new vs(this,{dim:this.dim,priority:t})}}function Os({pt:t,noPt:e}){const s={get zero(){return r},get pt(){return t()},get noPt(){return e()},of(t,e){return t?new fs(t,e,{dim:this}):r},by(t){if(!function(t){return"object"==typeof t&&("dimension"===t.type||"calc"===t.type||0===t.type)}(t))return;return t.toDim(this)}},r=new ws(s).usual;return s}const ks=Os({pt:()=>xs,noPt:()=>ks}),xs=Os({pt:()=>xs,noPt:()=>ks});class As extends Ye{constructor(t,e){super(e),this.url=t}get type(){return"url"}static by(t){switch(typeof t){case"string":{const[e,s]=ls(t);return new As(e,{priority:s})}case"object":if("url"===t.type)return t}}by(t){return As.by(t)||this}prioritize(t){return t===this.priority?this:new As(this.url,{priority:t})}is(t){return"object"==typeof t&&"url"===t.type&&t.url===this.url&&t.priority===this.priority}toString(){return`url('${We(this.url)}')`}}const Ss=St({});function $s(){return Ss}function Fs(t,e){if(!e)return Ss;if("string"!=typeof e){if(H(e))return Ts(e);if(ut(e))return Ts(js(e));if("function"==typeof e){const s=e(t);if("string"!=typeof s){if(H(s))return Ts(s);if(ut(s))return Ts(js(s))}return St(Es(s))}}return St(Es(e))}function js(t){return kt(t,n({}))}function Ts(e){return kt(e).keepThru(Es,function(){let t;return e=>t&&function(t,e){const s=p(Ds(e));for(const[e,r]of Ds(t)){const{value:t}=s.next();if(!t||e!==t[0]||!ts(r,t[1]))return!1}return!s.next().value}(e,t)?l():t=Object.assign({},e)}(),t)}function Es(t){return"string"==typeof t?{$$css:t}:t}function Ds(t){return k(R(t),s)}function zs(t,e){return Ts(xt({base:t,addendum:e}).keepThru(({base:[t],addendum:[e]})=>function(t,e){return O(R(e),(t,[e,s])=>function(t,e,s){Ms(t[e])<=Ms(s)&&(delete t[e],t[e]=s);return t}(t,e,s),Object.assign({},t))}(t,e)))}function Ms(t){switch(typeof t){case"string":return t.endsWith("!important")?1:0;case"object":return t.priority}return 0}function Rs(t){return">"===t||"+"===t||"~"===t}function Ks(t){if(!He(t))return[Us(t)];const e=[];let s;for(const r of t){const t=s;let n;if(s&&(e.push(s),s=void 0),Rs(r)){if(s=r,!t)continue;n={}}else n=Us(r);e.push(n)}return s&&e.push(s,{}),e}function Us(t){return"string"==typeof t?t?{s:t}:{}:qs(t)}function qs(t){const e=t.ns||void 0,s=t.i||void 0,r=function(t){if(!t)return;if(Ht(t))return[t];const e=t.filter(t=>!!t);return Xe(e)?e.sort(Xt):void 0}(t.c),n=function(t){if(!t)return;if(function(t){return"string"!=typeof t[0]}(t)){const e=t.map(Cs);return Xe(e)?e:void 0}return[Cs(t)]}(t.u);return{ns:e,e:("*"!==t.e||!e&&!s&&!r&&n&&Ps(n[0]))&&t.e||void 0,i:s,c:r,u:n,s:t.s||void 0,$:Is(t.$)}}function Cs(t){if(!Ps(t))return t;if(t.length<3)return t;const[e,s,...r]=t;return He(r[0])?[e,s,...r.map(Ks)]:[e,s,Ks(r)]}function Ps(t){return t.length>1&&(":"===t[0]||"::"===t[0])}function Is(t){if(t)return Xe(t=He(t)?Array.from(new Set(x(t,Ns))).sort():Array.from(Ns(t)))?t:void 0}const Ls=new Set;function Ns(t){if(!t)return Ls;const e=t.indexOf("="),s=e<0?t:t.substring(0,e),r=new Set;let n;for(const t of s.split(":"))n?n+=":"+t:n=t,r.add(n);return e>=0&&r.add(t),r}const Vs=[[]];function Ws(t){if(!t.length)return Vs;let e,s=0;for(;;){const r=t[s++];if(!Rs(r))return[e?[e,r]:[r],t.slice(s)];e=r}}const Bs=[];function Js(t,e){return t&&e.every(e=>t.find(t=>function(t,e){if("string"==typeof t)return"string"==typeof e?t===e:!e[1].url&&e[0]===t;const[s,{url:r}]=t;return"string"==typeof e?!r&&s===e:s===e[0]&&r===e[1].url}(e,t)))}function Qs(t){return Ks(t)}const Zs={qualify:t=>`@${Ge(t)}`};function Gs(t){return Xs(t,Zs)}const Hs={};function Xs(t,{qualify:e,nsAlias:s=te()}=Hs){const r={qualify:e,nsAlias:s};return t.reduce((t,e)=>Rs(e)?t+e:(t&&!Rs(t[t.length-1])&&(t+=" "),t+function(t,{qualify:e,nsAlias:s}){const{ns:r,e:n,i,c:o,s:u,u:c,$:h}=t;let a=!1,l="";i&&(a=!0,l+=`#${Ge(Jt.name(i,s))}`);o&&(a=!0,l=o.reduce((t,e)=>`${t}.${Ge(Zt.name(e,s))}`,l));if(c){a=!0;const t={nsAlias:s};l=c.reduce((e,s)=>function(t,e,s){if(Ps(e)){if(t+=e[0]+e[1],e.length>2){t+="("+Xs(e[2],s);for(let r=3;r<e.length;++r)t+=","+Xs(e[r],s);t+=")"}return t}const[r,n,i,o]=e;t+="["+Ge(r),n&&(t+=n+We(i,{quotes:"double",wrap:!0}));o&&(t+=" "+o);return t+"]"}(e,s,t),l)}u&&(a=!0,l+=u);e&&h&&(l=h.reduce((t,s)=>t+e(s),l));if(r){const t=function(t,e){return"string"==typeof t?t:t.url?e(t):void 0}(r,s);l=t?`${t}|${n||"*"}${l}`:f()}else l=f();return l;function f(){return a?`${n?Wt.name(n,s):""}${l}`:`${n?Wt.name(n,s):"*"}${l}`}}(e,r)),"")}function Ys(t){return"cssRules"in t}class tr{constructor(t){this._rule=t}read(t){let e=this._rule.outer;for(;e;)t=zs(e.read().keepThru(rr),t),e=e.outer;return t}render(t,e){const{selector:s}=t;let{target:r}=t;if(!Ys(r))return void t.render(e);let n=r;const i=function(t){const e=new Map,s=[];for(const r of t)Rs(r)?s.push(r):s.push(ir(r,e));if(!e.size)return;return[e,Qs(s)]}(s);if(!i)return void t.render(e);const[o,u]=i;for(const t of o){const s=n.insertRule(`${er(e,t)}{}`,n.cssRules.length),i=n.cssRules[s];r=i,Ys(i)&&(n=i)}t.render(e,{target:r,selector:u})}}function er(t,[e,[s,r]]){let n="";const i=t=>{t&&(n&&(n+=" and "),n+=t)};for(const e of s){const[s]=ls(t[e]);i(s)}return i(r),n?`${e} ${n}`:e}const sr={order:-65535,create:t=>new tr(t)};function rr(t){return O(k(R(t),nr),(t,[e,s])=>(t[e]=s,t),{})}function nr(t){return"@"===String(t[0])[0]}function ir(t,e){const s=t.$;if(!s)return t;const r=[];for(const t of s)"@"===t[0]?or(e,t):r.push(t);return r.length===s.length?t:Xe(r)?Object.assign(Object.assign({},t),{$:r}):Object.assign(Object.assign({},t),{$:void 0})}function or(t,e){const s=e.indexOf("=");let r,n;s<0?r=e:(r=e.substring(0,s),n=e.substring(s+1));const i=r.indexOf(":"),o=i<0?r:r.substring(0,i),u=t.get(o);if(u){const[t,e]=u;t.add(r),n&&(u[1]=e?`${e} and ${n}`:n)}else t.set(o,[(new Set).add(r),n])}const ur={order:-65534,needs:sr,render(t,e){const s=t.styleSheet;let r=0,n=0;for(const[t,i]of R(e)){const e=String(t);if("@"===e[0]){const[t]=ls(i),o=cr(s,r,e,t);r+=o,n+=o;const u=As.by(t);u&&(n+=hr(s,n,e,u),n+=ar(s,n,e,u))}}t.render(e)}};function cr(t,e,s,r){if(!s.startsWith("@import:"))return 0;let n=`@import ${new As(s.substring("@import:".length))}`;return r&&(n+=" "+r),t.insertRule(n+";",e),1}function hr(t,e,s,r){return"@namespace"!==s?0:(t.insertRule(`@namespace ${r};`,e),1)}function ar(t,e,s,r){if(!s.startsWith("@namespace:"))return 0;const n=s.substring("@namespace:".length);return t.insertRule(`@namespace ${n} ${r};`,e),1}function lr(t,e){const s=t.addRule(),{style:r}=s;b(k(R(e),fr),([t,e])=>{const[s,n]=ls(e);r.setProperty(function(t){if(Qe.hasOwnProperty(t))return Qe[t];var e=t.replace(Be,Ze);return Qe[t]=Je.test(e)?"-"+e:e}(t),`${s}`,n>=1?"important":void 0)}),t.render(e,{target:s})}function fr(t){const[e,s]=t;if(null==s)return!1;const r=String(e)[0];return r>="a"&&r<="z"||r>="A"&&r<="Z"}function dr(t){if("function"==typeof t)return{create:()=>({render:t})};if(function(t){return"create"in t}(t))return{order:t.order,needs:t.needs,create:e=>function(t){return"function"==typeof t?{render:t}:t}(t.create(e))};const e=t.render.bind(t);return{order:t.order,needs:t.needs,create:()=>({render:e})}}function pr(t,e){const s=t.order||0,r=e.order||0;return s>r?1:s<r?-1:0}function yr(t,s={}){const{document:r=window.document,rootSelector:n={e:"body"},addStyleSheet:i=gr,scheduler:o=ge,nsAlias:u=te()}=s,{parent:c=r.head}=s,h=r.defaultView||window,a={nsAlias:u},l=function(t){const e=new Map;return s(t.renderer),e.delete(lr),[...e.values(),dr(lr)].sort(pr);function s(t){t&&(He(t)?t.forEach(r):r(t))}function r(t){if(e.has(t))return;const r=dr(t);e.set(t,r),s(r.needs)}}(s),f=O(A(t,y),(t,e)=>et().cuts(e).cuts(t),et());const d=function(){const e=et();return Tt(t).to({supply:e,receive:(t,s)=>{s.forEach(t=>y(t).needs(e))}})}();return et().needs(f).needs(d).cuts(f).cuts(d);function p(t,e,s){return new class{get document(){return r}get parent(){return c}get rule(){return t}get styleSheet(){return s.styleSheet}get target(){return s.target}get selector(){return s.selector}nsAlias(t){return u(t)}render(r,n){e(n?p(t,e,{styleSheet:s.styleSheet,target:n.target||s.target,selector:n.selector||s.selector}):this,r)}addRule(t=s.selector){const e=s.target;if(!Ys(e))return e;const r=e.insertRule(`${n=t,function(t,e){return Xs(Qs(t),e)}(n,a)}{}`,e.cssRules.length);var n;return e.cssRules[r]}}}function y(t){const[s,r]=function(t){const s=l.map(e=>e.create(t));return[s.reduce((t,e)=>e.read?kt(e.read(t)):t,t.read()),function t(r){return(n,i)=>{const o=r+1;let u;u=o===l.length?e:t(o);const c=p(n.rule,u,n);s[r].render(c,i)}}(0)]}(t);let u;const c=function(t){const e=t.selector;if(!e.length)return Qs(n);if(Rs(e[0]))return[...Qs(n),...e];return e}(t),a=o({window:h});return s.to((function(e){a(()=>{u&&function(t){for(;t.cssRules.length;)t.deleteRule(t.cssRules.length-1)}(u.styleSheet);const s=p(t,r,{get styleSheet(){return u||(u=i(s)),u.styleSheet},get target(){return this.styleSheet},selector:c});s.render(e)})})).whenOff((function(){a(()=>{const t=u;if(t)return u=void 0,t.remove()})}))}}function gr(t){const{document:e,parent:s}=t,r=e.createElement("style");return r.setAttribute("type","text/css"),r.append(e.createTextNode("")),s.append(r),{styleSheet:r.sheet,remove(){r.parentElement.removeChild(r)}}}function _r(t,e){const s=e.$$css;if(s){const r=t.addRule();r.style.cssText=s,t.render(e,{target:r})}else t.render(e)}const mr={order:-65535,needs:ur,render(t,e){const r=k(A(D(t.selector),t=>!Rs(t)&&t.ns&&"string"!=typeof t.ns?t.ns:null),s);function n(e,s){return e[`@namespace:${t.nsAlias(s)}`]=new As(s.url),e}t.render(v(r)?e:O(r,n,Object.assign({},e)))}};function br(t,e={}){return yr(t,Object.assign(Object.assign({},e),{renderer:vr(e.renderer)}))}function vr(t){const e=[sr,mr,ur,_r];return t&&(He(t)?e.push(...t):e.push(t)),e}class wr{[G](){return this.read()}add(t){return this.rules.add([],t)}clear(){return this.set()}}class Or{[G](){return this.read()}[ot](){return this.onUpdate()}}class kr extends Or{}class xr extends Or{constructor(e,s){super(),this._list=e,s?(this._buildList=()=>k(e,s),this._filterArray=t=>t.filter(s)):(this._buildList=()=>e,this._filterArray=t)}read(t){return(this.read=Ot(this.onUpdate().thru(r(this)),n(this)).F)(t)}onUpdate(t){return(this.onUpdate=mt(t=>{const e=this._ruleSet||(this._ruleSet=new Set(this._buildList()));Tt(this._list).to({supply:t.supply.whenOff(()=>this._ruleSet=void 0),receive:(s,r,n)=>{r=this._filterArray(r),((n=this._filterArray(n)).length||r.length)&&(n.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),t.receive(s,r,n))}})}).share().F)(t)}[Symbol.iterator](){return this._ruleSet?this._ruleSet.values():y(this._buildList())}grab(t){return Ar(this,t)}}function Ar(t,e){const s=function(t){return qs(t)}(e);return new xr(t,t=>function(t,e){if(!t.length)return!1;const s=t[t.length-1];return(!e.ns||s.ns===e.ns)&&((!e.e||s.e===e.e)&&((!e.i||s.i===e.i)&&(!(e.c&&!Js(s.c,e.c))&&!(e.$&&!Js(s.$,e.$)))))}(t.selector,s))}class Sr extends kr{constructor(t,e){super(),this._root=t,this.nested=e,this._updates=new Ft,this.self=function(t,e){const s=new Ft,r=[t];e.onUpdate((e,n)=>{n[0]===t&&(r.length=0,s.send([],[t]))}).cuts(s);return new xr(new class{[ot](){return s.on()}[Symbol.iterator](){return y(r)}})}(t,this)}read(t){return(this.read=Ot(this._updates.on().thru(r(this)),n(this)).F)(t)}onUpdate(t){return(this.onUpdate=this._updates.on().F)(t)}[Symbol.iterator](){return Fr(this._root)}grab(t){return Ar(this,t)}add(t,e){return function t(e,s,r,n){const[i,o]=Ws(s);if(!o)return e._spec.it=function(t,e){const s=t._spec.it;if(!e)return s;if(t.empty)return t=>Fs(t,e);return t=>zs(s(t),Fs(t,e))}(e,r),e;const u=Gs(i),c=e.rules.nested._rule(u);if(c)return t(c,o,r,n);const h=new Tr(e.root,[...e.selector,...i],i),a=t(h,o,r,!1);return e.rules.nested._add(u,h,n),a}(this._root,Qs(t),e,!0)}get(t){return this._get(Qs(t))}_get(t){const[e,s]=Ws(t);if(!s)return this._root;const r=this.nested._rule(Gs(e));return r?r.rules.get(s):void 0}watch(t){const e=Qs(t);return wt(t=>{const s=Pt({}),r=this.read().consume(()=>{const t=this._get(e);return t&&t.read(t=>s.it=t).whenOff(()=>s.it={})});return s.read(t).cuts(r)}).share()}_add(t,e){t.rules.onUpdate((t,e)=>this._updates.send(t,e)),e&&this._updates.send($r(t),[])}_remove(t){const e=$r(this._root);this._updates.send([],e),e.forEach(e=>{e.rules._updates.done(t),e._spec.done(t)})}}function $r(t){return Array.from(Fr(t))}function*Fr(t){yield t;for(const e of t.rules.nested)yield*$r(e)}class jr extends Or{constructor(t){super(),this._updates=new Ft,this._byKey=new Map,this._all=new Sr(t,this)}read(t){return(this.read=Ot(this._updates.on().thru(r(this)),n(this)).F)(t)}onUpdate(t){return(this.onUpdate=this._updates.on().F)(t)}[Symbol.iterator](){return this._byKey.values()}grab(t){return Ar(this,t)}_rule(t){return this._byKey.get(t)}_add(t,e,s){this._byKey.set(t,e),e.rules.onUpdate((s,r)=>{r[0]===e&&(this._byKey.delete(t),this._updates.send([],[e]))}),s&&this._updates.send([e],[]),this._all._add(e,s)}}class Tr extends wr{constructor(t,e,s,r=$s){super(),this._root=t||this,this._selector=e,this._key=s,this._spec=Pt(r),this._nested=new jr(this)}get root(){return this._root}get outer(){if(void 0!==this._outer)return this._outer;const t=function(t){let e=t.length-1;if(e<=0)return e?void 0:Bs;do{switch(--e,t[e]){case">":return t.slice(0,e);case"+":case"~":--e;continue;default:return t.slice(0,e+1)}}while(e>0)}(this.selector);return this._outer=t&&this.root.rules.get(t)||null}get selector(){return this._selector}get key(){return this._key}get empty(){return this._spec.it===$s}get rules(){return this._nested._all}read(t){return(this.read=this._spec.read().keepThru(t=>$t(t(this))).F)(t)}set(t){return this._spec.it=t?e=>Fs(e,t):$s,this}remove(t){return this.rules._remove(t),this}}const Er=[];function Dr(t){return new Tr(void 0,Er,[],t?e=>Fs(e,t):void 0)}class zr extends class{[G](){return this.read()}clear(){return this.set()}}{constructor(t,e,s){super(),this._root=t,this._selector=e,this._map=s}read(t){return(this.read=xt({ms:this._map(this._root),ps:this._root.rules.watch(this._selector)}).keepThru(({ms:[t],ps:[e]})=>c(as.map(t,e))).F)(t)}add(t){return this._root.rules.add(this._selector,t),this}set(t){return this._root.rules.add(this._selector).set(t),this}}const Mr={by(t,e){let s;return s="function"==typeof e?t=>Rr(e(t)):r(Rr(e)),e=>new zr(e,t,s)}};function Rr(t){return H(t)?t:St(t)}class Kr{constructor(t){this.refs=t}static by(t,e){const s={};for(const r of Object.keys(t))s[r]=t[r](e);return new Kr(s)}read(t){const e=xt(this.refs);return(this.read=e.keepThru(Ur).F)(t)}[G](){return this.read()}}function Ur(t){const e={};for(const s of Object.keys(t))e[s]=t[s][0];return e}const qr=new xr({[ot]:()=>jt,[Symbol.iterator]:()=>[][Symbol.iterator]()});function Cr(...t){return t.length?Nr(t.map(Pr)):qr}function Pr(t){return"function"==typeof t?function(t){let e;return{[Symbol.iterator]:()=>s()[Symbol.iterator](),[ot]:()=>s()[ot]()};function s(){return e||(e=Vr(t()))}}(t):Vr(t)}function Ir(...t){return t.length?Nr(t.map(Lr)):qr}function Lr(t){return"function"==typeof t?function(t){const e=new Set,s=mt(s=>{const r=Vr(t());Wr(r,e,s),r[ot]().to({supply:s.supply.whenOff(()=>e.clear()),receive(t,r,n){n.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),s.receive(t,r,n)}})}).share();return{[ot]:()=>s,[Symbol.iterator]:()=>e.values()}}(t):Vr(t)}function Nr(t){if(1===t.length){const e=t[0];return e instanceof Or?e:new xr(e)}return new xr({*[Symbol.iterator](){for(const e of t)yield*e},[ot]:()=>mt(e=>{t.forEach(t=>Tt(t).to({supply:et().needs(e.supply),receive(t,s,r){e.receive(t,s,r)}}))}).share()})}function Vr(t){return t instanceof wr?t.rules.self:ut(t)?t:function(t){const e=new Set,s=mt(s=>{let r=at();const{supply:n}=s;n.cuts(r).whenOff(()=>e.clear()),t.then(t=>{if(!n.isOff){const i=t instanceof wr?t.rules:t;Wr(i,e,s),r=Tt(i).to({receive(t,r,n){n.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),s.receive(t,r,n)}}).needs(n)}})}).share();return{[ot]:()=>s,[Symbol.iterator]:()=>e.values()}}(t)}function Wr(t,e,s){const r=[];if(b(t,t=>{r.push(t),e.add(t)}),r.length){const t=new it;t.on(s),t.send(r,[])}}class Br extends Set{constructor(t){super(),this._added=new Set(t),this._removed=new Set,this._added.forEach(t=>this.add(t))}add(t){return this.has(t)||(this._added.add(t),this._removed.delete(t),super.add(t)),this}delete(t){return!!super.delete(t)&&(this._added.delete(t),this._removed.add(t),!0)}clear(){this._added.clear(),this.forEach(t=>this._removed.add(t)),super.clear()}delta(t,e=[]){return Jr(this)(t,e),this}redelta(t){return("function"==typeof t?t:Jr(t))([...this._added],[...this._removed]),this}undelta(){return this._added.clear(),this._removed.clear(),this}}function Jr(t){return(e,s)=>{for(const e of s)t.delete(e);for(const s of e)t.add(s)}}const Qr=Symbol("in-aspect"),Zr={instance:null,convertTo:e};function Gr(t,e,s,r,n){return void 0===r&&(r=s(t,n)),{instance:r,convertTo:r=>Gr(r,e,s,void 0,t),attachTo:r=>Gr(r,e,s,t.aspect(e)||s(r))}}function Hr(t,e,s=null){return Gr(t,e,r(null),s)}function Xr(t){return{instance:t,convertTo(){return this}}}const Yr=new Gt("https://surol.github.io/input-aspects/ns","inasp","input-aspects"),tn={applyTo:()=>Xr(te())},en={get[Qr](){return tn},to:t=>({applyAspect:e=>e===tn?Xr(t):void 0})},sn={applyTo:()=>Xr(ge)},rn={get[Qr](){return sn},to:t=>({applyAspect:e=>e===sn?Xr(t):void 0})};function nn(t,...r){if(!t)return cn;const n=an(t);if(!r.length)return n;const i=A(r,an);return(t,r)=>{const o=n(t,r),u=O(x([[o],k(A(i,e=>e(t,r)),s)]),(t,e)=>e.applyAspect?s=>t(s)||e.applyAspect(s):t,e);return hn(o)?{applyAspect:u}:{set:o.set.bind(o),get:o.get.bind(o),applyAspect:u}}}function on(t){return t?(e=t,Array.isArray(e)?nn(...t):nn(t)):nn();var e}const un={applyAspect(){}};function cn(){return un}function hn(t){return!t.set}function an(t){return"function"==typeof t?t:r(t)}class ln extends qt{constructor(){super(...arguments),this._aspects=new Map}aspect(t){return this._aspect(t[Qr]).instance}setup(t,s=e){return Qr in t?s(this.aspect(t),this):t(this),this}convert(t,...e){return new fn(this,nn(t,...e))}_aspect(t){const e=this._aspects.get(t);if(e)return e;const s=this._applyAspect(t)||t.applyTo(this);return this._aspects.set(t,s),s}_applyAspect(t){}}class fn extends ln{constructor(e,s){super(),this._on=new Ft,this._supply=et().needs(e);let r,n=0;const i=s(e,this);let o,u,c;hn(i)?(o=t,u=t,c=t=>{const s=e._aspect(t);return s.attachTo?s.attachTo(this):s.convertTo(this)}):(o=i.set,u=i.get,c=t=>e._aspect(t).convertTo(this)),this._applyAspect=t=>{var e;return(null===(e=i.applyAspect)||void 0===e?void 0:e.call(i,t))||c(t)},this._it=Pt([o(e.it),0]),tt(this._it).needs(this._supply),this._it.on(([t],[e])=>{t!==e&&this._on.send(t,e)}).cuts(this._on),e.on(t=>{t!==r&&(this._it.it=[o(t),++n])}).cuts(this),this._it.on(([t,s])=>{if(s!==n){n=s,r=u(t);try{e.it=r}finally{r=void 0}}})}get[X](){return this._supply}get it(){return this._it.it[0]}set it(t){const[e,s]=this._it.it;t!==e&&(this._it.it=[t,s+1])}on(t){return(this.on=this._on.on().F)(t)}}class dn extends ln{constructor(t){super(),this._control=t}get[X](){return this._supply||(this._supply=et().needs(this._control))}get it(){return this._control.it}set it(t){this._control.it=t}on(t){return(this.on=this._control.on().F)(t)}}class pn extends ln{constructor({aspects:t}){super(),this._aspectConversion=on(t)(new dn(this),this)}_applyAspect(t){return this._aspectConversion.applyAspect(t)||super._applyAspect(t)}}const yn={applyTo:t=>Hr(t,gn)};class gn extends pn{static get[Qr](){return yn}_applyAspect(t){return t===yn?Hr(this,gn,this):super._applyAspect(t)}}const _n={applyTo:t=>Xr(new bn(t))};class mn{static get[Qr](){return _n}[ot](){return this.on()}[G](){return this.read()}}class bn extends mn{constructor(t){super(),this._control=t,this._map=new Map,this._on=new Ft,tt(this._on).needs(this._control)}add(t){const e=this._map.get(t);if(e)return e;const s=et(()=>{this._map.delete(t),this._on.send([],[t])});return this._map.set(t,s),this._on.send([t],[]),s.needs(this._control).needs(t.parent)}on(t){return(this.on=this._on.on().F)(t)}read(t){const e=()=>this._map.keys();return(this.read=Ot(this.on().thru(e),()=>[e()]).F)(t)}}const vn={applyTo:t=>Hr(t,wn)};class wn extends pn{static get[Qr](){return vn}_applyAspect(t){return t===vn?Hr(this,wn,this):super._applyAspect(t)}}const On={applyTo:t=>Gr(t,kn,t=>new Sn(t))};class kn{static get[Qr](){return On}[ot](){return this.on()}[G](){return this.read()}static hasData(t){return"off"!==t&&"-"!==t[0]}done(t){return this.own.done(t),this}}class xn extends qt{constructor(t){super(),this._tracker=Pt(t?function(t){return null!=t.getAttribute("disabled")?"off":null!=t.getAttribute("readonly")?"ro":"on"}(t.element):"on")}get[X](){return tt(this._tracker)}get it(){return this._tracker.it}set it(t){switch(t){case"off":case"ro":case"-on":case"-ro":break;default:t="on"}this._tracker.it=t}on(t){return(this.on=this._tracker.on().F)(t)}}class An{constructor(){this._all=new Set,this._on=new Ft;const t=Ot(this._on.on().thru(()=>this._all),n(this._all));this.read=t.keepThru(t=>$t(At(...t)),Fn)}add(t){const e=et(()=>{this._all.delete(t),this._on.send()});return this._all.add(t),this._on.send(),e}}class Sn extends kn{constructor(t){super(),this._control=t,this._derived=new An;const e=t.aspect(wn);this.own=new xn(e),tt(this.own).needs(t),this.derive(t.aspect(mn).read().keepThru_($n)),e&&this.read(t=>function(t,e){switch(e){case"off":t.setAttribute("disabled","");break;case"ro":case"-ro":t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly","");break;default:t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly",""),t.removeAttribute("readonly")}}(e.element,t))}read(t){let e="on";return(this.read=Ot(xt({derived:this._derived.read,own:this.own}).thru(({derived:[t],own:[s]})=>{let r;if("off"===s||"off"===t)r="off";else{let e=!1;"-"===s[0]&&(e=!0,s=s.substring(1)),"-"===t[0]&&(e=!0,t=t.substring(1)),r="ro"===t?"ro":s,e&&(r="-"+r)}return e===r?l():h(e=r)}),n(e)).F)(t)}on(t){let e="on";return(this.on=this.read().thru(t=>{const s=e;return s===t?l():h(e=t,s)}).F)(t)}derive(t){return this._derived.add(kt(H(t)?t:t(this._control)).tillOff(this._control)).needs(this._control)}}function $n(t){const e=Array.from(t);return e.length?$t(At(...e.map(({parent:t})=>t.aspect(kn))).keepThru_(Fn)):h("on")}function Fn(...t){return function(...t){let e=!1,s=!1;for(const r of t)switch(r){case"off":return"off";case"ro":e=!0;break;case"-on":s=!0;break;case"-ro":s=!0,e=!0}return s?e?"-ro":"-on":e?"ro":"on"}(...x(t))}const jn={applyTo:t=>Gr(t,Tn,t=>xt({value:t,mode:t.aspect(kn)}).keepThru(({value:[t],mode:[e]})=>kn.hasData(e)?h(t):h()))},Tn={get[Qr](){return jn}},En={applyTo:t=>Hr(t,Dn)};class Dn extends gn{static get[Qr](){return En}_applyAspect(t){return t===En?Hr(this,Dn,this):super._applyAspect(t)}}const zn={};class Mn{constructor(t){this._map=t}get(t){const e=this._map.get(t);return e&&e[0]}[Symbol.iterator](){return y(A(this._map.values(),([t])=>t))}entries(){return y(A(this._map.entries(),([t,[e]])=>[t,e]))}}class Rn{constructor(t){this._controls=t,this._supply=et(),this._map=new Map}set(t,e,s,r){const n=this._map.get(t);let i;if(e){i=et();const o=this.newEntry(t,e,i);let u=!0;n&&(n[0]===e?u=!1:r.push([t,n])),u?(this.modify().set(t,o),s.push([t,o])):this._map.set(t,o)}else i=at(),n&&(r.push([t,n]),this.modify().delete(t));return n&&n[1].off(zn),i}newEntry(t,e,s){return[e,et(e=>{e!==zn&&this._controls.remove(t)}).needs(this._supply).needs(s).whenOff(t=>s.off(t===zn?void 0:t))]}modify(){if(this._shot){const t=new Map;b(this._map.entries(),([e,s])=>t.set(e,s)),this._shot=void 0,this._map=t}return this._map}snapshot(){return this._shot||(this._shot=new Mn(this._map))}clear(){const t=[],e=[];return b(this._map.keys(),s=>this.set(s,void 0,t,e)),e}}class Kn extends class extends class{[ot](){return this.on()}[G](){return this.read()}}{remove(t){this.set(t,void 0)}}{constructor(t){super(),this._group=t,this._updates=new Ft;this._map=new Rn(this),this._map._supply.needs(t.read(t=>{this.read().once(e=>{const s=new Set;b(R(t),([t,r])=>{s.add(t);const n=e.get(t);n&&(n.it=r)}),b(e.entries(),([t,e])=>{s.has(t)||(e.it=void 0)})})}))}on(t){return(this.on=this._updates.on().thru((t,e)=>h(t.map(Un),e.map(Un))).F)(t)}read(t){return(this.read=Ot(this._updates.on().thru(()=>this._map.snapshot()),()=>[this._map.snapshot()]).F)(t)}set(t,e){const s=this._group,r=[],n=[];let i;return"object"==typeof t?(i=et(),b(R(t),([t,e])=>{this._map.set(t,e,r,n).needs(i)})):i=this._map.set(t,e,r,n),(r.length||n.length)&&(this._updates.send(r,n),r.length&&function(){let t;r.forEach(([e,[r,n]])=>{r.aspect(mn).add({parent:s}).needs(n).cuts(n);const i=r.it;if(t)t[e]=i;else{const r=s.it;r[e]!==i&&(t=Object.assign(Object.assign({},r),{[e]:i}))}}),t&&(s.it=t);r.forEach(([t,[e,r]])=>{e.read().tillOff(r).to(e=>{s.it[t]!==e&&(s.it=Object.assign(Object.assign({},s.it),{[t]:e}))}).cuts(r)})}()),i}clear(){const t=this._map.clear();t.length&&this._updates.send([],t)}}function Un([t,[e]]){return[t,e]}class qn extends Dn{constructor(t,e){super(e),this._model=Pt(t),this.controls=new Kn(this),tt(this).whenOff(()=>this.controls.clear())}get[X](){return tt(this._model)}get it(){return this._model.it}set it(t){this._model.it=t}on(t){return(this.on=this._model.on().F)(t)}_applyAspect(t){return t===Tn[Qr]?{instance:(s=this,xt({cs:s.controls,model:s,mode:s.aspect(kn)}).keepThru_(Cn)),convertTo:e}:super._applyAspect(t);var s}}function Cn({cs:[t],model:[e],mode:[s]}){if(!kn.hasData(s))return h();const r={};return b(t.entries(),([t,e])=>{r[t]=e.aspect(Tn)}),$t(xt(r).keepThru(t=>{const s=Object.assign({},e);return b(R(t),([t,[e]])=>{s[t]=e}),c(s)}))}function Pn(t,{aspects:e}={}){return new qn(t,{aspects:e})}const In=St();function Ln(){return In}function Nn(t){return H(t)?r(kt(t)):"function"==typeof t?e=>kt(t(e)):e=>e.read().keepThru(function(t,e){return()=>{const s=e.validate(t);return null==s?h():Array.isArray(s)?h(...s):h(s)}}(e,t))}const Vn={};class Wn{constructor(s){const r=new Ft,i=new Map,o=new Map;let u=e,c=e;this._messages=wt(s=>{const h=kt(r,n()).to(s).whenOff(()=>{u=e,c=e});c=(t,e)=>{const s=t.to((...e)=>{if(e.length)o.set(t,e);else if(!o.delete(t))return;u()}).needs(e).whenOff(s=>{s!==Vn&&e.off(s),o.delete(t)&&u()});h.whenOff(()=>s.off(Vn))},b(i.entries(),([t,e])=>c(t,e)),u=()=>{r.send(...x(o.values(),t))},o.size&&u()}).share().tillOff(s),this.from=t=>{const e=Nn(t)(s),r=et(()=>{i.delete(e)});return i.set(e,r),c(e,r),r.needs(s)}}[G](){return this._messages}}const Bn={applyTo:t=>Gr(t,Jn,(t,e)=>{const s=new Hn(t);if(e){const t=e.aspect(Jn);s.by(t.read().keepThru(t=>h(...t.messages())))}return s})};class Jn{static get[Qr](){return Bn}[G](){return this.read()}}const Qn={get ok(){return!0},messages:()=>[],has:()=>!1,hasBut:()=>!1,[Symbol.iterator]:()=>[][Symbol.iterator]()};class Zn{constructor(t){this._byCode=new Map,this._all=[],b(t,t=>{let e=!1;b(R(t),([s,r])=>{if(r){e=!0;const r=this._byCode.get(s);r?r.push(t):this._byCode.set(s,[t])}}),e&&this._all.push(t)})}get ok(){return!this._all.length}messages(t){return null==t?this._all:this._byCode.get(t)||[]}has(t){return null==t||this._byCode.has(t)}hasBut(...t){return this._all.some(e=>t.every(t=>!e[t]))}[Symbol.iterator](){return this._all[Symbol.iterator]()}}function Gn(...t){return t.length?new Zn(t):Qn}class Hn extends Jn{constructor(t){super(),this._messages=new Wn(t);const e=t.aspect(gn);e&&this._messages.from(function(t){return t.controls.read().keepThru(Xn,Yn)}(e))}by(...t){return this._messages.from(function(...t){const e=t.length;return 1===e?t[0]:e?e=>{const s=new Wn(e);return t.forEach(t=>s.from(t)),s}:Ln}(...t))}read(t){return(this.read=kt(this._messages).keepThru(Gn).F)(t)}}function Xn(t){return $t(At(...A(t,t=>t.aspect(Jn))))}function Yn(...t){return h(...x(A(t,t=>t[0])))}function ti(t){return t?t.read().keepThru(t=>t?h():{missing:"missing"}):ti}class ei extends wn{constructor(t,{aspects:e,get:s,set:r}){super({aspects:e}),this.element=t,this._input=new Ft;const n=this;this._get=s,this._set=r,this._value=this.it;const i=this._update=(t,e)=>o({value:t},e);function o(t,e){for(;;){let s;n._value=t.value,n._update=(e,r)=>{s=[Object.assign(Object.assign({},t),{value:e}),r]};try{n._input.send(t,e)}finally{n._update=i}if(!s)break;[t,e]=s}}this.events=new we(t),tt(this.events).needs(this),this.listenForInput(t=>o(t,this._value))}get[X](){return tt(this._input)}get it(){return this._get()}set it(t){const e=this.it;t!==e&&(this._set(t),this._update(this._get(),e))}input(e){return(this.input=Ot(this._input.on().thru(t),()=>[{value:this.it}]).F)(e)}on(t){return(this.on=this._input.on().thru(({value:t},e)=>t===e?l():h(t,e)).F)(t)}listenForInput(t){const e=e=>t({value:this.it,event:e});this.events.on("input").to(e),this.events.on("change").to(e)}}function si(t,{aspects:e}={}){return new ei(t,{get(){return this.element.value},set(t){this.element.value=t},aspects:e})}const ri={applyTo:t=>Gr(t,ni,t=>{const e=t.aspect(wn);return e&&new ii(e)})};class ni extends qt{static get[Qr](){return ri}}class ii extends ni{constructor(t){super();const{element:s,events:r}=t,n=s.getRootNode?s.getRootNode():s.ownerDocument;this._it=Pt(!!n&&n.activeElement===s),tt(this).needs(t),r.on("focus").to(()=>this._it.it=!0),r.on("blur").to(()=>this._it.it=!1),this.on({receive(t,r){t.onRecurrent(e),r?s.focus():s.blur()}})}get[X](){return tt(this._it)}get it(){return this._it.it}set it(t){this._it.it=t}on(t){return(this.on=this._it.on().F)(t)}}const oi={applyTo:t=>Gr(t,ui,t=>{const e=t.aspect(gn);return null!=e?new ai(e):new hi(t)})};class ui{static get[Qr](){return oi}[G](){return this.read()}}const ci={hasFocus:!1,touched:!1,edited:!1};class hi extends ui{constructor(t){super(),this._flags=Pt(ci),tt(this._flags).needs(t),this._flags.by(function(t,e){const s=e.aspect(wn);return xt({hasFocus:e.aspect(ni)||St(!1),edited:s?s.input().keepThru(({event:t})=>!!t):St(!1)}).keepThru(({hasFocus:[e],edited:[s]})=>function(t,e,s){t=e?Object.assign(Object.assign({},t),{hasFocus:e,touched:!0}):Object.assign(Object.assign({},t),{hasFocus:e});s&&(t=Object.assign(Object.assign({},t),{edited:s,touched:!0}));return t}(t.it,e,s))}(this._flags,t))}read(t){return(this.read=this._flags.read().F)(t)}markTouched(t=!0){const e=this._flags.it;return t?e.touched||(this._flags.it=Object.assign(Object.assign({},e),{touched:t})):e.touched&&(this._flags.it=Object.assign(Object.assign({},e),{touched:e.hasFocus,edited:!1})),this}markEdited(t=!0){const e=this._flags.it;return t?e.edited||(this._flags.it=Object.assign(Object.assign({},e),{touched:!0,edited:t})):e.edited&&(this._flags.it=Object.assign(Object.assign({},e),{edited:t})),this}}class ai extends ui{constructor(t){super(),this._container=t}read(t){return(this.read=(e=this._container,e.controls.read().tillOff(e).keepThru_(t=>$t(At(...function(t){return A(t,t=>t.aspect(ui))}(t))),li)).F)(t);var e}markEdited(t){return this._container.controls.read().once(e=>b(e,e=>e.aspect(ui).markEdited(t))),this}markTouched(t){return this._container.controls.read().once(e=>b(e,e=>e.aspect(ui).markTouched(t))),this}}function li(...t){const e={hasFocus:!1,touched:!1,edited:!1};return b(t,([{hasFocus:t,touched:s,edited:r}])=>{s&&(e.touched=!0),t&&(e.hasFocus=e.touched=!0),r&&(e.edited=e.touched=!0)}),e}const fi={applyTo(t){const e=t.aspect(wn);return e?Xr(e.element):Zr}},di={get[Qr](){return fi},to:(t=null)=>({applyAspect:e=>e===fi?Xr(t):void 0})},pi={applyTo:t=>({instance:new mi(t),convertTo:e})};class yi{static get[Qr](){return pi}[G](){return this.read()}}const gi=Symbol("reason");function _i(t){return t&&"object"==typeof t&&gi in t}class mi extends yi{constructor(t){super(),this._control=t,this._sources=Pt([new Map]);const e=t.aspect(di);e&&this.applyTo(e,this.schedule),tt(t).whenOff(t=>this.done(t))}get schedule(){return this._schedule||(this._schedule=vi(this._control,this._control.aspect(di)))}read(t){return(this.read=this._sources.read().tillOff(this._control).keepThru_(([t])=>$t(At(...t.keys())),(...t)=>{const e={};return t.forEach(([t])=>bi(t,e)),e}).F)(t)}track(t){return(this.track=wt(t=>{t.supply.needs(this._control);const e=new Br,s=new it;let r=!1;return s.on(t),this.read(t=>{const n=new Set(e),i=[];b(k(R(t),([,t])=>!!t),([t])=>{n.delete(t)||i.push(t)}),(!r||i.length||n.size)&&(e.delta(i,n),r=!0,e.redelta((t,e)=>s.send(t,e)).undelta())})}).F)(t)}specs(t){return kt(H(t)?t:t(this._control))}resolve(t){const e=this._control.aspect(en);return this.specs(t).keepThru((...t)=>{const s={};return t.forEach(t=>{Ht(t)?s[Zt.name(t,e)]=!0:bi(t,s)}),s})}add(t){const e=tt(this._control);if(e.isOff)return e;const s=et(),r=wt(e=>{const r=this.resolve(t).to({receive(t,...s){e.receive(t,...s)}});e.supply.whenOff(t=>{s.off({[gi]:t})}),s.needs(r).whenOff(t=>{_i(t)&&r.off(t[gi])})}).share(),[n]=this._sources.it;return n.set(r,s),s.whenOff(t=>{_i(t)||(n.delete(r),this._sources.it=[n])}),this._sources.it=[n],s.needs(e)}applyTo(t,e=vi(this._control,t)){const{classList:s}=t,r=new Br,n=()=>{r.redelta((t,e)=>{s.remove(...e),s.add(...t)}).undelta()};return this.track((t,s)=>{r.delta(t,s),e(n)}).whenOff(()=>{r.size&&(r.clear(),e(n))})}done(t){return b(this._sources.it[0].values(),e=>e.off(t)),this._sources.done(t),this}}function bi(t,e){b(R(t),([t,s])=>{null!=s&&(e[t]=s)})}function vi(t,e){return t.aspect(rn)({node:e})}const wi=[["has-error",Yr]];function Oi(t){return!t.ok}function ki({mark:t,when:e}={}){let s,r;return s=e?Array.isArray(e)?e.length?t=>e.every(e=>t.has(e)):Oi:t=>t.has(e):Oi,r=t?Array.isArray(t)?t.length?t:wi:[t]:wi,t=>t.aspect(Jn).read().keepThru(t=>s(t)?h(...r):h())}function xi({ns:t=Yr}={}){return e=>{const s=e=>[e,t];return xt({md:e.aspect(kn),vl:e.aspect(Jn),st:e.aspect(ui)}).keepThru(({md:[t],vl:[e],st:[{hasFocus:r,touched:n,edited:i}]})=>{const o=[];return kn.hasData(t)||o.push(s("disabled")),"ro"!==t&&"-ro"!==t||o.push(s("readonly")),e.ok||o.push(s("invalid")),e.has("missing")&&o.push(s("missing")),e.has("incomplete")&&o.push(s("incomplete")),r&&o.push(s("has-focus")),n&&o.push(s("touched")),i&&o.push(s("edited")),h(...o)})}}export{Wt as $,F as A,c as B,L as C,mt as D,te as E,e as F,ce as G,ge as H,Yr as I,we as J,tt as K,Et as L,Q as M,Gt as N,et as O,b as P,D as Q,Mr as R,ss as S,Ut as T,X as U,qt as V,x as W,G as X,Ht as Y,s as Z,Oe as _,xs as a,Ft as a0,kt as a1,Zt as a2,ot as a3,w as a4,Tt as a5,p as a6,st as a7,Dt as a8,a as a9,Ce as aa,qe as ab,Ot as ac,n as ad,at as ae,it as af,B as ag,Ir as ah,br as ai,Qs as aj,Dr as ak,ln as al,ue as am,nn as an,en as ao,rn as ap,Pn as aq,si as ar,Jn as as,ti as at,It as au,ks as b,Kr as c,di as d,yi as e,ki as f,O as g,K as h,xi as i,J as j,N as k,oe as l,cs as m,wt as n,St as o,yr as p,xt as q,h as r,Cr as s,Pt as t,$t as u,r as v,At as w,A as x,l as y,k as z};//# sourceMappingURL=lib.43b73b82.m.js.map
