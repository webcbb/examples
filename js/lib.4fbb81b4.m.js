function t(t){return t}function e(){}function n(t){return null!=t}function r(t){return()=>t}function s(...t){return()=>t}const i=Symbol("next-call");function o(t){const e=()=>e;return e[i]=(e,n)=>t(e,n),e}function u(t){return"function"==typeof t&&i in t}function c(t){return o((e,n)=>e.pass(n,t))}function a(...t){return o((e,n)=>e.call(n,t))}function h(t){return o((e,n)=>{for(const r of t)e.pass(n,r)})}const l=o(t=>t.skip());function f(t){return"length"in t}function d(t){return"reverse"in t}function p(t){return t[Symbol.iterator]()}function y(t){return function*(){yield*t}()}function g(t,e){const n={[Symbol.iterator]:t};if(!e)return n;const r=n;return r.reverse=e,r}function _(t){if(f(t))return m(t);if(d(t)){const e=t.reverse();return g(()=>p(e))}return m(Array.from(t))}function m(t){return g((function*(){for(let e=t.length-1;e>=0;--e)yield t[e]}))}function b(t,e){for(const n of t)e(n)}function v(t){return!!p(t).next().done}function w(t){return p(t).next().value}function O(t,e,n){let r=n;for(const n of t)r=e(r,n);return r}function k(t,e){return g((function*(){for(const n of t)e(n)&&(yield n)}))}function x(e,n=t){return g((function*(){for(const t of e)yield*n(t)}))}function S(t,e){return g((function*(){for(const n of t)yield e(n)}))}function A(n,...r){let s=[];const o=t=>{const n=t>=r.length,c=++t<r.length?r[t]:e,a=(e,r)=>{u(e)?e[i](o(t),c):n?s.push([r]):o(t).pass(c,e)};return{call(t,e){a(t(...e),e)},pass(t,e){a(t(e),e)},skip(){},iterate(t,e){s.push({*[Symbol.iterator](){for(const n of e){const e=s,r=[];try{s=r,a(t(n),n)}finally{s=e}for(const t of r)yield*t}}})}}};return o(0).iterate(r[0],n),x(s,t)}const $=["every","filter","flatMap","forEach","map","reduce","reverse","some"];class j{static none(){return T}static is(t){return $.every(e=>e in t)}static of(t){return j.is(t)?t:j.from(t)}static from(t){return D(()=>t,()=>_(t))}every(t){return function(t,e){for(const n of t)if(!e(n))return!1;return!0}(this,t)}filter(t){return D(()=>k(this,t),()=>k(this.reverse(),t))}flatMap(t){return D(()=>x(this,t),()=>x(this.reverse(),e=>_(t(e))))}forEach(t){b(this,t)}map(t){return D(()=>S(this,t),()=>S(this.reverse(),t))}reduce(t,e){return O(this,t,e)}reverse(){return D(()=>m(Array.from(this)),()=>this)}some(t){return function(t,e){for(const n of t)if(e(n))return!0;return!1}(this,t)}thru(...t){const e=A;return D(()=>e(this,...t))}}class E extends j{*[Symbol.iterator](){}reverse(){return this}}const T=new E;function D(t,e){return new class extends j{[Symbol.iterator](){return p(t())}reverse(){return e?j.from(g(()=>p(e()),()=>this)):super.reverse()}}}function M(t){return g((function*(){for(let e=0;e<t.length;++e)yield t[e]}),()=>m(t))}const z={*[Symbol.iterator](){},reverse(){return this}};function R(t){return M(Reflect.ownKeys(t))}function F(t){const e=R(t);function n(e){return S(e,e=>[e,t[e]])}return g(()=>p(n(e)),()=>n(e.reverse()))}const K=Symbol("context-key");class q{constructor(t){this.name=t}get[K](){return this}toString(){return`ContextKey(${this.name})`}}class P extends q{constructor(t){super(`${t.name}:seed`)}get seedKey(){return this}grow(t){const{seeder:e,seed:n}=t;return e.isEmpty(n)?t.byDefault(()=>n):n}}class U extends Error{constructor(t,e=`There is no value with key ${t}`){super(e),this.key=t}}function C(t){if(function(t){return"by"in t}(t)){if(!I(t))return t;const{a:e,by:n,with:r}=t;return{a:e,by:t=>n(...r.map(e=>t.get(e)))}}if(function(t){return"is"in t}(t)){const{a:e,is:n}=t;return{a:e,by:r(n)}}if(function(t){return"via"in t}(t)){const{a:e,via:n}=t;return{a:e,by:t=>t.get(n)}}if(function(t){return"as"in t}(t)){if(function(t){return!("a"in t)}(t)&&(t=function(t){return Object.assign(Object.assign({},t),{a:t.as})}(t)),!I(t)){const{as:e}=t;return{a:t.a,by:t=>new e(t)}}const{as:e,with:n}=t;return{a:t.a,by:t=>new e(...n.map(e=>t.get(e)))}}throw new TypeError(`Malformed context value specifier: ${t}`)}function I(t){return"with"in t}class N{}class V{constructor(t){this._seeds=new Map,this._initial=null==t?e:"function"==typeof t?t:e=>t.get(e)}provide(t){const{a:{[K]:{seedKey:e}},by:n}=C(t),[r]=this._seeding(e);return r.provide(n)}_seeding(t){const e=this._seeds.get(t);if(e)return e;const n=t.seeder(),r=[n,e=>n.seed(e,this._initial(t,e))];return this._seeds.set(t,r),r}seed(t,e){const[,n]=this._seeding(e);return n(t)}seedIn(t,e){return this.newValues(e).get.bind(t)}newValues(t=!0){if(!t&&this._nonCachedValues)return this._nonCachedValues;const e=new Map,n=this;class r extends N{get({[K]:r},s){const i=e.get(r);if(null!=i)return i;const[o,u]=function(t,e,r){const[s,i]=function(t,e){const{seedKey:r}=e,[s,i]=n._seeding(r);if(r!==e)return[s,t.get(r)];return[s,i(t)]}(t,e);let o=!1;const u={context:t,seeder:s,seed:i,byDefault:r&&"or"in r?()=>(o=!0,r.or):t=>{const n=t();if(null==n)throw new U(e);return n}};r&&"or"in r&&(u.or=r.or);return[e.grow(u),o]}(this,r,s);return t&&!u&&e.set(r,o),o}}return t?new r:this._nonCachedValues=new r}append(t){return new V((e,n)=>{const[r,s]=this._seeding(e);return r.combine(s(n),t.seed(n,e),n)})}}class W{constructor(){this._providers=[]}provide(t){return this._providers.push(t),()=>{const e=this._providers.indexOf(t);e>=0&&this._providers.splice(e,1)}}seed(e,n=j.from(z)){return j.from([n,Z(e,this._providers)]).flatMap(t)}isEmpty(t){return v(t)}combine(e,n){return j.from([e,n]).flatMap(t)}}class L extends P{seeder(){return new W}}class B extends q{constructor(t,e){super(t),this.seedKey=e||new L(this)}}class J extends B{constructor(t,{seedKey:n,byDefault:r=e}={}){super(t,n),this.byDefault=r}grow(t){const e=function(t){if(f(t))return t[t.length-1];if(d(t))return w(t.reverse());let e;for(const n of t)e=n;return e}(t.seed);return null!=e?e:t.byDefault(()=>this.byDefault(t.context,this))}}class Q extends B{constructor(t,{seedKey:e,byDefault:n=s()}={}){super(t,e),this.byDefault=n}grow(t){const e=Array.from(t.seed);return e.length?e:t.byDefault(()=>{const e=this.byDefault(t.context,this);if(e)return Array.from(e)})}}function Z(t,e){return j.from(M(e.map(t=>[t]))).map(e=>{if(e.length>1)return e[1];const n=e[0](t);return e.push(n),n}).filter(n)}const G=Symbol("after-event");function H(t){return G in t}const X=Symbol("events-supply");class Y{get[X](){return this}needs(t){return tt(t).whenOff(t=>this.off(t)),this}}function tt(t){return t[X]}function et(t=e){let n,r=s=>{n=t=>t(s),r=e,t(s)};n=t=>{const e=r;r=n=>{e(n),t(n)}};return new class extends Y{get isOff(){return r===e}off(t){return r(t),this}whenOff(t){return n(t),this}}}class nt extends Y{get isOff(){return!0}off(){return this}whenOff(t){return t(),this}}const rt=new nt;function st(){return rt}function it(t){let n;return n="function"==typeof t?{supply:et(),receive(e,...n){t(...n)}}:{supply:t.supply||et(),receive(e,...n){this.supply.isOff||t.receive(e,...n)}},n.supply.whenOff(()=>n.receive=e),n}const ot=Symbol("on-event");function ut(t){return ot in t}function ct(t){return e=>t({supply:e.supply,receive:(t,...n)=>{e.receive(t,...n),e.supply.off()}})}class at{constructor(){this._rcvs=new Set,this.send=function(t){let e=function n(r){let s=t;const i=[];e=t=>i.push(t);try{for(;;){s=ht(s,r);const t=i.shift();if(!t)break;r=t}}finally{e=n}};return(...t)=>e(t)}(this._rcvs),this[X]=et(t=>{this._rcvs.forEach(({supply:e})=>e.off(t))})}get size(){return this._rcvs.size}[ot](t){return this.on(t)}on(t){const e=it(t);return this._rcvs.add(e),e.supply.needs(this).whenOff(()=>this._rcvs.delete(e))}done(t){return tt(this).off(t),this}}function ht(t,e){const n=[];for(const r of t){const t=n.length;n.push(r);const s={onRecurrent(e){n[t]=it({supply:r.supply,receive(t,...n){e(...n)}})}};r.receive(s,...e)}return n}function lt(t){const e=new at;let n,r;return s=>{if(e.size||(r=[],n=et(()=>r=void 0),t({supply:n,receive(t,...n){r&&(e.size?r=void 0:r.push(n)),e.send(...n)}})),s.supply.needs(n),e.on(s).whenOff(t=>{e.size||n.off(t)}),r){const t=new at;t.on(s),r.forEach(e=>t.send(...e))}}}function ft(t,e,n){const r=tt(e);return e=>{if(n){const s=et().needs(r);n.needs(s),t({supply:s,receive:e.receive.bind(e)})}else e.supply.needs(r),t(e)}}class dt extends Function{get[ot](){return this}get once(){return pt(ct(this))}tillOff(t,e){return pt(ft(this,t,e))}consume(t){let e=st();const n=this((...n)=>{const r=e;try{e=t(...n)||st()}finally{e!==r&&r.off()}});return et(t=>{e.off(t),n.off(t)}).needs(n)}share(){return pt(lt(this))}thru(...t){return pt(lt(this.thru_(...t)))}thru_(...t){return function(t,n,r,s){return n(n=>{const o=[];t({supply:n.supply,receive(t,...c){const a=(c,h)=>{const l=c>=s.length;++c;const f=o[c];if(f){const t=f.supply;return f.supply=h,[f.chain,t]}const d=c<s.length?s[c]:e,p={chain:{call(t,e){y(t(...e),e)},pass(t,e){y(t(e),[e])},skip(){p.supply.off()},onEvent(t,e){const n=et().needs(p.supply);r(e)({supply:n,receive(e,...r){y(t(...r),r,n)}})}},supply:h};return o[c]=p,[p.chain,st()];function y(e,r,s=p.supply){const[o,h]=a(c,et().needs(s));try{u(e)?e[i](o,d):l?n.receive(t,...r):o.pass(d,e)}finally{h.off()}}},[h,l]=a(0,et().needs(n.supply));try{h.call(s[0],c)}finally{l.off()}}})})}(this,pt,yt,t)}}function pt(t){const e=e=>{const n=it(e),{supply:r}=n;return r.isOff||t(n),r};return Object.setPrototypeOf(e,dt.prototype),e}function yt(t){const e=ut(t)?t[ot]:t[G];return e instanceof dt?e:pt(e.bind(t))}const gt=pt(({supply:t})=>t.off());class _t{constructor(t){this._keeper=t}thru(...t){return this.thru_(...t).share()}thru_(...t){return vt(this._keeper.thru_(...t))}}class mt extends dt{get[G](){return this}get keep(){return new _t(this)}get once(){return bt(ct(this))}tillOff(t,e){return bt(ft(this,t,e))}share(){return bt(lt(this))}}function bt(t,n=Ot){let r,s=0;const i=i=>{let o=e;const u=it(i);if(u.supply.isOff)return u.supply;const c=et().needs(u.supply);let a=!1;return t({supply:c,receive(t,...e){a=!0,r=e,o(t,...e)}}),++s,c.isOff&&!a||(u.receive({onRecurrent(t){o=(e,...n)=>t(...n)}},...r||(r=n())),o=(t,...e)=>u.receive(t,...e)),c.whenOff(t=>{--s||(r=void 0),u.supply.off(t)}),c};return Object.setPrototypeOf(i,mt.prototype),i}function vt(t,e){if(!H(t))return function(t,e){return bt(e=>t[ot](e),e)}(t,e);const n=t[G];return n instanceof mt?n:bt(n.bind(t))}function wt(...t){return bt(()=>et(),r(t))}function Ot(){throw new Error("No events to send")}var kt;class xt extends at{constructor(){super(...arguments),this.on=pt(t=>super.on(t)),this[kt]=this.on}}function St(t){const n=Object.keys(t);return bt((function(r){const s=new at,i=s.on(r);let o=e;const u={};n.forEach(e=>{i.needs(t[e][G]((...t)=>{u[e]=t,o()}).needs(i))}),i.isOff||(o=()=>s.send(u))}),(function(){const e={};return n.forEach(n=>vt(t[n]).once((...t)=>e[n]=t)),[e]})).share()}function At(...t){return bt((function(n){const r=new at,s=r.on(n);let i=e;const o=[];t.forEach((t,e)=>{s.needs(t[G]((...t)=>{o[e]=t,i()}).needs(s))}),s.isOff||(i=()=>r.send(...o))}),(function(){const e=[];return t.forEach(t=>vt(t).once((...t)=>e.push(t))),e})).share()}function $t(t){return o((e,n)=>e.onEvent(n,vt(t)))}function jt(...t){return t.length?pt(e=>{const{supply:n}=e;let r=t.length;const s=t=>{--r||n.off(t)},i=(t,...n)=>{e.receive(t,...n)};t.forEach(t=>yt(t)({supply:et(s).needs(n),receive:i}))}).share():gt}function Et(t){return pt(e=>{const{supply:n}=e,r=new at;r.on(e);const s=et();let i=0;const o=yt(t).tillOff(n,s).thru_(t=>(++i,t));let u=[],c=1,a=0;s.whenOff(t=>{i||e.supply.off(t)}),function(t){return pt(e=>{const{supply:n}=e,r=new at;r.on(e);let s=0;t[ot]({supply:n,receive(t,e){const i=++s;Promise.resolve().then(()=>e).then(t=>r.send(t,i),t=>n.off(t))}})})}(o)({supply:n,receive(t,n,o){const h=o-c;if(u[h]=n,++a,a>h){let t;a===u.length?(t=u,u=[]):t=u.splice(0,h+1),c+=t.length,a-=t.length,i-=t.length,r.send(...t),!i&&s.isOff&&e.supply.needs(s)}}})})}function Tt(t){return Array.isArray(t)?t:[t]}kt=ot;class Dt{constructor(t){this._drop=t,this.emitter=new xt,this._nested=new Map,this.emitter.on((t,e,n)=>{const r=(t=Tt(t))[0],s=this._nested.get(r);s&&s.emitter.send(t.slice(1),e,n)})}on(t){const e=this.emitter.on(t);return et(t=>{e.off(t),this._dropIfEmpty()}).needs(e)}nest(t,e){const n=this._nested.get(t);if(n||e)return n;const r=new Dt(()=>this._remove(t));return this._nested.set(t,r),r}done(t){for(const e of this._nested.values())e.done(t);this.emitter.done(t)}_remove(t){this._nested.delete(t),this._dropIfEmpty()}_dropIfEmpty(){!this._nested.size&&this.emitter.size<=1&&this._drop()}}class Mt{constructor(){this._root=new Dt(e)}on(t,e){return this._entry(t).on(e)}send(t,e,n){this._root.emitter.send(t,e,n)}done(t,e){const n=this._entry(t,!0);n&&n.done(e)}_entry(t,e){let n=this._root;for(const r of t){const t=n.nest(r,e);if(!t)return;n=t}return n}}class zt{constructor(t,e){this._trackers=t,this._path=e,this.update=(t,e,n)=>{this._trackers.send([...this._path,...Tt(t)],e,n)},this.onUpdate=pt(t=>this._trackers.on(this._path,t))}get _tracker(){return this}get[ot](){return this.onUpdate}track(t){return(t=Tt(t)).length?new zt(this._trackers,[...this._path,...t]):this}done(t){this._trackers.done(this._path,t)}}class Rt{constructor(){this._tracker=new zt(new Mt,[])}get onUpdate(){return this._tracker.onUpdate}get[ot](){return this.onUpdate}get update(){return this._tracker.update}track(t){const e=this._tracker.track(t);return e===this._tracker?this:e}done(t){this._tracker.done(t)}}class Ft{constructor(){this._by=st(),this.read=bt(t=>{return this.on({supply:(e=t).supply,receive(t,n){e.receive({onRecurrent(e){t.onRecurrent(t=>e(t))}},n)}});var e},()=>[this.it])}get[ot](){return this.on}get[G](){return this.read}by(t,e){const n=t=>(H(t)?t[G]:t[ot])(t=>this.it=t);if(this.byNone(),e){const r=t;this._by=yt(r).consume((...t)=>{const r=e(...t);if(r)return n(r)})}else{const e=t;this._by=n(e)}return this._by.whenOff(()=>this._by=st()),this}byNone(t){return this._by.off(t),this}done(t){return tt(this).off(t),this}}class Kt extends Ft{constructor(t){super(),this._it=t,this._on=new xt}get on(){return this._on.on}get[X](){return tt(this._on)}get it(){return this._it}set it(t){const e=this._it;e!==t&&(this._it=t,this._on.send(t,e))}}function qt(t){return new Kt(t)}class Pt extends Ft{constructor(t){super(),this._on=new xt,this._it=t}get on(){return this._on.on}get[X](){return tt(this._on)}get it(){return this._it}set it(t){const e=this.it;e!==t&&(this._it=t,this._on.send(t,e))}sync(t,e,n){let r,s,i=t=>c(this,t);"string"==typeof t?("in"===t&&(i=t=>c(t,this)),r=e,s=n):(r=t,s=e);const o=s;if(!o)return i(r);const u=r;return(H(u)?vt(u):yt(u)).consume((...t)=>{const e=o(...t);return e&&i(e)});function c(t,e){const n=t.read(t=>{e.it=t}),r=e.on(e=>{t.it=e});return et(t=>{r.off(t),n.off(t)}).needs(n).needs(r)}}}class Ut{name(t,e){if("string"==typeof t)return t;const[n,r]=t;return r.name(e(r),n,this)}}class Ct extends Ut{applyAlias(t,e){return`${e}-${t}`}}const It=new Ct,Nt=new Ct;class Vt extends Ut{applyAlias(t,e){return`${e}:${t}`}}const Wt=new Vt;class Lt extends Ut{applyAlias(t,e){return`${t}@${e}`}}const Bt=new Lt;class Jt{constructor(t,...e){this.url=t,this.aliases=e}get alias(){return this.aliases[0]||"ns"}name(t,e,n=It){return n.applyAlias(e,t,this)}}function Qt(t){return"string"==typeof t||function(t){return Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&t[1]instanceof Jt}(t)}function Zt(t,e){if("string"==typeof t)return"string"==typeof e?Gt(t,e):e[1].url?-1:Gt(t,e[0]);const[n,{url:r}]=t;return"string"==typeof e?r?1:Gt(n,e):Gt(r,e[1].url)||Gt(n,e[0])}function Gt(t,e){return t<e?-1:t>e?1:0}function Ht(){const t=new Map,e=new Map;return function(n){const r=t.get(n.url);if(r)return r;const s=n.alias;let i=0;for(const r of[s,...n.aliases]){const s=e.get(r);if(!s)return t.set(n.url,r),e.set(r,1),r;i||(i=s)}const o=s+ ++i;return t.set(n.url,o),e.set(s,i),o}}class Xt{constructor(){this._providers=qt([])}provide(t){return this._providers.it=[...this._providers.it,t],()=>{const e=this._providers.it,n=e.indexOf(t);n>=0&&(this._providers.it=e.slice(0,n).concat(e.slice(n+1)))}}seed(t,e=wt()){return this.combine(e,function(t,e){return e.read.keep.thru(e=>e.length?$t(At(...S(S(M(e),e=>e(t)),Yt))):a(),te)}(t,this._providers))}isEmpty(){return!1}combine(t,e){return At(t,e).keep.thru(te)}}function Yt(t){return null==t?wt():function(t){return("object"==typeof t||"function"==typeof t)&&H(t)}(t)?vt(t):wt(t)}function te(...t){return a(...x(t))}class ee extends P{seeder(){return new Xt}}class ne extends q{constructor(t,e){super(t.name+":up"),this._key=t,this.grow=e}get seedKey(){return this._key.seedKey}}class re extends q{constructor(t,e){super(t),this.seedKey=e||new ee(this)}createUpKey(t){return new ne(this,t)}}class se extends re{constructor(t,{seedKey:n,byDefault:r=e}={}){super(t,n),this.byDefault=r}get upKey(){return this}grow(t){return t.seed.keep.thru((...e)=>{if(e.length)return c(e[e.length-1]);const n=t.byDefault(()=>{const e=this.byDefault(t.context,this);return e&&wt(e)});return $t(null!=n?n:bt(()=>{throw new U(this)}))})}}class ie extends re{constructor(t,{seedKey:n,byDefault:r=e}={}){super(t,n),this.byDefault=(t,e)=>r(t,e)||(()=>{throw new U(this)}),this.upKey=this.createUpKey(t=>t.seed.keep.thru((...e)=>{if(e.length)return e[e.length-1];const n=()=>wt(this.byDefault(t.context,this));return $t(t.byDefault(n)||n())}))}grow(t){let e;return t.context.get(this.upKey,"or"in t?{or:null!=t.or?wt(t.or):t.or}:void 0)(t=>e=t),(...t)=>e(...t)}}const oe={by(t={}){let e;return{get node(){return t.node},get window(){return e||(e=t.window||t.node&&((n=t.node).ownerDocument||n).defaultView||window);var n},error(...e){t&&t.error?t.error(...e):console.error(...e)}}}};const ue={by({schedule:t,replace:e=(()=>{})}){const n=[];return{schedule:t,add(t){n.push(t)},pull:()=>n.shift(),reset(){const n=ue.by({schedule:t,replace:e});return e(n),n}}}},ce=Symbol("scheduled-render-q");class ae{constructor(t,e){this.q=t,this.schedule=this.doSchedule,this.ref=e||[this]}static by(t,e){return t[ce]||(t[ce]=new ae(t,e))}add(t){this.q.add(t)}doSchedule(t){this.schedule=()=>{};const e={get config(){return t},postpone:t=>this.add(t)};this.q.schedule(()=>{const t=this.reset();t.suspend(),this.exec(e),t.resume()})}exec(t){for(;;){const e=this.q.pull();if(!e)break;e(t)}}reset(){return this.ref[0]=ae.by(this.q.reset(),this.ref)}suspend(){this.schedule=t=>{this.scheduled=t,this.schedule=()=>{}}}resume(){this.scheduled?this.doSchedule(this.scheduled):this.schedule=this.doSchedule}}function he(t){return e=>{const n=oe.by(e),r=ae.by(t.newQueue(n)).ref;let s=[];return t=>{const[e]=s,[i]=r;if(e===i)s[1]=t;else{const e=s=[i,t];i.add(t=>{try{e[1]({get config(){return n},postpone(e){t.postpone(e)}})}catch(t){n.error(t)}})}i.schedule(n)}}}const le=new WeakMap;let fe=he({newQueue({window:t}){const e=le.get(t);if(e)return e;const n=ue.by({schedule:e=>t.requestAnimationFrame(e),replace:e=>le.set(t,e)});return le.set(t,n),n}});function de(t){return fe(t)}class pe extends dt{get once(){return ye(ct(this))}tillOff(t,e){return ye(ft(this,t,e))}get capture(){return ye((t,e)=>null==e?this(t,!0):"object"==typeof e&&null==e.capture?this(t,Object.assign(Object.assign({},e),{capture:!0})):this(t,e))}get instead(){return ye((t,e)=>{const n=it(t);return this({supply:n.supply,receive(t,e){e.preventDefault(),n.receive(t,e)}},e)})}get just(){return ye((t,e)=>{const n=it(t);return this({supply:n.supply,receive(t,e){e.stopPropagation(),n.receive(t,e)}},e)})}get last(){return ye((t,e)=>{const n=it(t);return this({supply:n.supply,receive(t,e){e.stopImmediatePropagation(),n.receive(t,e)}},e)})}get passive(){return ye((t,e)=>null==e?this(t,{passive:!0}):"boolean"==typeof e?this(t,{capture:e,passive:!0}):null==e.passive?this(t,Object.assign(Object.assign({},e),{passive:!0})):this(t,e))}}function ye(t){const e=(e,n)=>{const r=it(e);return t(r,n),r.supply};return Object.setPrototypeOf(e,pe.prototype),e}var ge;const _e={onRecurrent:e};class me{constructor(t){this[ge]=et(),this._target=t}on(t){return ye((e,n)=>{const{supply:r}=e;if(r.needs(tt(this)),!r.isOff){const r=t=>e.receive(_e,t);this._target.addEventListener(t,r,n),e.supply.whenOff(()=>this._target.removeEventListener(t,r))}})}dispatch(t){return!tt(this).isOff&&this._target.dispatchEvent(t)}done(t){return tt(this).off(t),this}}function be(t,e,n,r){var s,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o}function ve({$:t,n:e,t:n,v:r,x:s=[],p:i={},pl:o=[]}){return{$:t,n:e,t:n,v:r,x:s,p:i,pl:o}}function we({p:t,pl:e},n){const r=n.n||n.v,s=t[r];(!s||!s.n&&n.n)&&(t[r]=n),e.push(n)}function Oe(t){return e=>{const n=e.s[e.i];return e.d=t.delimiterOf(n),n}}ge=X;const ke=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \d\d (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d\d\d\d \d\d:\d\d:\d\d GMT/;function xe(t,e){return t.s=t.s.substring(t.i),t.i=0,!!t.s.match(ke)&&(e(t.s.substring(t.i,t.i+=29)),!0)}const Se=()=>!1;function Ae(t,{named:e=!0,tagged:n=!0,extra:r=!0,next:s=Oe(t)}={}){const i=function(t){return(e,n)=>{let r="";for(++e.i;e.i<e.s.length;++e.i){const s=e.s[e.i];if("\\"===s){const t=e.s[++e.i];r+=t||s}else{if(65536&t.delimiterOf(s))return++e.i,void n(r);r+=s}}n(r)}}(t),o=function(t){return(e,n)=>{if(!(262144&t.delimiterOf(e.s[e.i])))return!1;let r="";for(++e.i;e.i<e.s.length;){const n=e.s[e.i++];if(524288&t.delimiterOf(n))break;r+=n}return n(r),!0}}(t),u=r?Ae(t,{next:s,tagged:!1,named:!1,extra:!1}):Se;return(t,r)=>{let c,a,h,l="",f="raw";for(;t.i<t.s.length;){const r=s(t);if(t.d){if(12&t.d)break;if(null==a){if(16&t.d){a=l?"":r,++t.i;continue}if(65536&t.d){!n&&l||i(t,t=>{l?(f="tagged-string",c=l):f="quoted-string",l="",a=t});break}if(!l&&o(t,t=>{f="angle-bracketed-string",a=t}))break;a=l,l=""}else{if(65536&t.d){!n&&a||i(t,t=>{a?(f="tagged-string",c=a):f="quoted-string",a=t});break}if(!a&&o(t,t=>{f="angle-bracketed-string",a=t}))break}}if(null==a){if(!l&&xe(t,t=>a=t)){f="date-time";break}e?l+=r:a=r}else{if(!a&&xe(t,t=>a=t)){f="date-time";break}a+=r}++t.i}if(null==a){if(!l)return!1;h=ve({$:f,v:l})}else h=ve({$:f,n:l||void 0,t:c,v:a});for(;u(t,t=>h.x.push(t)););return r(h),!0}}function $e(t){return e=>{let n=e.s[e.i];return"\\"!==n?(e.d=t.delimiterOf(n),n):(++e.i,e.i<e.s.length?(n=e.s[e.i],e.d=t.delimiterOf(n)?1:0):e.d=1,n)}}function je(t){return e=>{const n=e.i;do{const n=e.s[e.i];if(!(2&t.delimiterOf(n)))break;e.i++}while(e.i<e.s.length);return e.i!==n}}function Ee(t,e={}){const n=je(t),r=Ae(t,Object.assign(Object.assign({},e),{tagged:!1}));return(e,s)=>!!(8&t.delimiterOf(e.s[e.i]))&&(++e.i,n(e),r(e,s))}const Te={" ":7,"\t":7,",":5,";":9,'"':65569,"\\":33,"<":262145,">":524289,"=":17,"(":1,")":1,"/":1,":":1,"?":1,"@":1,"[":1,"]":1,"{":1,"}":1};function De({delimit:t}={}){const e=t?Object.assign(Object.assign({},Te),t):Te;return{delimiterOf:t=>e[t]||(t>="\0"&&t<=" "||"\x7f"===t?1:0)}}const Me=De(),ze=De({delimit:{":":17,"(":131105,")":37," ":3,"\t":3,"=":1,",":1}});function Re(t){var e;const n=t?De(t):Me,r=function(t){const e=je(t);return n=>!!(4&t.delimiterOf(n.s[n.i]))&&(n.i++,e(n),!0)}(n),s=Ee(n),i=Ae(n),o=(null===(e=t)||void 0===e?void 0:e.comments)?function(t){const e=je(t),n={next:$e(t)},r=Ae(t,n),s=Ee(t,n);return(n,i)=>{if(!(131072&t.delimiterOf(n.s[n.i])))return!1;let o;for(++n.i;e(n)||s(n,t=>{o||(o=ve({$:"raw",v:""})),we(o,t)})||r(n,t=>o=t););return++n.i,i(o||ve({$:"raw",v:""})),!0}}(ze):Se;return t=>{const e=[],n={i:0,s:t};for(;n.i<n.s.length&&(r(n)||s(n,t=>{e.length||e.push(ve({$:"raw",v:""})),we(e[e.length-1],t)})||o(n,t=>e.push(t))||i(n,t=>e.push(t))););return e}}const Fe=Re();function Ke(t){if(!t)return'""';let e,n=!1;for(let r=0;r<t.length;++r){const s=t[r],i=Me.delimiterOf(s);i?(32&i&&(e||(e=t.substring(0,r)),e+="\\"+s),n=!0):e&&(e+=s)}return n?`"${e||t}"`:t}var qe={}.hasOwnProperty,Pe=/[ -,\.\/:-@\[-\^`\{-~]/,Ue=/[ -,\.\/:-@\[\]\^`\{-~]/,Ce=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,Ie=function t(e,n){"single"!=(n=function(t,e){if(!t)return e;var n={};for(var r in e)n[r]=qe.call(t,r)?t[r]:e[r];return n}(n,t.options)).quotes&&"double"!=n.quotes&&(n.quotes="single");for(var r="double"==n.quotes?'"':"'",s=n.isIdentifier,i=e.charAt(0),o="",u=0,c=e.length;u<c;){var a=e.charAt(u++),h=a.charCodeAt(),l=void 0;if(h<32||h>126){if(h>=55296&&h<=56319&&u<c){var f=e.charCodeAt(u++);56320==(64512&f)?h=((1023&h)<<10)+(1023&f)+65536:u--}l="\\"+h.toString(16).toUpperCase()+" "}else l=n.escapeEverything?Pe.test(a)?"\\"+a:"\\"+h.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(a)?"\\"+h.toString(16).toUpperCase()+" ":"\\"==a||!s&&('"'==a&&r==a||"'"==a&&r==a)||s&&Ue.test(a)?"\\"+a:a;o+=l}return s&&(/^-[-\d]/.test(o)?o="\\-"+o.slice(1):/\d/.test(i)&&(o="\\3"+i+" "+o.slice(1))),o=o.replace(Ce,(function(t,e,n){return e&&e.length%2?t:(e||"")+n})),!s&&n.wrap?r+o+r:o};Ie.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},Ie.version="3.0.0";var Ne=Ie,Ve=/[A-Z]/g,We=/^ms-/,Le={};function Be(t){return"-"+t.toLowerCase()}function Je(t){return Ne(t,{isIdentifier:!0})}function Qe(t){return Array.isArray(t)}function Ze(t){return!!t.length}class Ge{constructor(t){this.priority=t&&t.priority||0}important(){return this.prioritize(1)}usual(){return this.prioritize(0)}}function He(t,e){return t===e||("object"==typeof t?t.is(e):"object"==typeof e&&e.is(t))}class Xe extends Ge{}class Ye extends Xe{constructor(t,e){super(e),this.r=nn(t.r,255),this.g=nn(t.g,255),this.b=nn(t.b,255),this.a=null!=t.a?rn(t.a,1):1}get type(){return"rgb"}get rgb(){return this}get hsl(){const{a:t}=this,e=100*this.r/255,n=100*this.g/255,r=100*this.b/255,s=Math.max(e,n,r),i=Math.min(e,n,r),o=Math.round((s+i)/2);if(s===i)return new tn({h:0,s:0,l:o,a:t},this);const u=s-i,c=Math.round(o>50?100*u/(200-s-i):100*u/(s+i));let a;switch(s){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;default:a=(e-n)/u+4}return a*=60,a=Math.round(a),new tn({h:a,s:c,l:o,a:t},this)}by(t){return en.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new Ye(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{r:e=this.r,g:n=this.g,b:r=this.b,a:s=this.a}=t;return new Ye({r:e,g:n,b:r,a:s},this)}toString(){const t=`${this.r}, ${this.g}, ${this.b}`;return 1===this.a?`rgb(${t})`:`rgba(${t}, ${this.a})`}}class tn extends Xe{constructor(t,e){var n;super(e),this.h=(n=t.h,(n%=360)<0?360+n:n),this.s=rn(t.s,100),this.l=rn(t.l,100),this.a=null!=t.a?rn(t.a,1):1}get type(){return"hsl"}get rgb(){const{a:t}=this,e=this.s/100,n=this.l/100;if(!e){const e=255*n;return new Ye({r:e,g:e,b:e,a:t},this)}const r=n<.5?n*(1+e):n+e-n*e,s=2*n-r,i=this.h/360;return new Ye({r:sn(s,r,i+1/3),g:sn(s,r,i),b:sn(s,r,i-1/3),a:t},this)}get hsl(){return this}by(t){return en.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.h===this.h&&t.s===this.s&&t.l===this.l&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new tn(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{h:e=this.h,s:n=this.s,l:r=this.l,a:s=this.a}=t;return new tn({h:e,s:n,l:r,a:s},this)}toString(){const t=`${this.h}, ${this.s}%, ${this.l}%`;return 1===this.a?`hsl(${t})`:`hsla(${t}, ${this.a})`}}const en={by(t){if("object"==typeof t&&("rgb"===t.type||"hsl"===t.type))return t}};function nn(t,e){return rn(Math.round(t),e)}function rn(t,e){return Math.max(Math.min(t,e),0)}function sn(t,e,n){let r,s=n;return s<0?s+=1:s>1&&(s-=1),r=s<1/6?t+6*s*(e-t):s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t,255*r}function on(t,e,n){const r=2*n-1,s=t.rgb,i=e.rgb,o=s.a-i.a,u=((r*o==-1?r:(r+o)/(1+r*o))+1)/2,c=1-u;return new Ye({r:s.r*u+i.r*c,g:s.g*u+i.g*c,b:s.b*u+i.b*c,a:s.a*n+i.a*(1-n)},t)}class un extends Ge{constructor(t){super(t),this.dim=t.dim}by(t){return this.dim.by(t)||this}toString(){return this.toFormula()}}const cn={map(t,e){const n={},r={from:e,get(r){if(r in n)return n[r];const s=function(t){switch(typeof t){case"function":return t;case"object":return t.by.bind(t)}const e=typeof t;return n=>typeof n===e?n:t}(t[r])(e[r],this,r);return n[r]=s,s}};return b(R(t),t=>r.get(t)),n},by:t=>cn.map.bind(void 0,t)};function an(t){if(null==t)return[void 0,0];switch(typeof t){case"object":return[t,t.priority];case"string":if(t.endsWith("!important"))return[t.substring(0,t.length-"!important".length).trim(),1]}return[t,0]}class hn extends un{constructor(t,e,n){super(n),this.val=t,this.unit=e}get type(){return"dimension"}toDim(t){const e=this.dim;if(t===e||t===e.pt||t===("%"===this.unit?t.pt:e.noPt))return this}is(t){return t===this||"object"==typeof t&&t.type===this.type&&this.unit===t.unit&&this.val===t.val&&this.priority===t.priority}prioritize(t){return this.priority===t?this:new hn(this.val,this.unit,{dim:this.dim,priority:t})}add(t,e){return"number"==typeof t&&(t=ln(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?ln(this.val+t.val,this.unit,this):pn(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=ln(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?ln(this.val-t.val,this.unit,this):pn(this,"-",t)}mul(t){return 1===t?this:ln(this.val*t,this.unit,this)}div(t){return 1===t?this:ln(this.val/t,this.unit,this)}negate(){return ln(-this.val,this.unit,this)}toFormula(){return this.val+this.unit}}function ln(t,e,n){return t?new hn(t,e,n):n.dim.zero.prioritize(n.priority||0)}class fn extends un{constructor(t,e,n,r){super(r),this.left=t.usual(),this.op=e,this.right=n}get type(){return"calc"}is(t){return this===t||"object"==typeof t&&t.type===this.type&&(this.op===t.op&&this.left.is(t.left)&&He(this.right,t.right)&&this.priority===t.priority)}add(t,e){return"number"==typeof t&&(t=ln(t,e,this)),pn(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=ln(t,e,this)),pn(this,"-",t)}mul(t){return gn(this,t)}div(t){return _n(this,t)}toString(){return"calc"+super.toString()}}class dn extends fn{constructor(t,e,n,r){super(t,e,n.usual(),r)}prioritize(t){return this.priority===t?this:new dn(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(!e)return;const n=this.right.toDim(t);return n?e===this.left&&n===this.right?this:new dn(e,this.op,n,{dim:t,priority:this.priority}):void 0}negate(){return"-"===this.op?new dn(this.right,this.op,this.left,this):new dn(this.left.negate(),"-",this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right.toFormula()})`}}function pn(t,e,n){return n.type?new dn(t,e,n,t):t}class yn extends fn{prioritize(t){return this.priority===t?this:new yn(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(e)return e===this.left?this:new yn(e,this.op,this.right,{dim:t,priority:this.priority})}mul(t){return("*"===this.op?gn(this.left,this.right*t):_n(this.left,this.right/t)).prioritize(this.priority)}div(t){return("/"===this.op?_n(this.left,this.right*t):gn(this.left,this.right/t)).prioritize(this.priority)}negate(){return new yn(this.left,this.op,-this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right})`}}function gn(t,e){return e?1===e?t.prioritize(t.priority):new yn(t,"*",e,t):t.dim.zero.prioritize(t.priority)}function _n(t,e){return 1===e?t.prioritize(t.priority):new yn(t,"/",e,t)}class mn extends un{constructor(t,e){super(e),this._byPriority=t}get type(){return 0}toDim(t){return t.zero.prioritize(this.priority)}is(t){return this===t||("object"==typeof t?t.type===this.type&&t.priority===this.priority:0===t||"0"===t?0===this.priority:"0 !important"===t&&1===this.priority)}add(t,e){return"number"==typeof t&&(t=ln(t,e,this)),t.prioritize(this.priority)}sub(t,e){return"number"==typeof t&&(t=ln(t,e,this)),t.negate().prioritize(this.priority)}mul(){return this}div(){return this}negate(){return this}prioritize(t){return this._byPriority.get(t)}important(){return this._byPriority.important}usual(){return this._byPriority.usual}toFormula(){return"0"}}class bn{constructor(t){this.dim=t,this.usual=new mn(this,{dim:t}),this.important=new mn(this,{dim:t,priority:1})}get(t){switch(t){case 0:return this.usual;case 1:return this.important}return new mn(this,{dim:this.dim,priority:t})}}function vn({pt:t,noPt:e}){const n={get zero(){return r},get pt(){return t()},get noPt(){return e()},of(t,e){return t?new hn(t,e,{dim:this}):r},by(t){if(!function(t){return"object"==typeof t&&("dimension"===t.type||"calc"===t.type||0===t.type)}(t))return;return t.toDim(this)}},r=new bn(n).usual;return n}const wn=vn({pt:()=>On,noPt:()=>wn}),On=vn({pt:()=>On,noPt:()=>wn});class kn extends Ge{constructor(t,e){super(e),this.url=t}get type(){return"url"}static by(t){switch(typeof t){case"string":{const[e,n]=an(t);return new kn(e,{priority:n})}case"object":if("url"===t.type)return t}}by(t){return kn.by(t)||this}prioritize(t){return t===this.priority?this:new kn(this.url,{priority:t})}is(t){return"object"==typeof t&&"url"===t.type&&t.url===this.url&&t.priority===this.priority}toString(){return`url('${Ne(this.url)}')`}}const xn=wt({});function Sn(){return xn}function An(t,e){if(!e)return xn;if("string"!=typeof e){if(H(e))return jn(e);if(ut(e))return jn($n(e));if("function"==typeof e){const n=e(t);if("string"!=typeof n){if(H(n))return jn(n);if(ut(n))return jn($n(n))}return wt(En(n))}}return wt(En(e))}function $n(t){return vt(t,s({}))}function jn(e){return vt(e).keep.thru(En,function(){let t;return e=>t&&function(t,e){const n=p(Tn(e));for(const[e,r]of Tn(t)){const{value:t}=n.next();if(!t||e!==t[0]||!He(r,t[1]))return!1}return!n.next().value}(e,t)?l():t=Object.assign({},e)}(),t)}function En(t){return"string"==typeof t?{$$css:t}:t}function Tn(t){return k(F(t),n)}function Dn(t,e){return jn(St({base:t,addendum:e}).keep.thru(({base:[t],addendum:[e]})=>function(t,e){return O(F(e),(t,[e,n])=>function(t,e,n){Mn(t[e])<=Mn(n)&&(delete t[e],t[e]=n);return t}(t,e,n),Object.assign({},t))}(t,e)))}function Mn(t){switch(typeof t){case"string":return t.endsWith("!important")?1:0;case"object":return t.priority}return 0}function zn(t){return">"===t||"+"===t||"~"===t}function Rn(t){if(!Qe(t))return[Fn(t)];const e=[];let n;for(const r of t){const t=n;let s;if(n&&(e.push(n),n=void 0),zn(r)){if(n=r,!t)continue;s={}}else s=Fn(r);e.push(s)}return n&&e.push(n,{}),e}function Fn(t){return"string"==typeof t?t?{s:t}:{}:Kn(t)}function Kn(t){const e=t.ns||void 0,n=t.i||void 0,r=function(t){if(!t)return;if(Qt(t))return[t];const e=t.filter(t=>!!t);return Ze(e)?e.sort(Zt):void 0}(t.c),s=function(t){if(!t)return;if(function(t){return"string"!=typeof t[0]}(t)){const e=t.map(qn);return Ze(e)?e:void 0}return[qn(t)]}(t.u);return{ns:e,e:("*"!==t.e||!e&&!n&&!r&&s&&Pn(s[0]))&&t.e||void 0,i:n,c:r,u:s,s:t.s||void 0,$:Un(t.$)}}function qn(t){if(!Pn(t))return t;if(t.length<3)return t;const[e,n,...r]=t;return Qe(r[0])?[e,n,...r.map(Rn)]:[e,n,Rn(r)]}function Pn(t){return t.length>1&&(":"===t[0]||"::"===t[0])}function Un(t){if(t)return Ze(t=Qe(t)?Array.from(new Set(x(t,In))).sort():Array.from(In(t)))?t:void 0}const Cn=new Set;function In(t){if(!t)return Cn;const e=t.indexOf("="),n=e<0?t:t.substring(0,e),r=new Set;let s;for(const t of n.split(":"))s?s+=":"+t:s=t,r.add(s);return e>=0&&r.add(t),r}const Nn=[[]];function Vn(t){if(!t.length)return Nn;let e,n=0;for(;;){const r=t[n++];if(!zn(r))return[e?[e,r]:[r],t.slice(n)];e=r}}const Wn=[];function Ln(t,e){return t&&e.every(e=>t.find(t=>function(t,e){if("string"==typeof t)return"string"==typeof e?t===e:!e[1].url&&e[0]===t;const[n,{url:r}]=t;return"string"==typeof e?!r&&n===e:n===e[0]&&r===e[1].url}(e,t)))}function Bn(t){return Rn(t)}const Jn={qualify:t=>`@${Je(t)}`};function Qn(t){return Gn(t,Jn)}const Zn={};function Gn(t,{qualify:e,nsAlias:n=Ht()}=Zn){const r={qualify:e,nsAlias:n};return t.reduce((t,e)=>zn(e)?t+e:(t&&!zn(t[t.length-1])&&(t+=" "),t+function(t,{qualify:e,nsAlias:n}){const{ns:r,e:s,i,c:o,s:u,u:c,$:a}=t;let h=!1,l="";i&&(h=!0,l+=`#${Je(Wt.name(i,n))}`);o&&(h=!0,l=o.reduce((t,e)=>`${t}.${Je(Bt.name(e,n))}`,l));if(c){h=!0;const t={nsAlias:n};l=c.reduce((e,n)=>function(t,e,n){if(Pn(e)){if(t+=e[0]+e[1],e.length>2){t+="("+Gn(e[2],n);for(let r=3;r<e.length;++r)t+=","+Gn(e[r],n);t+=")"}return t}const[r,s,i,o]=e;t+="["+Je(r),s&&(t+=s+Ne(i,{quotes:"double",wrap:!0}));o&&(t+=" "+o);return t+"]"}(e,n,t),l)}u&&(h=!0,l+=u);e&&a&&(l=a.reduce((t,n)=>t+e(n),l));if(r){const t=function(t,e){return"string"==typeof t?t:t.url?e(t):void 0}(r,n);l=t?`${t}|${s||"*"}${l}`:f()}else l=f();return l;function f(){return h?`${s?Nt.name(s,n):""}${l}`:`${s?Nt.name(s,n):"*"}${l}`}}(e,r)),"")}function Hn(t){return"cssRules"in t}class Xn{constructor(t){this._rule=t}read(t){let e=this._rule.outer;for(;e;)t=Dn(e.read.keep.thru(er),t),e=e.outer;return t}render(t,e){const{selector:n}=t;let{target:r}=t;if(!Hn(r))return void t.render(e);let s=r;const i=function(t){const e=new Map,n=[];for(const r of t)zn(r)?n.push(r):n.push(rr(r,e));if(!e.size)return;return[e,Bn(n)]}(n);if(!i)return void t.render(e);const[o,u]=i;for(const t of o){const n=s.insertRule(`${Yn(e,t)}{}`,s.cssRules.length),i=s.cssRules[n];r=i,Hn(i)&&(s=i)}t.render(e,{target:r,selector:u})}}function Yn(t,[e,[n,r]]){let s="";const i=t=>{t&&(s&&(s+=" and "),s+=t)};for(const e of n){const[n]=an(t[e]);i(n)}return i(r),s?`${e} ${s}`:e}const tr={order:-65535,create:t=>new Xn(t)};function er(t){return O(k(F(t),nr),(t,[e,n])=>(t[e]=n,t),{})}function nr(t){return"@"===String(t[0])[0]}function rr(t,e){const n=t.$;if(!n)return t;const r=[];for(const t of n)"@"===t[0]?sr(e,t):r.push(t);return r.length===n.length?t:Ze(r)?Object.assign(Object.assign({},t),{$:r}):Object.assign(Object.assign({},t),{$:void 0})}function sr(t,e){const n=e.indexOf("=");let r,s;n<0?r=e:(r=e.substring(0,n),s=e.substring(n+1));const i=r.indexOf(":"),o=i<0?r:r.substring(0,i),u=t.get(o);if(u){const[t,e]=u;t.add(r),s&&(u[1]=e?`${e} and ${s}`:s)}else t.set(o,[(new Set).add(r),s])}const ir={order:-65534,needs:tr,render(t,e){const n=t.styleSheet;let r=0,s=0;for(const[t,i]of F(e)){const e=String(t);if("@"===e[0]){const[t]=an(i),o=or(n,r,e,t);r+=o,s+=o;const u=kn.by(t);u&&(s+=ur(n,s,e,u),s+=cr(n,s,e,u))}}t.render(e)}};function or(t,e,n,r){if(!n.startsWith("@import:"))return 0;let s=`@import ${new kn(n.substring("@import:".length))}`;return r&&(s+=" "+r),t.insertRule(s+";",e),1}function ur(t,e,n,r){return"@namespace"!==n?0:(t.insertRule(`@namespace ${r};`,e),1)}function cr(t,e,n,r){if(!n.startsWith("@namespace:"))return 0;const s=n.substring("@namespace:".length);return t.insertRule(`@namespace ${s} ${r};`,e),1}function ar(t,e){const n=t.addRule(),{style:r}=n;b(k(F(e),hr),([t,e])=>{const[n,s]=an(e);r.setProperty(function(t){if(Le.hasOwnProperty(t))return Le[t];var e=t.replace(Ve,Be);return Le[t]=We.test(e)?"-"+e:e}(t),`${n}`,s>=1?"important":void 0)}),t.render(e,{target:n})}function hr(t){const[e,n]=t;if(null==n)return!1;const r=String(e)[0];return r>="a"&&r<="z"||r>="A"&&r<="Z"}function lr(t){if("function"==typeof t)return{create:()=>({render:t})};if(function(t){return"create"in t}(t))return{order:t.order,needs:t.needs,create:e=>function(t){return"function"==typeof t?{render:t}:t}(t.create(e))};const e=t.render.bind(t);return{order:t.order,needs:t.needs,create:()=>({render:e})}}function fr(t,e){const n=t.order||0,r=e.order||0;return n>r?1:n<r?-1:0}function dr(t,n={}){const{document:r=window.document,rootSelector:s={e:"body"},addStyleSheet:i=pr,scheduler:o=de,nsAlias:u=Ht()}=n,{parent:c=r.head}=n,a=r.defaultView||window,h={nsAlias:u},l=function(t){const e=new Map;return n(t.render),e.delete(ar),[...e.values(),lr(ar)].sort(fr);function n(t){t&&(Qe(t)?t.forEach(r):r(t))}function r(t){if(e.has(t))return;const r=lr(t);e.set(t,r),n(r.needs)}}(n),f=O(S(t,y),(t,e)=>et(n=>{e.off(n),t.off(n)}),et());const d=function(){const e=new Map,n=yt(t)((t,n)=>{t.forEach(t=>e.set(t,y(t))),n.forEach(t=>e.delete(t))});return et(t=>{n.off(t),b(e.values(),e=>e.off(t)),e.clear()}).needs(n)}();return et(t=>{d.off(t),f.off(t)}).needs(f).needs(d);function p(t,e,n){return new class{get document(){return r}get parent(){return c}get rule(){return t}get styleSheet(){return n.styleSheet}get target(){return n.target}get selector(){return n.selector}nsAlias(t){return u(t)}render(r,s){e(s?p(t,e,{styleSheet:n.styleSheet,target:s.target||n.target,selector:s.selector||n.selector}):this,r)}addRule(t=n.selector){const e=n.target;if(!Hn(e))return e;const r=e.insertRule(`${s=t,function(t,e){return Gn(Bn(t),e)}(s,h)}{}`,e.cssRules.length);var s;return e.cssRules[r]}}}function y(t){const[n,r]=function(t){const n=l.map(e=>e.create(t));return[n.reduce((t,e)=>e.read?vt(e.read(t)):t,t.read),function t(r){return(s,i)=>{const o=r+1;let u;u=o===l.length?e:t(o);const c=p(s.rule,u,s);n[r].render(c,i)}}(0)]}(t);let u;const c=function(t){const e=t.selector;if(!e.length)return Bn(s);if(zn(e[0]))return[...Bn(s),...e];return e}(t),h=o({window:a});return n((function(e){h(()=>{u&&function(t){for(;t.cssRules.length;)t.deleteRule(t.cssRules.length-1)}(u.styleSheet);const n=p(t,r,{get styleSheet(){return u||(u=i(n)),u.styleSheet},get target(){return this.styleSheet},selector:c});n.render(e)})})).whenOff((function(){h(()=>{const t=u;if(t)return u=void 0,t.remove()})}))}}function pr(t){const{document:e,parent:n}=t,r=e.createElement("style");return r.setAttribute("type","text/css"),r.append(e.createTextNode("")),n.append(r),{styleSheet:r.sheet,remove(){r.parentElement.removeChild(r)}}}function yr(t,e){const n=e.$$css;if(n){const r=t.addRule();r.style.cssText=n,t.render(e,{target:r})}else t.render(e)}const gr={order:-65535,needs:ir,render(t,e){const r=k(S(M(t.selector),t=>!zn(t)&&t.ns&&"string"!=typeof t.ns?t.ns:null),n);function s(e,n){return e[`@namespace:${t.nsAlias(n)}`]=new kn(n.url),e}t.render(v(r)?e:O(r,s,Object.assign({},e)))}};function _r(t,e={}){return dr(t,Object.assign(Object.assign({},e),{render:mr(e.render)}))}function mr(t){const e=[tr,gr,ir,yr];return t&&(Qe(t)?e.push(...t):e.push(t)),e}class br{get[G](){return this.read}add(t){return this.rules.add([],t)}clear(){return this.set()}}class vr{get[G](){return this.read}get[ot](){return this.onUpdate}}class wr extends vr{}class Or extends vr{constructor(e,n){let i,o,u;super(),n?(i=()=>k(e,n),o=t=>t.filter(n)):(i=()=>e,o=t),this.onUpdate=pt(t=>{const n=u||(u=new Set(i()));yt(e)({supply:t.supply.whenOff(()=>u=void 0),receive(e,r,s){r=o(r),((s=o(s)).length||r.length)&&(s.forEach(t=>n.delete(t)),r.forEach(t=>n.add(t)),t.receive(e,r,s))}})}).share(),this.read=vt(this.onUpdate.thru(r(this)),s(this)),this[Symbol.iterator]=()=>u?u.values():y(i())}grab(t){return kr(this,t)}}function kr(t,e){const n=function(t){return Kn(t)}(e);return new Or(t,t=>function(t,e){if(!t.length)return!1;const n=t[t.length-1];return(!e.ns||n.ns===e.ns)&&((!e.e||n.e===e.e)&&((!e.i||n.i===e.i)&&(!(e.c&&!Ln(n.c,e.c))&&!(e.$&&!Ln(n.$,e.$)))))}(t.selector,n))}class xr extends wr{constructor(t,e){super(),this._root=t,this.nested=e,this._updates=new xt,this.self=function(t,e){const n=new xt,r=[t];e.onUpdate((e,s)=>{s[0]===t&&(r.length=0,n.send([],[t]))}).whenOff(t=>n.done(t));return new Or(new class{get[ot](){return n.on}[Symbol.iterator](){return y(r)}})}(t,this),this.read=vt(this._updates.on.thru(r(this)),s(this))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return Ar(this._root)}grab(t){return kr(this,t)}add(t,e){return function t(e,n,r,s){const[i,o]=Vn(n);if(!o)return e._spec.it=function(t,e){const n=t._spec.it;if(!e)return n;if(t.empty)return t=>An(t,e);return t=>Dn(n(t),An(t,e))}(e,r),e;const u=Qn(i),c=e.rules.nested._rule(u);if(c)return t(c,o,r,s);const a=new jr(e.root,[...e.selector,...i],i),h=t(a,o,r,!1);return e.rules.nested._add(u,a,s),h}(this._root,Bn(t),e,!0)}get(t){return this._get(Bn(t))}_get(t){const[e,n]=Vn(t);if(!n)return this._root;const r=this.nested._rule(Qn(e));return r?r.rules.get(n):void 0}watch(t){const e=Bn(t);return bt(t=>{const n=qt({}),r=this.read.consume(()=>{const t=this._get(e);return t&&t.read(t=>n.it=t).whenOff(()=>n.it={})}),s=n.read(t);return r.needs(s),s}).share()}_add(t,e){t.rules.onUpdate((t,e)=>this._updates.send(t,e)),e&&this._updates.send(Sr(t),[])}_remove(t){const e=Sr(this._root);this._updates.send([],e),e.forEach(e=>{e.rules._updates.done(t),e._spec.done(t)})}}function Sr(t){return Array.from(Ar(t))}function*Ar(t){yield t;for(const e of t.rules.nested)yield*Sr(e)}class $r extends vr{constructor(t){super(),this._updates=new xt,this._byKey=new Map,this._all=new xr(t,this),this.read=vt(this._updates.on.thru(r(this)),s(this))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return this._byKey.values()}grab(t){return kr(this,t)}_rule(t){return this._byKey.get(t)}_add(t,e,n){this._byKey.set(t,e),e.rules.onUpdate((n,r)=>{r[0]===e&&(this._byKey.delete(t),this._updates.send([],[e]))}),n&&this._updates.send([e],[]),this._all._add(e,n)}}class jr extends br{constructor(t,e,n,r=Sn){super(),this._root=t||this,this._selector=e,this._key=n,this._spec=qt(r),this._read=this._spec.read.keep.thru(t=>$t(t(this))),this._nested=new $r(this)}get root(){return this._root}get outer(){if(void 0!==this._outer)return this._outer;const t=function(t){let e=t.length-1;if(e<=0)return e?void 0:Wn;do{switch(--e,t[e]){case">":return t.slice(0,e);case"+":case"~":--e;continue;default:return t.slice(0,e+1)}}while(e>0)}(this.selector);return this._outer=t&&this.root.rules.get(t)||null}get selector(){return this._selector}get key(){return this._key}get empty(){return this._spec.it===Sn}get read(){return this._read}get rules(){return this._nested._all}set(t){return this._spec.it=t?e=>An(e,t):Sn,this}remove(t){return this.rules._remove(t),this}}const Er=[];function Tr(t){return new jr(void 0,Er,[],t?e=>An(e,t):void 0)}const Dr={by(t,e){let n;return n="function"==typeof e?t=>Mr(e(t)):r(Mr(e)),function(e){const r=St({ms:n(e),ps:e.rules.watch(t)}).keep.thru(({ms:[t],ps:[e]})=>c(cn.map(t,e)));return new class extends class{get[G](){return this.read}clear(){return this.set()}}{get read(){return r}add(n){return e.rules.add(t,n),this}set(n){return e.rules.add(t).set(n),this}}}}};function Mr(t){return H(t)?t:wt(t)}class zr{constructor(t){this.refs=t}static by(t,e){const n={};for(const r of Object.keys(t))n[r]=t[r](e);return new zr(n)}get read(){if(this._read)return this._read;const t=St(this.refs);return this._read=t.keep.thru(Rr)}get[G](){return this.read}}function Rr(t){const e={};for(const n of Object.keys(t))e[n]=t[n][0];return e}const Fr=new Or({[ot]:gt,[Symbol.iterator]:()=>[][Symbol.iterator]()});function Kr(...t){return t.length?Cr(t.map(qr)):Fr}function qr(t){return"function"==typeof t?function(t){let e;return{[Symbol.iterator]:()=>n()[Symbol.iterator](),get[ot](){return n()[ot]}};function n(){return e||(e=Ir(t()))}}(t):Ir(t)}function Pr(...t){return t.length?Cr(t.map(Ur)):Fr}function Ur(t){return"function"==typeof t?function(t){const e=new Set,n=pt(n=>{const r=Ir(t());Nr(r,e,n),r[ot]({supply:n.supply.whenOff(()=>e.clear()),receive(t,r,s){s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),n.receive(t,r,s)}})}).share();return{[ot]:n,[Symbol.iterator]:()=>e.values()}}(t):Ir(t)}function Cr(t){if(1===t.length){const e=t[0];return e instanceof vr?e:new Or(e)}return new Or({*[Symbol.iterator](){for(const e of t)yield*e},get[ot](){return pt(e=>{t.forEach(t=>yt(t)({supply:et().needs(e.supply),receive(t,n,r){e.receive(t,n,r)}}))}).share()}})}function Ir(t){return t instanceof br?t.rules.self:ut(t)?t:function(t){const e=new Set,n=pt(n=>{let r=st();const{supply:s}=n;s.whenOff(t=>{r.off(t),e.clear()}),t.then(t=>{if(!s.isOff){const i=t instanceof br?t.rules:t;Nr(i,e,n),r=yt(i)({receive(t,r,s){s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),n.receive(t,r,s)}}).needs(s)}})}).share();return{[ot]:n,[Symbol.iterator]:()=>e.values()}}(t)}function Nr(t,e,n){const r=[];if(b(t,t=>{r.push(t),e.add(t)}),r.length){const t=new at;t.on(n),t.send(r,[])}}class Vr extends Set{constructor(t){super(),this._added=new Set(t),this._removed=new Set,this._added.forEach(t=>this.add(t))}add(t){return this.has(t)||(this._added.add(t),this._removed.delete(t),super.add(t)),this}delete(t){return!!super.delete(t)&&(this._added.delete(t),this._removed.add(t),!0)}clear(){this._added.clear(),this.forEach(t=>this._removed.add(t)),super.clear()}delta(t,e=[]){return Wr(this)(t,e),this}redelta(t){return("function"==typeof t?t:Wr(t))([...this._added],[...this._removed]),this}undelta(){return this._added.clear(),this._removed.clear(),this}}function Wr(t){return(e,n)=>{for(const e of n)t.delete(e);for(const n of e)t.add(n)}}const Lr=Symbol("in-aspect"),Br={instance:null,convertTo:e};function Jr(t,e,n,r,s){return void 0===r&&(r=n(t,s)),{instance:r,convertTo:r=>Jr(r,e,n,void 0,t),attachTo:r=>Jr(r,e,n,t.aspect(e)||n(r))}}function Qr(t,e,n=null){return Jr(t,e,r(null),n)}function Zr(t){return{instance:t,convertTo(){return this}}}function Gr(t,...r){if(!t)return Xr;const s=ts(t);if(!r.length)return s;const i=S(r,ts);return(t,r)=>{const o=s(t,r),u=O(x([[o],k(S(i,e=>e(t,r)),n)]),(t,e)=>e.applyAspect?n=>t(n)||e.applyAspect(n):t,e);return Yr(o)?{applyAspect:u}:{set:o.set.bind(o),get:o.get.bind(o),applyAspect:u}}}const Hr={applyAspect(){}};function Xr(){return Hr}function Yr(t){return!t.set}function ts(t){return"function"==typeof t?t:r(t)}class es extends Ft{constructor(){super(...arguments),this._aspects=new Map}aspect(t){return this._aspect(t[Lr]).instance}setup(t,n=e){return Lr in t?n(this.aspect(t),this):t(this),this}convert(t,...e){return new ns(this,Gr(t,...e))}_aspect(t){const e=this._aspects.get(t);if(e)return e;const n=this._applyAspect(t)||t.applyTo(this);return this._aspects.set(t,n),n}_applyAspect(t){}}class ns extends es{constructor(e,n){super(),this._supply=et().needs(e);let r,s=0;const i=new xt;this.on=i.on;const o=n(e,this);let u,c,a;Yr(o)?(u=t,c=t,a=t=>{const n=e._aspect(t);return n.attachTo?n.attachTo(this):n.convertTo(this)}):(u=o.set,c=o.get,a=t=>e._aspect(t).convertTo(this)),this._applyAspect=t=>{var e,n;return(null===(n=(e=o).applyAspect)||void 0===n?void 0:n.call(e,t))||a(t)},this._it=qt([u(e.it),0]),tt(this._it).needs(this._supply),this._it.on(([t],[e])=>{t!==e&&i.send(t,e)}).whenOff(t=>i.done(t)),e.on(t=>{t!==r&&(this._it.it=[u(t),++s])}).whenOff(t=>this.done(t)),this._it.on(([t,n])=>{if(n!==s){s=n,r=c(t);try{e.it=r}finally{r=void 0}}})}get[X](){return this._supply}get it(){return this._it.it[0]}set it(t){const[e,n]=this._it.it;t!==e&&(this._it.it=[t,n+1])}}const rs={applyTo:t=>Qr(t,ss)};class ss extends es{static get[Lr](){return rs}_applyAspect(t){return t===rs?Qr(this,ss,this):super._applyAspect(t)}}const is={applyTo:t=>Zr(new us(t))};class os{static get[Lr](){return is}get[ot](){return this.on}get[G](){return this.read}}class us extends os{constructor(t){super(),this._control=t,this._map=new Map,this._on=new xt;const e=this._map;function n(){return e.keys()}this.on=this._on.on.tillOff(t),this.read=bt(this.on.thru(n),()=>[n()])}add(t){const e=this._map.get(t);if(e)return e;const n=et(()=>{this._map.delete(t),this._on.send([],[t])});return this._map.set(t,n),this._on.send([t],[]),n.needs(this._control).needs(t.parent)}}const cs={applyTo:t=>Qr(t,as)};class as extends es{static get[Lr](){return cs}_applyAspect(t){return t===cs?Qr(this,as,this):void 0}}const hs={applyTo:t=>Jr(t,ls,t=>new ps(t))};class ls{static get[Lr](){return hs}get[ot](){return this.on}get[G](){return this.read}static hasData(t){return"off"!==t&&"-"!==t[0]}done(t){return this.own.done(t),this}}class fs extends Ft{constructor(t){super(),this._tracker=qt(t?function(t){return null!=t.getAttribute("disabled")?"off":null!=t.getAttribute("readonly")?"ro":"on"}(t.element):"on")}get on(){return this._tracker.on}get[X](){return tt(this._tracker)}get it(){return this._tracker.it}set it(t){switch(t){case"off":case"ro":case"-on":case"-ro":break;default:t="on"}this._tracker.it=t}}class ds{constructor(){this._all=new Set,this._on=new xt;const t=bt(this._on.on.thru(()=>this._all),s(this._all));this.read=t.keep.thru(t=>$t(At(...t)),gs)}add(t){const e=et(()=>{this._all.delete(t),this._on.send()});return this._all.add(t),this._on.send(),e}}class ps extends ls{constructor(t){super(),this._control=t,this._derived=new ds;const e=t.aspect(as);this.own=new fs(e),tt(this.own).needs(t),this.derive(t.aspect(os).read.keep.thru_(ys));let n="on";this.read=bt(St({derived:this._derived.read,own:this.own}).thru(({derived:[t],own:[e]})=>{let r;if("off"===e||"off"===t)r="off";else{let n=!1;"-"===e[0]&&(n=!0,e=e.substring(1)),"-"===t[0]&&(n=!0,t=t.substring(1)),r="ro"===t?"ro":e,n&&(r="-"+r)}return n===r?l():a(n=r)}),s(n)).tillOff(t),e&&this.read(t=>function(t,e){switch(e){case"off":t.setAttribute("disabled","");break;case"ro":case"-ro":t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly","");break;default:t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly",""),t.removeAttribute("readonly")}}(e.element,t));let r="on";this.on=this.read.thru(t=>{const e=r;return e===t?l():a(r=t,e)})}derive(t){return this._derived.add(vt(H(t)?t:t(this._control)).tillOff(this._control)).needs(this._control)}}function ys(t){const e=Array.from(t);return e.length?$t(At(...e.map(({parent:t})=>t.aspect(ls))).keep.thru_(gs)):a("on")}function gs(...t){return function(...t){let e=!1,n=!1;for(const r of t)switch(r){case"off":return"off";case"ro":e=!0;break;case"-on":n=!0;break;case"-ro":n=!0,e=!0}return n?e?"-ro":"-on":e?"ro":"on"}(...x(t))}const _s={applyTo:t=>Jr(t,ms,t=>St({value:t,mode:t.aspect(ls)}).keep.thru(({value:[t],mode:[e]})=>ls.hasData(e)?a(t):a()))},ms={get[Lr](){return _s}},bs={applyTo:t=>Qr(t,vs)};class vs extends ss{static get[Lr](){return bs}_applyAspect(t){return t===bs?Qr(this,vs,this):super._applyAspect(t)}}const ws={};class Os{constructor(t){this._map=t}get(t){const e=this._map.get(t);return e&&e[0]}[Symbol.iterator](){return y(S(this._map.values(),([t])=>t))}entries(){return y(S(this._map.entries(),([t,[e]])=>[t,e]))}}class ks{constructor(t){this._controls=t,this._supply=et(),this._map=new Map}set(t,e,n,r){const s=this,i=this._map.get(t);let o;if(e){if(i){if(i[0]===e)return i[1];r.push([t,i])}o=et();const c=et(e=>{e!==ws&&s._controls.remove(t)}).needs(s._supply).needs(o),a=[e,c];c.whenOff(t=>o.off(t===ws?void 0:t)),u().set(t,a),n.push([t,a])}else o=st(),i&&(r.push([t,i]),u().delete(t));return i&&i[1].off(ws),o;function u(){if(s._shot){const t=new Map;b(s._map.entries(),([e,n])=>t.set(e,n)),s._shot=void 0,s._map=t}return s._map}}snapshot(){return this._shot||(this._shot=new Os(this._map))}clear(){const t=[],e=[];return b(this._map.keys(),n=>this.set(n,void 0,t,e)),e}}class xs extends class extends class{get[ot](){return this.on}get[G](){return this.read}}{remove(t){this.set(t,void 0)}}{constructor(t){super(),this._group=t,this._updates=new xt;const e=this;this._map=new ks(this),this.on=this._updates.on.thru((t,e)=>a(t.map(Ss),e.map(Ss))),this.read=bt(this._updates.on.thru(()=>this._map.snapshot()),()=>[this._map.snapshot()]),this._map._supply.needs(t.read((function(t){e.read.once(e=>{const n=new Set;b(F(t),([t,r])=>{n.add(t);const s=e.get(t);s&&(s.it=r)}),b(e.entries(),([t,e])=>{n.has(t)||(e.it=void 0)})})})))}set(t,e){const n=this._group,r=[],s=[];let i;return"object"==typeof t?(i=et(),b(F(t),([t,e])=>{this._map.set(t,e,r,s).needs(i)})):i=this._map.set(t,e,r,s),(r.length||s.length)&&(this._updates.send(r,s),r.length&&function(){let t;r.forEach(([e,[r,s]])=>{s.needs(r.aspect(os).add({parent:n}).needs(s));const i=r.it;if(t)t[e]=i;else{const r=n.it;r[e]!==i&&(t=Object.assign(Object.assign({},r),{[e]:i}))}}),t&&(n.it=t);r.forEach(([t,[e,r]])=>{r.needs(e.read(e=>{n.it[t]!==e&&(n.it=Object.assign(Object.assign({},n.it),{[t]:e}))}).needs(r))})}()),i}clear(){const t=this._map.clear();t.length&&this._updates.send([],t)}}function Ss([t,[e]]){return[t,e]}class As extends vs{constructor(t){super(),this._model=qt(t),this.controls=new xs(this),tt(this).whenOff(()=>this.controls.clear())}get on(){return this._model.on}get[X](){return tt(this._model)}get it(){return this._model.it}set it(t){this._model.it=t}_applyAspect(t){return t===ms[Lr]?{instance:(n=this,St({cs:n.controls,model:n,mode:n.aspect(ls)}).keep.thru_($s)),convertTo:e}:super._applyAspect(t);var n}}function $s({cs:[t],model:[e],mode:[n]}){if(!ls.hasData(n))return a();const r={};return b(t.entries(),([t,e])=>{r[t]=e.aspect(ms)}),$t(St(r).keep.thru(t=>{const n=Object.assign({},e);return b(F(t),([t,[e]])=>{n[t]=e}),c(n)}))}function js(t){return new As(t)}const Es=wt();function Ts(){return Es}function Ds(t){return H(t)?r(vt(t)):"function"==typeof t?e=>vt(t(e)):e=>e.read.keep.thru(function(t,e){return()=>{const n=e.validate(t);return null==n?a():Array.isArray(n)?a(...n):a(n)}}(e,t))}const Ms={};class zs{constructor(n){const r=new xt,i=new Map,o=new Map;let u=e,c=e;this[G]=bt(n=>{const a=vt(r,s())(n).whenOff(()=>{u=e,c=e});c=(t,e)=>{const n=t((...e)=>{if(e.length)o.set(t,e);else if(!o.delete(t))return;u()}).needs(e).whenOff(n=>{n!==Ms&&e.off(n),o.delete(t)&&u()});a.whenOff(()=>n.off(Ms))},b(i.entries(),([t,e])=>c(t,e)),u=()=>{r.send(...x(o.values(),t))},o.size&&u()}).share().tillOff(n),this.from=t=>{const e=Ds(t)(n),r=et(()=>{i.delete(e)});return i.set(e,r),c(e,r),r.needs(n)}}}const Rs={applyTo:t=>Jr(t,Fs,(t,e)=>{const n=new Us(t);if(e){const t=e.aspect(Fs);n.by(t.read.keep.thru(t=>a(...t.messages())))}return n})};class Fs{static get[Lr](){return Rs}get[G](){return this.read}}const Ks={get ok(){return!0},messages:()=>[],has:()=>!1,hasBut:()=>!1,[Symbol.iterator]:()=>[][Symbol.iterator]()};class qs{constructor(t){this._byCode=new Map,this._all=[],b(t,t=>{let e=!1;b(F(t),([n,r])=>{if(r){e=!0;const r=this._byCode.get(n);r?r.push(t):this._byCode.set(n,[t])}}),e&&this._all.push(t)})}get ok(){return!this._all.length}messages(t){return null==t?this._all:this._byCode.get(t)||[]}has(t){return null==t||this._byCode.has(t)}hasBut(...t){return this._all.some(e=>t.every(t=>!e[t]))}[Symbol.iterator](){return this._all[Symbol.iterator]()}}function Ps(...t){return t.length?new qs(t):Ks}class Us extends Fs{constructor(t){super(),this._messages=new zs(t);const e=t.aspect(ss);e&&this._messages.from(function(t){return t.controls.read.keep.thru(Cs,Is)}(e)),this.read=vt(this._messages).keep.thru(Ps)}by(...t){return this._messages.from(function(...t){const e=t.length;return 1===e?t[0]:e?e=>{const n=new zs(e);return t.forEach(t=>n.from(t)),n}:Ts}(...t))}}function Cs(t){return $t(At(...S(t,t=>t.aspect(Fs))))}function Is(...t){return a(...x(S(t,t=>t[0])))}function Ns(t){return t?t.read.keep.thru(t=>t?a():{missing:"missing"}):Ns}class Vs extends as{constructor(e,{get:n,set:r}){super(),this.element=e,this._input=new xt,this._get=n,this._set=r,this._value=this.it;const s=this._update=(t,e)=>c({value:t},e);this.input=vt(this._input.on.thru(t),()=>[{value:this.it}]),this.on=this._input.on.thru(({value:t},e)=>t===e?l():a(t,e)),this.events=new me(e);const i=this,o=tt(this),u=t=>c({value:i.it,event:t},i._value);function c(t,e){for(;;){let n;i._value=t.value,i._update=(e,r)=>{n=[Object.assign(Object.assign({},t),{value:e}),r]};try{i._input.send(t,e)}finally{i._update=s}if(!n)break;[t,e]=n}}this.events.on("input")(u).needs(o),this.events.on("change")(u).needs(o)}get[X](){return tt(this._input)}get it(){return this._get()}set it(t){const e=this.it;t!==e&&(this._set(t),this._update(this._get(),e))}}function Ws(t){return new Vs(t,{get(){return this.element.value},set(t){this.element.value=t}})}const Ls={applyTo:t=>Jr(t,Bs,t=>{const e=t.aspect(as);return e&&new Js(e)})};class Bs extends Ft{static get[Lr](){return Ls}}class Js extends Bs{constructor(t){super();const{element:n,events:r}=t,s=n.getRootNode?n.getRootNode():n.ownerDocument;this._it=qt(!!s&&s.activeElement===n),tt(this).needs(t),r.on("focus")(()=>this._it.it=!0),r.on("blur")(()=>this._it.it=!1),this.on({receive(t,r){t.onRecurrent(e),r?n.focus():n.blur()}})}get on(){return this._it.on}get[X](){return tt(this._it)}get it(){return this._it.it}set it(t){this._it.it=t}}const Qs={applyTo:t=>Jr(t,Zs,t=>{const e=t.aspect(ss);return null!=e?new Xs(e):new Hs(t)})};class Zs{static get[Lr](){return Qs}get[G](){return this.read}}const Gs={hasFocus:!1,touched:!1,edited:!1};class Hs extends Zs{constructor(t){super(),this._flags=qt(Gs),this._flags.by(function(t,e){const n=e.aspect(as);return St({hasFocus:e.aspect(Bs)||wt(!1),edited:n?n.input.keep.thru(({event:t})=>!!t):wt(!1)}).keep.thru(({hasFocus:[e],edited:[n]})=>function(t,e,n){t=e?Object.assign(Object.assign({},t),{hasFocus:e,touched:!0}):Object.assign(Object.assign({},t),{hasFocus:e});n&&(t=Object.assign(Object.assign({},t),{edited:n,touched:!0}));return t}(t.it,e,n))}(this._flags,t)),this.read=this._flags.read.tillOff(t)}markTouched(t=!0){const e=this._flags.it;return t?e.touched||(this._flags.it=Object.assign(Object.assign({},e),{touched:t})):e.touched&&(this._flags.it=Object.assign(Object.assign({},e),{touched:e.hasFocus,edited:!1})),this}markEdited(t=!0){const e=this._flags.it;return t?e.edited||(this._flags.it=Object.assign(Object.assign({},e),{touched:!0,edited:t})):e.edited&&(this._flags.it=Object.assign(Object.assign({},e),{edited:t})),this}}class Xs extends Zs{constructor(t){var e;super(),this._container=t,this.read=(e=t,e.controls.read.keep.thru_(t=>$t(At(...function(t){return S(t,t=>t.aspect(Zs))}(t))),Ys)).tillOff(t)}markEdited(t){return this._container.controls.read.once(e=>b(e,e=>e.aspect(Zs).markEdited(t))),this}markTouched(t){return this._container.controls.read.once(e=>b(e,e=>e.aspect(Zs).markTouched(t))),this}}function Ys(...t){const e={hasFocus:!1,touched:!1,edited:!1};return b(t,([{hasFocus:t,touched:n,edited:r}])=>{n&&(e.touched=!0),t&&(e.hasFocus=e.touched=!0),r&&(e.edited=e.touched=!0)}),e}const ti=new Jt("https://surol.github.io/input-aspects/ns","inasp","input-aspects"),ei={applyTo:()=>Zr(Ht())},ni={get[Lr](){return ei},to:t=>({applyAspect:e=>e===ei?Zr(t):void 0})},ri={applyTo:()=>Zr(de)},si={get[Lr](){return ri},to:t=>({applyAspect:e=>e===ri?Zr(t):void 0})},ii={applyTo(t){const e=t.aspect(as);return e?Zr(e.element):Br}},oi={get[Lr](){return ii},to:(t=null)=>({applyAspect:e=>e===ii?Zr(t):void 0})},ui={applyTo:t=>({instance:new li(t),convertTo:e})};class ci{static get[Lr](){return ui}get[G](){return this.read}}const ai=Symbol("reason");function hi(t){return t&&"object"==typeof t&&ai in t}class li extends ci{constructor(t){super(),this._control=t,this._sources=qt([new Map]),this.read=this._sources.read.keep.thru_(([t])=>$t(At(...t.keys())),(...t)=>{const e={};return t.forEach(([t])=>fi(t,e)),e}).tillOff(t),this.track=bt(t=>{const e=new Vr,n=new at;let r=!1;return n.on(t),this.read(t=>{const s=new Set(e),i=[];b(k(F(t),([,t])=>!!t),([t])=>{s.delete(t)||i.push(t)}),(!r||i.length||s.size)&&(e.delta(i,s),r=!0,e.redelta((t,e)=>n.send(t,e)).undelta())})}).tillOff(t);const e=t.aspect(oi);e&&this.applyTo(e,this.schedule),tt(t).whenOff(t=>this.done(t))}get schedule(){return this._schedule||(this._schedule=di(this._control,this._control.aspect(oi)))}specs(t){return vt(H(t)?t:t(this._control))}resolve(t){const e=this._control.aspect(ni);return this.specs(t).keep.thru((...t)=>{const n={};return t.forEach(t=>{Qt(t)?n[Bt.name(t,e)]=!0:fi(t,n)}),n})}add(t){const e=tt(this._control);if(e.isOff)return e;const n=et(),r=bt(e=>{const r=this.resolve(t)({receive(t,...n){e.receive(t,...n)}});e.supply.whenOff(t=>{n.off({[ai]:t})}),n.needs(r).whenOff(t=>{hi(t)&&r.off(t[ai])})}).share(),[s]=this._sources.it;return s.set(r,n),n.whenOff(t=>{hi(t)||(s.delete(r),this._sources.it=[s])}),this._sources.it=[s],n.needs(e)}applyTo(t,e=di(this._control,t)){const{classList:n}=t,r=new Vr,s=()=>{r.redelta((t,e)=>{n.remove(...e),n.add(...t)}).undelta()};return this.track((t,n)=>{r.delta(t,n),e(s)}).whenOff(()=>{r.size&&(r.clear(),e(s))})}done(t){return b(this._sources.it[0].values(),e=>e.off(t)),this._sources.done(t),this}}function fi(t,e){b(F(t),([t,n])=>{null!=n&&(e[t]=n)})}function di(t,e){return t.aspect(si)({node:e})}const pi=[["has-error",ti]];function yi(t){return!t.ok}function gi({mark:t,when:e}={}){let n,r;return n=e?Array.isArray(e)?e.length?t=>e.every(e=>t.has(e)):yi:t=>t.has(e):yi,r=t?Array.isArray(t)?t.length?t:pi:[t]:pi,t=>t.aspect(Fs).read.keep.thru(t=>n(t)?a(...r):a())}function _i({ns:t=ti}={}){return e=>{const n=e=>[e,t];return St({md:e.aspect(ls),vl:e.aspect(Fs),st:e.aspect(Zs)}).keep.thru(({md:[t],vl:[e],st:[{hasFocus:r,touched:s,edited:i}]})=>{const o=[];return ls.hasData(t)||o.push(n("disabled")),"ro"!==t&&"-ro"!==t||o.push(n("readonly")),e.ok||o.push(n("invalid")),e.has("missing")&&o.push(n("missing")),e.has("incomplete")&&o.push(n("incomplete")),r&&o.push(n("has-focus")),s&&o.push(n("touched")),i&&o.push(n("edited")),a(...o)})}}export{Pr as $,j as A,X as B,V as C,me as D,xt as E,ie as F,x as G,G as H,n as I,Nt as J,vt as K,Bt as L,w as M,Jt as N,ot as O,c as P,yt as Q,p as R,J as S,it as T,at as U,Ft as V,Et as W,h as X,Ke as Y,Fe as Z,st as _,K as a,B as a0,Kr as a1,_r as a2,dr as a3,Bn as a4,Q as a5,Tr as a6,es as a7,se as a8,Gr as a9,ni as aa,si as ab,Dr as ac,Ye as ad,On as ae,wn as af,zr as ag,be as ah,ti as ai,oi as aj,ci as ak,_i as al,gi as am,on as an,js as ao,Ws as ap,Fs as aq,Ns as ar,Pt as as,N as b,re as c,bt as d,wt as e,St as f,a as g,$t as h,O as i,At as j,l as k,k as l,S as m,de as n,pt as o,Ht as p,e as q,Rt as r,Qt as s,qt as t,tt as u,r as v,jt as w,et as x,b as y,M as z};//# sourceMappingURL=lib.4fbb81b4.m.js.map
