const t=Symbol("next-call"),e=Symbol("next-call:last-outcome");class n extends Function{static is(e){return"function"==typeof e&&t in e}static of(t){return n.is(t)?t:s(e=>e(t))}}const r=t=>t;function s(n,s=(()=>n(r))){const i=()=>i;return i[t]=t=>n(t),i[e]=s,i}const i=Symbol("passed-thru");class o{static is(t){return"object"==typeof t&&i in t}static get(t){return o.is(t)?t[i]:t}static items(t){return o.is(t)?t:{*[Symbol.iterator](){yield t}}}}function u(...r){return function(...s){return o.get(function s(i,o){const u=r.length;return i<u?n.is(o)?o[t]((function(...t){return s(i+1,r[i].apply(this,t))})):s(i+1,r[i].call(null,o)):n.is(o)?o[e]():o}(1,r[0].apply(this,s)))}}function c(t){return t}function a(){}function h(t){return null!=t}function f(t){return()=>t}function l(...t){return()=>t}function d(...t){return s(e=>e.apply(void 0,t),()=>t)}function p(r){return s(e=>({[Symbol.iterator]:()=>(function*(e,r){for(const s of e)yield*o.items(n.is(s)?s[t](r):r(s))})(r,e)}),()=>({[Symbol.iterator]:()=>(function*(t){for(const r of t)yield*o.items(n.is(r)?r[e]():r)})(r)}))}const g={[i]:void 0,*[Symbol.iterator](){}};function y(){return g}const _=s(y,y);function m(){return _}function b(t){return"length"in t}function v(t){return"reverse"in t}function w(t){return t[Symbol.iterator]()}function O(t){return function*(){yield*t}()}function k(t,e){const n={[Symbol.iterator]:t};if(!e)return n;const r=n;return r.reverse=e,r}function x(t){if(b(t))return S(t);if(v(t)){const e=t.reverse();return k(()=>w(e))}return S([...t])}function S(t){return k((function*(){for(let e=t.length-1;e>=0;--e)yield t[e]}))}function j(t,e){for(const n of t)e(n)}function $(t){return w(t).next().value}function A(t,e,n){let r=n;for(const n of t)r=e(r,n);return r}function E(t,...e){return u(p(t),...e)()}function z(t,e){return k((function*(){for(const n of t)e(n)&&(yield n)}))}function M(t,e){return k((function*(){for(const n of t)yield*e(n)}))}function D(t,e){return k((function*(){for(const n of t)yield e(n)}))}const P=["every","filter","flatMap","forEach","map","reduce","reverse"];class T{static none(){return R}static is(t){return P.every(e=>e in t)}static of(t){return T.is(t)?t:T.from(t)}static from(t){return U(()=>t,()=>x(t))}every(t){return function(t,e){for(const n of t)if(!e(n))return!1;return!0}(this,t)}filter(t){return U(()=>z(this,t),()=>z(this.reverse(),t))}flatMap(t){return U(()=>M(this,t),()=>M(this.reverse(),e=>x(t(e))))}forEach(t){j(this,t)}map(t){return U(()=>D(this,t),()=>D(this.reverse(),t))}reduce(t,e){return A(this,t,e)}reverse(){const t=this;return U(()=>S([...t]),()=>this)}thru(...t){const e=E;return U(()=>e(this,...t))}}class F extends T{*[Symbol.iterator](){}reverse(){return this}}const R=new F;function U(t,e){return new class extends T{[Symbol.iterator](){return w(t())}reverse(){return e?T.from(k(()=>w(e()),()=>this)):super.reverse()}}}function C(t){return k((function*(){for(let e=0;e<t.length;++e)yield t[e]}),()=>S(t))}const K={*[Symbol.iterator](){},reverse(){return this}};function q(t){return C(Reflect.ownKeys(t))}function I(t){const e=q(t);function n(e){return D(e,e=>[e,t[e]])}return k(()=>w(n(e)),()=>n(e.reverse()))}const N=Symbol("after-event");function V(t){return N in t}class L{needs(t){return t.whenOff(t=>this.off(t)),this}}function J(t=a){let e,n=r=>{e=t=>t(r),n=a,t(r)};e=t=>{const e=n;n=n=>{e(n),t(n)}};return new class extends L{get isOff(){return n===a}off(t){return n(t),this}whenOff(t){return e(t),this}}}class W extends L{get isOff(){return!0}off(){return this}whenOff(t){return t(),this}}const H=new W;function Z(){return H}function B(t){let e;return(e="function"==typeof t?{supply:J(),receive(e,...n){t(...n)}}:{supply:t.supply||J(),receive(e,...n){this.supply.isOff||t.receive(e,...n)}}).supply.whenOff(()=>e.receive=a),e}const G=Symbol("on-event");function Q(t){return G in t}class X{constructor(){this._rcvs=new Set,this.send=function(t){let e=function n(r){let s=t;const i=[];e=function(t){i.push(t)};try{for(;;){s=Y(s,r);const t=i.shift();if(!t)break;r=t}}finally{e=n}};return(...t)=>e(t)}(this._rcvs)}get size(){return this._rcvs.size}[G](t){return this.on(t)}on(t){const e=B(t);return this._rcvs.add(e),e.supply.whenOff(()=>this._rcvs.delete(e))}done(t){return this._rcvs.forEach(({supply:e})=>e.off(t)),this}}function Y(t,e){const n=[];for(const r of t){const t=n.length;n.push(r);const s={onRecurrent(e){n[t]=B({supply:r.supply,receive(t,...n){e(...n)}})}};r.receive(s,...e)}return n}class tt extends Function{get[G](){return this}once(t){const e=B(t),{supply:n}=e;return this({supply:n,receive:(t,...r)=>{e.receive(t,...r),n.off()}})}dig(t){return st(this.dig_(t))}dig_(t){return et(e=>{let n=Z();this({supply:e.supply,receive(r,...s){const i=n,o=t(...s);try{n=o?nt(o)({supply:J().needs(e.supply),receive(t,...n){e.receive(t,...n)}}):Z()}finally{i.off()}}})})}consume(t){let e=Z();const n=this((...n)=>{const r=e;try{e=t(...n)||Z()}finally{r.off()}});return J(t=>{e.off(t),n.off(t)}).needs(n)}share(){return st(this)}thru(...t){return st(this.thru_(...t))}thru_(...t){const e=u;return et(n=>this({supply:n.supply,receive(r,...s){e(...t,(...t)=>n.receive(r,...t))(...s)}}))}}function et(t){const e=e=>{const n=B(e),{supply:r}=n;return r.isOff||t(n),r};return Object.setPrototypeOf(e,tt.prototype),e}function nt(t){const e=Q(t)?t[G]:t[N];return e instanceof tt?e:et(e.bind(t))}const rt=et(({supply:t})=>t.off());function st(t){const e=new X;let n=Z(),r=[];const s=t=>{e.size||(n.off(t),r=[])};return et(i=>{if(e.size||(n=t((...t)=>{r&&(e.size?r=void 0:r.push(t)),e.send(...t)})),e.on(i).whenOff(s).needs(n),r){const t=new X;t.on(i),r.forEach(e=>t.send(...e))}})}class it{constructor(t){this._keeper=t}dig(t){return this.dig_(t).share()}dig_(t){return ct(this._keeper.dig_((...e)=>ct(t(...e))))}thru(...t){return this.thru_(...t).share()}thru_(...t){return ct(this._keeper.thru_(...t))}}class ot extends tt{get[N](){return this}get keep(){return new it(this)}share(){return ut(super.share())}}function ut(t,e=ft){let n,r=0;const s=s=>{let i=a;const o=B(s),{supply:u}=o;return u.isOff?u:(t({supply:u,receive(t,...e){n=e,i(t,...e)}}),++r,u.isOff||(o.receive({onRecurrent(t){i=(e,...n)=>t(...n)}},...n||(n=e())),i=(t,...e)=>o.receive(t,...e)),u.whenOff(()=>{--r||(n=void 0)}),u)};return Object.setPrototypeOf(s,ot.prototype),s}function ct(t,e){if(!V(t))return function(t,e){return ut(e=>t[G](e),e)}(t,e);const n=t[N];return n instanceof ot?n:ut(n.bind(t))}function at(...t){return ut(()=>J(),f(t))}const ht=ut(({supply:t})=>t.off());function ft(){throw new Error("No events to send")}class lt extends tt{get capture(){return dt((t,e)=>null==e?this(t,!0):"object"==typeof e&&null==e.capture?this(t,Object.assign(Object.assign({},e),{capture:!0})):this(t,e))}get instead(){return dt((t,e)=>{const n=B(t);return this({supply:n.supply,receive(t,e){e.preventDefault(),n.receive(t,e)}},e)})}get just(){return dt((t,e)=>{const n=B(t);return this({supply:n.supply,receive(t,e){e.stopPropagation(),n.receive(t,e)}},e)})}get last(){return dt((t,e)=>{const n=B(t);return this({supply:n.supply,receive(t,e){e.stopImmediatePropagation(),n.receive(t,e)}},e)})}get passive(){return dt((t,e)=>null==e?this(t,{passive:!0}):"boolean"==typeof e?this(t,{capture:e,passive:!0}):null==e.passive?this(t,Object.assign(Object.assign({},e),{passive:!0})):this(t,e))}}function dt(t){const e=(e,n)=>{const r=B(e);return t(r,n),r.supply};return Object.setPrototypeOf(e,lt.prototype),e}const pt={onRecurrent:a};class gt{constructor(t){this._target=t}on(t){return dt((e,n)=>{const r=t=>e.receive(pt,t);this._target.addEventListener(t,r,n),e.supply.whenOff(()=>this._target.removeEventListener(t,r))})}dispatch(t){return this._target.dispatchEvent(t)}}var yt;class _t extends X{constructor(){super(...arguments),this.on=et(t=>super.on(t)),this[yt]=this.on}}function mt(t){const e=Object.keys(t);return e.length?ut((function(n){const r=new X,s=r.on(n);let i=a;const o={};e.forEach((function(e){s.needs(t[e][N]((...t)=>{o[e]=t,i()}).needs(s))})),s.isOff||(i=()=>r.send(o))}),(function(){const n={};return e.forEach(e=>ct(t[e]).once((...t)=>n[e]=t)),[n]})).share():ht}function bt(...t){return t.length?ut((function(e){const n=new X,r=n.on(e);let s=a;const i=[];t.forEach((function(t,e){r.needs(t[N]((...t)=>{i[e]=t,s()}).needs(r))})),r.isOff||(s=()=>n.send(...i))}),(function(){const e=[];return t.forEach(t=>ct(t).once((...t)=>e.push(t))),e})).share():ht}function vt(...t){return t.length?et(e=>{const{supply:n}=e;let r=t.length;const s=t=>{--r||n.off(t)},i=(t,...n)=>{e.receive(t,...n)};t.forEach(t=>nt(t)({supply:J(s).needs(n),receive:i}))}).share():rt}function wt(t){return Array.isArray(t)?t:[t]}yt=G;class Ot{constructor(t){this._drop=t,this.emitter=new _t,this._nested=new Map,this.emitter.on((t,e,n)=>{const r=(t=wt(t))[0],s=this._nested.get(r);s&&s.emitter.send(t.slice(1),e,n)})}on(t){const e=this,n=this.emitter.on(t);return J(t=>{n.off(t),e._dropIfEmpty()}).needs(n)}nest(t,e){const n=this._nested.get(t);if(n||e)return n;const r=new Ot(()=>this._remove(t));return this._nested.set(t,r),r}done(t){for(const e of this._nested.values())e.done(t);this.emitter.done(t)}_remove(t){this._nested.delete(t),this._dropIfEmpty()}_dropIfEmpty(){!this._nested.size&&this.emitter.size<=1&&this._drop()}}class kt{constructor(){this._root=new Ot(a)}on(t,e){return this._entry(t).on(e)}send(t,e,n){this._root.emitter.send(t,e,n)}done(t,e){const n=this._entry(t,!0);n&&n.done(e)}_entry(t,e){let n=this._root;for(const r of t){const t=n.nest(r,e);if(!t)return;n=t}return n}}class xt{constructor(t,e){this._trackers=t,this._path=e,this.update=(t,e,n)=>{this._trackers.send([...this._path,...wt(t)],e,n)},this.onUpdate=et(t=>this._trackers.on(this._path,t))}get _tracker(){return this}get[G](){return this.onUpdate}track(t){return(t=wt(t)).length?new xt(this._trackers,[...this._path,...t]):this}done(t){this._trackers.done(this._path,t)}}class St{constructor(){this._tracker=new xt(new kt,[])}get onUpdate(){return this._tracker.onUpdate}get[G](){return this.onUpdate}get update(){return this._tracker.update}track(t){const e=this._tracker.track(t);return e===this._tracker?this:e}done(t){this._tracker.done(t)}}class jt{constructor(){this._by=Z(),this.read=ut(t=>this.on(function(t){return{supply:t.supply,receive(e,n){t.receive({onRecurrent(t){e.onRecurrent(e=>t(e))}},n)}}}(t)),()=>[this.it])}get[G](){return this.on}get[N](){return this.read}by(t,e){const n=this;if(this.byNone(),e){const n=t;this._by=nt(n).consume((...t)=>{const n=e(...t);if(n)return r(n)})}else{const e=t;this._by=r(e)}return this._by.whenOff(()=>this._by=Z()),this;function r(t){return(V(t)?t[N]:t[G])(t=>n.it=t)}}byNone(t){return this._by.off(t),this}}class $t extends jt{constructor(t){super(),this._it=t,this._on=new _t}get on(){return this._on.on}get it(){return this._it}set it(t){const e=this._it;e!==t&&(this._it=t,this._on.send(t,e))}done(t){return this._on.done(t),this}}function At(t){return new $t(t)}class Et extends jt{constructor(t){super(),this._on=new _t,this._it=t}get on(){return this._on.on}get it(){return this._it}set it(t){const e=this.it;e!==t&&(this._it=t,this._on.send(t,e))}sync(t,e,n){let r,s,i=t=>c(this,t);"string"==typeof t?("in"===t&&(i=t=>c(t,this)),r=e,s=n):(r=t,s=e);const o=s;if(!o)return i(r);const u=r;return(V(u)?ct(u):nt(u)).consume((...t)=>{const e=o(...t);return e&&i(e)});function c(t,e){const n=t.read(t=>{e.it=t}),r=e.on(e=>{t.it=e});return J(t=>{r.off(t),n.off(t)}).needs(n).needs(r)}}done(t){return this._on.done(t),this}}const zt=Symbol("context-key");class Mt{constructor(t){this.name=t}get[zt](){return this}toString(){return`ContextKey(${this.name})`}}class Dt extends Mt{constructor(t){super(`${t.name}:seed`)}get seedKey(){return this}grow(t){const{seeder:e,seed:n}=t;return e.isEmpty(n)?t.byDefault(()=>n):n}}class Pt extends Error{constructor(t,e=`There is no value with key ${t}`){super(e),this.key=t}}function Tt(t){if(function(t){return"by"in t}(t)){if(!Ft(t))return t;const{a:e,by:n,with:r}=t;return{a:e,by:t=>n(...r.map(e=>t.get(e)))}}if(function(t){return"is"in t}(t)){const{a:e,is:n}=t;return{a:e,by:f(n)}}if(function(t){return"via"in t}(t)){const{a:e,via:n}=t;return{a:e,by:t=>t.get(n)}}if(function(t){return"as"in t}(t)){if(function(t){return!("a"in t)}(t)&&(t=function(t){return Object.assign(Object.assign({},t),{a:t.as})}(t)),Ft(t)){const{a:e,as:n,with:r}=t;return{a:e,by:t=>new n(...r.map(e=>t.get(e)))}}{const{a:e,as:n}=t;return{a:e,by:t=>new n(t)}}}throw new TypeError(`Malformed context value specifier: ${t}`)}function Ft(t){return"with"in t}class Rt{}class Ut{constructor(t){this._seeds=new Map,this._initial=null==t?a:"function"==typeof t?t:e=>t.get(e)}provide(t){const{a:{[zt]:{seedKey:e}},by:n}=Tt(t),[r]=this._seeding(e);return r.provide(n)}_seeding(t){const e=this._seeds.get(t);if(e)return e;const n=t.seeder(),r=[n,e=>n.seed(e,this._initial(t,e))];return this._seeds.set(t,r),r}seed(t,e){const[,n]=this._seeding(e);return n(t)}seedIn(t,e){const n=this.newValues(e);return e=>n.get.call(t,e)}newValues(t=!0){if(!t&&this._nonCachedValues)return this._nonCachedValues;const e=new Map,n=this;class r extends Rt{get({[zt]:r},s){const i=e.get(r);if(null!=i)return i;const[o,u]=function(t,e,r){const[s,i]=function(t,e){const{seedKey:r}=e,[s,i]=n._seeding(r);if(r!==e)return[s,t.get(r)];return[s,i(t)]}(t,e);let o=!1;const u={context:t,seeder:s,seed:i,byDefault:r&&"or"in r?()=>(o=!0,r.or):t=>{const n=t();if(null==n)throw new Pt(e);return n}};return[e.grow(u),o]}(this,r,s);return t&&!u&&e.set(r,o),o}}return t?new r:this._nonCachedValues=new r}append(t){const e=this;return new Ut((function(n,r){const[s]=e._seeding(n);return s.combine(e.seed(r,n),t.seed(r,n),r)}))}}class Ct{constructor(){this._providers=At([])}provide(t){return this._providers.it=[...this._providers.it,t],()=>{const e=this._providers.it,n=e.indexOf(t);n>=0&&(this._providers.it=e.slice(0,n).concat(e.slice(n+1)))}}seed(t,e=at()){return this.combine(e,function(t,e){return e.read.keep.dig(e=>e.length?bt(...D(D(C(e),e=>e(t)),Kt)).keep.thru((...t)=>qt(t)):at())}(t,this._providers))}isEmpty(){return!1}combine(t,e){return bt(t,e).keep.thru((...t)=>qt(t))}}function Kt(t){return null==t?at():function(t){return("object"==typeof t||"function"==typeof t)&&V(t)}(t)?ct(t):at(t)}function qt(t){return d(...M(C(t),c))}class It extends Dt{seeder(){return new Ct}}class Nt extends Mt{constructor(t,e){super(t),this.seedKey=e||new It(this)}}class Vt extends Nt{constructor(t,{seedKey:e,byDefault:n=a}={}){super(t,e),this.byDefault=(t,e)=>n(t,e)||(()=>{throw new Pt(this)})}grow(t){let e;return t.seed((...n)=>{if(n.length)e=n[n.length-1];else{const n=()=>this.byDefault(t.context,this),r=t.byDefault(n);e=r||n()}}),(...t)=>e(...t)}}class Lt{constructor(){this._providers=[]}provide(t){return this._providers.push(t),()=>{const e=this._providers.indexOf(t);e>=0&&this._providers.splice(e,1)}}seed(t,e=T.from(K)){return T.from([e,Bt(t,this._providers)]).flatMap(c)}isEmpty(t){return!!w(t).next().done}combine(t,e){return T.from([t,e]).flatMap(c)}}class Jt extends Dt{seeder(){return new Lt}}class Wt extends Mt{constructor(t,e){super(t),this.seedKey=e||new Jt(this)}}class Ht extends Wt{constructor(t,{seedKey:e,byDefault:n=a}={}){super(t,e),this.byDefault=n}grow(t){const e=function(t){if(b(t))return t[t.length-1];if(v(t))return $(t.reverse());let e;for(const n of t)e=n;return e}(t.seed);return null!=e?e:t.byDefault(()=>this.byDefault(t.context,this))}}class Zt extends Wt{constructor(t,{seedKey:e,byDefault:n=l()}={}){super(t,e),this.byDefault=n}grow(t){const e=[...t.seed];return e.length?e:t.byDefault(()=>{const e=this.byDefault(t.context,this);if(e)return[...e]})}}function Bt(t,e){return T.from(C(e.map(t=>[t]))).map(e=>{if(e.length>1)return e[1];const n=e[0](t);return e.push(n),n}).filter(h)}class Gt{name(t,e){if("string"==typeof t)return t;const[n,r]=t;return r.name(e(r),n,this)}}class Qt extends Gt{applyAlias(t,e){return`${e}-${t}`}}const Xt=new Qt,Yt=new Qt;const te=new class extends Gt{applyAlias(t,e){return`${e}:${t}`}};const ee=new class extends Gt{applyAlias(t,e){return`${t}@${e}`}};class ne{constructor(t,...e){this.url=t,this.aliases=e}get alias(){return this.aliases[0]||"ns"}name(t,e,n=Xt){return n.applyAlias(e,t,this)}}new class extends ne{constructor(){super("")}name(t,e){return e}};function re(t){return"string"==typeof t||function(t){return Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&t[1]instanceof ne}(t)}function se(t,e){if("string"==typeof t)return"string"==typeof e?ie(t,e):e[1].url?-1:ie(t,e[0]);const[n,{url:r}]=t;return"string"==typeof e?r?1:ie(n,e):ie(r,e[1].url)||ie(n,e[0])}function ie(t,e){return t<e?-1:t>e?1:0}function oe(){const t=new Map,e=new Map;return function(n){const r=t.get(n.url);if(r)return r;const s=n.alias;let i=0;for(const r of[s,...n.aliases]){const s=e.get(r);if(!s)return t.set(n.url,r),e.set(r,1),r;i||(i=s)}const o=s+ ++i;return t.set(n.url,o),e.set(s,i),o}}function ue(t,e,n,r){var s,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(o=(i<3?s(o):i>3?s(e,n,o):s(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o}function ce({$:t,n:e,t:n,v:r,x:s=[],p:i={},pl:o=[]}){return{$:t,n:e,t:n,v:r,x:s,p:i,pl:o}}function ae({p:t,pl:e},n){const r=n.n||n.v,s=t[r];(!s||!s.n&&n.n)&&(t[r]=n),e.push(n)}function he(t){return e=>{const n=e.s[e.i];return e.d=t.delimiterOf(n),n}}const fe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \d\d (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d\d\d\d \d\d:\d\d:\d\d GMT/;function le(t,e){return t.s=t.s.substring(t.i),t.i=0,!!t.s.match(fe)&&(e(t.s.substring(t.i,t.i+=29)),!0)}const de=()=>!1;function pe(t,{named:e=!0,tagged:n=!0,extra:r=!0,next:s=he(t)}={}){const i=function(t){return(e,n)=>{let r="";for(++e.i;e.i<e.s.length;++e.i){const s=e.s[e.i];if("\\"===s){const t=e.s[++e.i];r+=t||s}else{if(65536&t.delimiterOf(s))return++e.i,void n(r);r+=s}}n(r)}}(t),o=function(t){return(e,n)=>{if(!(262144&t.delimiterOf(e.s[e.i])))return!1;let r="";for(++e.i;e.i<e.s.length;){const n=e.s[e.i++];if(524288&t.delimiterOf(n))break;r+=n}return n(r),!0}}(t),u=r?pe(t,{next:s,tagged:!1,named:!1,extra:!1}):de;return(t,r)=>{let c,a,h,f="",l="raw";for(;t.i<t.s.length;){const r=s(t);if(t.d){if(12&t.d)break;if(null==a){if(16&t.d){a=f?"":r,++t.i;continue}if(65536&t.d){!n&&f||i(t,t=>{f?(l="tagged-string",c=f):l="quoted-string",f="",a=t});break}if(!f&&o(t,t=>{l="angle-bracketed-string",a=t}))break;a=f,f=""}else{if(65536&t.d){!n&&a||i(t,t=>{a?(l="tagged-string",c=a):l="quoted-string",a=t});break}if(!a&&o(t,t=>{l="angle-bracketed-string",a=t}))break}}if(null==a){if(!f&&le(t,t=>a=t)){l="date-time";break}e?f+=r:a=r}else{if(!a&&le(t,t=>a=t)){l="date-time";break}a+=r}++t.i}if(null==a){if(!f)return!1;h=ce({$:l,v:f})}else h=ce({$:l,n:f||void 0,t:c,v:a});for(;u(t,t=>h.x.push(t)););return r(h),!0}}function ge(t){return e=>{let n=e.s[e.i];return"\\"!==n?(e.d=t.delimiterOf(n),n):(++e.i,e.i<e.s.length?(n=e.s[e.i],e.d=t.delimiterOf(n)?1:0):e.d=1,n)}}function ye(t){return e=>{const n=e.i;do{const n=e.s[e.i];if(!(2&t.delimiterOf(n)))break;e.i++}while(e.i<e.s.length);return e.i!==n}}function _e(t,e={}){const n=ye(t),r=pe(t,Object.assign(Object.assign({},e),{tagged:!1}));return(e,s)=>!!(8&t.delimiterOf(e.s[e.i]))&&(++e.i,n(e),r(e,s))}const me={" ":7,"\t":7,",":5,";":9,'"':65569,"\\":33,"<":262145,">":524289,"=":17,"(":1,")":1,"/":1,":":1,"?":1,"@":1,"[":1,"]":1,"{":1,"}":1};function be({delimit:t}={}){const e=t?Object.assign(Object.assign({},me),t):me;return{delimiterOf:t=>e[t]||(t>="\0"&&t<=" "||"\x7f"===t?1:0)}}const ve=be(),we=be({delimit:{":":17,"(":131105,")":37," ":3,"\t":3,"=":1,",":1}});function Oe(t){var e;const n=t?be(t):ve,r=function(t){const e=ye(t);return n=>!!(4&t.delimiterOf(n.s[n.i]))&&(n.i++,e(n),!0)}(n),s=_e(n),i=pe(n),o=(null===(e=t)||void 0===e?void 0:e.comments)?function(t){const e=ye(t),n={next:ge(t)},r=pe(t,n),s=_e(t,n);return(n,i)=>{if(!(131072&t.delimiterOf(n.s[n.i])))return!1;let o;for(++n.i;e(n)||s(n,t=>{o||(o=ce({$:"raw",v:""})),ae(o,t)})||r(n,t=>o=t););return++n.i,i(o||ce({$:"raw",v:""})),!0}}(we):de;return t=>{const e=[],n={i:0,s:t};for(;n.i<n.s.length&&(r(n)||s(n,t=>{e.length||e.push(ce({$:"raw",v:""})),ae(e[e.length-1],t)})||o(n,t=>e.push(t))||i(n,t=>e.push(t))););return e}}Oe({comments:!0}),Oe({delimit:{" ":11,"\t":11,";":5}}),Oe({delimit:{",":1,";":1,"=":1}});const ke=Oe();function xe(t){if(!t)return'""';let e,n=!1;for(let r=0;r<t.length;++r){const s=t[r],i=ve.delimiterOf(s);i?(32&i&&(e||(e=t.substring(0,r)),e+="\\"+s),n=!0):e&&(e+=s)}return n?`"${e||t}"`:t}var Se={}.hasOwnProperty,je=/[ -,\.\/:-@\[-\^`\{-~]/,$e=/[ -,\.\/:-@\[\]\^`\{-~]/,Ae=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,Ee=function t(e,n){"single"!=(n=function(t,e){if(!t)return e;var n={};for(var r in e)n[r]=Se.call(t,r)?t[r]:e[r];return n}(n,t.options)).quotes&&"double"!=n.quotes&&(n.quotes="single");for(var r="double"==n.quotes?'"':"'",s=n.isIdentifier,i=e.charAt(0),o="",u=0,c=e.length;u<c;){var a=e.charAt(u++),h=a.charCodeAt(),f=void 0;if(h<32||h>126){if(h>=55296&&h<=56319&&u<c){var l=e.charCodeAt(u++);56320==(64512&l)?h=((1023&h)<<10)+(1023&l)+65536:u--}f="\\"+h.toString(16).toUpperCase()+" "}else f=n.escapeEverything?je.test(a)?"\\"+a:"\\"+h.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(a)?"\\"+h.toString(16).toUpperCase()+" ":"\\"==a||!s&&('"'==a&&r==a||"'"==a&&r==a)||s&&$e.test(a)?"\\"+a:a;o+=f}return s&&(/^-[-\d]/.test(o)?o="\\-"+o.slice(1):/\d/.test(i)&&(o="\\3"+i+" "+o.slice(1))),o=o.replace(Ae,(function(t,e,n){return e&&e.length%2?t:(e||"")+n})),!s&&n.wrap?r+o+r:o};Ee.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},Ee.version="3.0.0";var ze=Ee,Me=/[A-Z]/g,De=/^ms-/,Pe={};function Te(t){return"-"+t.toLowerCase()}function Fe(t){return ze(t,{isIdentifier:!0})}const Re="!important";function Ue(t){return Array.isArray(t)}function Ce(t){return!!t.length}class Ke{constructor(t){this.priority=t&&t.priority||0}important(){return this.prioritize(1)}usual(){return this.prioritize(0)}}function qe(t,e){return t===e||("object"==typeof t?t.is(e):"object"==typeof e&&e.is(t))}class Ie extends Ke{}class Ne extends Ie{constructor(t,e){super(e),this.r=Je(t.r,255),this.g=Je(t.g,255),this.b=Je(t.b,255),this.a=null!=t.a?We(t.a,1):1}get type(){return"rgb"}get rgb(){return this}get hsl(){const{a:t}=this,e=100*this.r/255,n=100*this.g/255,r=100*this.b/255,s=Math.max(e,n,r),i=Math.min(e,n,r),o=Math.round((s+i)/2);if(s===i)return new Ve({h:0,s:0,l:o,a:t},this);const u=s-i,c=Math.round(o>50?100*u/(200-s-i):100*u/(s+i));let a;switch(s){case e:a=(n-r)/u+(n<r?6:0);break;case n:a=(r-e)/u+2;break;default:a=(e-n)/u+4}return a*=60,a=Math.round(a),new Ve({h:a,s:c,l:o,a:t},this)}by(t){return Le.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new Ne(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{r:e=this.r,g:n=this.g,b:r=this.b,a:s=this.a}=t;return new Ne({r:e,g:n,b:r,a:s},this)}toString(){const t=`${this.r}, ${this.g}, ${this.b}`;return 1===this.a?`rgb(${t})`:`rgba(${t}, ${this.a})`}}class Ve extends Ie{constructor(t,e){var n;super(e),this.h=(n=t.h,(n%=360)<0?360+n:n),this.s=We(t.s,100),this.l=We(t.l,100),this.a=null!=t.a?We(t.a,1):1}get type(){return"hsl"}get rgb(){const{a:t}=this,e=this.s/100,n=this.l/100;if(!e){const e=255*n;return new Ne({r:e,g:e,b:e,a:t},this)}const r=n<.5?n*(1+e):n+e-n*e,s=2*n-r,i=this.h/360;return new Ne({r:He(s,r,i+1/3),g:He(s,r,i),b:He(s,r,i-1/3),a:t},this)}get hsl(){return this}by(t){return Le.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.h===this.h&&t.s===this.s&&t.l===this.l&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new Ve(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{h:e=this.h,s:n=this.s,l:r=this.l,a:s=this.a}=t;return new Ve({h:e,s:n,l:r,a:s},this)}toString(){const t=`${this.h}, ${this.s}%, ${this.l}%`;return 1===this.a?`hsl(${t})`:`hsla(${t}, ${this.a})`}}const Le={by(t){if("object"==typeof t&&("rgb"===t.type||"hsl"===t.type))return t}};function Je(t,e){return We(Math.round(t),e)}function We(t,e){return Math.max(Math.min(t,e),0)}function He(t,e,n){let r,s=n;return s<0?s+=1:s>1&&(s-=1),255*(r=s<1/6?t+6*s*(e-t):s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t)}function Ze(t,e,n){const r=2*n-1,s=t.rgb,i=e.rgb,o=s.a-i.a,u=((r*o==-1?r:(r+o)/(1+r*o))+1)/2,c=1-u;return new Ne({r:s.r*u+i.r*c,g:s.g*u+i.g*c,b:s.b*u+i.b*c,a:s.a*n+i.a*(1-n)},t)}class Be extends Ke{constructor(t){super(t),this.dim=t.dim}by(t){return this.dim.by(t)||this}toString(){return this.toFormula()}}const Ge={map(t,e){const n={},r={from:e,get(r){if(r in n)return n[r];const s=function(t){switch(typeof t){case"function":return t;case"object":return t.by.bind(t)}const e=typeof t;return n=>typeof n===e?n:t}(t[r])(e[r],this,r);return n[r]=s,s}};return j(q(t),t=>r.get(t)),n},by:t=>Ge.map.bind(void 0,t)};class Qe extends Be{constructor(t,e,n){super(n),this.val=t,this.unit=e}get type(){return"dimension"}toDim(t){const e=this.dim;if(t===e||t===e.pt||t===("%"===this.unit?t.pt:e.noPt))return this}is(t){return t===this||"object"==typeof t&&t.type===this.type&&this.unit===t.unit&&this.val===t.val&&this.priority===t.priority}prioritize(t){return this.priority===t?this:new Qe(this.val,this.unit,{dim:this.dim,priority:t})}add(t,e){return"number"==typeof t&&(t=Xe(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?Xe(this.val+t.val,this.unit,this):en(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=Xe(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?Xe(this.val-t.val,this.unit,this):en(this,"-",t)}mul(t){return 1===t?this:Xe(this.val*t,this.unit,this)}div(t){return 1===t?this:Xe(this.val/t,this.unit,this)}negate(){return Xe(-this.val,this.unit,this)}toFormula(){return this.val+this.unit}}function Xe(t,e,n){return t?new Qe(t,e,n):n.dim.zero.prioritize(n.priority||0)}class Ye extends Be{constructor(t,e,n,r){super(r),this.left=t.usual(),this.op=e,this.right=n}get type(){return"calc"}is(t){return this===t||"object"==typeof t&&t.type===this.type&&(this.op===t.op&&this.left.is(t.left)&&qe(this.right,t.right)&&this.priority===t.priority)}add(t,e){return"number"==typeof t&&(t=Xe(t,e,this)),en(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=Xe(t,e,this)),en(this,"-",t)}mul(t){return rn(this,t)}div(t){return sn(this,t)}toString(){return"calc"+super.toString()}}class tn extends Ye{constructor(t,e,n,r){super(t,e,n.usual(),r)}prioritize(t){return this.priority===t?this:new tn(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(!e)return;const n=this.right.toDim(t);return n?e===this.left&&n===this.right?this:new tn(e,this.op,n,{dim:t,priority:this.priority}):void 0}negate(){return"-"===this.op?new tn(this.right,this.op,this.left,this):new tn(this.left.negate(),"-",this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right.toFormula()})`}}function en(t,e,n){return n.type?new tn(t,e,n,t):t}class nn extends Ye{prioritize(t){return this.priority===t?this:new nn(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(e)return e===this.left?this:new nn(e,this.op,this.right,{dim:t,priority:this.priority})}mul(t){return("*"===this.op?rn(this.left,this.right*t):sn(this.left,this.right/t)).prioritize(this.priority)}div(t){return("/"===this.op?sn(this.left,this.right*t):rn(this.left,this.right/t)).prioritize(this.priority)}negate(){return new nn(this.left,this.op,-this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right})`}}function rn(t,e){return e?1===e?t.prioritize(t.priority):new nn(t,"*",e,t):t.dim.zero.prioritize(t.priority)}function sn(t,e){return 1===e?t.prioritize(t.priority):new nn(t,"/",e,t)}function on(t){return"object"==typeof t&&("dimension"===t.type||"calc"===t.type||0===t.type)}class un extends Be{constructor(t,e){super(e),this._byPriority=t}get type(){return 0}toDim(t){return t.zero.prioritize(this.priority)}is(t){return this===t||("object"==typeof t?t.type===this.type&&t.priority===this.priority:0===t||"0"===t?0===this.priority:"0 !important"===t&&1===this.priority)}add(t,e){return"number"==typeof t&&(t=Xe(t,e,this)),t.prioritize(this.priority)}sub(t,e){return"number"==typeof t&&(t=Xe(t,e,this)),t.negate().prioritize(this.priority)}mul(){return this}div(){return this}negate(){return this}prioritize(t){return this._byPriority.get(t)}important(){return this._byPriority.important}usual(){return this._byPriority.usual}toFormula(){return"0"}}class cn{constructor(t){this.dim=t,this.usual=new un(this,{dim:t}),this.important=new un(this,{dim:t,priority:1})}get(t){switch(t){case 0:return this.usual;case 1:return this.important}return new un(this,{dim:this.dim,priority:t})}}function an({pt:t,noPt:e}){const n={get zero(){return r},get pt(){return t()},get noPt(){return e()},of(t,e){return t?new Qe(t,e,{dim:this}):r},by(t){if(!on(t))return;return t.toDim(this)}},r=new cn(n).usual;return n}function hn({zeroUnit:t,withPercent:e,noPercent:n}){const r={get pt(){return e&&e()},get noPt(){return n?n():this},get zero(){return s},of(t,e){return new Qe(t,e,{dim:this})},by(t){if(!on(t))return;return t.toDim(this)}},s=new Qe(0,t,{dim:r});return r}const fn=an({pt:()=>ln,noPt:()=>fn}),ln=an({pt:()=>ln,noPt:()=>fn}),dn=hn({zeroUnit:"kHz",withPercent:()=>pn,noPercent:()=>dn}),pn=hn({zeroUnit:"kHz",withPercent:()=>pn,noPercent:()=>dn}),gn=an({pt:()=>yn,noPt:()=>gn}),yn=an({pt:()=>yn,noPt:()=>gn}),_n=at({});function mn(){return _n}function bn(t,e){if(!e)return _n;if("string"!=typeof e){if(V(e))return wn(e);if(Q(e))return wn(vn(e));if("function"==typeof e){const n=e(t);if("string"!=typeof n){if(V(n))return wn(n);if(Q(n))return wn(vn(n))}return at(On(n))}}return at(On(e))}function vn(t){return ct(t,l({}))}function wn(t){return ct(t).keep.thru(On,function(){let t;return e=>t&&function(t,e){const n=w(kn(e));for(const[e,r]of kn(t)){const{value:t}=n.next();if(!t||e!==t[0]||!qe(r,t[1]))return!1}return!n.next().value}(e,t)?m():t=Object.assign({},e)}(),c)}function On(t){return"string"==typeof t?{$$css:t}:t}function kn(t){return z(I(t),h)}function xn(t,e){return wn(mt({base:t,addendum:e}).keep.thru(({base:[t],addendum:[e]})=>(function(t,e){return A(I(e),(t,[e,n])=>(function(t,e,n){Sn(t[e])<=Sn(n)&&(delete t[e],t[e]=n);return t})(t,e,n),Object.assign({},t))})(t,e)))}function Sn(t){switch(typeof t){case"string":return t.endsWith(Re)?1:0;case"object":return t.priority}return 0}function jn(t){return">"===t||"+"===t||"~"===t}function $n(t){return{ns:t.ns||void 0,e:(e=t.e,"*"!==e&&e||void 0),i:t.i||void 0,s:t.s||void 0,c:An(t.c),$:En(t.$)};var e}function An(t){if(!t)return;if(re(t))return[t];const e=t.filter(t=>!!t);return Ce(e)?e.sort(se):void 0}function En(t){if(t)return Ce(t=Ue(t)?[...A(M(t,Mn),(t,e)=>t.add(e),new Set)].sort():[...Mn(t)])?t:void 0}const zn=new Set;function Mn(t){if(!t)return zn;const e=t.indexOf("="),n=e<0?t:t.substring(0,e),r=new Set;let s;for(const t of n.split(":"))s?s+=":"+t:s=t,r.add(s);return e>=0&&r.add(t),r}const Dn=[[]];function Pn(t){if(!t.length)return Dn;let e,n=0;for(;;){const r=t[n++];if(!jn(r))return[e?[e,r]:[r],t.slice(n)];e=r}}const Tn=[];function Fn(t,e){return t&&e.every(e=>t.find(t=>(function(t,e){if("string"==typeof t)return"string"==typeof e?t===e:!e[1].url&&e[0]===t;const[n,{url:r}]=t;return"string"==typeof e?!r&&n===e:n===e[0]&&r===e[1].url})(e,t)))}function Rn(t){if(!Ue(t))return[Un(t)];const e=[];let n;for(const r of t){const t=n;let s;if(n&&(e.push(n),n=void 0),jn(r)){if(n=r,!t)continue;s={}}else s=Un(r);e.push(s)}return n&&e.push(n,{}),e}function Un(t){return"string"==typeof t?t?{s:t}:{}:$n(t)}const Cn={qualify:t=>`@${Fe(t)}`};function Kn(t){return In(t,Cn)}const qn={};function In(t,{qualify:e,nsAlias:n=oe()}=qn){const r={qualify:e,nsAlias:n};return t.reduce((t,e)=>jn(e)?t+e:(t&&!jn(t[t.length-1])&&(t+=" "),t+function(t,{qualify:e,nsAlias:n}){const{ns:r,e:s,i,c:o,s:u,$:c}=t;let a=!1,h="";i&&(a=!0,h+=`#${Fe(te.name(i,n))}`);o&&(a=!0,h=o.reduce((t,e)=>`${t}.${Fe(ee.name(e,n))}`,h));u&&(a=!0,h+=u);e&&c&&(h=c.reduce((t,n)=>t+e(n),h));if(r){const t=function(t,e){return"string"==typeof t?t:t.url?e(t):void 0}(r,n);h=t?`${t}|${s||"*"}${h}`:f()}else h=f();return h;function f(){return a?`${s?Yt.name(s,n):""}${h}`:`${s?Yt.name(s,n):"*"}${h}`}}(e,r)),"")}function Nn(t,e){const n=t.addRule(),{style:r}=n;j(z(I(e),Vn),([t,e])=>{const[n,s]=function(t){if(null==t)return[void 0,0];switch(typeof t){case"object":return[t,t.priority];case"string":if(t.endsWith(Re))return[t.substring(0,t.length-Re.length).trim(),1]}return[t,0]}(e);r.setProperty(function(t){if(Pe.hasOwnProperty(t))return Pe[t];var e=t.replace(Me,Te);return Pe[t]=De.test(e)?"-"+e:e}(t),`${n}`,s>=1?"important":void 0)}),t.render(e,{target:n})}function Vn(t){const[e,n]=t;if(null==n)return!1;const r=String(e)[0];return r>="a"&&r<="z"||r>="A"&&r<="Z"}function Ln(t){if("function"==typeof t)return{create:()=>({render:t})};if(function(t){return"create"in t}(t))return{order:t.order,needs:t.needs,create:e=>(function(t){return"function"==typeof t?{render:t}:t})(t.create(e))};const e=t.render.bind(t);return{order:t.order,needs:t.needs,create:()=>({render:e})}}function Jn(t,e){const n=t.order||0,r=e.order||0;return n>r?1:n<r?-1:0}function Wn(t,e={}){const{document:n=window.document,rootSelector:r={e:"body"},addStyleSheet:s=Hn,schedule:i=y,nsAlias:o=oe()}=e,{parent:u=n.head}=e,c=n.defaultView||window,h={nsAlias:o},f=function(t){const e=new Map;return n(t.render),e.delete(Nn),[...e.values(),Ln(Nn)].sort(Jn);function n(t){t&&(Ue(t)?t.forEach(r):r(t))}function r(t){if(e.has(t))return;const r=Ln(t);e.set(t,r),n(r.needs)}}(e),l=A(D(t,g),(t,e)=>J(n=>{e.off(n),t.off(n)}),J());const d=function(){const e=new Map,n=nt(t)((t,n)=>{t.forEach(t=>e.set(t,g(t))),n.forEach(t=>e.delete(t))});return J(t=>{n.off(t),j(e.values(),e=>e.off(t)),e.clear()}).needs(n)}();return J(t=>{d.off(t),l.off(t)}).needs(l).needs(d);function p(t,e,r){return new class{constructor(){}get document(){return n}get parent(){return u}get rule(){return t}get styleSheet(){return r.styleSheet}get target(){return r.target}get selector(){return r.selector}nsAlias(t){return o(t)}render(n,s){e(s?p(t,e,{styleSheet:r.styleSheet,target:s.target||r.target,selector:s.selector||r.selector}):this,n)}addRule(t=r.selector){const e=r.target;if(!("cssRules"in e))return e;const n=e.insertRule(`${s=t,function(t,e){return In(Rn(t),e)}(s,h)}{}`,e.cssRules.length);var s;return e.cssRules[n]}}}function g(t){const[e,n]=function(t){const e=f.map(e=>e.create(t));return[e.reduce((t,e)=>e.read?ct(e.read(t)):t,t.read),function t(n){return(r,s)=>{const i=n+1;let o;o=i===f.length?a:t(i);const u=p(r.rule,o,r);e[n].render(u,s)}}(0)]}(t);let o,u=0;const c=function(t){const e=t.selector;if(!e.length)return Rn(r);if(jn(e[0]))return[...Rn(r),...e];return e}(t);return e((function(e){const r=++u;i((function(){if(u!==r)return;o&&function(t){for(;t.cssRules.length;)t.deleteRule(t.cssRules.length-1)}(o.styleSheet);const i=p(t,n,{get styleSheet(){return o||(o=s(i)),o.styleSheet},get target(){return this.styleSheet},selector:c});i.render(e)}))})).whenOff((function(){++u;const t=o;if(t)return o=void 0,t.remove()}))}function y(t){c.requestAnimationFrame(t)}}function Hn(t){const{document:e,parent:n}=t,r=e.createElement("style");return r.setAttribute("type","text/css"),r.append(e.createTextNode("")),n.append(r),{styleSheet:r.sheet,remove(){r.parentElement.removeChild(r)}}}class Zn{get[N](){return this.read}add(t){return this.rules.add([],t)}clear(){return this.set()}}class Bn{get[N](){return this.read}get[G](){return this.onUpdate}}class Gn extends Bn{}class Qn extends Bn{constructor(t,e){let n,r,s;super(),e?(n=()=>z(t,e),r=t=>t.filter(e)):(n=()=>t,r=c),this.onUpdate=et(e=>{const i=s||(s=new Set(n()));nt(t)({supply:e.supply.whenOff(()=>s=void 0),receive(t,n,s){n=r(n),((s=r(s)).length||n.length)&&(s.forEach(t=>i.delete(t)),n.forEach(t=>i.add(t)),e.receive(t,n,s))}})}).share(),this.read=ct(this.onUpdate.thru(f(this)),l(this)),this[Symbol.iterator]=()=>s?s.values():O(n())}grab(t){return Xn(this,t)}}function Xn(t,e){const n=function(t){return $n(t)}(e);return new Qn(t,t=>(function(t,e){if(!t.length)return!1;const n=t[t.length-1];return(!e.ns||n.ns===e.ns)&&((!e.e||n.e===e.e)&&((!e.i||n.i===e.i)&&(!(e.c&&!Fn(n.c,e.c))&&!(e.$&&!Fn(n.$,e.$)))))})(t.selector,n))}class Yn extends Gn{constructor(t,e){super(),this._root=t,this.nested=e,this._updates=new _t,this.self=function(t,e){const n=new _t,r=[t];e.onUpdate((e,s)=>{s[0]===t&&(r.length=0,n.send([],[t]))}).whenOff(t=>n.done(t));return new Qn(new class{get[G](){return n.on}[Symbol.iterator](){return O(r)}})}(t,this),this.read=ct(this._updates.on.thru(f(this)),l(this))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return er(this._root)}grab(t){return Xn(this,t)}add(t,e){return function t(e,n,r,s){const[i,o]=Pn(n);if(!o)return e._spec.it=function(t,e){const n=t._spec.it;if(!e)return n;if(t.empty)return t=>bn(t,e);return t=>xn(n(t),bn(t,e))}(e,r),e;const u=Kn(i),c=e.rules.nested._rule(u);if(c)return t(c,o,r,s);const a=new rr(e.root,[...e.selector,...i],i),h=t(a,o,r,!1);return e.rules.nested._add(u,a,s),h}(this._root,Rn(t),e,!0)}get(t){return this._get(Rn(t))}_get(t){const[e,n]=Pn(t);if(!n)return this._root;const r=this.nested._rule(Kn(e));return r?r.rules.get(n):void 0}watch(t){const e=Rn(t);return ut(t=>{const n=At({}),r=this.read.consume(()=>{const t=this._get(e);return t&&t.read(t=>n.it=t).whenOff(()=>n.it={})}),s=n.read(t);return r.needs(s),s}).share()}_add(t,e){t.rules.onUpdate((t,e)=>this._updates.send(t,e)),e&&this._updates.send(tr(t),[])}_remove(t){const e=tr(this._root);this._updates.send([],e),e.forEach(e=>{e.rules._updates.done(t),e._spec.done(t)})}}function tr(t){return[...er(t)]}function*er(t){yield t;for(const e of t.rules.nested)yield*tr(e)}class nr extends Bn{constructor(t){super(),this._updates=new _t,this._byKey=new Map,this._all=new Yn(t,this),this.read=ct(this._updates.on.thru(f(this)),l(this))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return this._byKey.values()}grab(t){return Xn(this,t)}_rule(t){return this._byKey.get(t)}_add(t,e,n){this._byKey.set(t,e),e.rules.onUpdate((n,r)=>{r[0]===e&&(this._byKey.delete(t),this._updates.send([],[e]))}),n&&this._updates.send([e],[]),this._all._add(e,n)}}class rr extends Zn{constructor(t,e,n,r=mn){super(),this._root=t||this,this._selector=e,this._key=n,this._spec=At(r),this._read=this._spec.read.keep.dig(t=>t(this)),this._nested=new nr(this)}get root(){return this._root}get outer(){if(void 0!==this._outer)return this._outer;const t=function(t){let e=t.length-1;if(e<=0)return e?void 0:Tn;do{switch(t[--e]){case">":return t.slice(0,e);case"+":case"~":--e;continue;default:return t.slice(0,e+1)}}while(e>0)}(this.selector);return this._outer=t&&this.root.rules.get(t)||null}get selector(){return this._selector}get key(){return this._key}get empty(){return this._spec.it===mn}get read(){return this._read}get rules(){return this._nested._all}set(t){return this._spec.it=t?e=>bn(e,t):mn,this}remove(t){return this.rules._remove(t),this}}const sr=[];function ir(t){return new rr(void 0,sr,[],t?e=>bn(e,t):void 0)}class or{get[N](){return this.read}clear(){return this.set()}}const ur={by(t,e){let n;return n="function"==typeof e?t=>cr(e(t)):f(cr(e)),function(e){const r=mt({ms:n(e),ps:e.rules.watch(t)}).keep.thru(({ms:[t],ps:[e]})=>Ge.map(t,e));return new class extends or{get read(){return r}add(n){return e.rules.add(t,n),this}set(n){return e.rules.add(t).set(n),this}}}}};function cr(t){return V(t)?t:at(t)}class ar{constructor(t){this.refs=t}static by(t,e){const n={};for(const r of Object.keys(t))n[r]=t[r](e);return new ar(n)}get read(){if(this._read)return this._read;const t=mt(this.refs);return this._read=t.keep.thru(hr)}get[N](){return this.read}}function hr(t){const e={};for(const n of Object.keys(t))e[n]=t[n][0];return e}const fr=new Qn({[G]:rt,[Symbol.iterator]:()=>[][Symbol.iterator]()});function lr(...t){return t.length?yr(t.map(dr)):fr}function dr(t){return"function"==typeof t?function(t){let e;return{[Symbol.iterator]:()=>n()[Symbol.iterator](),get[G](){return n()[G]}};function n(){return e||(e=_r(t()))}}(t):_r(t)}function pr(...t){return t.length?yr(t.map(gr)):fr}function gr(t){return"function"==typeof t?function(t){const e=new Set,n=et(n=>{const r=_r(t());mr(r,e,n),r[G]({supply:n.supply.whenOff(()=>e.clear()),receive(t,r,s){s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),n.receive(t,r,s)}})}).share();return{[G]:n,[Symbol.iterator]:()=>e.values()}}(t):_r(t)}function yr(t){if(1===t.length){const e=t[0];return e instanceof Bn?e:new Qn(e)}return new Qn({*[Symbol.iterator](){for(const e of t)yield*e},get[G](){return et(e=>{t.forEach(t=>nt(t)({supply:J().needs(e.supply),receive(t,n,r){e.receive(t,n,r)}}))}).share()}})}function _r(t){return t instanceof Zn?t.rules.self:Q(t)?t:function(t){const e=new Set,n=et(n=>{let r=Z();const{supply:s}=n;s.whenOff(t=>{r.off(t),e.clear()}),t.then(t=>{if(!s.isOff){const i=t instanceof Zn?t.rules:t;mr(i,e,n),r=nt(i)({receive(t,r,s){s.forEach(t=>e.delete(t)),r.forEach(t=>e.add(t)),n.receive(t,r,s)}}).needs(s)}})}).share();return{[G]:n,[Symbol.iterator]:()=>e.values()}}(t)}function mr(t,e,n){const r=[];if(j(t,t=>{r.push(t),e.add(t)}),r.length){const t=new X;t.on(n),t.send(r,[])}}const br=Symbol("in-aspect"),vr={instance:null,convertTo:a};function wr(t){return{instance:t,convertTo(){return this}}}class Or extends jt{constructor(){super(...arguments),this._aspects=new Map}aspect(t){return this._aspect(t[br]).instance}setup(t,e=a){return br in t?e(this.aspect(t),this):t(this),this}convert(t,e){let n;return n=e?f({set:t,get:e}):t,new kr(this,n)}_aspect(t){const e=this._aspects.get(t);if(e)return e;const n=this._applyAspect(t)||t.applyTo(this);return this._aspects.set(t,n),n}_applyAspect(t){}}class kr extends Or{constructor(t,e){super();let n,r=0;const s=new _t;this.on=s.on;const i=e(t,this),{applyAspect:o}=i;function u(e){return t._aspect(e).convertTo(this)}this._applyAspect=o?function(t){return o.call(i,t)||u.call(this,t)}:u,this._it=At([i.set(t.it),0]),this._it.on(([t],[e])=>{t!==e&&s.send(t,e)}).whenOff(t=>s.done(t)),t.on(t=>{t!==n&&(this._it.it=[i.set(t),++r])}).whenOff(t=>this.done(t)),this._it.on(([e,s])=>{if(s!==r){r=s,n=i.get(e);try{t.it=n}finally{n=void 0}}})}get it(){return this._it.it[0]}set it(t){const[e,n]=this._it.it;t!==e&&(this._it.it=[t,n+1])}done(t){return this._it.done(t),this}}const xr={applyTo:()=>vr};class Sr extends Or{static get[br](){return xr}_applyAspect(t){return t===xr?wr(this):void 0}}class jr{get[G](){return this.on}get[N](){return this.read}}const $r={applyTo:()=>wr(new Er)};class Ar{static get[br](){return $r}get[G](){return this.on}get[N](){return this.read}}class Er extends Ar{constructor(){super(),this._map=new Map,this._on=new _t;const t=this._map;function e(){return t.keys()}this.read=ut(this._on.on.thru(e),()=>[e()])}get on(){return this._on.on}add(t){const e=this._map.get(t);if(e)return e;const n=J(()=>{this._map.delete(t),this._on.send([],[t])});return this._map.set(t,n),this._on.send([t],[]),n}}const zr={applyTo:()=>vr};class Mr extends Or{static get[br](){return zr}_applyAspect(t){return t===zr?wr(this):void 0}}const Dr={applyTo:t=>wr(new Rr(t))};class Pr{static get[br](){return Dr}get[G](){return this.on}get[N](){return this.read}static hasData(t){return"off"!==t&&"-"!==t[0]}done(t){return this.own.done(t),this}}class Tr extends jt{constructor(t){super(),this._tracker=At(t?function(t){return null!=t.getAttribute("disabled")?"off":null!=t.getAttribute("readonly")?"ro":"on"}(t.element):"on")}get on(){return this._tracker.on}get it(){return this._tracker.it}set it(t){switch(t){case"off":case"ro":case"-on":case"-ro":break;default:t="on"}this._tracker.it=t}done(t){return this._tracker.done(t),this}}class Fr{constructor(){this._all=new Set,this._on=new _t;const t=ut(this._on.on.thru(()=>this._all),l(this._all));this.read=t.keep.dig(t=>bt(...t).keep.thru(Cr))}add(t){const e=ct(t),n=J(()=>{this._all.delete(e),this._on.send()});return this._all.add(e),this._on.send(),n}}class Rr extends Pr{constructor(t){super(),this._derived=new Fr;const e=t.aspect(Mr);this.own=new Tr(e),this.derive(t.aspect(Ar).read.keep.dig_(Ur));let n="on";this.read=ut(mt({derived:this._derived.read,own:this.own}).thru(({derived:[t],own:[e]})=>{let r;if("off"===e||"off"===t)r="off";else{let n=!1;"-"===e[0]&&(n=!0,e=e.substring(1)),"-"===t[0]&&(n=!0,t=t.substring(1)),r="ro"===t?"ro":e,n&&(r="-"+r)}return n===r?m():d(n=r)}),l(n)),e&&this.read(t=>(function(t,e){switch(e){case"off":t.setAttribute("disabled","");break;case"ro":case"-ro":t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly","");break;default:t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly",""),t.removeAttribute("readonly")}})(e.element,t));let r="on";this.on=this.read.thru(t=>{const e=r;return e===t?m():d(r=t,e)})}derive(t){return this._derived.add(t)}}function Ur(t){const e=[...t];return e.length?bt(...e.map(({parent:t})=>t.aspect(Pr))).keep.thru_(Cr):at("on")}function Cr(...t){let e=!1,n=!1;for(const[r]of t)switch(r){case"off":return"off";case"ro":e=!0;break;case"-on":n=!0;break;case"-ro":n=!0,e=!0}return n?e?"-ro":"-on":e?"ro":"on"}const Kr={applyTo:t=>({instance:mt({value:t,mode:t.aspect(Pr)}).keep.thru(({value:[t],mode:[e]})=>(function(t,e){return Pr.hasData(e)?d(t):d()})(t,e)),convertTo:a})};const qr={get[br](){return Kr}};class Ir extends Sr{}class Nr extends jr{remove(t){return this.set(t,void 0)}}const Vr={};class Lr{constructor(t){this._map=t}get(t){const e=this._map.get(t);return e&&e[0]}[Symbol.iterator](){return O(D(this._map.values(),([t])=>t))}entries(){return O(D(this._map.entries(),([t,[e]])=>[t,e]))}}class Jr{constructor(t){this._controls=t,this._supply=J(),this._map=new Map}set(t,e,n,r){const s=this,i=this._map.get(t);if(e){if(i){if(i[0]===e)return;r.push([t,i])}const u=[e,J(e=>{e!==Vr&&s._controls.remove(t)}).needs(s._supply)];o().set(t,u),n.push([t,u])}else i&&(r.push([t,i]),o().delete(t));function o(){if(s._shot){const t=new Map;j(s._map.entries(),([e,n])=>t.set(e,n)),s._shot=void 0,s._map=t}return s._map}i&&i[1].off(Vr)}snapshot(){return this._shot||(this._shot=new Lr(this._map))}}class Wr extends Nr{constructor(t){super(),this._group=t,this._updates=new _t;const e=this;this._map=new Jr(this),this.on=this._updates.on.thru((t,e)=>d(t.map(Hr),e.map(Hr))),this.read=ut(this._updates.on.thru(()=>this._map.snapshot()),()=>[this._map.snapshot()]),this._map._supply.needs(t.read((function(t){e.read.once(e=>{const n=new Set;j(I(t),([t,r])=>{n.add(t);const s=e.get(t);s&&(s.it=r)}),j(e.entries(),([t,e])=>{n.has(t)||(e.it=void 0)})})})))}set(t,e){const n=this._group,r=[],s=[];return"object"==typeof t?j(I(t),([t,e])=>{this._map.set(t,e,r,s)}):this._map.set(t,e,r,s),(r.length||s.length)&&(this._updates.send(r,s),r.length&&function(){let t;r.forEach(([e,[r,s]])=>{s.needs(r.aspect(Ar).add({parent:n}).needs(s));const i=r.it;if(t)t[e]=i;else{const r=n.it;r[e]!==i&&(t=Object.assign(Object.assign({},r),{[e]:i}))}}),t&&(n.it=t);r.forEach(([t,[e,r]])=>{r.needs(e.read(e=>{n.it[t]!==e&&(n.it=Object.assign(Object.assign({},n.it),{[t]:e}))}).needs(r))})}()),this}}function Hr([t,[e]]){return[t,e]}class Zr extends Ir{constructor(t){super(),this._model=At(t),this.controls=new Wr(this)}get on(){return this._model.on}get it(){return this._model.it}set it(t){this._model.it=t}done(t){return this._model.done(t),this}_applyAspect(t){return t===qr[br]?{instance:(e=this,mt({cs:e.controls,model:e,mode:e.aspect(Pr)}).keep.dig_(Br)),convertTo:a}:super._applyAspect(t);var e}}function Br({cs:[t],model:[e],mode:[n]}){if(!Pr.hasData(n))return at();const r={};return j(t.entries(),([t,e])=>{r[t]=e.aspect(qr)}),mt(r).keep.thru(t=>{const n=Object.assign({},e);return j(I(t),([t,[e]])=>{n[t]=e}),n})}function Gr(t){return new Zr(t)}const Qr=at();function Xr(){return Qr}function Yr(t){return V(t)?f(ct(t)):"function"==typeof t?e=>ct(t(e)):e=>e.read.keep.thru(function(t,e){return()=>{const n=e.validate(t);return null==n?d():Array.isArray(n)?d(...n):n}}(e,t))}const ts={};class es{constructor(t){const e=new _t,n=new Map,r=new Map;let s=a,i=a;this[N]=ut(t=>{const o=ct(e,l())(t).whenOff(()=>{s=a,i=a});i=(t,e)=>{const n=t((...e)=>{if(e.length)r.set(t,e);else if(!r.delete(t))return;s()}).needs(e).whenOff(n=>{n!==ts&&e.off(n),r.delete(t)&&s()});o.whenOff(()=>n.off(ts))},j(n.entries(),([t,e])=>i(t,e)),s=()=>{e.send(...M(r.values(),c))},r.size&&s()}).share(),this.from=e=>{const r=Yr(e)(t),s=J(()=>{n.delete(r)});return n.set(r,s),i(r,s),s}}}const ns={applyTo(t){const e=new us(t);return{instance:e,convertTo:t=>(function t(e,n){const r=new us(n);return r.by(e._messages),{instance:r,convertTo:e=>t(r,e)}})(e,t)}}};class rs{static get[br](){return ns}get[N](){return this.read}}const ss={get ok(){return!0},messages:()=>[],has:()=>!1,[Symbol.iterator]:()=>[][Symbol.iterator]()};class is{constructor(t){this._byCode=new Map,this._all=[],j(t,t=>{let e=!1;j(I(t),([n,r])=>{if(r){e=!0;const r=this._byCode.get(n);r?r.push(t):this._byCode.set(n,[t])}}),e&&this._all.push(t)})}get ok(){return!this._all.length}messages(t){return null==t?this._all:this._byCode.get(t)||[]}has(t){return null==t||this._byCode.has(t)}[Symbol.iterator](){return this._all[Symbol.iterator]()}}function os(...t){return t.length?new is(t):ss}class us extends rs{constructor(t){super(),this._messages=new es(t);const e=t.aspect(Sr);e&&this._messages.from(function(t){return t.controls.read.keep.dig_(cs).keep.thru(as)}(e)),this.read=ct(this._messages).keep.thru(os)}by(...t){return this._messages.from(function(...t){const e=t.length;return 1===e?t[0]:e?e=>{const n=new es(e);return t.forEach(t=>n.from(t)),n}:Xr}(...t))}}function cs(t){return bt(...D(t,t=>t.aspect(rs)))}function as(...[t]){return d(...M(t,c))}function hs(t){return t?t.read.keep.thru(t=>t?d():{missing:"missing"}):hs}class fs extends Mr{constructor(t,{get:e,set:n}){super(),this.element=t,this._input=new _t,this._get=e,this._set=n,this._value=this.it,this._update=o,this.input=ct(this._input.on.thru(c),()=>[{value:this.it}]),this.on=this._input.on.thru(({value:t},e)=>t===e?m():d(t,e)),this.events=new gt(t);const r=this,s=this._supply=J(t=>this._input.done(t));function i(t){u({value:r.it,event:t},r._value)}function o(t,e){u({value:t},e)}function u(t,e){for(;;){let n;r._value=t.value,r._update=(e,r)=>{n=[Object.assign(Object.assign({},t),{value:e}),r]};try{r._input.send(t,e)}finally{r._update=o}if(!n)break;[t,e]=n}}this.events.on("input")(i).needs(s),this.events.on("change")(i).needs(s)}get it(){return this._get()}set it(t){const e=this.it;t!==e&&(this._set(t),this._update(this._get(),e))}done(t){return this._supply.off(t),this}}function ls(t){return new fs(t,{get(){return this.element.value},set(t){this.element.value=t}})}const ds={applyTo(t){const e=t.aspect(Mr);return e?wr(new gs(e)):vr}};class ps extends jt{static get[br](){return ds}}class gs extends ps{constructor(t){super(),this._element=t,this._on=new _t;const e=t.events;e.on("focus")(()=>this._on.send(!0,!1)),e.on("blur")(()=>this._on.send(!1,!0))}get on(){return this._on.on}get it(){const t=this._element.element,e=t.getRootNode?t.getRootNode():t.ownerDocument;return!!e&&e.activeElement===t}set it(t){if(this.it!==t){const e=this._element.element;t?e.focus():e.blur()}}done(t){return this._on.done(t),this}}const ys={applyTo(t){const e=t.aspect(Sr);return wr(e?new vs(e):new bs(t))}};class _s{static get[br](){return ys}get[N](){return this.read}}const ms={hasFocus:!1,touched:!1,edited:!1};class bs extends _s{constructor(t){super(),this._flags=At(ms),this._flags.by(function(t,e){const n=e.aspect(Mr);return mt({hasFocus:e.aspect(ps)||at(!1),edited:n?n.input.keep.thru(({event:t})=>!!t):at(!1)}).keep.thru(({hasFocus:[e],edited:[n]})=>(function(t,e,n){t=e?Object.assign(Object.assign({},t),{hasFocus:e,touched:!0}):Object.assign(Object.assign({},t),{hasFocus:e});n&&(t=Object.assign(Object.assign({},t),{edited:n,touched:!0}));return t})(t.it,e,n))}(this._flags,t))}get read(){return this._flags.read}markTouched(t=!0){const e=this._flags.it;return t?e.touched||(this._flags.it=Object.assign(Object.assign({},e),{touched:t})):e.touched&&(this._flags.it=Object.assign(Object.assign({},e),{touched:e.hasFocus,edited:!1})),this}markEdited(t=!0){const e=this._flags.it;return t?e.edited||(this._flags.it=Object.assign(Object.assign({},e),{touched:!0,edited:t})):e.edited&&(this._flags.it=Object.assign(Object.assign({},e),{edited:t})),this}}class vs extends _s{constructor(t){super(),this._container=t,this.read=t.controls.read.keep.dig_(t=>bt(...function(t){return D(t,t=>t.aspect(_s))}(t))).keep.thru(ws)}markEdited(t){return this._container.controls.read.once(e=>j(e,e=>e.aspect(_s).markEdited(t))),this}markTouched(t){return this._container.controls.read.once(e=>j(e,e=>e.aspect(_s).markTouched(t))),this}}function ws(...t){const e={hasFocus:!1,touched:!1,edited:!1};return j(t,([{hasFocus:t,touched:n,edited:r}])=>{n&&(e.touched=!0),t&&(e.hasFocus=e.touched=!0),r&&(e.edited=e.touched=!0)}),e}const Os={applyTo(t){const e=t.aspect(Mr);return e?wr(e.element):vr}},ks={get[br](){return Os}},xs={applyTo:t=>({instance:new As(t),convertTo:a})};class Ss{static get[br](){return xs}get[N](){return this.read}}const js=Symbol("reason");function $s(t){return t&&"object"==typeof t&&js in t}class As extends Ss{constructor(t){super(),this._control=t,this._sources=At([new Map]),this.read=this._sources.read.keep.dig_(([t])=>t.size?bt(...t.keys()):at()).keep.thru((...t)=>{const e={};return t.forEach(([t])=>{j(I(t),([t,n])=>{null!=n&&(e[t]=n)})}),e});const e=t.aspect(ks);if(e){const{classList:t}=e,n=new Set;this.read(e=>{const r=new Set(n),s=new Set(D(z(I(e),([t,e])=>!!e&&!r.delete(t)),([t])=>t));r.forEach(e=>{t.remove(e),n.delete(e)}),s.forEach(e=>{t.add(e),n.add(e)})})}}add(t){const e=function(t){if(V(t))return f(t);return t}(t)(this._control),n=J(),r=ut(t=>{const r=e[N]({receive(e,...n){t.receive(e,...n)}});t.supply.whenOff(t=>{n.off({[js]:t})}),n.needs(r).whenOff(t=>{$s(t)&&r.off(t[js])})}).share(),[s]=this._sources.it;return s.set(r,n),n.whenOff(t=>{$s(t)||(s.delete(r),this._sources.it=[s])}),this._sources.it=[s],n}done(t){return j(this._sources.it[0].values(),e=>e.off(t)),this._sources.done(t),this}}function Es({prefix:t="inap-",suffix:e=""}={}){return t=>mt({md:t.aspect(Pr),vl:t.aspect(rs),st:t.aspect(_s)}).keep.thru(({md:[t],vl:[e],st:[{hasFocus:r,touched:s,edited:i}]})=>({[n("disabled")]:!Pr.hasData(t),[n("readonly")]:"ro"===t||"-ro"===t,[n("invalid")]:!e.ok,[n("missing")]:e.has("missing"),[n("incomplete")]:e.has("incomplete"),[n("has-focus")]:r,[n("touched")]:s,[n("edited")]:i}));function n(n){return`${t}${n}${e}`}}export{Ne as $,T as A,Z as B,Ut as C,gt as D,_t as E,Vt as F,et as G,Wn as H,w as I,M as J,c as K,B as L,A as M,xe as N,G as O,ke as P,$ as Q,Zt as R,Ht as S,ee as T,ir as U,nt as V,ne as W,ct as X,vt as Y,jt as Z,ur as _,zt as a,yn as a0,ar as a1,gn as a2,Ze as a3,ue as a4,Gr as a5,ls as a6,rs as a7,hs as a8,Ss as a9,Es as aa,Et as ab,Rt as b,Nt as c,d,m as e,ut as f,at as g,mt as h,bt as i,z as j,oe as k,St as l,J as m,a as n,D as o,h as p,re as q,Yt as r,pr as s,At as t,Wt as u,f as v,lr as w,N as x,j as y,C as z};
//# sourceMappingURL=lib.a89aa200.module.js.map
