const t=Symbol("next-call"),e=Symbol("next-call:last-outcome");class r extends Function{static is(e){return"function"==typeof e&&t in e}static of(t){return r.is(t)?t:s(e=>e(t))}}const n=t=>t;function s(r,s=(()=>r(n))){const i=()=>i;return i[t]=t=>r(t),i[e]=s,i}const i=Symbol("passed-thru");class o{static is(t){return"object"==typeof t&&i in t}static get(t){return o.is(t)?t[i]:t}static items(t){return o.is(t)?t:{*[Symbol.iterator](){yield t}}}}function u(...n){return function(...s){return o.get(function s(i,o){const u=n.length;return i<u?r.is(o)?o[t]((function(...t){return s(i+1,n[i].apply(this,t))})):s(i+1,n[i].call(null,o)):r.is(o)?o[e]():o}(1,n[0].apply(this,s)))}}function c(t){return t}function a(){}function h(t){return null!=t}function l(t){return()=>t}function f(...t){return()=>t}function d(...t){return s(e=>e.apply(void 0,t),()=>t)}function p(n){return s(e=>({[Symbol.iterator]:()=>function*(e,n){for(const s of e)yield*o.items(r.is(s)?s[t](n):n(s))}(n,e)}),()=>({[Symbol.iterator]:()=>function*(t){for(const n of t)yield*o.items(r.is(n)?n[e]():n)}(n)}))}const y={[i]:void 0,*[Symbol.iterator](){}};function g(){return y}const _=s(g,g);function m(){return _}function b(t){return"length"in t}function v(t){return"reverse"in t}function w(t){return t[Symbol.iterator]()}function O(t){return function*(){yield*t}()}function k(t,e){const r={[Symbol.iterator]:t};if(!e)return r;const n=r;return n.reverse=e,n}function x(t){if(b(t))return S(t);if(v(t)){const e=t.reverse();return k(()=>w(e))}return S([...t])}function S(t){return k((function*(){for(let e=t.length-1;e>=0;--e)yield t[e]}))}function $(t,e){for(const r of t)e(r)}function j(t){return!!w(t).next().done}function A(t){return w(t).next().value}function E(t,e,r){let n=r;for(const r of t)n=e(n,r);return n}function z(t,...e){return u(p(t),...e)()}function D(t,e){return k((function*(){for(const r of t)e(r)&&(yield r)}))}function M(t,e){return k((function*(){for(const r of t)yield*e(r)}))}function T(t,e){return k((function*(){for(const r of t)yield e(r)}))}const R=["every","filter","flatMap","forEach","map","reduce","reverse"];class F{static none(){return q}static is(t){return R.every(e=>e in t)}static of(t){return F.is(t)?t:F.from(t)}static from(t){return P(()=>t,()=>x(t))}every(t){return function(t,e){for(const r of t)if(!e(r))return!1;return!0}(this,t)}filter(t){return P(()=>D(this,t),()=>D(this.reverse(),t))}flatMap(t){return P(()=>M(this,t),()=>M(this.reverse(),e=>x(t(e))))}forEach(t){$(this,t)}map(t){return P(()=>T(this,t),()=>T(this.reverse(),t))}reduce(t,e){return E(this,t,e)}reverse(){const t=this;return P(()=>S([...t]),()=>this)}thru(...t){const e=z;return P(()=>e(this,...t))}}class K extends F{*[Symbol.iterator](){}reverse(){return this}}const q=new K;function P(t,e){return new class extends F{[Symbol.iterator](){return w(t())}reverse(){return e?F.from(k(()=>w(e()),()=>this)):super.reverse()}}}function U(t){return k((function*(){for(let e=0;e<t.length;++e)yield t[e]}),()=>S(t))}const C={*[Symbol.iterator](){},reverse(){return this}};function I(t){return U(Reflect.ownKeys(t))}function N(t){const e=I(t);function r(e){return T(e,e=>[e,t[e]])}return k(()=>w(r(e)),()=>r(e.reverse()))}const V=Symbol("after-event");function W(t){return V in t}class L{needs(t){return t.whenOff(t=>this.off(t)),this}}function J(t=a){let e,r=n=>{e=t=>t(n),r=a,t(n)};e=t=>{const e=r;r=r=>{e(r),t(r)}};return new class extends L{get isOff(){return r===a}off(t){return r(t),this}whenOff(t){return e(t),this}}}class Q extends L{get isOff(){return!0}off(){return this}whenOff(t){return t(),this}}const Z=new Q;function B(){return Z}function G(t){let e;return e="function"==typeof t?{supply:J(),receive(e,...r){t(...r)}}:{supply:t.supply||J(),receive(e,...r){this.supply.isOff||t.receive(e,...r)}},e.supply.whenOff(()=>e.receive=a),e}const H=Symbol("on-event");function X(t){return H in t}function Y(t){return e=>t({supply:e.supply,receive:(t,...r)=>{e.receive(t,...r),e.supply.off()}})}class tt{constructor(){this._rcvs=new Set,this.send=function(t){let e=function r(n){let s=t;const i=[];e=t=>i.push(t);try{for(;;){s=et(s,n);const t=i.shift();if(!t)break;n=t}}finally{e=r}};return(...t)=>e(t)}(this._rcvs)}get size(){return this._rcvs.size}[H](t){return this.on(t)}on(t){const e=G(t);return this._rcvs.add(e),e.supply.whenOff(()=>this._rcvs.delete(e))}done(t){return this._rcvs.forEach(({supply:e})=>e.off(t)),this}}function et(t,e){const r=[];for(const n of t){const t=r.length;r.push(n);const s={onRecurrent(e){r[t]=G({supply:n.supply,receive(t,...r){e(...r)}})}};n.receive(s,...e)}return r}function rt(t){const e=new tt;let r,n;return s=>{if(e.size||(n=[],r=J(()=>n=void 0),t({supply:r,receive(t,...r){n&&(e.size?n=void 0:n.push(r)),e.send(...r)}})),s.supply.needs(r),e.on(s).whenOff(t=>{e.size||r.off(t)}),n){const t=new tt;t.on(s),n.forEach(e=>t.send(...e))}}}function nt(t,e){return r=>{r.supply.needs(e),t(r)}}class st extends Function{get[H](){return this}get once(){return it(Y(this))}tillOff(t){return it(nt(this,t))}dig(t){return it(rt(this.dig_(t)))}dig_(t){return it(e=>{let r=B();this({supply:e.supply,receive(n,...s){const i=r,o=t(...s);try{r=o?ot(o)({supply:J().needs(e.supply),receive(t,...r){e.receive(t,...r)}}):B()}finally{i.off()}}})})}consume(t){let e=B();const r=this((...r)=>{const n=e;try{e=t(...r)||B()}finally{n.off()}});return J(t=>{e.off(t),r.off(t)}).needs(r)}share(){return it(rt(this))}thru(...t){return it(rt(this.thru_(...t)))}thru_(...t){const e=u;return it(r=>this({supply:r.supply,receive(n,...s){e(...t,(...t)=>r.receive(n,...t))(...s)}}))}}function it(t){const e=e=>{const r=G(e),{supply:n}=r;return n.isOff||t(r),n};return Object.setPrototypeOf(e,st.prototype),e}function ot(t){const e=X(t)?t[H]:t[V];return e instanceof st?e:it(e.bind(t))}const ut=it(({supply:t})=>t.off());class ct{constructor(t){this._keeper=t}dig(t){return this.dig_(t).share()}dig_(t){return lt(this._keeper.dig_((...e)=>lt(t(...e))))}thru(...t){return this.thru_(...t).share()}thru_(...t){return lt(this._keeper.thru_(...t))}}class at extends st{get[V](){return this}get keep(){return new ct(this)}get once(){return ht(Y(this))}tillOff(t){return ht(nt(this,t))}share(){return ht(rt(this))}}function ht(t,e=pt){let r,n=0;const s=s=>{let i=a;const o=G(s);if(o.supply.isOff)return o.supply;const u=J().needs(o.supply);let c=!1;return t({supply:u,receive(t,...e){c=!0,r=e,i(t,...e)}}),++n,u.isOff&&!c||(o.receive({onRecurrent(t){i=(e,...r)=>t(...r)}},...r||(r=e())),i=(t,...e)=>o.receive(t,...e)),u.whenOff(t=>{--n||(r=void 0),o.supply.off(t)}),u};return Object.setPrototypeOf(s,at.prototype),s}function lt(t,e){if(!W(t))return function(t,e){return ht(e=>t[H](e),e)}(t,e);const r=t[V];return r instanceof at?r:ht(r.bind(t))}function ft(...t){return ht(()=>J(),l(t))}const dt=ht(({supply:t})=>t.off());function pt(){throw new Error("No events to send")}var yt;class gt extends tt{constructor(){super(...arguments),this.on=it(t=>super.on(t)),this[yt]=this.on}}function _t(t){const e=Object.keys(t);return e.length?ht((function(r){const n=new tt,s=n.on(r);let i=a;const o={};e.forEach(e=>{s.needs(t[e][V]((...t)=>{o[e]=t,i()}).needs(s))}),s.isOff||(i=()=>n.send(o))}),(function(){const r={};return e.forEach(e=>lt(t[e]).once((...t)=>r[e]=t)),[r]})).share():dt}function mt(...t){return t.length?ht((function(e){const r=new tt,n=r.on(e);let s=a;const i=[];t.forEach((t,e)=>{n.needs(t[V]((...t)=>{i[e]=t,s()}).needs(n))}),n.isOff||(s=()=>r.send(...i))}),(function(){const e=[];return t.forEach(t=>lt(t).once((...t)=>e.push(t))),e})).share():dt}function bt(...t){return t.length?it(e=>{const{supply:r}=e;let n=t.length;const s=t=>{--n||r.off(t)},i=(t,...r)=>{e.receive(t,...r)};t.forEach(t=>ot(t)({supply:J(s).needs(r),receive:i}))}).share():ut}function vt(t){return Array.isArray(t)?t:[t]}yt=H;class wt{constructor(t){this._drop=t,this.emitter=new gt,this._nested=new Map,this.emitter.on((t,e,r)=>{const n=(t=vt(t))[0],s=this._nested.get(n);s&&s.emitter.send(t.slice(1),e,r)})}on(t){const e=this.emitter.on(t);return J(t=>{e.off(t),this._dropIfEmpty()}).needs(e)}nest(t,e){const r=this._nested.get(t);if(r||e)return r;const n=new wt(()=>this._remove(t));return this._nested.set(t,n),n}done(t){for(const e of this._nested.values())e.done(t);this.emitter.done(t)}_remove(t){this._nested.delete(t),this._dropIfEmpty()}_dropIfEmpty(){!this._nested.size&&this.emitter.size<=1&&this._drop()}}class Ot{constructor(){this._root=new wt(a)}on(t,e){return this._entry(t).on(e)}send(t,e,r){this._root.emitter.send(t,e,r)}done(t,e){const r=this._entry(t,!0);r&&r.done(e)}_entry(t,e){let r=this._root;for(const n of t){const t=r.nest(n,e);if(!t)return;r=t}return r}}class kt{constructor(t,e){this._trackers=t,this._path=e,this.update=(t,e,r)=>{this._trackers.send([...this._path,...vt(t)],e,r)},this.onUpdate=it(t=>this._trackers.on(this._path,t))}get _tracker(){return this}get[H](){return this.onUpdate}track(t){return(t=vt(t)).length?new kt(this._trackers,[...this._path,...t]):this}done(t){this._trackers.done(this._path,t)}}class xt{constructor(){this._tracker=new kt(new Ot,[])}get onUpdate(){return this._tracker.onUpdate}get[H](){return this.onUpdate}get update(){return this._tracker.update}track(t){const e=this._tracker.track(t);return e===this._tracker?this:e}done(t){this._tracker.done(t)}}class St{constructor(){this._by=B(),this.read=ht(t=>{return this.on({supply:(e=t).supply,receive(t,r){e.receive({onRecurrent(e){t.onRecurrent(t=>e(t))}},r)}});var e},()=>[this.it])}get[H](){return this.on}get[V](){return this.read}by(t,e){const r=t=>(W(t)?t[V]:t[H])(t=>this.it=t);if(this.byNone(),e){const n=t;this._by=ot(n).consume((...t)=>{const n=e(...t);if(n)return r(n)})}else{const e=t;this._by=r(e)}return this._by.whenOff(()=>this._by=B()),this}byNone(t){return this._by.off(t),this}}class $t extends St{constructor(t){super(),this._it=t,this._on=new gt}get on(){return this._on.on}get it(){return this._it}set it(t){const e=this._it;e!==t&&(this._it=t,this._on.send(t,e))}done(t){return this._on.done(t),this}}function jt(t){return new $t(t)}class At extends St{constructor(t){super(),this._on=new gt,this._it=t}get on(){return this._on.on}get it(){return this._it}set it(t){const e=this.it;e!==t&&(this._it=t,this._on.send(t,e))}sync(t,e,r){let n,s,i=t=>c(this,t);"string"==typeof t?("in"===t&&(i=t=>c(t,this)),n=e,s=r):(n=t,s=e);const o=s;if(!o)return i(n);const u=n;return(W(u)?lt(u):ot(u)).consume((...t)=>{const e=o(...t);return e&&i(e)});function c(t,e){const r=t.read(t=>{e.it=t}),n=e.on(e=>{t.it=e});return J(t=>{n.off(t),r.off(t)}).needs(r).needs(n)}}done(t){return this._on.done(t),this}}const Et=Symbol("context-key");class zt{constructor(t){this.name=t}get[Et](){return this}toString(){return`ContextKey(${this.name})`}}class Dt extends zt{constructor(t){super(`${t.name}:seed`)}get seedKey(){return this}grow(t){const{seeder:e,seed:r}=t;return e.isEmpty(r)?t.byDefault(()=>r):r}}class Mt extends Error{constructor(t,e=`There is no value with key ${t}`){super(e),this.key=t}}function Tt(t){if(function(t){return"by"in t}(t)){if(!Rt(t))return t;const{a:e,by:r,with:n}=t;return{a:e,by:t=>r(...n.map(e=>t.get(e)))}}if(function(t){return"is"in t}(t)){const{a:e,is:r}=t;return{a:e,by:l(r)}}if(function(t){return"via"in t}(t)){const{a:e,via:r}=t;return{a:e,by:t=>t.get(r)}}if(function(t){return"as"in t}(t)){if(function(t){return!("a"in t)}(t)&&(t=function(t){return Object.assign(Object.assign({},t),{a:t.as})}(t)),!Rt(t)){const{as:e}=t;return{a:t.a,by:t=>new e(t)}}const{as:e,with:r}=t;return{a:t.a,by:t=>new e(...r.map(e=>t.get(e)))}}throw new TypeError(`Malformed context value specifier: ${t}`)}function Rt(t){return"with"in t}class Ft{}class Kt{constructor(t){this._seeds=new Map,this._initial=null==t?a:"function"==typeof t?t:e=>t.get(e)}provide(t){const{a:{[Et]:{seedKey:e}},by:r}=Tt(t),[n]=this._seeding(e);return n.provide(r)}_seeding(t){const e=this._seeds.get(t);if(e)return e;const r=t.seeder(),n=[r,e=>r.seed(e,this._initial(t,e))];return this._seeds.set(t,n),n}seed(t,e){const[,r]=this._seeding(e);return r(t)}seedIn(t,e){return this.newValues(e).get.bind(t)}newValues(t=!0){if(!t&&this._nonCachedValues)return this._nonCachedValues;const e=new Map,r=this;class n extends Ft{get({[Et]:n},s){const i=e.get(n);if(null!=i)return i;const[o,u]=function(t,e,n){const[s,i]=function(t,e){const{seedKey:n}=e,[s,i]=r._seeding(n);if(n!==e)return[s,t.get(n)];return[s,i(t)]}(t,e);let o=!1;const u={context:t,seeder:s,seed:i,byDefault:n&&"or"in n?()=>(o=!0,n.or):t=>{const r=t();if(null==r)throw new Mt(e);return r}};n&&"or"in n&&(u.or=n.or);return[e.grow(u),o]}(this,n,s);return t&&!u&&e.set(n,o),o}}return t?new n:this._nonCachedValues=new n}append(t){return new Kt((e,r)=>{const[n,s]=this._seeding(e);return n.combine(s(r),t.seed(r,e),r)})}}class qt{constructor(){this._providers=jt([])}provide(t){return this._providers.it=[...this._providers.it,t],()=>{const e=this._providers.it,r=e.indexOf(t);r>=0&&(this._providers.it=e.slice(0,r).concat(e.slice(r+1)))}}seed(t,e=ft()){return this.combine(e,function(t,e){return e.read.keep.dig(e=>e.length?mt(...T(T(U(e),e=>e(t)),Pt)).keep.thru(Ut):ft())}(t,this._providers))}isEmpty(){return!1}combine(t,e){return mt(t,e).keep.thru(Ut)}}function Pt(t){return null==t?ft():function(t){return("object"==typeof t||"function"==typeof t)&&W(t)}(t)?lt(t):ft(t)}function Ut(...t){return d(...M(U(t),c))}class Ct extends Dt{seeder(){return new qt}}class It extends zt{constructor(t,e){super(t.name+":up"),this._key=t,this.grow=e}get seedKey(){return this._key.seedKey}}class Nt extends zt{constructor(t,e){super(t),this.seedKey=e||new Ct(this)}createUpKey(t){return new It(this,t)}}class Vt extends Nt{constructor(t,{seedKey:e,byDefault:r=a}={}){super(t,e),this.byDefault=r}get upKey(){return this}grow(t){return t.seed.keep.dig((...e)=>{if(e.length)return ft(e[e.length-1]);const r=t.byDefault(()=>{const e=this.byDefault(t.context,this);return e&&ft(e)});return null!=r?r:ht(()=>{throw new Mt(this)})})}}class Wt extends Nt{constructor(t,{seedKey:e,byDefault:r=a}={}){super(t,e),this.byDefault=(t,e)=>r(t,e)||(()=>{throw new Mt(this)}),this.upKey=this.createUpKey(t=>t.seed.keep.dig((...e)=>{if(e.length)return ft(e[e.length-1]);const r=()=>ft(this.byDefault(t.context,this));return t.byDefault(r)||r()}))}grow(t){let e;return t.context.get(this.upKey,"or"in t?{or:null!=t.or?ft(t.or):t.or}:void 0)(t=>e=t),(...t)=>e(...t)}}class Lt{constructor(){this._providers=[]}provide(t){return this._providers.push(t),()=>{const e=this._providers.indexOf(t);e>=0&&this._providers.splice(e,1)}}seed(t,e=F.from(C)){return F.from([e,Gt(t,this._providers)]).flatMap(c)}isEmpty(t){return j(t)}combine(t,e){return F.from([t,e]).flatMap(c)}}class Jt extends Dt{seeder(){return new Lt}}class Qt extends zt{constructor(t,e){super(t),this.seedKey=e||new Jt(this)}}class Zt extends Qt{constructor(t,{seedKey:e,byDefault:r=a}={}){super(t,e),this.byDefault=r}grow(t){const e=function(t){if(b(t))return t[t.length-1];if(v(t))return A(t.reverse());let e;for(const r of t)e=r;return e}(t.seed);return null!=e?e:t.byDefault(()=>this.byDefault(t.context,this))}}class Bt extends Qt{constructor(t,{seedKey:e,byDefault:r=f()}={}){super(t,e),this.byDefault=r}grow(t){const e=Array.from(t.seed);return e.length?e:t.byDefault(()=>{const e=this.byDefault(t.context,this);if(e)return Array.from(e)})}}function Gt(t,e){return F.from(U(e.map(t=>[t]))).map(e=>{if(e.length>1)return e[1];const r=e[0](t);return e.push(r),r}).filter(h)}class Ht{name(t,e){if("string"==typeof t)return t;const[r,n]=t;return n.name(e(n),r,this)}}class Xt extends Ht{applyAlias(t,e){return`${e}-${t}`}}const Yt=new Xt,te=new Xt;class ee extends Ht{applyAlias(t,e){return`${e}:${t}`}}const re=new ee;class ne extends Ht{applyAlias(t,e){return`${t}@${e}`}}const se=new ne;class ie{constructor(t,...e){this.url=t,this.aliases=e}get alias(){return this.aliases[0]||"ns"}name(t,e,r=Yt){return r.applyAlias(e,t,this)}}function oe(t){return"string"==typeof t||function(t){return Array.isArray(t)&&2===t.length&&"string"==typeof t[0]&&t[1]instanceof ie}(t)}function ue(t,e){if("string"==typeof t)return"string"==typeof e?ce(t,e):e[1].url?-1:ce(t,e[0]);const[r,{url:n}]=t;return"string"==typeof e?n?1:ce(r,e):ce(n,e[1].url)||ce(r,e[0])}function ce(t,e){return t<e?-1:t>e?1:0}function ae(){const t=new Map,e=new Map;return function(r){const n=t.get(r.url);if(n)return n;const s=r.alias;let i=0;for(const n of[s,...r.aliases]){const s=e.get(n);if(!s)return t.set(r.url,n),e.set(n,1),n;i||(i=s)}const o=s+ ++i;return t.set(r.url,o),e.set(s,i),o}}const he={by(t={}){let e;return{get node(){return t.node},get window(){return e||(e=t.window||t.node&&((r=t.node).ownerDocument||r).defaultView||window);var r},error(...e){t&&t.error?t.error(...e):console.error(...e)}}}};const le={by({schedule:t,replace:e=(()=>{})}){const r=[];return{schedule:t,add(t){r.push(t)},pull:()=>r.shift(),reset(){const r=le.by({schedule:t,replace:e});return e(r),r}}}},fe=Symbol("scheduled-render-q");class de{constructor(t,e){this.q=t,this.schedule=this.doSchedule,this.ref=e||[this]}static by(t,e){return t[fe]||(t[fe]=new de(t,e))}add(t){this.q.add(t)}doSchedule(t){this.schedule=()=>{};const e={get config(){return t},postpone:t=>this.add(t)};this.q.schedule(()=>{const t=this.reset();t.suspend(),this.exec(e),t.resume()})}exec(t){for(;;){const e=this.q.pull();if(!e)break;e(t)}}reset(){return this.ref[0]=de.by(this.q.reset(),this.ref)}suspend(){this.schedule=t=>{this.scheduled=t,this.schedule=()=>{}}}resume(){this.scheduled?this.doSchedule(this.scheduled):this.schedule=this.doSchedule}}function pe(t){return e=>{const r=he.by(e),n=de.by(t.newQueue(r)).ref;let s=[];return t=>{const[e]=s,[i]=n;if(e===i)s[1]=t;else{const e=s=[i,t];i.add(t=>{try{e[1]({get config(){return r},postpone(e){t.postpone(e)}})}catch(t){r.error(t)}})}i.schedule(r)}}}const ye=new WeakMap;let ge=pe({newQueue({window:t}){const e=ye.get(t);if(e)return e;const r=le.by({schedule:e=>t.requestAnimationFrame(e),replace:e=>ye.set(t,e)});return ye.set(t,r),r}});function _e(t){return ge(t)}class me extends st{get once(){return be(Y(this))}tillOff(t){return be(nt(this,t))}get capture(){return be((t,e)=>null==e?this(t,!0):"object"==typeof e&&null==e.capture?this(t,Object.assign(Object.assign({},e),{capture:!0})):this(t,e))}get instead(){return be((t,e)=>{const r=G(t);return this({supply:r.supply,receive(t,e){e.preventDefault(),r.receive(t,e)}},e)})}get just(){return be((t,e)=>{const r=G(t);return this({supply:r.supply,receive(t,e){e.stopPropagation(),r.receive(t,e)}},e)})}get last(){return be((t,e)=>{const r=G(t);return this({supply:r.supply,receive(t,e){e.stopImmediatePropagation(),r.receive(t,e)}},e)})}get passive(){return be((t,e)=>null==e?this(t,{passive:!0}):"boolean"==typeof e?this(t,{capture:e,passive:!0}):null==e.passive?this(t,Object.assign(Object.assign({},e),{passive:!0})):this(t,e))}}function be(t){const e=(e,r)=>{const n=G(e);return t(n,r),n.supply};return Object.setPrototypeOf(e,me.prototype),e}const ve={onRecurrent:a};class we{constructor(t){this._target=t}on(t){return be((e,r)=>{const n=t=>e.receive(ve,t);this._target.addEventListener(t,n,r),e.supply.whenOff(()=>this._target.removeEventListener(t,n))})}dispatch(t){return this._target.dispatchEvent(t)}}function Oe(t,e,r,n){var s,i=arguments.length,o=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(s=t[u])&&(o=(i<3?s(o):i>3?s(e,r,o):s(e,r))||o);return i>3&&o&&Object.defineProperty(e,r,o),o}function ke({$:t,n:e,t:r,v:n,x:s=[],p:i={},pl:o=[]}){return{$:t,n:e,t:r,v:n,x:s,p:i,pl:o}}function xe({p:t,pl:e},r){const n=r.n||r.v,s=t[n];(!s||!s.n&&r.n)&&(t[n]=r),e.push(r)}function Se(t){return e=>{const r=e.s[e.i];return e.d=t.delimiterOf(r),r}}const $e=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \d\d (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \d\d\d\d \d\d:\d\d:\d\d GMT/;function je(t,e){return t.s=t.s.substring(t.i),t.i=0,!!t.s.match($e)&&(e(t.s.substring(t.i,t.i+=29)),!0)}const Ae=()=>!1;function Ee(t,{named:e=!0,tagged:r=!0,extra:n=!0,next:s=Se(t)}={}){const i=function(t){return(e,r)=>{let n="";for(++e.i;e.i<e.s.length;++e.i){const s=e.s[e.i];if("\\"===s){const t=e.s[++e.i];n+=t||s}else{if(65536&t.delimiterOf(s))return++e.i,void r(n);n+=s}}r(n)}}(t),o=function(t){return(e,r)=>{if(!(262144&t.delimiterOf(e.s[e.i])))return!1;let n="";for(++e.i;e.i<e.s.length;){const r=e.s[e.i++];if(524288&t.delimiterOf(r))break;n+=r}return r(n),!0}}(t),u=n?Ee(t,{next:s,tagged:!1,named:!1,extra:!1}):Ae;return(t,n)=>{let c,a,h,l="",f="raw";for(;t.i<t.s.length;){const n=s(t);if(t.d){if(12&t.d)break;if(null==a){if(16&t.d){a=l?"":n,++t.i;continue}if(65536&t.d){!r&&l||i(t,t=>{l?(f="tagged-string",c=l):f="quoted-string",l="",a=t});break}if(!l&&o(t,t=>{f="angle-bracketed-string",a=t}))break;a=l,l=""}else{if(65536&t.d){!r&&a||i(t,t=>{a?(f="tagged-string",c=a):f="quoted-string",a=t});break}if(!a&&o(t,t=>{f="angle-bracketed-string",a=t}))break}}if(null==a){if(!l&&je(t,t=>a=t)){f="date-time";break}e?l+=n:a=n}else{if(!a&&je(t,t=>a=t)){f="date-time";break}a+=n}++t.i}if(null==a){if(!l)return!1;h=ke({$:f,v:l})}else h=ke({$:f,n:l||void 0,t:c,v:a});for(;u(t,t=>h.x.push(t)););return n(h),!0}}function ze(t){return e=>{let r=e.s[e.i];return"\\"!==r?(e.d=t.delimiterOf(r),r):(++e.i,e.i<e.s.length?(r=e.s[e.i],e.d=t.delimiterOf(r)?1:0):e.d=1,r)}}function De(t){return e=>{const r=e.i;do{const r=e.s[e.i];if(!(2&t.delimiterOf(r)))break;e.i++}while(e.i<e.s.length);return e.i!==r}}function Me(t,e={}){const r=De(t),n=Ee(t,Object.assign(Object.assign({},e),{tagged:!1}));return(e,s)=>!!(8&t.delimiterOf(e.s[e.i]))&&(++e.i,r(e),n(e,s))}const Te={" ":7,"\t":7,",":5,";":9,'"':65569,"\\":33,"<":262145,">":524289,"=":17,"(":1,")":1,"/":1,":":1,"?":1,"@":1,"[":1,"]":1,"{":1,"}":1};function Re({delimit:t}={}){const e=t?Object.assign(Object.assign({},Te),t):Te;return{delimiterOf:t=>e[t]||(t>="\0"&&t<=" "||"\x7f"===t?1:0)}}const Fe=Re(),Ke=Re({delimit:{":":17,"(":131105,")":37," ":3,"\t":3,"=":1,",":1}});function qe(t){var e;const r=t?Re(t):Fe,n=function(t){const e=De(t);return r=>!!(4&t.delimiterOf(r.s[r.i]))&&(r.i++,e(r),!0)}(r),s=Me(r),i=Ee(r),o=(null===(e=t)||void 0===e?void 0:e.comments)?function(t){const e=De(t),r={next:ze(t)},n=Ee(t,r),s=Me(t,r);return(r,i)=>{if(!(131072&t.delimiterOf(r.s[r.i])))return!1;let o;for(++r.i;e(r)||s(r,t=>{o||(o=ke({$:"raw",v:""})),xe(o,t)})||n(r,t=>o=t););return++r.i,i(o||ke({$:"raw",v:""})),!0}}(Ke):Ae;return t=>{const e=[],r={i:0,s:t};for(;r.i<r.s.length&&(n(r)||s(r,t=>{e.length||e.push(ke({$:"raw",v:""})),xe(e[e.length-1],t)})||o(r,t=>e.push(t))||i(r,t=>e.push(t))););return e}}const Pe=qe();function Ue(t){if(!t)return'""';let e,r=!1;for(let n=0;n<t.length;++n){const s=t[n],i=Fe.delimiterOf(s);i?(32&i&&(e||(e=t.substring(0,n)),e+="\\"+s),r=!0):e&&(e+=s)}return r?`"${e||t}"`:t}var Ce={}.hasOwnProperty,Ie=/[ -,\.\/:-@\[-\^`\{-~]/,Ne=/[ -,\.\/:-@\[\]\^`\{-~]/,Ve=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,We=function t(e,r){"single"!=(r=function(t,e){if(!t)return e;var r={};for(var n in e)r[n]=Ce.call(t,n)?t[n]:e[n];return r}(r,t.options)).quotes&&"double"!=r.quotes&&(r.quotes="single");for(var n="double"==r.quotes?'"':"'",s=r.isIdentifier,i=e.charAt(0),o="",u=0,c=e.length;u<c;){var a=e.charAt(u++),h=a.charCodeAt(),l=void 0;if(h<32||h>126){if(h>=55296&&h<=56319&&u<c){var f=e.charCodeAt(u++);56320==(64512&f)?h=((1023&h)<<10)+(1023&f)+65536:u--}l="\\"+h.toString(16).toUpperCase()+" "}else l=r.escapeEverything?Ie.test(a)?"\\"+a:"\\"+h.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(a)?"\\"+h.toString(16).toUpperCase()+" ":"\\"==a||!s&&('"'==a&&n==a||"'"==a&&n==a)||s&&Ne.test(a)?"\\"+a:a;o+=l}return s&&(/^-[-\d]/.test(o)?o="\\-"+o.slice(1):/\d/.test(i)&&(o="\\3"+i+" "+o.slice(1))),o=o.replace(Ve,(function(t,e,r){return e&&e.length%2?t:(e||"")+r})),!s&&r.wrap?n+o+n:o};We.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},We.version="3.0.0";var Le=We,Je=/[A-Z]/g,Qe=/^ms-/,Ze={};function Be(t){return"-"+t.toLowerCase()}function Ge(t){return Le(t,{isIdentifier:!0})}function He(t){return Array.isArray(t)}function Xe(t){return!!t.length}class Ye{constructor(t){this.priority=t&&t.priority||0}important(){return this.prioritize(1)}usual(){return this.prioritize(0)}}function tr(t,e){return t===e||("object"==typeof t?t.is(e):"object"==typeof e&&e.is(t))}class er extends Ye{}class rr extends er{constructor(t,e){super(e),this.r=ir(t.r,255),this.g=ir(t.g,255),this.b=ir(t.b,255),this.a=null!=t.a?or(t.a,1):1}get type(){return"rgb"}get rgb(){return this}get hsl(){const{a:t}=this,e=100*this.r/255,r=100*this.g/255,n=100*this.b/255,s=Math.max(e,r,n),i=Math.min(e,r,n),o=Math.round((s+i)/2);if(s===i)return new nr({h:0,s:0,l:o,a:t},this);const u=s-i,c=Math.round(o>50?100*u/(200-s-i):100*u/(s+i));let a;switch(s){case e:a=(r-n)/u+(r<n?6:0);break;case r:a=(n-e)/u+2;break;default:a=(e-r)/u+4}return a*=60,a=Math.round(a),new nr({h:a,s:c,l:o,a:t},this)}by(t){return sr.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new rr(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{r:e=this.r,g:r=this.g,b:n=this.b,a:s=this.a}=t;return new rr({r:e,g:r,b:n,a:s},this)}toString(){const t=`${this.r}, ${this.g}, ${this.b}`;return 1===this.a?`rgb(${t})`:`rgba(${t}, ${this.a})`}}class nr extends er{constructor(t,e){var r;super(e),this.h=(r=t.h,(r%=360)<0?360+r:r),this.s=or(t.s,100),this.l=or(t.l,100),this.a=null!=t.a?or(t.a,1):1}get type(){return"hsl"}get rgb(){const{a:t}=this,e=this.s/100,r=this.l/100;if(!e){const e=255*r;return new rr({r:e,g:e,b:e,a:t},this)}const n=r<.5?r*(1+e):r+e-r*e,s=2*r-n,i=this.h/360;return new rr({r:ur(s,n,i+1/3),g:ur(s,n,i),b:ur(s,n,i-1/3),a:t},this)}get hsl(){return this}by(t){return sr.by(t)||this}is(t){return"object"==typeof t&&t.type===this.type&&t.h===this.h&&t.s===this.s&&t.l===this.l&&t.a===this.a&&t.priority===this.priority}prioritize(t){return this.priority===t?this:new nr(this,{priority:t})}set(t){"function"==typeof t&&(t=t(this));const{h:e=this.h,s:r=this.s,l:n=this.l,a:s=this.a}=t;return new nr({h:e,s:r,l:n,a:s},this)}toString(){const t=`${this.h}, ${this.s}%, ${this.l}%`;return 1===this.a?`hsl(${t})`:`hsla(${t}, ${this.a})`}}const sr={by(t){if("object"==typeof t&&("rgb"===t.type||"hsl"===t.type))return t}};function ir(t,e){return or(Math.round(t),e)}function or(t,e){return Math.max(Math.min(t,e),0)}function ur(t,e,r){let n,s=r;return s<0?s+=1:s>1&&(s-=1),n=s<1/6?t+6*s*(e-t):s<.5?e:s<2/3?t+(e-t)*(2/3-s)*6:t,255*n}function cr(t,e,r){const n=2*r-1,s=t.rgb,i=e.rgb,o=s.a-i.a,u=((n*o==-1?n:(n+o)/(1+n*o))+1)/2,c=1-u;return new rr({r:s.r*u+i.r*c,g:s.g*u+i.g*c,b:s.b*u+i.b*c,a:s.a*r+i.a*(1-r)},t)}class ar extends Ye{constructor(t){super(t),this.dim=t.dim}by(t){return this.dim.by(t)||this}toString(){return this.toFormula()}}const hr={map(t,e){const r={},n={from:e,get(n){if(n in r)return r[n];const s=function(t){switch(typeof t){case"function":return t;case"object":return t.by.bind(t)}const e=typeof t;return r=>typeof r===e?r:t}(t[n])(e[n],this,n);return r[n]=s,s}};return $(I(t),t=>n.get(t)),r},by:t=>hr.map.bind(void 0,t)};function lr(t){if(null==t)return[void 0,0];switch(typeof t){case"object":return[t,t.priority];case"string":if(t.endsWith("!important"))return[t.substring(0,t.length-"!important".length).trim(),1]}return[t,0]}class fr extends ar{constructor(t,e,r){super(r),this.val=t,this.unit=e}get type(){return"dimension"}toDim(t){const e=this.dim;if(t===e||t===e.pt||t===("%"===this.unit?t.pt:e.noPt))return this}is(t){return t===this||"object"==typeof t&&t.type===this.type&&this.unit===t.unit&&this.val===t.val&&this.priority===t.priority}prioritize(t){return this.priority===t?this:new fr(this.val,this.unit,{dim:this.dim,priority:t})}add(t,e){return"number"==typeof t&&(t=dr(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?dr(this.val+t.val,this.unit,this):gr(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=dr(t,e||this.unit,this)),"dimension"===t.type&&this.unit===t.unit?dr(this.val-t.val,this.unit,this):gr(this,"-",t)}mul(t){return 1===t?this:dr(this.val*t,this.unit,this)}div(t){return 1===t?this:dr(this.val/t,this.unit,this)}negate(){return dr(-this.val,this.unit,this)}toFormula(){return this.val+this.unit}}function dr(t,e,r){return t?new fr(t,e,r):r.dim.zero.prioritize(r.priority||0)}class pr extends ar{constructor(t,e,r,n){super(n),this.left=t.usual(),this.op=e,this.right=r}get type(){return"calc"}is(t){return this===t||"object"==typeof t&&t.type===this.type&&(this.op===t.op&&this.left.is(t.left)&&tr(this.right,t.right)&&this.priority===t.priority)}add(t,e){return"number"==typeof t&&(t=dr(t,e,this)),gr(this,"+",t)}sub(t,e){return"number"==typeof t&&(t=dr(t,e,this)),gr(this,"-",t)}mul(t){return mr(this,t)}div(t){return br(this,t)}toString(){return"calc"+super.toString()}}class yr extends pr{constructor(t,e,r,n){super(t,e,r.usual(),n)}prioritize(t){return this.priority===t?this:new yr(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(!e)return;const r=this.right.toDim(t);return r?e===this.left&&r===this.right?this:new yr(e,this.op,r,{dim:t,priority:this.priority}):void 0}negate(){return"-"===this.op?new yr(this.right,this.op,this.left,this):new yr(this.left.negate(),"-",this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right.toFormula()})`}}function gr(t,e,r){return r.type?new yr(t,e,r,t):t}class _r extends pr{prioritize(t){return this.priority===t?this:new _r(this.left,this.op,this.right,{dim:this.dim,priority:t})}toDim(t){const e=this.left.toDim(t);if(e)return e===this.left?this:new _r(e,this.op,this.right,{dim:t,priority:this.priority})}mul(t){return("*"===this.op?mr(this.left,this.right*t):br(this.left,this.right/t)).prioritize(this.priority)}div(t){return("/"===this.op?br(this.left,this.right*t):mr(this.left,this.right/t)).prioritize(this.priority)}negate(){return new _r(this.left,this.op,-this.right,this)}toFormula(){return`(${this.left.toFormula()} ${this.op} ${this.right})`}}function mr(t,e){return e?1===e?t.prioritize(t.priority):new _r(t,"*",e,t):t.dim.zero.prioritize(t.priority)}function br(t,e){return 1===e?t.prioritize(t.priority):new _r(t,"/",e,t)}class vr extends ar{constructor(t,e){super(e),this._byPriority=t}get type(){return 0}toDim(t){return t.zero.prioritize(this.priority)}is(t){return this===t||("object"==typeof t?t.type===this.type&&t.priority===this.priority:0===t||"0"===t?0===this.priority:"0 !important"===t&&1===this.priority)}add(t,e){return"number"==typeof t&&(t=dr(t,e,this)),t.prioritize(this.priority)}sub(t,e){return"number"==typeof t&&(t=dr(t,e,this)),t.negate().prioritize(this.priority)}mul(){return this}div(){return this}negate(){return this}prioritize(t){return this._byPriority.get(t)}important(){return this._byPriority.important}usual(){return this._byPriority.usual}toFormula(){return"0"}}class wr{constructor(t){this.dim=t,this.usual=new vr(this,{dim:t}),this.important=new vr(this,{dim:t,priority:1})}get(t){switch(t){case 0:return this.usual;case 1:return this.important}return new vr(this,{dim:this.dim,priority:t})}}function Or({pt:t,noPt:e}){const r={get zero(){return n},get pt(){return t()},get noPt(){return e()},of(t,e){return t?new fr(t,e,{dim:this}):n},by(t){if(!function(t){return"object"==typeof t&&("dimension"===t.type||"calc"===t.type||0===t.type)}(t))return;return t.toDim(this)}},n=new wr(r).usual;return r}const kr=Or({pt:()=>xr,noPt:()=>kr}),xr=Or({pt:()=>xr,noPt:()=>kr});class Sr extends Ye{constructor(t,e){super(e),this.url=t}get type(){return"url"}static by(t){switch(typeof t){case"string":{const[e,r]=lr(t);return new Sr(e,{priority:r})}case"object":if("url"===t.type)return t}}by(t){return Sr.by(t)||this}prioritize(t){return t===this.priority?this:new Sr(this.url,{priority:t})}is(t){return"object"==typeof t&&"url"===t.type&&t.url===this.url&&t.priority===this.priority}toString(){return`url('${Le(this.url)}')`}}const $r=ft({});function jr(){return $r}function Ar(t,e){if(!e)return $r;if("string"!=typeof e){if(W(e))return zr(e);if(X(e))return zr(Er(e));if("function"==typeof e){const r=e(t);if("string"!=typeof r){if(W(r))return zr(r);if(X(r))return zr(Er(r))}return ft(Dr(r))}}return ft(Dr(e))}function Er(t){return lt(t,f({}))}function zr(t){return lt(t).keep.thru(Dr,function(){let t;return e=>t&&function(t,e){const r=w(Mr(e));for(const[e,n]of Mr(t)){const{value:t}=r.next();if(!t||e!==t[0]||!tr(n,t[1]))return!1}return!r.next().value}(e,t)?m():t=Object.assign({},e)}(),c)}function Dr(t){return"string"==typeof t?{$$css:t}:t}function Mr(t){return D(N(t),h)}function Tr(t,e){return zr(_t({base:t,addendum:e}).keep.thru(({base:[t],addendum:[e]})=>function(t,e){return E(N(e),(t,[e,r])=>function(t,e,r){Rr(t[e])<=Rr(r)&&(delete t[e],t[e]=r);return t}(t,e,r),Object.assign({},t))}(t,e)))}function Rr(t){switch(typeof t){case"string":return t.endsWith("!important")?1:0;case"object":return t.priority}return 0}function Fr(t){return">"===t||"+"===t||"~"===t}function Kr(t){if(!He(t))return[qr(t)];const e=[];let r;for(const n of t){const t=r;let s;if(r&&(e.push(r),r=void 0),Fr(n)){if(r=n,!t)continue;s={}}else s=qr(n);e.push(s)}return r&&e.push(r,{}),e}function qr(t){return"string"==typeof t?t?{s:t}:{}:Pr(t)}function Pr(t){const e=t.ns||void 0,r=t.i||void 0,n=function(t){if(!t)return;if(oe(t))return[t];const e=t.filter(t=>!!t);return Xe(e)?e.sort(ue):void 0}(t.c),s=function(t){if(!t)return;if(function(t){return"string"!=typeof t[0]}(t)){const e=t.map(Ur);return Xe(e)?e:void 0}return[Ur(t)]}(t.u);return{ns:e,e:("*"!==t.e||!e&&!r&&!n&&s&&Cr(s[0]))&&t.e||void 0,i:r,c:n,u:s,s:t.s||void 0,$:Ir(t.$)}}function Ur(t){if(!Cr(t))return t;if(t.length<3)return t;const[e,r,...n]=t;return He(n[0])?[e,r,...n.map(Kr)]:[e,r,Kr(n)]}function Cr(t){return t.length>1&&(":"===t[0]||"::"===t[0])}function Ir(t){if(t)return Xe(t=He(t)?Array.from(new Set(M(t,Vr))).sort():Array.from(Vr(t)))?t:void 0}const Nr=new Set;function Vr(t){if(!t)return Nr;const e=t.indexOf("="),r=e<0?t:t.substring(0,e),n=new Set;let s;for(const t of r.split(":"))s?s+=":"+t:s=t,n.add(s);return e>=0&&n.add(t),n}const Wr=[[]];function Lr(t){if(!t.length)return Wr;let e,r=0;for(;;){const n=t[r++];if(!Fr(n))return[e?[e,n]:[n],t.slice(r)];e=n}}const Jr=[];function Qr(t,e){return t&&e.every(e=>t.find(t=>function(t,e){if("string"==typeof t)return"string"==typeof e?t===e:!e[1].url&&e[0]===t;const[r,{url:n}]=t;return"string"==typeof e?!n&&r===e:r===e[0]&&n===e[1].url}(e,t)))}function Zr(t){return Kr(t)}const Br={qualify:t=>`@${Ge(t)}`};function Gr(t){return Xr(t,Br)}const Hr={};function Xr(t,{qualify:e,nsAlias:r=ae()}=Hr){const n={qualify:e,nsAlias:r};return t.reduce((t,e)=>Fr(e)?t+e:(t&&!Fr(t[t.length-1])&&(t+=" "),t+function(t,{qualify:e,nsAlias:r}){const{ns:n,e:s,i,c:o,s:u,u:c,$:a}=t;let h=!1,l="";i&&(h=!0,l+=`#${Ge(re.name(i,r))}`);o&&(h=!0,l=o.reduce((t,e)=>`${t}.${Ge(se.name(e,r))}`,l));if(c){h=!0;const t={nsAlias:r};l=c.reduce((e,r)=>function(t,e,r){if(Cr(e)){if(t+=e[0]+e[1],e.length>2){t+="("+Xr(e[2],r);for(let n=3;n<e.length;++n)t+=","+Xr(e[n],r);t+=")"}return t}const[n,s,i,o]=e;t+="["+Ge(n),s&&(t+=s+Le(i,{quotes:"double",wrap:!0}));o&&(t+=" "+o);return t+"]"}(e,r,t),l)}u&&(h=!0,l+=u);e&&a&&(l=a.reduce((t,r)=>t+e(r),l));if(n){const t=function(t,e){return"string"==typeof t?t:t.url?e(t):void 0}(n,r);l=t?`${t}|${s||"*"}${l}`:f()}else l=f();return l;function f(){return h?`${s?te.name(s,r):""}${l}`:`${s?te.name(s,r):"*"}${l}`}}(e,n)),"")}function Yr(t){return"cssRules"in t}class tn{constructor(t){this._rule=t}read(t){let e=this._rule.outer;for(;e;)t=Tr(e.read.keep.thru(nn),t),e=e.outer;return t}render(t,e){const{selector:r}=t;let{target:n}=t;if(!Yr(n))return void t.render(e);let s=n;const i=function(t){const e=new Map,r=[];for(const n of t)Fr(n)?r.push(n):r.push(on(n,e));if(!e.size)return;return[e,Zr(r)]}(r);if(!i)return void t.render(e);const[o,u]=i;for(const t of o){const r=s.insertRule(`${en(e,t)}{}`,s.cssRules.length),i=s.cssRules[r];n=i,Yr(i)&&(s=i)}t.render(e,{target:n,selector:u})}}function en(t,[e,[r,n]]){let s="";const i=t=>{t&&(s&&(s+=" and "),s+=t)};for(const e of r){const[r]=lr(t[e]);i(r)}return i(n),s?`${e} ${s}`:e}const rn={order:-65535,create:t=>new tn(t)};function nn(t){return E(D(N(t),sn),(t,[e,r])=>(t[e]=r,t),{})}function sn(t){return"@"===String(t[0])[0]}function on(t,e){const r=t.$;if(!r)return t;const n=[];for(const t of r)"@"===t[0]?un(e,t):n.push(t);return n.length===r.length?t:Xe(n)?Object.assign(Object.assign({},t),{$:n}):Object.assign(Object.assign({},t),{$:void 0})}function un(t,e){const r=e.indexOf("=");let n,s;r<0?n=e:(n=e.substring(0,r),s=e.substring(r+1));const i=n.indexOf(":"),o=i<0?n:n.substring(0,i),u=t.get(o);if(u){const[t,e]=u;t.add(n),s&&(u[1]=e?`${e} and ${s}`:s)}else t.set(o,[(new Set).add(n),s])}const cn={order:-65534,needs:rn,render(t,e){const r=t.styleSheet;let n=0,s=0;for(const[t,i]of N(e)){const e=String(t);if("@"===e[0]){const[t]=lr(i),o=an(r,n,e,t);n+=o,s+=o;const u=Sr.by(t);u&&(s+=hn(r,s,e,u),s+=ln(r,s,e,u))}}t.render(e)}};function an(t,e,r,n){if(!r.startsWith("@import:"))return 0;let s=`@import ${new Sr(r.substring("@import:".length))}`;return n&&(s+=" "+n),t.insertRule(s+";",e),1}function hn(t,e,r,n){return"@namespace"!==r?0:(t.insertRule(`@namespace ${n};`,e),1)}function ln(t,e,r,n){if(!r.startsWith("@namespace:"))return 0;const s=r.substring("@namespace:".length);return t.insertRule(`@namespace ${s} ${n};`,e),1}function fn(t,e){const r=t.addRule(),{style:n}=r;$(D(N(e),dn),([t,e])=>{const[r,s]=lr(e);n.setProperty(function(t){if(Ze.hasOwnProperty(t))return Ze[t];var e=t.replace(Je,Be);return Ze[t]=Qe.test(e)?"-"+e:e}(t),`${r}`,s>=1?"important":void 0)}),t.render(e,{target:r})}function dn(t){const[e,r]=t;if(null==r)return!1;const n=String(e)[0];return n>="a"&&n<="z"||n>="A"&&n<="Z"}function pn(t){if("function"==typeof t)return{create:()=>({render:t})};if(function(t){return"create"in t}(t))return{order:t.order,needs:t.needs,create:e=>function(t){return"function"==typeof t?{render:t}:t}(t.create(e))};const e=t.render.bind(t);return{order:t.order,needs:t.needs,create:()=>({render:e})}}function yn(t,e){const r=t.order||0,n=e.order||0;return r>n?1:r<n?-1:0}function gn(t,e={}){const{document:r=window.document,rootSelector:n={e:"body"},addStyleSheet:s=_n,scheduler:i=_e,nsAlias:o=ae()}=e,{parent:u=r.head}=e,c=r.defaultView||window,h={nsAlias:o},l=function(t){const e=new Map;return r(t.render),e.delete(fn),[...e.values(),pn(fn)].sort(yn);function r(t){t&&(He(t)?t.forEach(n):n(t))}function n(t){if(e.has(t))return;const n=pn(t);e.set(t,n),r(n.needs)}}(e),f=E(T(t,y),(t,e)=>J(r=>{e.off(r),t.off(r)}),J());const d=function(){const e=new Map,r=ot(t)((t,r)=>{t.forEach(t=>e.set(t,y(t))),r.forEach(t=>e.delete(t))});return J(t=>{r.off(t),$(e.values(),e=>e.off(t)),e.clear()}).needs(r)}();return J(t=>{d.off(t),f.off(t)}).needs(f).needs(d);function p(t,e,n){return new class{get document(){return r}get parent(){return u}get rule(){return t}get styleSheet(){return n.styleSheet}get target(){return n.target}get selector(){return n.selector}nsAlias(t){return o(t)}render(r,s){e(s?p(t,e,{styleSheet:n.styleSheet,target:s.target||n.target,selector:s.selector||n.selector}):this,r)}addRule(t=n.selector){const e=n.target;if(!Yr(e))return e;const r=e.insertRule(`${s=t,function(t,e){return Xr(Zr(t),e)}(s,h)}{}`,e.cssRules.length);var s;return e.cssRules[r]}}}function y(t){const[e,r]=function(t){const e=l.map(e=>e.create(t));return[e.reduce((t,e)=>e.read?lt(e.read(t)):t,t.read),function t(r){return(n,s)=>{const i=r+1;let o;o=i===l.length?a:t(i);const u=p(n.rule,o,n);e[r].render(u,s)}}(0)]}(t);let o;const u=function(t){const e=t.selector;if(!e.length)return Zr(n);if(Fr(e[0]))return[...Zr(n),...e];return e}(t),h=i({window:c});return e((function(e){h(()=>{o&&function(t){for(;t.cssRules.length;)t.deleteRule(t.cssRules.length-1)}(o.styleSheet);const n=p(t,r,{get styleSheet(){return o||(o=s(n)),o.styleSheet},get target(){return this.styleSheet},selector:u});n.render(e)})})).whenOff((function(){h(()=>{const t=o;if(t)return o=void 0,t.remove()})}))}}function _n(t){const{document:e,parent:r}=t,n=e.createElement("style");return n.setAttribute("type","text/css"),n.append(e.createTextNode("")),r.append(n),{styleSheet:n.sheet,remove(){n.parentElement.removeChild(n)}}}function mn(t,e){const r=e.$$css;if(r){const n=t.addRule();n.style.cssText=r,t.render(e,{target:n})}else t.render(e)}const bn={order:-65535,needs:cn,render(t,e){const r=D(T(U(t.selector),t=>!Fr(t)&&t.ns&&"string"!=typeof t.ns?t.ns:null),h);function n(e,r){return e[`@namespace:${t.nsAlias(r)}`]=new Sr(r.url),e}t.render(j(r)?e:E(r,n,Object.assign({},e)))}};function vn(t,e={}){return gn(t,Object.assign(Object.assign({},e),{render:wn(e.render)}))}function wn(t){const e=[rn,bn,cn,mn];return t&&(He(t)?e.push(...t):e.push(t)),e}class On{get[V](){return this.read}add(t){return this.rules.add([],t)}clear(){return this.set()}}class kn{get[V](){return this.read}get[H](){return this.onUpdate}}class xn extends kn{}class Sn extends kn{constructor(t,e){let r,n,s;super(),e?(r=()=>D(t,e),n=t=>t.filter(e)):(r=()=>t,n=c),this.onUpdate=it(e=>{const i=s||(s=new Set(r()));ot(t)({supply:e.supply.whenOff(()=>s=void 0),receive(t,r,s){r=n(r),((s=n(s)).length||r.length)&&(s.forEach(t=>i.delete(t)),r.forEach(t=>i.add(t)),e.receive(t,r,s))}})}).share(),this.read=lt(this.onUpdate.thru(l(this)),f(this)),this[Symbol.iterator]=()=>s?s.values():O(r())}grab(t){return $n(this,t)}}function $n(t,e){const r=function(t){return Pr(t)}(e);return new Sn(t,t=>function(t,e){if(!t.length)return!1;const r=t[t.length-1];return(!e.ns||r.ns===e.ns)&&((!e.e||r.e===e.e)&&((!e.i||r.i===e.i)&&(!(e.c&&!Qr(r.c,e.c))&&!(e.$&&!Qr(r.$,e.$)))))}(t.selector,r))}class jn extends xn{constructor(t,e){super(),this._root=t,this.nested=e,this._updates=new gt,this.self=function(t,e){const r=new gt,n=[t];e.onUpdate((e,s)=>{s[0]===t&&(n.length=0,r.send([],[t]))}).whenOff(t=>r.done(t));return new Sn(new class{get[H](){return r.on}[Symbol.iterator](){return O(n)}})}(t,this),this.read=lt(this._updates.on.thru(l(this)),f(this))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return En(this._root)}grab(t){return $n(this,t)}add(t,e){return function t(e,r,n,s){const[i,o]=Lr(r);if(!o)return e._spec.it=function(t,e){const r=t._spec.it;if(!e)return r;if(t.empty)return t=>Ar(t,e);return t=>Tr(r(t),Ar(t,e))}(e,n),e;const u=Gr(i),c=e.rules.nested._rule(u);if(c)return t(c,o,n,s);const a=new Dn(e.root,[...e.selector,...i],i),h=t(a,o,n,!1);return e.rules.nested._add(u,a,s),h}(this._root,Zr(t),e,!0)}get(t){return this._get(Zr(t))}_get(t){const[e,r]=Lr(t);if(!r)return this._root;const n=this.nested._rule(Gr(e));return n?n.rules.get(r):void 0}watch(t){const e=Zr(t);return ht(t=>{const r=jt({}),n=this.read.consume(()=>{const t=this._get(e);return t&&t.read(t=>r.it=t).whenOff(()=>r.it={})}),s=r.read(t);return n.needs(s),s}).share()}_add(t,e){t.rules.onUpdate((t,e)=>this._updates.send(t,e)),e&&this._updates.send(An(t),[])}_remove(t){const e=An(this._root);this._updates.send([],e),e.forEach(e=>{e.rules._updates.done(t),e._spec.done(t)})}}function An(t){return Array.from(En(t))}function*En(t){yield t;for(const e of t.rules.nested)yield*An(e)}class zn extends kn{constructor(t){super(),this._updates=new gt,this._byKey=new Map,this._all=new jn(t,this),this.read=lt(this._updates.on.thru(l(this)),f(this))}get onUpdate(){return this._updates.on}[Symbol.iterator](){return this._byKey.values()}grab(t){return $n(this,t)}_rule(t){return this._byKey.get(t)}_add(t,e,r){this._byKey.set(t,e),e.rules.onUpdate((r,n)=>{n[0]===e&&(this._byKey.delete(t),this._updates.send([],[e]))}),r&&this._updates.send([e],[]),this._all._add(e,r)}}class Dn extends On{constructor(t,e,r,n=jr){super(),this._root=t||this,this._selector=e,this._key=r,this._spec=jt(n),this._read=this._spec.read.keep.dig(t=>t(this)),this._nested=new zn(this)}get root(){return this._root}get outer(){if(void 0!==this._outer)return this._outer;const t=function(t){let e=t.length-1;if(e<=0)return e?void 0:Jr;do{switch(--e,t[e]){case">":return t.slice(0,e);case"+":case"~":--e;continue;default:return t.slice(0,e+1)}}while(e>0)}(this.selector);return this._outer=t&&this.root.rules.get(t)||null}get selector(){return this._selector}get key(){return this._key}get empty(){return this._spec.it===jr}get read(){return this._read}get rules(){return this._nested._all}set(t){return this._spec.it=t?e=>Ar(e,t):jr,this}remove(t){return this.rules._remove(t),this}}const Mn=[];function Tn(t){return new Dn(void 0,Mn,[],t?e=>Ar(e,t):void 0)}const Rn={by(t,e){let r;return r="function"==typeof e?t=>Fn(e(t)):l(Fn(e)),function(e){const n=_t({ms:r(e),ps:e.rules.watch(t)}).keep.thru(({ms:[t],ps:[e]})=>hr.map(t,e));return new class extends class{get[V](){return this.read}clear(){return this.set()}}{get read(){return n}add(r){return e.rules.add(t,r),this}set(r){return e.rules.add(t).set(r),this}}}}};function Fn(t){return W(t)?t:ft(t)}class Kn{constructor(t){this.refs=t}static by(t,e){const r={};for(const n of Object.keys(t))r[n]=t[n](e);return new Kn(r)}get read(){if(this._read)return this._read;const t=_t(this.refs);return this._read=t.keep.thru(qn)}get[V](){return this.read}}function qn(t){const e={};for(const r of Object.keys(t))e[r]=t[r][0];return e}const Pn=new Sn({[H]:ut,[Symbol.iterator]:()=>[][Symbol.iterator]()});function Un(...t){return t.length?Vn(t.map(Cn)):Pn}function Cn(t){return"function"==typeof t?function(t){let e;return{[Symbol.iterator]:()=>r()[Symbol.iterator](),get[H](){return r()[H]}};function r(){return e||(e=Wn(t()))}}(t):Wn(t)}function In(...t){return t.length?Vn(t.map(Nn)):Pn}function Nn(t){return"function"==typeof t?function(t){const e=new Set,r=it(r=>{const n=Wn(t());Ln(n,e,r),n[H]({supply:r.supply.whenOff(()=>e.clear()),receive(t,n,s){s.forEach(t=>e.delete(t)),n.forEach(t=>e.add(t)),r.receive(t,n,s)}})}).share();return{[H]:r,[Symbol.iterator]:()=>e.values()}}(t):Wn(t)}function Vn(t){if(1===t.length){const e=t[0];return e instanceof kn?e:new Sn(e)}return new Sn({*[Symbol.iterator](){for(const e of t)yield*e},get[H](){return it(e=>{t.forEach(t=>ot(t)({supply:J().needs(e.supply),receive(t,r,n){e.receive(t,r,n)}}))}).share()}})}function Wn(t){return t instanceof On?t.rules.self:X(t)?t:function(t){const e=new Set,r=it(r=>{let n=B();const{supply:s}=r;s.whenOff(t=>{n.off(t),e.clear()}),t.then(t=>{if(!s.isOff){const i=t instanceof On?t.rules:t;Ln(i,e,r),n=ot(i)({receive(t,n,s){s.forEach(t=>e.delete(t)),n.forEach(t=>e.add(t)),r.receive(t,n,s)}}).needs(s)}})}).share();return{[H]:r,[Symbol.iterator]:()=>e.values()}}(t)}function Ln(t,e,r){const n=[];if($(t,t=>{n.push(t),e.add(t)}),n.length){const t=new tt;t.on(r),t.send(n,[])}}class Jn extends Set{constructor(t){super(),this._added=new Set(t),this._removed=new Set,this._added.forEach(t=>this.add(t))}add(t){return this.has(t)||(this._added.add(t),this._removed.delete(t),super.add(t)),this}delete(t){return!!super.delete(t)&&(this._added.delete(t),this._removed.add(t),!0)}clear(){this._added.clear(),this.forEach(t=>this._removed.add(t)),super.clear()}delta(t,e=[]){return Qn(this)(t,e),this}redelta(t){return("function"==typeof t?t:Qn(t))([...this._added],[...this._removed]),this}undelta(){return this._added.clear(),this._removed.clear(),this}}function Qn(t){return(e,r)=>{for(const e of r)t.delete(e);for(const r of e)t.add(r)}}const Zn=Symbol("in-aspect"),Bn={instance:null,convertTo:a};function Gn(t){return{instance:t,convertTo(){return this}}}function Hn(t,...e){if(!t)return Yn;const r=ts(t),n=T(e,ts);return(t,e)=>{const s=r(t,e),i=Array.from(D(T(n,r=>r(t,e)),h)),o=t=>{if(s.applyAspect){const e=s.applyAspect(t);if(e)return e}for(const e of i){const r=e.applyAspect(t);if(r)return r}};return function(t){return null==t.get}(s)?{get:c,set:c,applyAspect:o}:{set:t=>s.set(t),get:t=>s.get(t),applyAspect:o}}}const Xn={get:c,set:c};function Yn(){return Xn}function ts(t){return"function"==typeof t?t:l(t)}class es extends St{constructor(){super(...arguments),this._aspects=new Map}aspect(t){return this._aspect(t[Zn]).instance}setup(t,e=a){return Zn in t?e(this.aspect(t),this):t(this),this}convert(t,...e){return new rs(this,Hn(t,...e))}_aspect(t){const e=this._aspects.get(t);if(e)return e;const r=this._applyAspect(t)||t.applyTo(this);return this._aspects.set(t,r),r}_applyAspect(t){}}class rs extends es{constructor(t,e){super();let r,n=0;const s=new gt;this.on=s.on;const i=e(t,this),o=e=>t._aspect(e).convertTo(this);this._applyAspect=t=>{var e,r;return(null===(r=(e=i).applyAspect)||void 0===r?void 0:r.call(e,t))||o(t)},this._it=jt([i.set(t.it),0]),this._it.on(([t],[e])=>{t!==e&&s.send(t,e)}).whenOff(t=>s.done(t)),t.on(t=>{t!==r&&(this._it.it=[i.set(t),++n])}).whenOff(t=>this.done(t)),this._it.on(([e,s])=>{if(s!==n){n=s,r=i.get(e);try{t.it=r}finally{r=void 0}}})}get it(){return this._it.it[0]}set it(t){const[e,r]=this._it.it;t!==e&&(this._it.it=[t,r+1])}done(t){return this._it.done(t),this}}const ns={applyTo:()=>Bn};class ss extends es{static get[Zn](){return ns}_applyAspect(t){return t===ns?Gn(this):void 0}}const is={applyTo:()=>Gn(new us)};class os{static get[Zn](){return is}get[H](){return this.on}get[V](){return this.read}}class us extends os{constructor(){super(),this._map=new Map,this._on=new gt;const t=this._map;function e(){return t.keys()}this.read=ht(this._on.on.thru(e),()=>[e()])}get on(){return this._on.on}add(t){const e=this._map.get(t);if(e)return e;const r=J(()=>{this._map.delete(t),this._on.send([],[t])});return this._map.set(t,r),this._on.send([t],[]),r}}const cs={applyTo:()=>Bn};class as extends es{static get[Zn](){return cs}_applyAspect(t){return t===cs?Gn(this):void 0}}const hs={applyTo:t=>Gn(new ps(t))};class ls{static get[Zn](){return hs}get[H](){return this.on}get[V](){return this.read}static hasData(t){return"off"!==t&&"-"!==t[0]}done(t){return this.own.done(t),this}}class fs extends St{constructor(t){super(),this._tracker=jt(t?function(t){return null!=t.getAttribute("disabled")?"off":null!=t.getAttribute("readonly")?"ro":"on"}(t.element):"on")}get on(){return this._tracker.on}get it(){return this._tracker.it}set it(t){switch(t){case"off":case"ro":case"-on":case"-ro":break;default:t="on"}this._tracker.it=t}done(t){return this._tracker.done(t),this}}class ds{constructor(){this._all=new Set,this._on=new gt;const t=ht(this._on.on.thru(()=>this._all),f(this._all));this.read=t.keep.dig(t=>mt(...t).keep.thru(gs))}add(t){const e=lt(t),r=J(()=>{this._all.delete(e),this._on.send()});return this._all.add(e),this._on.send(),r}}class ps extends ls{constructor(t){super(),this._derived=new ds;const e=t.aspect(as);this.own=new fs(e),this.derive(t.aspect(os).read.keep.dig_(ys));let r="on";this.read=ht(_t({derived:this._derived.read,own:this.own}).thru(({derived:[t],own:[e]})=>{let n;if("off"===e||"off"===t)n="off";else{let r=!1;"-"===e[0]&&(r=!0,e=e.substring(1)),"-"===t[0]&&(r=!0,t=t.substring(1)),n="ro"===t?"ro":e,r&&(n="-"+n)}return r===n?m():d(r=n)}),f(r)),e&&this.read(t=>function(t,e){switch(e){case"off":t.setAttribute("disabled","");break;case"ro":case"-ro":t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly","");break;default:t.setAttribute("disabled",""),t.removeAttribute("disabled"),t.setAttribute("readonly",""),t.removeAttribute("readonly")}}(e.element,t));let n="on";this.on=this.read.thru(t=>{const e=n;return e===t?m():d(n=t,e)})}derive(t){return this._derived.add(t)}}function ys(t){const e=Array.from(t);return e.length?mt(...e.map(({parent:t})=>t.aspect(ls))).keep.thru_(gs):ft("on")}function gs(...t){let e=!1,r=!1;for(const[n]of t)switch(n){case"off":return"off";case"ro":e=!0;break;case"-on":r=!0;break;case"-ro":r=!0,e=!0}return r?e?"-ro":"-on":e?"ro":"on"}const _s={applyTo:t=>({instance:_t({value:t,mode:t.aspect(ls)}).keep.thru(({value:[t],mode:[e]})=>function(t,e){return ls.hasData(e)?d(t):d()}(t,e)),convertTo:a})};const ms={get[Zn](){return _s}};class bs extends ss{}const vs={};class ws{constructor(t){this._map=t}get(t){const e=this._map.get(t);return e&&e[0]}[Symbol.iterator](){return O(T(this._map.values(),([t])=>t))}entries(){return O(T(this._map.entries(),([t,[e]])=>[t,e]))}}class Os{constructor(t){this._controls=t,this._supply=J(),this._map=new Map}set(t,e,r,n){const s=this,i=this._map.get(t);if(e){if(i){if(i[0]===e)return;n.push([t,i])}const u=[e,J(e=>{e!==vs&&s._controls.remove(t)}).needs(s._supply)];o().set(t,u),r.push([t,u])}else i&&(n.push([t,i]),o().delete(t));function o(){if(s._shot){const t=new Map;$(s._map.entries(),([e,r])=>t.set(e,r)),s._shot=void 0,s._map=t}return s._map}i&&i[1].off(vs)}snapshot(){return this._shot||(this._shot=new ws(this._map))}clear(){const t=[],e=[];return $(this._map.keys(),r=>this.set(r,void 0,t,e)),e}}class ks extends class extends class{get[H](){return this.on}get[V](){return this.read}}{remove(t){return this.set(t,void 0)}}{constructor(t){super(),this._group=t,this._updates=new gt;const e=this;this._map=new Os(this),this.on=this._updates.on.thru((t,e)=>d(t.map(xs),e.map(xs))),this.read=ht(this._updates.on.thru(()=>this._map.snapshot()),()=>[this._map.snapshot()]),this._map._supply.needs(t.read((function(t){e.read.once(e=>{const r=new Set;$(N(t),([t,n])=>{r.add(t);const s=e.get(t);s&&(s.it=n)}),$(e.entries(),([t,e])=>{r.has(t)||(e.it=void 0)})})})))}set(t,e){const r=this._group,n=[],s=[];return"object"==typeof t?$(N(t),([t,e])=>{this._map.set(t,e,n,s)}):this._map.set(t,e,n,s),(n.length||s.length)&&(this._updates.send(n,s),n.length&&function(){let t;n.forEach(([e,[n,s]])=>{s.needs(n.aspect(os).add({parent:r}).needs(s));const i=n.it;if(t)t[e]=i;else{const n=r.it;n[e]!==i&&(t=Object.assign(Object.assign({},n),{[e]:i}))}}),t&&(r.it=t);n.forEach(([t,[e,n]])=>{n.needs(e.read(e=>{r.it[t]!==e&&(r.it=Object.assign(Object.assign({},r.it),{[t]:e}))}).needs(n))})}()),this}clear(){const t=this._map.clear();return t.length&&this._updates.send([],t),this}}function xs([t,[e]]){return[t,e]}class Ss extends bs{constructor(t){super(),this._model=jt(t),this.controls=new ks(this)}get on(){return this._model.on}get it(){return this._model.it}set it(t){this._model.it=t}done(t){return this._model.done(t),this}_applyAspect(t){return t===ms[Zn]?{instance:(e=this,_t({cs:e.controls,model:e,mode:e.aspect(ls)}).keep.dig_($s)),convertTo:a}:super._applyAspect(t);var e}}function $s({cs:[t],model:[e],mode:[r]}){if(!ls.hasData(r))return ft();const n={};return $(t.entries(),([t,e])=>{n[t]=e.aspect(ms)}),_t(n).keep.thru(t=>{const r=Object.assign({},e);return $(N(t),([t,[e]])=>{r[t]=e}),r})}function js(t){return new Ss(t)}const As=ft();function Es(){return As}function zs(t){return W(t)?l(lt(t)):"function"==typeof t?e=>lt(t(e)):e=>e.read.keep.thru(function(t,e){return()=>{const r=e.validate(t);return null==r?d():Array.isArray(r)?d(...r):r}}(e,t))}const Ds={};class Ms{constructor(t){const e=new gt,r=new Map,n=new Map;let s=a,i=a;this[V]=ht(t=>{const o=lt(e,f())(t).whenOff(()=>{s=a,i=a});i=(t,e)=>{const r=t((...e)=>{if(e.length)n.set(t,e);else if(!n.delete(t))return;s()}).needs(e).whenOff(r=>{r!==Ds&&e.off(r),n.delete(t)&&s()});o.whenOff(()=>r.off(Ds))},$(r.entries(),([t,e])=>i(t,e)),s=()=>{e.send(...M(n.values(),c))},n.size&&s()}).share(),this.from=e=>{const n=zs(e)(t),s=J(()=>{r.delete(n)});return r.set(n,s),i(n,s),s}}}const Ts={applyTo(t){const e=new Ps(t);return{instance:e,convertTo:t=>function t(e,r){const n=new Ps(r);return n.by(e._messages),{instance:n,convertTo:e=>t(n,e)}}(e,t)}}};class Rs{static get[Zn](){return Ts}get[V](){return this.read}}const Fs={get ok(){return!0},messages:()=>[],has:()=>!1,[Symbol.iterator]:()=>[][Symbol.iterator]()};class Ks{constructor(t){this._byCode=new Map,this._all=[],$(t,t=>{let e=!1;$(N(t),([r,n])=>{if(n){e=!0;const n=this._byCode.get(r);n?n.push(t):this._byCode.set(r,[t])}}),e&&this._all.push(t)})}get ok(){return!this._all.length}messages(t){return null==t?this._all:this._byCode.get(t)||[]}has(t){return null==t||this._byCode.has(t)}[Symbol.iterator](){return this._all[Symbol.iterator]()}}function qs(...t){return t.length?new Ks(t):Fs}class Ps extends Rs{constructor(t){super(),this._messages=new Ms(t);const e=t.aspect(ss);e&&this._messages.from(function(t){return t.controls.read.keep.dig_(Us).keep.thru(Cs)}(e)),this.read=lt(this._messages).keep.thru(qs)}by(...t){return this._messages.from(function(...t){const e=t.length;return 1===e?t[0]:e?e=>{const r=new Ms(e);return t.forEach(t=>r.from(t)),r}:Es}(...t))}}function Us(t){return mt(...T(t,t=>t.aspect(Rs)))}function Cs(...[t]){return d(...M(t,c))}function Is(t){return t?t.read.keep.thru(t=>t?d():{missing:"missing"}):Is}class Ns extends as{constructor(t,{get:e,set:r}){super(),this.element=t,this._input=new gt,this._get=e,this._set=r,this._value=this.it;const n=this._update=(t,e)=>u({value:t},e);this.input=lt(this._input.on.thru(c),()=>[{value:this.it}]),this.on=this._input.on.thru(({value:t},e)=>t===e?m():d(t,e)),this.events=new we(t);const s=this,i=this._supply=J(t=>this._input.done(t)),o=t=>u({value:s.it,event:t},s._value);function u(t,e){for(;;){let r;s._value=t.value,s._update=(e,n)=>{r=[Object.assign(Object.assign({},t),{value:e}),n]};try{s._input.send(t,e)}finally{s._update=n}if(!r)break;[t,e]=r}}this.events.on("input")(o).needs(i),this.events.on("change")(o).needs(i)}get it(){return this._get()}set it(t){const e=this.it;t!==e&&(this._set(t),this._update(this._get(),e))}done(t){return this._supply.off(t),this}}function Vs(t){return new Ns(t,{get(){return this.element.value},set(t){this.element.value=t}})}const Ws={applyTo(t){const e=t.aspect(as);return e?Gn(new Js(e)):Bn}};class Ls extends St{static get[Zn](){return Ws}}class Js extends Ls{constructor({element:t,events:e}){super();const r=t.getRootNode?t.getRootNode():t.ownerDocument;this._it=jt(!!r&&r.activeElement===t),e.on("focus")(()=>this._it.it=!0),e.on("blur")(()=>this._it.it=!1),this.on({receive(e,r){e.onRecurrent(a),r?t.focus():t.blur()}})}get on(){return this._it.on}get it(){return this._it.it}set it(t){this._it.it=t}done(t){return this._it.done(t),this}}const Qs={applyTo(t){const e=t.aspect(ss);return Gn(null!=e?new Hs(e):new Gs(t))}};class Zs{static get[Zn](){return Qs}get[V](){return this.read}}const Bs={hasFocus:!1,touched:!1,edited:!1};class Gs extends Zs{constructor(t){super(),this._flags=jt(Bs),this._flags.by(function(t,e){const r=e.aspect(as);return _t({hasFocus:e.aspect(Ls)||ft(!1),edited:r?r.input.keep.thru(({event:t})=>!!t):ft(!1)}).keep.thru(({hasFocus:[e],edited:[r]})=>function(t,e,r){t=e?Object.assign(Object.assign({},t),{hasFocus:e,touched:!0}):Object.assign(Object.assign({},t),{hasFocus:e});r&&(t=Object.assign(Object.assign({},t),{edited:r,touched:!0}));return t}(t.it,e,r))}(this._flags,t))}get read(){return this._flags.read}markTouched(t=!0){const e=this._flags.it;return t?e.touched||(this._flags.it=Object.assign(Object.assign({},e),{touched:t})):e.touched&&(this._flags.it=Object.assign(Object.assign({},e),{touched:e.hasFocus,edited:!1})),this}markEdited(t=!0){const e=this._flags.it;return t?e.edited||(this._flags.it=Object.assign(Object.assign({},e),{touched:!0,edited:t})):e.edited&&(this._flags.it=Object.assign(Object.assign({},e),{edited:t})),this}}class Hs extends Zs{constructor(t){super(),this._container=t,this.read=t.controls.read.keep.dig_(t=>mt(...function(t){return T(t,t=>t.aspect(Zs))}(t))).keep.thru(Xs)}markEdited(t){return this._container.controls.read.once(e=>$(e,e=>e.aspect(Zs).markEdited(t))),this}markTouched(t){return this._container.controls.read.once(e=>$(e,e=>e.aspect(Zs).markTouched(t))),this}}function Xs(...t){const e={hasFocus:!1,touched:!1,edited:!1};return $(t,([{hasFocus:t,touched:r,edited:n}])=>{r&&(e.touched=!0),t&&(e.hasFocus=e.touched=!0),n&&(e.edited=e.touched=!0)}),e}const Ys=new ie("https://surol.github.io/input-aspects/ns","inasp","input-aspects"),ti={applyTo:()=>Gn(ae())},ei={get[Zn](){return ti},to:t=>({applyAspect:e=>e===ti?Gn(t):void 0})},ri={applyTo:()=>Gn(_e)},ni={get[Zn](){return ri},to:t=>({applyAspect:e=>e===ri?Gn(t):void 0})},si={applyTo(t){const e=t.aspect(as);return e?Gn(e.element):Bn}},ii={get[Zn](){return si},to:(t=null)=>({applyAspect:e=>e===si?Gn(t):void 0})},oi={applyTo:t=>({instance:new hi(t),convertTo:a})};class ui{static get[Zn](){return oi}get[V](){return this.read}}const ci=Symbol("reason");function ai(t){return t&&"object"==typeof t&&ci in t}class hi extends ui{constructor(t){super(),this._control=t,this._sources=jt([new Map]),this.read=this._sources.read.keep.dig_(([t])=>t.size?mt(...t.keys()):ft()).keep.thru((...t)=>{const e={};return t.forEach(([t])=>li(t,e)),e}),this.track=ht(t=>{const e=new Jn,r=new tt;let n=!1;return r.on(t),this.read(t=>{const s=new Set(e),i=[];$(D(N(t),([,t])=>!!t),([t])=>{s.delete(t)||i.push(t)}),(!n||i.length||s.size)&&(e.delta(i,s),n=!0,e.redelta((t,e)=>r.send(t,e)).undelta())})});const e=t.aspect(ii);e&&this.applyTo(e,this.schedule)}get schedule(){return this._schedule||(this._schedule=fi(this._control,this._control.aspect(ii)))}add(t){const e=function(t){const e=W(t)?l(t):t;return t=>{const r=t.aspect(ei);return lt(e(t)).keep.thru((...t)=>{const e={};return t.forEach(t=>{oe(t)?e[se.name(t,r)]=!0:li(t,e)}),e})}}(t)(this._control),r=J(),n=ht(t=>{const n=e({receive(e,...r){t.receive(e,...r)}});t.supply.whenOff(t=>{r.off({[ci]:t})}),r.needs(n).whenOff(t=>{ai(t)&&n.off(t[ci])})}).share(),[s]=this._sources.it;return s.set(n,r),r.whenOff(t=>{ai(t)||(s.delete(n),this._sources.it=[s])}),this._sources.it=[s],r}applyTo(t,e=fi(this._control,t)){const{classList:r}=t,n=new Jn,s=()=>{n.redelta((t,e)=>{r.remove(...e),r.add(...t)}).undelta()};return this.track((t,r)=>{n.delta(t,r),e(s)}).whenOff(()=>{n.size&&(n.clear(),e(s))})}done(t){return $(this._sources.it[0].values(),e=>e.off(t)),this._sources.done(t),this}}function li(t,e){$(N(t),([t,r])=>{null!=r&&(e[t]=r)})}function fi(t,e){return t.aspect(ni)({node:e})}const di=[["has-error",Ys]];function pi(t){return!t.ok}function yi({mark:t,when:e}={}){let r,n;return r=e?Array.isArray(e)?e.length?t=>e.every(e=>t.has(e)):pi:t=>t.has(e):pi,n=t?Array.isArray(t)?t.length?t:di:[t]:di,t=>t.aspect(Rs).read.keep.thru(t=>r(t)?d(...n):d())}function gi({ns:t=Ys}={}){return e=>{const r=e=>[e,t];return _t({md:e.aspect(ls),vl:e.aspect(Rs),st:e.aspect(Zs)}).keep.thru(({md:[t],vl:[e],st:[{hasFocus:n,touched:s,edited:i}]})=>{const o=[];return ls.hasData(t)||o.push(r("disabled")),"ro"!==t&&"-ro"!==t||o.push(r("readonly")),e.ok||o.push(r("invalid")),e.has("missing")&&o.push(r("missing")),e.has("incomplete")&&o.push(r("incomplete")),n&&o.push(r("has-focus")),s&&o.push(r("touched")),i&&o.push(r("edited")),d(...o)})}}export{Tn as $,F as A,c as B,Kt as C,we as D,gt as E,Wt as F,V as G,te as H,A as I,ot as J,w as K,G as L,Ue as M,Pe as N,H as O,lt as P,B as Q,In as R,Zt as S,Qt as T,Un as U,St as V,vn as W,gn as X,Zr as Y,Bt as Z,se as _,Et as a,ie as a0,Vt as a1,Hn as a2,ei as a3,ni as a4,Rn as a5,rr as a6,xr as a7,kr as a8,Kn as a9,Oe as aa,ii as ab,ui as ac,gi as ad,yi as ae,Ys as af,cr as ag,js as ah,Vs as ai,Rs as aj,Is as ak,At as al,Ft as b,Nt as c,ht as d,ft as e,_t as f,mt as g,m as h,E as i,d as j,D as k,ae as l,T as m,_e as n,it as o,a as p,xt as q,oe as r,bt as s,jt as t,J as u,l as v,$ as w,U as x,h as y,M as z};//# sourceMappingURL=lib.f35d7321.m.js.map
