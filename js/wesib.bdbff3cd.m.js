import{S as e,C as t,a as n,b as s,i as r,m as o,t as i,c as a,d as c,e as u,f as l,g as h,n as d,h as p,j as f,o as g,k as m,l as w,p as y,F as b,A as _,q as v,D as x,v as O,E as S,r as k,s as C,u as D,w as E,x as R,y as j,z as P,B as T,G as q,H as A,I as M,J as U,O as L,K as N,L as $,M as z,N as B,P as I,Q as V,R as F,T as H,U as Q,V as G,W as J,X as K,Y as W,Z as X,_ as Y,$ as Z,a0 as ee,a1 as te}from"./lib.e2c9a0a7.m.js";const ne=new e("bootstrap-context");class se extends s{static get[n](){return ne}}function re(e){return(t,n)=>{const s=t.get(se);return t===s?e(s,n):s.get(n)}}const oe=new e("component-factory");class ie{static get[n](){return oe}connectTo(e){const t=this.mountTo(e);return t.connected=!0,t}}const ae=new e("window",{byDefault:()=>window}),ce=new e("default-namespace-aliaser");function ue(e){return Array.isArray(e)}class le extends _{constructor(e){super(),this.items=null==e?new Set:ue(e)?new Set(e):new Set([e])}get value(){switch(this.items.size){case 0:return;case 1:return this.items[Symbol.iterator]().next().value;default:return[...this.items]}}[Symbol.iterator](){return this.items[Symbol.iterator]()}add(...e){return e.forEach(e=>this.items.add(e)),this}get size(){return this.items.size}merge(e){return null==e?this:ue(e)?this.add(...e):this.add(e)}}function he(e,t=(()=>!0)){const n=Object.getPrototypeOf(e.prototype);if(null==n)return;const s=n.constructor;return t(s)?s:he(s,t)}function de(e,t,n=((e,t)=>t)){return e?t?function(...s){return n(e.apply(this,s),t.apply(this,s))}:e:t}function pe(e){return e.nodeType===Node.ELEMENT_NODE}class fe{constructor(e){this.symbol=e}own(e){return e.hasOwnProperty(this.symbol)?e[this.symbol]:void 0}of(e){const t=this.own(e),n=he(e),s=n&&this.of(n);return t?s?this.merge([s,t]):t:s}define(e,t){const n=this.own(e),s=o(t,t=>this.meta(t,e)),r=this.merge(n?j([[n],s],P):s);return Object.defineProperty(e,this.symbol,{configurable:!0,value:r}),e}}class ge{constructor(){this.promise=new Promise((e,t)=>{this._resolve=e,this._reject=t})}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}const me=Symbol("feature-def");class we extends fe{constructor(){super(me)}merge(e){return r(e,(e,t)=>({needs:new le(e.needs).merge(t.needs).value,has:new le(e.has).merge(t.has).value,setup:de(e.setup,t.setup),init:de(e.init,t.init)}),{})}meta(e,t){const n=e[me];return null==n?e:this.meta("function"==typeof n?e[me](t):n,t)}}const ye=new we,be={[me]:()=>({})},_e={of:e=>ye.of(e)||{},for:(e,t)=>ye.meta(t,e),merge:(...e)=>ye.merge(e),all:(...e)=>r(e,(e,t)=>({[me]:n=>_e.merge(_e.for(n,e),_e.for(n,t))}),be),define:(e,...t)=>ye.define(e,t)};function ve(...e){return t=>_e.define(t,...e)}const xe=new e("feature-context");class Oe extends se{static get[n](){return xe}whenDefined(e){return this.get(se).whenDefined(e)}load(e){return this.get(se).load(e)}}class Se extends Error{constructor(e){super("Circular feature needs: "+e.reduce((e,[t,n,s])=>(e||t.name)+` ${n} ${s.name}`,"")),this.needs=e}}class ke{get[T](){return this.read}}const Ce=Symbol("component-def");class De extends fe{constructor(){super(Ce)}merge(e){return r(e,(e,t)=>Object.assign(Object.assign(Object.assign({},e),t),{setup:de(e.setup,t.setup),define:de(e.define,t.define),feature:e.feature?t.feature?_e.merge(e.feature,t.feature):e.feature:t.feature}),{})}meta(e,t){const n=e[Ce];return null!=n?this.meta("function"==typeof n?e[Ce](t):n,t):null!=e[me]?{feature:_e.for(t,e)}:v(e)?{name:e}:e}}const Ee=new De,Re=Symbol("component-defined"),je={[Ce]:()=>({})},Pe={of:e=>Ee.of(e)||{},for:(e,t)=>Ee.meta(t,e),merge:(...e)=>Ee.merge(e),all:(...e)=>r(e,(e,t)=>({[Ce]:n=>Pe.merge(Pe.for(n,e),Pe.for(n,t))}),je),define(e,...t){const n=Ee.merge(o(t,t=>Pe.for(e,t)));return Ee.define(e,[n]),_e.define(e,Pe.featureDef(n)),e},featureDef:e=>({[me](t){const n={init(e){e.feature!==t||t.hasOwnProperty(Re)||(Object.defineProperty(t,Re,{value:1}),e.define(t))}},{feature:s}=e;return s?_e.merge(s,n):n}})};function Te(...e){return t=>Pe.define(t,...e)}const qe=new e("component-context"),Ae=new e("component-event-dispatcher",{byDefault:()=>({dispatch:(e,t)=>e.element.dispatchEvent(t),on:(e,t)=>new x(e.element).on(t)})}),Me=new e("content-root",{byDefault:e=>e.get(qe).element}),Ue=new b("state-updater",{byDefault:O(w)}),Le=Symbol("component-context");class Ne extends s{constructor(){super(...arguments),this.updateState=$e.bind(this)}static get[n](){return qe}static of(e){const t=e[Le];if(!t)throw TypeError(`No component context found in ${e}`);return t}get contentRoot(){return this.get(Me)}on(e){return this.get(Ae).on(this,e)}dispatchEvent(e){this.get(ne).get(Ae).dispatch(this,e)}}function $e(e,t,n){this.get(Ue)(e,t,n)}class ze extends Event{constructor(e,t){super(e,t)}get context(){return Ne.of(this.target)}}class Be{get component(){return this.context.component}get element(){return this.context.element}}class Ie extends a{constructor(){super("element-adapter")}grow(e){const t=e=>e[Le];let n;return e.seed((...s)=>{const r=s.reduce((e,t)=>n=>e(n)||t(n),t);n=r!==t?r:e.byDefault(()=>t)||t}),e=>n(e)}}const Ve=new Ie,Fe=new b("element-observer",{byDefault:re(e=>{const t=e.get(Ve);class n extends MutationObserver{constructor(e){super(n=>{n.forEach(e=>{D(E(e.removedNodes),e=>{var t;return null===(t=function(e){var t;return null===(t=e[Le])||void 0===t?void 0:t.mount}(e))||void 0===t?void 0:t.checkConnected()}),D(f(E(e.addedNodes),pe),e=>{var n,s;return null===(s=null===(n=t(e))||void 0===n?void 0:n.mount)||void 0===s?void 0:s.checkConnected()})}),e(n,this)})}observe(e,t){super.observe(e,Object.assign(Object.assign({},t),{childList:!0}))}}return e=>new n(e)})});const He=Symbol("component-factory");function Qe(e){const t=e[He];if(!t)throw new TypeError(`Component is not defined: ${e}`);return t}const Ge=new e("custom-elements",{byDefault:function(e){const t=e.get(ae).customElements,n=e.get(ce);return new class extends Je{define(e,s){if(v(e))return void t.define(q.name(e,n),s);const r=Qe(e),{name:o,extend:i}=r.elementDef;o?i&&i.name?t.define(q.name(o,n),s,{extends:i.name}):t.define(q.name(o,n),s):We(e).resolve(void 0)}whenDefined(e){if(v(e))return t.whenDefined(q.name(e,n));const s=Qe(e),{name:r}=s.elementDef;return r?t.whenDefined(q.name(r,n)):We(e).promise}}}});class Je{static get[n](){return Ge}}const Ke=Symbol("component-resolver");function We(e){return e[Ke]||(e[Ke]=new ge)}const Xe=new e("definition-context"),Ye=new e("element-def",{byDefault(e){const t=e.get(Xe).componentType,{name:n,extend:s}=Pe.of(t),r={get type(){return s&&s.type||e.get(ae).HTMLElement},get name(){return s&&s.name}};return{get name(){return n},get extend(){return r}}}});class Ze extends s{static get[n](){return Xe}get elementDef(){return this.get(Ye)}}const et=new e("bootstrap-context-registry");class tt extends t{constructor(){super(),this.provide({a:tt,is:this}),this.values=this.newValues()}static get[n](){return et}static create(){return new tt}}const nt=new e("component-context-registry",{byDefault:re(()=>new st)});class st extends t{static get[n](){return nt}constructor(e){super(e)}}const rt=new e("definition-context-registry",{byDefault:re(e=>new ot(e))});class ot extends t{static get[n](){return rt}constructor(e){super(e)}}const it=Symbol("post-def-setup");function at(e){if(e.hasOwnProperty(it))return e[it];const t=i(),n=new S,s=t.read.thru(e=>e?p(e):d()),r=k(s,n),o=he(e,e=>Ce in e);if(o){const e=at(o);r(t=>e.send(t))}const a={on:r,send(e){n.send(e)},setup(e){t.it=e}};return Object.defineProperty(e,it,{value:a}),a}const ct=new e("element-builder",{byDefault:re((function(e){const t=e.get(ot),n=e.get(st),s=new S,r=new S;return{definitions:s,components:r,buildElement(e){var r,a;const c=Pe.of(e),u=new S;let l;const h=i(!1),f=h.read.thru(e=>e?p():d());let g;function m(){return n.append(l)}const y=new class extends ie{get componentType(){return g.componentType}get elementType(){return g.elementType}get elementDef(){return g.elementDef}mountTo(e){if(e[Le])throw new Error(`Element ${e} already bound to component`);const t=o({definitionContext:g,onComponent:u,registry:m(),element:e,elementSuper:t=>e[t],createMount:t=>new class extends Be{get context(){return t}get connected(){return 3===lt(e).it}set connected(t){lt(e).it=t?3:2}checkConnected(){const t=e,n=t.ownerDocument;return this.connected=null!=n&&n.contains(t)}}}).mount;return t.checkConnected(),ht(t.context),t}};g=new class extends Ze{constructor(){var n,s;super();const r=this;this.whenReady=f.thru(()=>this).once;const o=new ot(t.seedIn(this));o.provide({a:Ze,is:this}),o.provide({a:ie,is:y}),this.get=o.newValues().get,l=new st(o.seedIn(this));const i={get componentType(){return e},get whenReady(){return r.whenReady},perDefinition:e=>o.provide(e),perComponent:e=>l.provide(e)};null===(s=(n=c).setup)||void 0===s||s.call(n,i),at(e).setup(i)}get componentType(){return e}get onComponent(){return u.on}get elementType(){throw new Error("Custom element class is not constructed yet. Consider to use a `whenReady()` callback")}perComponent(e){return l.provide(e)}},null===(a=(r=c).define)||void 0===a||a.call(r,g),s.send(g);const b=function(e,t,n){const s=e.get(Ye);class r extends s.extend.type{constructor(){super(),ht(o({definitionContext:e,onComponent:t,registry:n,element:this,createMount:w,elementSuper:e=>super[e]}))}connectedCallback(){lt(this).it=3}disconnectedCallback(){lt(this).it=2}}return r}(g,u,m());return Object.defineProperty(g,"elementType",{configurable:!0,enumerable:!0,value:b}),h.it=!0,y}};function o({definitionContext:e,onComponent:t,registry:n,element:s,createMount:o,elementSuper:a}){const c=i(0),u=i();c.on(w).whenOff(e=>u.it=[e]);const l=u.read.thru(e=>e?p(e[0]):d()).once,h=c.read.thru(e=>2===e?p():d()),f=c.read.thru(e=>{if(3!==e)return d();const t=C();return h.once(()=>t.off()),p(t)});let g;const m=n.newValues();const y=new class extends Ne{constructor(){super(),this.get=m.get,this.elementSuper=a;const e=c.read.thru(e=>e?p(this):d());this.whenReady=e.once}get componentType(){return e.componentType}get element(){return s}get component(){throw new Error("The component is not constructed yet. Consider to use a `whenReady()` callback")}get mount(){return g||(g=o(this))}get connected(){return 3===c.it}get whenOn(){return f}get whenOff(){return h}get whenDestroyed(){return l}destroy(e){c.done(e)}};y.whenDestroyed(()=>(function(e){const{element:t,mount:n}=e;n&&(n.connected=!1);const s=t.parentElement;s&&s.removeChild(t)})(y)),n.provide({a:Ne,is:y}),Object.defineProperty(s,Le,{value:y}),Object.defineProperty(s,ut,{writable:!0,value:c}),r.send(y),t.send(y);const b=function(e,t){const n=e.prototype,s=n[Le];n[Le]=t;try{const r=new e(t);return Object.defineProperty(r,Le,{value:t}),r}finally{n[Le]=s}}(e.componentType,y);return Object.defineProperty(y,"component",{configurable:!0,enumerable:!0,value:b}),c.it=1,y}}))});const ut=Symbol("component-status");function lt(e){return e[ut]}function ht(e){e.dispatchEvent(new ze("wesib:component",{bubbles:!0}))}const dt=O(w);class pt{constructor(e){this._context=e,this._definitionQueue=[],e.whenReady(()=>{this._definitionQueue.forEach(e=>e()),delete this._definitionQueue})}get customElements(){return this._context.get(Je)}define(e){this._definitionQueue.push(()=>{const t=this._context.get(ct).buildElement(e);e[He]=t,this.customElements.define(e,t.elementType)})}}const ft=Symbol("feature-key");class gt extends a{static of(e){return e.hasOwnProperty(ft)?e[ft]:e[ft]=new gt(e)}constructor(e){super(`feature:${e.name}`)}grow(e){return t=e.context.get(se),n=e.seed.keep.thru(mt),c(e=>{let s,r=u(),o=Promise.resolve("idle");return l({clause:n,deps:wt(t,n)}).dig_(({clause:[e],deps:n})=>{if(!e)return u();const[i,,a]=e;if(i.feature===s)return r;if(s=i.feature,a!==s)return r=t.get(gt.of(s)).thru_(e=>(e.to(o),o=e.stage,e));const l=new bt(t,i,n).to(o),h=u(l);return r=c(e=>h(e).whenOff(()=>{o=l.unload()})).share()})(e)}).keep.thru(function(){let e=null;return t=>e===t?d():(e=t,t?p(t):p())}());var t,n}}function mt(...e){let t,n=!1;for(const s of e)switch(s[1]){case"is":n=!0,t||(t=s);break;case"has":t=s;break;case"needs":n=!0}return n?t:void 0}function wt(e,t){return t.keep.dig_(t=>{if(!t)return u();const[{def:n}]=t,s=new le(n.needs);return s.size?h(...s.map(t=>e.get(gt.of(t)))).keep.thru_(yt):u()})}function yt(...e){return p(...f(o(e,e=>e[0]),R))}class bt{constructor(e,t,n){this.bsContext=e,this.request=t,this.deps=n,this.state=i(!1),this.down=new Promise(e=>this._down=e),this._stage=Promise.resolve(new vt(this))}get stage(){return this._stage.then(e=>e.after)}get ready(){return this.state.it}to(e){const t=this._stage;return this._stage=e.then(e=>t.then(t=>t[e]())),this}async setup(){await(this._stage=this._stage.then(e=>e.setup()))}async init(){await(this._stage=this._stage.then(e=>e.init()))}async unload(){const e=this._stage;delete this._stage;const t=await e,n=await t.stop();return this._down(),n}}class _t{constructor(e,t=(()=>Promise.resolve())){this.loader=e,this._stop=t}async idle(){return this}stop(){return this._stop().then(()=>this.after)}perDep(e){const{deps:t}=this.loader;return Promise.all(t.map(t=>e(t)))}}class vt extends _t{get after(){return"idle"}async setup(){var e,n;await this.perDep(e=>e.setup());const{bsContext:s,request:{def:r}}=this.loader,[o,a]=function(e,n){const s=function(){const e=[];let t=t=>{const n=t();return e.push(n),n};return{supply:C(()=>{t=dt,D(E(e).reverse(),e=>e()),e.length=0}),add:e=>t(e)}}();let r;const o=e.get(ot),a=e.get(st),c=new t(e),u=e.get(ct),h=u.definitions.on.tillOff(s.supply),f=u.components.on.tillOff(s.supply);return[new class extends Oe{constructor(){super(),this.get=c.newValues().get;const t=l({st:n.state,bs:i().by(e.whenReady)}).thru(({st:[e],bs:[t]})=>t&&e?p(this):d());this.whenReady=t.once,c.provide({a:Oe,is:this}),r=new pt(this)}get feature(){return n.request.feature}get onDefinition(){return h}get onComponent(){return f}provide(t){return s.add(()=>e.get(tt).provide(t))}perDefinition(e){return s.add(()=>o.provide(e))}perComponent(e){return s.add(()=>a.provide(e))}setupDefinition(e){return function(e,t){const{on:n}=at(e);return g(e=>{n({supply:e.supply.needs(t.supply),receive(n,s){const r=s.whenReady.tillOff(t.supply);e.receive(n,{get componentType(){return s.componentType},get whenReady(){return r},perDefinition:e=>t.add(()=>s.perDefinition(e)),perComponent:e=>t.add(()=>s.perComponent(e))})}})})}(e,s)}define(e){r.define(e)}},s.supply]}(s,this.loader);return null===(n=(e=r).setup)||void 0===n||n.call(e,o),new xt(this.loader,o,async()=>a.off())}init(){return this.setup().then(e=>e.init())}}class xt extends _t{constructor(e,t,n){super(e,n),this._context=t}get after(){return"setup"}async setup(){return this}async init(){var e,t;await this.perDep(e=>e.init());const{request:{def:n}}=this.loader;return null===(t=(e=n).init)||void 0===t||t.call(e,this._context),new Ot(this)}}class Ot extends _t{get after(){return"init"}constructor(e){super(e.loader,()=>e.stop()),e.loader.state.it=!0}async setup(){return this}async init(){return this}}class St{constructor(e,t,n){this._requester=e,this.feature=t,this._revoke=n,this._uses=0,this.def=_e.of(t)}request(e){const t=this._requester,{registry:n}=t,s=[this,"is",this.feature];return this._revokeBy(n.provide({a:gt.of(this.feature),is:s})),new le(this.def.has).forEach(s=>{const r=[this,"has",s];this._revokeBy(n.provide({a:gt.of(s),is:r}));const o=t.request(s,[...e,r]);this._revokeBy(()=>o.unuse())}),new le(this.def.needs).forEach(s=>{const r=[this,"needs",s],o=t.request(s,[...e,r]);this._revokeBy(()=>o.unuse()),this._revokeBy(n.provide({a:gt.of(s),is:r}))}),this._uses=1,this}reuse(e){if(!this._uses)throw new Se(e.map(([{feature:e},t,n])=>[e,t,n]));return++this._uses,this}unuse(){--this._uses||this._revoke()}_revokeBy(e){this._revoke=de(e,this._revoke)}}const kt=new e("feature-requester",{byDefault:re(e=>new Ct(e))});class Ct{constructor(e){this._map=new Map,this.registry=e.get(tt)}static get[n](){return kt}request(e,t=[]){const n=this._map.get(e);if(n)return n.reuse(t);const s=new St(this,e,()=>this._map.delete(e));return this._map.set(e,s),s.request(t)}}function Dt(...e){const t=tt.create(),{bootstrapContext:n,complete:s}=function(e){const t=i(0),n=e.values;const s=new class extends se{constructor(){super(),this.get=n.get;const s=t.read.thru(e=>e?p(this):d());this.whenReady=s.once,e.provide({a:ce,by:m}),e.provide({a:se,is:this})}async whenDefined(e){return await new Promise(e=>this.whenReady(e)),await this.get(Je).whenDefined(e),Qe(e)}load(e){const t=c(t=>{const n=s.get(Ct).request(e),r=i({status:{feature:e,ready:!1}});this.get(gt.of(e))({supply:t.supply,receive(e,t){const n=t;r.it={status:{feature:n.request.feature,ready:n.ready},down:n.down},n.ready||n.init().then(()=>{r.it={status:{feature:n.request.feature,ready:!0},down:n.down}})}}).whenOff(()=>{n.unuse()}),r.read(t)}).share();let n;const r=t(({down:e})=>n=e),o=t.keep.thru(e=>e.status).tillOff(r);return new class extends ke{get read(){return o}get down(){return n}dismiss(e){return r.off(e),n}}}};return{bootstrapContext:s,complete(){t.it=1}}}(t),r=1===e.length?e[0]:(o=e,_e.define(class{},{needs:o}));var o;return n.get(Ct).request(r),n.get(gt.of(r))(e=>{e.init().then(s)}),n}const Et=Symbol("attribute");function Rt(e,t=!0){if(!1===t)return w;if(!0===t||"function"==typeof t){const n=function(e){return[Et,e]}(e),s=!0===t?jt:t;return function(e,t){s.call(this,n,e,t)}}return function(e,n){Ne.of(this).updateState(t,e,n)}}function jt(e,t,n){Ne.of(this).updateState(e,t,n)}function Pt(e,t,n){let s,r;if("string"==typeof n)s=n,r=Rt(s);else{if(n&&n.name)s=n.name;else{if("string"!=typeof t)throw new TypeError("Attribute name is required, as property key is not a string: "+`${e.constructor.name}.${t.toString()}`);s=t}r=Rt(s,n&&n.updateState)}return{name:s,updateState:r}}const Tt=new e("attribute-registrar"),qt=new e("attribute-registry");class At{constructor(e){this._attrs={},this._MutationObserver=e.get(ae).MutationObserver}static get[n](){return qt}add(e,t){this._attrs[e]=de(this._attrs[e],t)}define(e){const t=this._attrs,n=Object.keys(t);n.length&&(Object.defineProperty(e,"observedAttributes",{configurable:!0,enumerable:!0,value:n}),Object.defineProperty(e.prototype,"attributeChangedCallback",{configurable:!0,enumerable:!0,value:function(e,n,s){t[e].call(Ne.of(this).component,s,n)}}))}mount(e){const t=e.element,n=this._attrs,s=Object.keys(n);s.length&&new this._MutationObserver(e=>e.forEach(e=>{const s=e.attributeName;return n[s].call(Ne.of(t).component,t.getAttribute(s),e.oldValue)})).observe(t,{attributes:!0,attributeFilter:s,attributeOldValue:!0})}}const Mt={setup(e){e.perDefinition({as:At}),e.perDefinition({a:Tt,by:e=>(t,n)=>e.add(t,n),with:[At]}),e.onDefinition(e=>{e.whenReady(({elementType:t})=>e.get(At).define(t))}),e.onComponent(e=>{const t=e.mount;t&&e.get(At).mount(t)})}};class Ut{static get[me](){return Mt}}function Lt(e){return(t,n,s)=>{const{name:r,updateState:o}=Pt(t,n,e),i=t.constructor;_e.define(i,{needs:Ut}),Pe.define(i,{define(e){e.get(Tt)(r,o)}});const a={get(){return Ne.of(this).element.getAttribute(r)},set(e){Ne.of(this).element.setAttribute(r,e)}};if(null!=s)return a;Object.defineProperty(t,n,a)}}function Nt(e){return(t,n)=>{const{name:s,updateState:r}=Pt(t,n,e),o=t.constructor;_e.define(o,{needs:Ut}),Pe.define(o,{define(e){e.get(Tt)(s,(function(e,t){this[n].call(this,e,t),r.call(this,e,t)}))}})}}const $t=Symbol("dom-property");const zt=new e("component-state");class Bt extends y{static get[n](){return zt}}const It={setup(e){e.perComponent({a:Bt,by(e){const t=new Bt;return e.whenDestroyed(e=>t.done(e)),t}}),e.perComponent({a:Ue,by:e=>e.update,with:[Bt]})}};class Vt{static get[me](){return It}}const Ft=new e("render-scheduler");class Ht{static get[n](){return Ft}}const Qt={render(e,t,n={}){const{offline:s,path:r=[]}=n,o=e.get(Bt).track(r),i=e.get(Ht).newSchedule();let a=!1;const c=o.onUpdate(()=>{s||e.connected?u():a=!1});function u(){a=!0,i.schedule(l)}function l(){for(;;){const e=t();if(e===t||"function"!=typeof e)break;t=e}}s?u():e.whenOn(()=>{a||u()}).whenOff(e=>{c.off(e),a=!0})}},Gt={setup(e){e.provide({a:Ht,by:Kt,with:[ae]})}};class Jt{static get[me](){return Gt}}function Kt(e){return new class extends Ht{newSchedule(){let t=w;return new class{schedule(n){const s=t;t=n,s===w&&e.requestAnimationFrame(()=>{t(),t=w})}}}}}function Wt(e){return(t,n)=>{const s=t.constructor;Pe.define(s,{define(t){t.onComponent(t=>{t.whenReady(()=>{const s=t.component,r=s[n].bind(s);Qt.render(t,r,e)})})},feature:{needs:[Vt,Jt]}})}}const Xt=new e("shadow-content-root");class Yt extends Event{constructor(e,t){super(e,t)}get shadowRoot(){return this.target.shadowRoot}}const Zt=new b("shadow-root-builder"),en={setup(e){e.provide({a:Zt,is:nn})}};class tn{static get[me](){return en}}function nn(e,t){const n=function(e,t){const n=e.shadowRoot;if(n)return n;if("attachShadow"in e)return e.attachShadow(t);return}(e.element,t);if(n)return n[Le]=e,e.dispatchEvent(new Yt("wesib:shadowAttached",{bubbles:!0})),n}const sn={mode:"open"},rn={componentDef:(e=sn)=>({setup(t){t.perComponent({a:Xt,by:t=>t.get(Zt)(t,e)}),t.perComponent({a:Me,by:e=>e.get(Xt,{or:null})})},feature:{needs:tn}})};function on(e){return t=>{Pe.define(t,rn.componentDef(e))}}class an extends a{constructor(e){super(e)}grow(e){let t;return e.seed((...e)=>t=function(e){return(t,n)=>{const s=(n,r)=>{const o=e[n];return o?Q(o((e=r)=>s(n+1,e),r)):t(r)};return s(0,n)}}(e)),e.byDefault(()=>(e,n)=>t(e,n))||cn}}function cn(e,t){return e(t)}const un=new an("http-fetch-agent"),ln={};const hn=new b("http-fetch",{byDefault:re((function(e){const t=e.get(ae),n=e.get(un);return(e,t)=>n(s,new Request(e,t));function s(e){return g(n=>{const s=new S;let r;if("AbortController"in t){const o=new t.AbortController,{signal:i}=o;r=C(e=>{e===ln&&o.abort()}),n.supply.whenOff(()=>r.off(ln)).needs(r),s.on({supply:r,receive(e,t){n.receive(e,t)}});const a=e.signal;a&&(new x(a).on("abort").once(()=>o.abort()),a.aborted&&o.abort()),e=new Request(e,{signal:i})}else r=s.on(n);t.fetch(e).then(e=>{s.send(e),r.off()}).catch(e=>r.off(e))})}}))}),dn=new G("component-in"),pn=new e("component-node");class fn extends _{get[L](){return this.onUpdate}get[T](){return this.read}}const gn={subtree:!0};function mn(e,t,n,s,{deep:r,all:i}){const a=new S,u=r?gn:void 0;let l,h,d=new Set;"string"==typeof n?h=n:e.whenDefined(n).then(({elementDef:{name:t}})=>{if(l=void 0,t&&(h=q.name(t,e.get(ce)),a.size)){const e=k();if(e.size){const t=[...f(o(e,e=>s(e)),R)];t.length&&a.send(t,[])}}});const m=e.get(Fe)((function(e){const t=[],n=[];e.forEach(e=>{D(f(o(E(e.removedNodes),P),R),e=>n.push(e)),D(f(o(E(e.addedNodes),j),R),e=>t.push(e))}),(t.length||n.length)&&a.send(t,n)}));let w;const y=g(e=>{const n=!a.size,s=a.on(e);return n&&(k(),m.observe(t,u)),C(e=>{s.off(e),a.size||m.disconnect()}).needs(s)}),b=c(y.thru(()=>w),()=>[w]),v=y.thru((e,t)=>p(_.of(e),_.of(t))),x=c(e=>{const t=new S;t.on(e),t.send(w,_.of([])),v(e)}),O=z(b).keep.thru(V);i||t.addEventListener("wesib:component",e=>{const t=e.target;if(d.has(t)){const e=s(t);a.send([e],[])}});return w=new class extends fn{get onUpdate(){return y}get read(){return b}get track(){return x}get first(){return O}[Symbol.iterator](){return J(l||(l=f(o(a.size?d:k(),e=>s(e)),R)))}};function k(){return l=void 0,d=function(){const e=h;if(!e)return new Set;if(r)return new Set(E(t.querySelectorAll(e)));return new Set(f(E(t.children),t=>t.matches(e)))}()}function j(e){if(pe(e))return h&&e.matches(h)&&!d.has(e)?(d.add(e),s(e)):void 0}function P(e){if(pe(e)&&d.delete(e))return s(e,!0)}}class wn{constructor(e,t){this._bs=e,this.element=t,this._emitters=new Map}get observer(){if(this._observer)return this._observer;const e=this._bs.get(ae).MutationObserver;return this._observer=new e(e=>this._update(e))}observe(e,t){const n=this,s=this.observer,r=this._emitter(e),o=K(t),i=r.on({supply:C(()=>{this._emitters.delete(e),s.disconnect(),this._emitters.size?a():this._observer=void 0}).needs(o.supply),receive:(e,t,n)=>o.receive(e,t,n)});return s.disconnect(),a(),i;function a(){n._update(s.takeRecords()),s.observe(n.element,{attributes:!0,attributeOldValue:!0,attributeFilter:[...n._emitters.keys()]})}}_update(e){e.forEach(e=>{const t=e.attributeName,n=this._emitters.get(t);n&&n.send(this.element.getAttribute(t),e.oldValue)})}_emitter(e){const t=new S;return this._emitters.set(e,t),t}}class yn extends ee{constructor(e,t){super(),this._observer=e,this._name=t,this._updates=new S;let n=N();this.on=g(e=>{this._updates.size||(n=this._observer.observe(t,(e,t)=>this._updates.send(e,t))),e.supply.needs(n),this._updates.on(e).whenOff(e=>{this._updates.size||n.off(e)})})}get it(){return this._observer.element.getAttribute(this._name)}set it(e){this._observer.element.setAttribute(this._name,e)}done(e){return this._updates.done(e),this}}class bn{constructor(e,t){this._attrs=new Map,this._observer=new wn(e,t)}get(e){const t=this._attrs.get(e);if(t)return t;const n=new yn(this._observer,e);return this._attrs.set(e,n),n}}class _n extends ee{constructor(e,t){super(),this._element=e,this._key=t,this._updates=new S,this._supply=N()}get on(){return this._updates.on}bind(e){const t=e.get(Bt).track((n=this._key,[$t,n]));var n;this._supply=t.onUpdate({supply:C().whenOff(e=>this._updates.done(e)),receive:(e,t,n,s)=>this._updates.send(n,s)})}get it(){return this._element[this._key]}set it(e){this._element[this._key]=e}done(e){return this._supply.off(e),this}}class vn{constructor(e){this._element=e,this._props=new Map}bind(e){this._context=e,this._props.forEach(t=>t.bind(e))}get(e){const t=this._props.get(e);if(t)return t;const n=new _n(this._element,e);return this._context&&n.bind(this._context),this._props.set(e,n),n}}const xn=Symbol("element-node");class On{constructor(e,t){this._bs=e,this.element=t,this._attrs=new bn(e,t),this._props=new vn(t),t[xn]=this;const n=t[Le];n?this._bind(n):t.addEventListener("wesib:component",e=>this._bind(e.context))}get context(){return this.element[Le]}get parent(){const e=this.element.parentElement;return null!=e?Sn(this._bs,e):null}select(e,t){return function(e,t,n,s={}){if(s.all)return mn(e,t,n,(t,n)=>Sn(e,t,n),s);const r=e.get(Ve);return mn(e,t,n,(t,n)=>r(t)&&Sn(e,t,n),s)}(this._bs,this.element,e,t)}attribute(e){return this._attrs.get(e)}property(e){return this._props.get(e)}_bind(e){this._props.bind(e)}}function Sn(e,t,n){const s=t[xn];return s||n?s:new On(e,t)}const kn={needs:Vt,setup(e){e.perComponent({a:pn,by:e=>Sn(e.get(se),e.element)})}};class Cn{static get[me](){return kn}}const Dn=new e("component-in-receiver");function En(e,t){const n=C(),{root:s}=e;return s.context.whenOn(r=>{r.needs(n);const o=new Set,i=new Map;function a(n){const{element:s}=n;n.context.get(Dn,{or:null})&&(D(f(i.keys(),e=>s.contains(e.element)),c),o.add(n));const a=n.context.get(dn,{or:null});if(!a)return;for(const e of o)if(e!==n&&e.element.contains(s))return;const u={node:n,ins:a,supply:C().needs(r)};return i.set(n,u),function({ins:n,supply:s}){const r=C().needs(s);D(n,n=>z(n)({supply:r,receive:(n,...s)=>D(s,n=>n({receiver:e,control:t}).needs(r))}))}(u),u}function c(e){o.delete(e);const t=i.get(e);t&&(i.delete(e),t.supply.off())}s.select("*",{deep:!0}).track({supply:r,receive:(e,t,n)=>{D(n,c),D(t,a)}})}).needs(n),n}const Rn=new e("component-in-control"),jn={feature:{needs:Cn},setup(e){e.perComponent({as:Pn}),e.perComponent({a:Dn,via:Pn})}};class Pn{constructor(e){this.root=e.get(pn)}static get[n](){return Rn}static get[Ce](){return jn}in(e){return En(this,e)}}function Tn({select:t,pick:s={all:!0,deep:!0},build:r}){const o=new e("component-in-element:"+t),a=new e("component-in-element:"+t+":control"),c=Pe.all(Pn,{define(e){e.perComponent({a,by:i}),e.perComponent({a:o,by:e=>e.read,with:[a]}),e.onComponent(u)}});return{get[n](){return o},get[Ce](){return c}};function u(e){const n=e.get(a),o=e.get(Pn),i=e.get(pn);e.whenOn(e=>{n.by(i.select(t,s).first.tillOff(e).thru_(e=>e&&r(e,i))),n.read.tillOff(e).consume(e=>e&&o.in(e).whenOff(()=>n.it=void 0))})}}const qn=new e("component-in-validity"),An=new e("context-in-validity:tracker"),Mn={setup(e){e.perComponent({a:An,is:i(B())}),e.perComponent({a:dn,by:Ln,with:[An]}),e.perComponent({a:Un,by:e=>e.read,with:[An]})}},Un={get[n](){return qn},get[Ce](){return Mn}};function Ln(e){return u(({control:t})=>t.aspect(I).read(t=>e.it=t).whenOff(()=>e.it=B()))}class Nn extends Event{constructor(e,t){super(e,Object.assign(Object.assign({},t),{cancelable:!1})),this.when=t.when,this.to=t.to}}class $n extends Event{constructor(e,t){super(e,Object.assign(Object.assign({},t),{cancelable:!0})),this.when=t.when,this.from=t.from,this.to=t.to}}class zn extends Event{constructor(e,t){super(e,Object.assign(Object.assign({},t),{cancelable:!0})),this.from=t.from,this.to=t.to,this.reason=t.reason}get when(){return"stay"}}const Bn=new e("navigation");class In{static get[n](){return Bn}get[L](){return this.on}get[T](){return this.read}back(){this.go(-1)}forward(){this.go(1)}reload(){this.go()}}class Vn extends a{constructor(e){super(e)}grow(e){const{document:t}=e.context.get(ae);return(t,s,r,o)=>{const i=e.byDefault(()=>n);return i?i(t,s,r,o):t(o)};function n(n,s,r,o){let i;return e.seed.once((...e)=>i=e),function e(o,a){const c=i[o];if(!c)return n(a);c(({url:n=a.url,title:s=a.title,data:r=a.data}=a)=>e(o+1,{url:new URL(String(n),t.baseURI),title:s,data:r,get visited(){return a.visited},get current(){return a.current},get:e=>a.get(e),put(e,t){a.put(e,t)}}),s,r,a)}(0,o)}}}const Fn=new Vn("navigation-agent"),Hn=Symbol("page-param");class Qn{get[Hn](){return this}}class Gn extends s{}const Jn=new e("navigation-history",{byDefault:re(e=>new Kn(e))});class Kn{constructor(e){this._context=e,this._entries=new Map,this._lastId=0;const t=e.get(ae);this._document=t.document,this._location=t.location,this._history=t.history,this._uid=btoa(String(Math.random()))}static get[n](){return Jn}init(){const{data:e}=Xn(this._history.state),t=this.newEntry({url:new URL(this._location.href),data:e,title:this._document.title});return this._entries.set(t.id,t),t.schedule(()=>{t.enter("init"),this._history.replaceState(this._historyState(t),"")}),t}newEntry(e){return new Yn(this._context,++this._lastId,e)}open(e,t){const{page:{title:n="",url:s}}=e;this._history.pushState(this._historyState(e),n,s.href),this._enter("open",e,t)}_enter(e,t,n){const s=n.it;this._entries.set(t.id,t);try{for(let e=s.next;e;e=e.next)this._forget(e)}finally{t.prev=s,s.next=t,t.schedule(()=>{try{s.leave()}finally{t.enter(e)}}),n.it=t}}replace(e,t){const n=t.it,{page:{title:s="",url:r}}=e;this._history.replaceState(this._historyState(e),s,r.href),this._entries.set(e.id,e);const o=n.prev;o&&(e.prev=o,o.next=e),e.schedule(()=>{try{n.leave()}finally{try{this._forget(n)}finally{e.enter("replace")}}}),t.it=e}popState(e,t){const{state:n}=e;if(null==n)return null==this._history.state?this._changeHash(t):void 0;const s=t.it,{uid:r,data:o,id:i}=Xn(n);let a;const c=r===this._uid&&null!=i?this._entries.get(i):void 0;return c?a=c:(a=this.newEntry({url:new URL(this._location.href),data:o,title:this._document.title}),s.transfer(a,"return"),this._entries.set(a.id,a),this._history.replaceState(this._historyState(a),"")),a.schedule(()=>{try{s.leave()}finally{a.enter("return")}}),t.it=a,a}hashChange(e){if(null==this._history.state)return this._changeHash(e)}update(e,t){const n=e.it,s=new Yn(this._context,++this._lastId,Object.assign(Object.assign({},n.page),{url:t}),n);return this._entries.set(s.id,s),this._history.replaceState(this._historyState(s),"",t.href),this._entries.delete(n.id),e.it=s}_changeHash(e){const t=e.it,n=this.newEntry({url:new URL(this._location.href),data:null,title:this._document.title});try{t.transfer(n,"enter")}finally{this._history.replaceState(this._historyState(n),""),this._enter("enter",n,e)}return n}_forget(e){this._entries.delete(e.id),e.forget()}_historyState({id:e,page:{data:t}}){return{[Wn]:{uid:this._uid,id:e,data:t}}}}const Wn="wesib:navigation:data";function Xn(e){return null==e||"object"!=typeof e?{data:e}:e[Wn]}class Yn{constructor(e,t,n,s){this._context=e,this.id=t,this._status=0,this._update=w,this._params=s?s._params:new Map;const r=this;this.page={url:n.url,title:n.title,data:n.data,get visited(){return!!r._status},get current(){return 2===r._status},get:e=>r.get(e),put(e,t){r.put(e,t)}}}get(e){const t=this._params.get(e[Hn]);return t&&t.get()}put(e,n){const s=e[Hn],r=this._params.get(s);if(r)return r.put(n),r.get();const o=new t(this._context);const i=s.create(this.page,n,new class extends Gn{constructor(){super(...arguments),this.get=o.newValues().get}});return this._params.set(s,i),this.page.current&&i.enter&&i.enter(this.page,"init"),i.get()}transfer(e,t){D(this._params.entries(),([n,s])=>{if(s.transfer){const r=s.transfer(e.page,t);r&&e._params.set(n,r)}})}stay(e){D(this._params.values(),t=>t.stay&&t.stay(e))}enter(e){this._status=2,D(this._params.values(),t=>t.enter&&t.enter(this.page,e))}leave(){this._status=1,D(this._params.values(),e=>e.leave&&e.leave())}forget(){D(this._params.values(),e=>e.forget&&e.forget()),this._params.clear()}schedule(e){this._update=e}apply(){const e=this._update;this._update=w,e()}}function Zn(e){const t=e.get(ae),{document:n,history:s}=t,r=new x(t),o=e.get(Kn),a=e.get(Fn),c=r.on("wesib:enterPage"),u=r.on("wesib:leavePage"),l=r.on("wesib:stayOnPage"),h=k(c,u,l),d=i(o.init());d.read(e=>e.apply());const p=d.read.keep.thru(e=>e.page);let f=Promise.resolve();r.on("popstate")(e=>{const t=o.popState(e,d);t&&r.dispatch(new Nn("wesib:enterPage",{when:null!=e.state?"return":"enter",to:t.page}))}),r.on("hashchange")(()=>{const e=o.hashChange(d);e&&r.dispatch(new Nn("wesib:enterPage",{when:"enter",to:e.page}))});return new class extends In{get length(){return s.length}get onEnter(){return c}get onLeave(){return u}get onStay(){return l}get on(){return h}get read(){return p}go(e){s.go(e)}open(e){return m("pre-open","open",e)}replace(e){return m("pre-replace","replace",e)}update(e){return o.update(d,g(e)).page}with(e,t){return function e(t){return{with:(n,s)=>e(de(t,e=>e.put(n,s))),open:e=>m("pre-open","open",e,t),replace:e=>m("pre-replace","replace",e,t)}}(n=>n.put(e,t))}};function g(e){return"string"==typeof e?new URL(e,n.baseURI):e||d.it.page.url}function m(e,t,n,s=w){const i=function(e){return"string"==typeof e||e instanceof URL?{url:g(e)}:e.url instanceof URL?e:Object.assign(Object.assign({},e),{url:g(e.url)})}(n),c=f=f.then(u,u);return c;function u(){let n;try{const u=function(){if(f!==c)return l();const t=d.it,n=o.newEntry(i);t.transfer(n,e);const u=new $n("wesib:leavePage",{when:e,from:t.page,to:n.page});if(s(n.page),!r.dispatch(u)||f!==c)return l(n);let h;if(a(e=>h=e,e,u.from,u.to),!h)return l(n);return n}();return u?(n=u,o[t](n,d),r.dispatch(new Nn("wesib:enterPage",{when:t,to:n.page})),n.page):u}catch(e){throw l(n,e),e}}function l(e,t){return e&&e.stay(d.it.page),r.dispatch(new zn("wesib:stayOnPage",{from:d.it.page,to:i,reason:t})),null}}}const es={setup(e){e.provide({a:In,by:Zn})}};function ts(e){let t;return n=>{const s=function(e){return new URL("",e.url).href}(n);if(t){if(t.url===s)return t.on;t.sup.off()}let r;const o=C().whenOff(()=>{t=void 0,r=void 0}),a=g(t=>{if(!r){const t=e(n),s=i(),a=t(e=>{s.it=e}).whenOff(e=>{null!=e&&o.off(e)});o.whenOff(e=>{a.off(e),s.done(e)}),r={on:s.read.thru_(e=>e?p(e):d()),num:0}}const s=r;return++s.num,s.on(t).needs(o).whenOff(e=>{--s.num||Promise.resolve().then(()=>{s.num||s!==r||o.off(e)})})});return t={url:s,on:a,sup:o},a}}class ns extends Error{}class ss{constructor(e,t){this._navigation=e,this._loader=t,this._map=new Map}get fragments(){const e=[];for(const t of this){if(!t.fragment)return[];e.push(t.fragment)}return e}[Symbol.iterator](){return J(j(this._map.values(),P))}handle(){const e=this,t=C();let n=N();return{get(){},put(t){e._add(t)},transfer(t){const n=e._transfer();return t.put(rs,n),n.handle()},enter(s,r){if("init"===r)return;n=C().needs(t);const o=g(t=>{const r=new S,o=r.on(t);return e._loader(s)(e=>r.send(e)).whenOff(e=>{void 0===e||e instanceof ns||r.send({ok:!1,page:s,error:e})}).needs(n),o}).share();D(e,({fragment:e,receiver:t})=>(function(e,t){return t?e.thru_(e=>e.ok?Object.assign(Object.assign({},e),{fragment:(null!=t.tag?e.document.getElementsByTagName(t.tag)[0]:e.document.getElementById(t.id))||void 0}):e):e})(o,e)({supply:C().needs(t.supply),receive(e,n){t.receive(e,n)}}))},leave(){n.off(new ns("page left"))},stay(){t.off(new ns("navigation cancelled"))},forget(){t.off(new ns("page forgotten"))}}}_add(e){const t=Object.assign(Object.assign({},e),{receiver:K(e.receiver)}),{supply:n}=t.receiver,s=this._map.get(n);s?s.push(t):(this._map.set(n,[t]),n.whenOff(()=>this._map.delete(n)))}_transfer(){const e=new ss(this._navigation,this._loader);for(const[t,n]of this._map.entries())e._map.set(t,[...n]);return e}}const rs=new class extends Qn{create(e,t){return{get:()=>t,put:w}}},os=new an("page-load-agent"),is=new b("page-load-url",{byDefault:O(w)}),as=new e("page-loader",{byDefault:re((function(e){const t=e.get(ae),n=e.get(hn),s=e.get(is),o=e.get(os),i=new t.DOMParser;return e=>{const t=new URL(e.url.href);s(t);const a=new Request(t.href,{mode:"same-origin",credentials:"same-origin",headers:new Headers({Accept:"text/html"})});return g(e=>o(c,a)(e));function c(s){s=function(e,t){var n;const s=null===(n=e.get(rs))||void 0===n?void 0:n.fragments;if(!s||!s.length)return t;return new Request(t,{headers:{"Accept-Fragment":r(s,(e,t)=>(e?e+", ":"")+(null!=t.tag?"tag="+W(t.tag):"id="+W(t.id)),"")}})}(e,s);const o=new S,a=o.on.thru_((n,s)=>{if(!n.ok)return{ok:!1,page:e,response:n,error:n.status};try{return{ok:!0,page:e,response:n,document:cs(i,t,n,s)}}catch(t){return{ok:!1,page:e,response:n,error:t}}});return g(t=>{const{supply:r}=t;u({page:e}).once({supply:C().needs(r),receive(e,n){t.receive(e,n)}});const i=n(s)(e=>{a(t),e.text().then(t=>{o.send(e,t),r.needs(i)}).catch(e=>r.off(e))})})}}}))});function cs(e,t,n,s){const r=e.parseFromString(s,X(n.headers.get("Content-Type")||"text/html")[0].v);if(r.head){const e=r.head.querySelector("base");if(e)e.href=new URL(e.getAttribute("href"),t).href;else{const e=r.createElement("base");e.href=t.href,r.head.appendChild(e)}}return r}class us extends Qn{create(e,t,n){const s=new ss(n.get(In),ts(n.get(as))),r=s.handle();return e.put(rs,s),r.put(t),r}}const ls=new us,hs=new e("page-cache-buster",{byDefault:re(e=>new ps(e))}),ds="__wesib_app_rev__";class ps{constructor(e){const t=fs(e.get(ae).document);if(t){const n=e.get(In);this.urlModifier=u(e=>e.searchParams.set(ds,t)),this.agent=u((e,s)=>e(new Request(s.url,s)).thru_(e=>{if(e.ok){const s=fs(e.document);if(s&&s!==t){const t=new URL(e.page.url.href);t.searchParams.set(ds,s),n.update(t),n.reload()}}return e}))}else this.urlModifier=u(),this.agent=u()}static get[n](){return hs}}function fs(e){var t;return null===(t=e.querySelector("meta[name=wesib-app-rev]"))||void 0===t?void 0:t.getAttribute("content")}function gs(e,t,n,s=ms){let r;"function"==typeof n?(s=n,r=null):r=n||null;const o=t.ownerDocument;if(pe(e)){const n=o.createElement(e.tagName.toLowerCase());return e.getAttributeNames().forEach(t=>n.setAttribute(t,e.getAttribute(t))),s(e,n),t.insertBefore(n,r),n}const i=o.importNode(e,!1);return t.insertBefore(i,r),i}function ms(e,t){D(E(e.childNodes),e=>gs(e,t))}function ws(e){const t=e.get(ae).document;return e=>e().thru_(e=>{if(e.ok){const n=new Set(o(ys(t,E(t.scripts)),([e])=>e));D(f(ys(e.document,E(e.document.querySelectorAll("script"))),([e])=>!n.has(e)),([e,s])=>{gs(s,t.head,(t,n)=>n.src=e),n.add(e)})}return e})}function ys(e,t){return o(f(t,e=>!!e.src),t=>[new URL(t.src,e.baseURI).href,t])}function bs(e){const t=e.get(ae).document;return e=>e().thru_(e=>{if(!e.ok)return e;const n=e.document.querySelectorAll("link[rel=stylesheet]");if(!n.length)return e;let s=t.head,r=null;const o=t.querySelectorAll("link[rel=stylesheet]"),i=new Map,a=o.item(0);return a&&(s=a.parentNode,r=a,D(E(o),e=>i.set(new URL(e.href,t.baseURI).href,e))),D(E(n),e=>{const n=new URL(e.href,t.baseURI).href,o=i.get(n);o?(V(i.keys())===n?(s=o.parentNode,r=o.nextSibling):s.insertBefore(o,r),i.delete(n)):gs(e,s,r,(e,t)=>t.href=n)}),D(i.values(),e=>e.parentNode.removeChild(e)),e})}function _s(e){const t=e.get(ae).document;return e=>e().thru_(e=>{if(e.ok){const n=e.document.getElementsByTagName("title").item(0);n&&n.textContent&&(t.title=n.textContent)}return e})}const vs={needs:class{static get[me](){return es}},setup(e){e.provide({a:is,by:e=>e.urlModifier,with:[ps]}),e.provide({a:os,by:e=>e.agent,with:[ps]}),e.provide({a:os,by:ws}),e.provide({a:os,by:bs}),e.provide({a:os,by:_s})}};class xs{static get[me](){return vs}}const Os=new e("component-style-producer"),Ss=new G("component-styp-render"),ks=new te("https://wesib.github.io/ns/element-id-class","elic","element-id-class"),Cs=new e("unique-element-class",{byDefault:function(e){const t=e.get(ce),n=e.get(Ne),s=n.get(Ye),r=`${s.name?q.name(s.name,t):"component"}#${++Ds}`,o=ks.name(t(ks),r,Y);return n.element.classList.add(o),o}});let Ds=0;const Es=new e("component-style-producer:impl");class Rs{constructor(e,t=F){this._context=e,this._produce=t}static get[n](){return Es}produce(e,t={}){const n=this._context,s=n.get(Xt,{or:null});return this._produce(e,Object.assign(Object.assign({},t),{document:t.document||n.get(ae).document,parent:t.parent||n.contentRoot,rootSelector:[],schedule:t.schedule||function(){const e=n.get(Ht);return t=>e.newSchedule().schedule(t)}(),nsAlias:t.nsAlias||n.get(ce),render:function(){const{render:e}=t,r=new le(e).add(...n.get(Ss)),o=t.hostSelector?H(t.hostSelector)[0]:void 0;return r.add(s?js(o):Ps(o||{c:[n.get(Cs)]})),r.value}()}))}}function js(e){return{order:-100,render(t,n){let{selector:s}=t;if(s.length){if(e){const[t,n]=Ts(s);n&&(s=n.length?[{u:[[":","host",qs(n,e)]]},...t]:[{u:[[":","host",[e]]]},...t])}}else s=[e||{u:[[":","host"]]}];t.render(n,{selector:s})}}}function Ps(e){return{order:-100,render(t,n){let{selector:s}=t;if(s.length){const[t,n]=Ts(s);s=n&&n.length?[...qs(n,e),...t]:[e,...t]}else s=[e];t.render(n,{selector:s})}}}function Ts(e){if("string"!=typeof e[0]){const[{ns:t,e:n,i:s,c:r,u:o,s:i,$:a},...c]=e;if(!t&&!n&&!s&&!r&&!i&&o){const[[e,t,...n]]=o;if(":"===e&&"host"===t){let e;return n.length?(e=[...n[0]],e[0].$=a):e=a?[{$:a}]:[],[c,e]}}}return[e]}function qs(e,{ns:t,e:n,i:s,c:r,u:o,s:i}){const[a,...c]=e;return[{ns:a.e||a.ns?a.ns:t,e:a.e||a.ns?a.e:n,i:a.i||s,c:a.c?r?[...a.c,...r]:a.c:r,u:a.u?o?[...a.u,...o]:a.u:o,s:(a.s||"")+(i||"")||void 0,$:a.$},...c]}const As={needs:Jt,setup(e){e.perComponent({as:Rs}),e.perComponent({a:Os,by:e=>(t,n)=>e.produce(t,n),with:[Rs]})}};class Ms{static get[me](){return As}}const Us={produce(e,t,n){const s=A(t),r=n&&n.offline,o=e.get(Os);let i,a=N();const c=C(e=>{i=w,a.off(e)});switch(i=()=>{a=o(s,n).needs(c)},r){case"always":e.whenReady(i);break;case!1:e.whenOn(e=>{i(),a.needs(e)});break;default:e.whenOn.once(i)}return e.whenDestroyed(e=>c.off(e)),c}};function Ls(e){return(t,n)=>{const s=t.constructor;Pe.define(s,{define(t){t.onComponent(t=>{t.whenReady(({component:s})=>{const r=s[n];Us.produce(t,"function"==typeof r?r.bind(s):r,e)})})},feature:{needs:[Ms]}})}}const Ns={has:Ms,needs:Jt,setup(e){e.perComponent({a:Rs,by:e=>new Rs(e,$)}),e.perComponent({a:Os,by:e=>(t,n)=>e.produce(t,n),with:[Rs]})}};class $s{static get[me](){return Ns}}const zs=new e("theme");class Bs{static get[n](){return zs}ref(e){return e(this.root)}}const Is=new e("theme-factory");class Vs{static get[n](){return Is}}const Fs=new class extends M{constructor(){super("theme-style")}grow(e){const t=new Map;return e.seed.forEach(e=>{let n,s,r;"function"==typeof e?(n=s=e,r=!0):(n=e.style,s=e.provide.bind(e),r=!1);const o=t.get(n);if(o){const[e,i]=o;t.set(n,[r?Hs(s,e):Hs(e,s),r||i])}else t.set(n,[s,r])}),t.size?n:e.byDefault(()=>n);function n(e){const n=t.get(e);if(!n)return e;const[s,r]=n;return r?s:Hs(e,s)}}};function Hs(e,t){return n=>U(e(n),t(n))}class Qs extends Bs{constructor(e){super(),this._styles=e,this.root=Z(),this._rules=new Map}style(...e){const t=this;return A(...e.reduce((function(e,n){const s=t._rules.get(n);if(s)e.push(s);else{const s=t._styles(n)(t);t._rules.set(n,s),e.push(s)}return e}),[]))}}class Gs extends Vs{constructor(e){super(),this._styles=e}newTheme(){return new Qs(this._styles)}}const Js={needs:Ms,setup(e){e.provide({a:Vs,as:Gs,with:[Fs]}),e.provide({a:Bs,by:e=>e.newTheme(),with:[Vs]})}};class Ks{static get[me](){return Js}}export{Nt as A,ae as B,Te as C,ce as D,ve as F,In as N,Ls as P,Wt as R,$s as S,Bs as T,Un as a,Cn as b,Ks as c,pn as d,xs as e,Jt as f,Dt as g,Lt as h,ms as i,on as j,Tn as k,ls as p};
//# sourceMappingURL=wesib.bdbff3cd.m.js.map
