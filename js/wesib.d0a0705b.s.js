System.register(["./lib.ebf0e7c0.s.js"],(function(e){"use strict";var t,n,r,u,i,o,a,c,s,f,l,h,v,p,d,y,g,m,w,b,k,_,x,O,S,D,C,R,E,A,T,j,P,U,F,q,L,N,M,K,B,z,I,V,H,W,$,Q,G,J,X,Y,Z,ee,te,ne,re,ue,ie,oe,ae,ce,se,fe,le,he,ve,pe,de,ye,ge,me,we,be,ke,_e,xe,Oe,Se,De,Ce,Re;return{setters:[function(e){t=e.j,n=e.k,r=e.l,u=e.n,i=e.t,o=e.N,a=e.o,c=e.q,s=e.r,f=e.u,l=e.v,h=e.A,v=e.w,p=e.C,d=e.x,y=e.y,g=e.z,m=e.B,w=e.D,b=e.E,k=e.F,_=e.G,x=e.H,O=e.J,S=e.K,D=e.L,C=e.M,R=e.O,E=e.P,A=e.Q,T=e.T,j=e.U,P=e.V,U=e.W,F=e.X,q=e.Y,L=e.Z,N=e.$,M=e.a0,K=e.a1,B=e.a2,z=e.a3,I=e.a4,V=e.a5,H=e.a6,W=e.a7,$=e.a8,Q=e.a9,G=e.aa,J=e.ab,X=e.ac,Y=e.ad,Z=e.ae,ee=e.af,te=e.ag,ne=e.ah,re=e.ai,ue=e.aj,ie=e.ak,oe=e.al,ae=e.am,ce=e.an,se=e.ao,fe=e.ap,le=e.aq,he=e.ar,ve=e.as,pe=e.at,de=e.au,ye=e.av,ge=e.s,me=e.aw,we=e.ax,be=e.ay,ke=e.az,_e=e.aA,xe=e.p,Oe=e.aB,Se=e.aC,De=e.aD,Ce=e.aE,Re=e.aF}],execute:function(){e({A:function(e){return it({feature:{needs:mn},setup:function(t){var n=function(e){"string"==typeof e?t.perDefinition({a:fn,is:{name:e,change:vn(e)}}):Object.keys(e).forEach((function(n){t.perDefinition({a:fn,is:{name:n,change:vn(n,e[n])}})}))};Me(e)?e.forEach(n):n(e)}})},C:it,F:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return Je.define.apply(Je,[e].concat(t))}},H:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.handle?e.handle.bind(e):qr(e),n=new Ke(e.event||"click");return it({feature:{needs:Dr},define:function(e){e.whenComponent((function(e){e.whenOn((function(r){var u=e.get(dr);n.forEach((function(n){e.on(n).to({supply:r,receive:function(n,r){u.read().once((function(n){return t({event:r,page:n,context:e,navigation:u})}))}})}))}))}))}})},I:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onResponse?e.onResponse.bind(e):F,n=e.contentKey?e.contentKey.bind(e):ru;return it({feature:{needs:nu},define:function(r){r.whenComponent((function(r){var u=r.get(Ue).document,i=r.get(Ne)(),o=r.get(dr),a=n(o.page),c=function(){var t=e.fragment;if(t)return t;var n=r.element,u=n.id,i=n.tagName;return u?{id:u}:{tag:i}};r.whenOn((function(e){var s=u.createRange();s.selectNodeContents(r.contentRoot),o.read().once((function(o){o.put($r,{fragment:c(),receiver:{supply:e,receive:function(e,o){return function(e){var o=n(e.page);if(o===a)return;if(!e.ok)return void i((function(){return t({context:r,range:s,response:e})}));a=o,i((function(){s.deleteContents();var n=u.createDocumentFragment(),i=e.fragment;i&&(Nr(i,n),s.insertNode(n)),t({context:r,range:s,response:e})}))}(o)}}})}))}))}))}})},P:function(e){return yt((function(t){var n=t.get;return{componentDef:{feature:{needs:yu},define:function(t){t.whenComponent((function(t){t.whenReady((function(r){var u=r.component,i=n(u),o="function"==typeof i?i.bind(u):i;gu(t,o,e)}))}))}}}}))},R:function(e){return yt((function(t){var n=t.get;return{componentDef:{feature:{needs:xn},define:function(t){t.whenComponent((function(t){t.whenReady((function(){var r=t.component;Dn(t,n(r).bind(r),e)}))}))}}}}))},a:function(e){return it({define:function(t){t.whenComponent((function(t){var n=t.get(Wn).up;b({parent:n().keepThru_((function(e){return e?x(e.get(Eu)):W({})})),aspects:t.get(Ru)}).keepThru_((function(n){var r=_(n.parent,1)[0],u=_(n.aspects,1)[0];if(r.control){var i=e({control:r,context:t,aspects:u});if(i)return i instanceof Oe?k(i):x(i)}return k()})).consume((function(e,n){if(e){var r=Au(t,e);return(n||j(e)).needs(r),r}}))}))}})},d:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.select,n=void 0===t?"a":t,r=e.pick,u=void 0===r?{all:!0,deep:!0}:r;return it({feature:{needs:[cr,Dr]},define:function(t){t.whenComponent((function(t){var r=Ur(t,e),i=Rr(e),o=t.get(dr),a=t.get(Qn);t.whenOn((function(e){var c=new Map;o.read().tillOff(e).consume((function(e){return a.select(n,u).read().keepThru_((function(n){return x(O.apply(void 0,l(n.map((function(n){return i({node:n,context:t,page:e})})))))})).consume((function(){for(var n=arguments.length,u=new Array(n),i=0;i<n;i++)u[i]=arguments[i];var o=Cr(u),a=new Map,s=T();return o.forEach((function(n){var u,i=c.get(n);i?(a.set(n,i),u=i):(u=r({node:n,context:t,page:e}),a.set(n,u)),u.supply().needs(s)})),c=a,s}))}))}))}))}})},f:function(){for(var e=jt.create(),t=sn(e),n=t.bootstrapContext,r=t.complete,u=arguments.length,i=new Array(u),o=0;o<u;o++)i[o]=arguments[o];var a=1===i.length?i[0]:cn(i);return n.get(an).request(a),n.get($t.of(a)).to((function(e){e.init().then(r)})),n},h:function(e){return yt((function(t){var n=t.type,r=t.key,u=function(e,t,n){var r,u;if("string"==typeof n)u=vn(r=n);else{if(n&&n.name)r=n.name;else{if("string"!=typeof t)throw new TypeError("Attribute name is required as property key is not a string: "+"".concat(e.constructor.name,".prototype.").concat(String(t)));r=t}u=vn(r,n&&n.updateState)}return{name:r,change:u}}(n.prototype,r,e),i=u.name;return{componentDef:{feature:{needs:mn},setup:function(e){e.perDefinition({a:fn,is:u})}},get:function(e){return lt.of(e).element.getAttribute(i)},set:function(e,t){var n=lt.of(e).element;null!=t?n.setAttribute(i,t):n.removeAttribute(i)}}}))},i:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pn;return it({setup:function(t){t.perComponent({a:Cn,by:function(t){return t.get(En)(t,e)}}),t.perComponent({a:ct,by:function(e){return e.get(Cn,{or:null})}})},feature:{needs:Tn}})},k:Au,t:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hn(t);return new On(e,t,n)}});var Ee=new n("bootstrap-context"),Ae=e("B",function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,null,[{key:p,get:function(){return Ee}}]),t}(d));function Te(e){return function(t,n){var r=t.get(Ae);return t===r?e(r,n):r.get(n)}}var je=new n("component-factory"),Pe=function(){function e(){u(this,e)}return f(e,[{key:"connectTo",value:function(e){var t=this.mountTo(e);return t.connected=!0,t}}],[{key:p,get:function(){return je}}]),e}(),Ue=e("g",new n("window",{byDefault:function(){return window}})),Fe=new n("bootstrap-root",{byDefault:function(e){return e.get(Ue).document.body}}),qe=new n("default-namespace-aliaser");function Le(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t(Object.assign(Object.assign({},n),{window:n.window||e.get(Ue)}))}}var Ne=new(function(e){function t(){var e;return u(this,t),(e=c(this,s(t).call(this,"default-render-scheduler"))).upKey=e.createUpKey((function(e){return e.seed.keepThru((function(){var t;if(arguments.length)return Le(e.context,(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t]);var n=function(){return w(Le(e.context,L))};return x(e.byDefault(n)||n())}))})),e}return a(t,e),f(t,[{key:"grow",value:function(e){var t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?w(e.or):e.or}:void 0).to((function(n){return t=Le(e.context,n)})),function(){return t.apply(void 0,arguments)}}}]),t}(C));function Me(e){return Array.isArray(e)}var Ke=function(e){function t(e){var n;return u(this,t),(n=c(this,s(t).call(this))).items=null==e?new Set:Me(e)?new Set(e):new Set([e]),n}return a(t,e),f(t,[{key:Symbol.iterator,value:function(){return this.items[Symbol.iterator]()}},{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.items.add(t)})),this}},{key:"merge",value:function(e){return null==e?this:Me(e)?this.add.apply(this,l(e)):this.add(e)}},{key:"value",get:function(){switch(this.items.size){case 0:return;case 1:return this.items[Symbol.iterator]().next().value;default:return l(this.items)}}},{key:"size",get:function(){return this.items.size}}]),t}(h);function Be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=Object.getPrototypeOf(e.prototype);if(null!=n){var r=n.constructor;return t(r)?r:Be(r,t)}}function ze(e,t,n,r){var u=!n,i=r(n?function(e){if(function(e){return void 0===e.value&&void 0===e.writable}(e))return e;var t=Symbol("value"),n=e.value,r=Object.assign(Object.assign({},e),{writable:void 0,value:void 0,get:function(){return t in this?this[t]:n}});return e.writable&&(r.set=function(e){this[t]=e}),delete r.writable,delete r.value,r}(n):function(e,t){var n=Symbol("".concat(String(t),":value")),r=e[t];return{configurable:!0,enumerable:!0,get:function(){return n in this?this[n]:r},set:function(e){this[n]=e}}}(e,t));if(!u||!i)return i;Object.defineProperty(e,t,i)}function Ie(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return t};return e?t?function(){for(var r=arguments.length,u=new Array(r),i=0;i<r;i++)u[i]=arguments[i];return n(e.apply(this,u),t.apply(this,u))}:e:t}function Ve(e){return e.nodeType===Node.ELEMENT_NODE}var He=function(){function e(t){u(this,e),this.symbol=t}return f(e,[{key:"own",value:function(e){return e.hasOwnProperty(this.symbol)?e[this.symbol]:void 0}},{key:"of",value:function(e){var t=this.own(e),n=Be(e),r=n&&this.of(n);return t?r?this.merge([r,t]):t:r}},{key:"define",value:function(e,t){var n=this,r=this.own(e),u=S(t,(function(t){return n.meta(t,e)})),i=this.merge(r?B([[r],u]):u);return Object.defineProperty(e,this.symbol,{configurable:!0,value:i}),e}}]),e}(),We=function(){function e(){var t=this;u(this,e),this.promise=new Promise((function(e,n){t._resolve=e,t._reject=n}))}return f(e,[{key:"resolve",value:function(e){this._resolve(e)}},{key:"reject",value:function(e){this._reject(e)}}]),e}(),$e=Symbol("feature-def"),Qe=new(function(e){function t(){return u(this,t),c(this,s(t).call(this,$e))}return a(t,e),f(t,[{key:"merge",value:function(e){return r(e,(function(e,t){return{needs:new Ke(e.needs).merge(t.needs).value,has:new Ke(e.has).merge(t.has).value,setup:Ie(e.setup,t.setup),init:Ie(e.init,t.init)}}),{})}},{key:"meta",value:function(e,t){var n=e[$e];return null==n?e:this.meta("function"==typeof n?e[$e](t):n,t)}}]),t}(He)),Ge=t({},$e,(function(){return{}})),Je={of:function(e){return Qe.of(e)||{}},for:function(e,t){return Qe.meta(t,e)},merge:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qe.merge(t)},all:function(){for(var e=arguments.length,n=new Array(e),u=0;u<e;u++)n[u]=arguments[u];return r(n,(function(e,n){return t({},$e,(function(t){return Je.merge(Je.for(t,e),Je.for(t,n))}))}),Ge)},define:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Qe.define(e,n)}};var Xe=new n("feature-context"),Ye=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"whenDefined",value:function(e){return this.get(Ae).whenDefined(e)}},{key:"load",value:function(e){return this.get(Ae).load(e)}}],[{key:p,get:function(){return Xe}}]),t}(Ae),Ze=function(e){function t(e){var n;return u(this,t),(n=c(this,s(t).call(this,"Circular feature needs: "+e.reduce((function(e,t){var n=_(t,3),r=n[0],u=n[1],i=n[2];return(e||r.name)+" ".concat(u," ").concat(i.name)}),"")))).needs=e,n}return a(t,e),t}(z(Error)),et=function(){function e(){u(this,e)}return f(e,[{key:I,value:function(){return this.read()}}]),e}(),tt=Symbol("component-def"),nt=new(function(e){function t(){return u(this,t),c(this,s(t).call(this,tt))}return a(t,e),f(t,[{key:"merge",value:function(e){return r(e,(function(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{setup:Ie(e.setup,t.setup),define:Ie(e.define,t.define),feature:e.feature?t.feature?Je.merge(e.feature,t.feature):e.feature:t.feature})}),{})}},{key:"meta",value:function(e,t){var n=e[tt];return null!=n?this.meta("function"==typeof n?e[tt](t):n,t):null!=e[$e]?{feature:Je.for(t,e)}:V(e)?{name:e}:e}}]),t}(He)),rt=t({},tt,(function(){return{}})),ut={of:function(e){return nt.of(e)||{}},for:function(e,t){return nt.meta(t,e)},merge:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nt.merge(t)},all:function(){for(var e=arguments.length,n=new Array(e),u=0;u<e;u++)n[u]=arguments[u];return r(n,(function(e,n){return t({},tt,(function(t){return ut.merge(ut.for(t,e),ut.for(t,n))}))}),rt)},define:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return nt.define(e,n)}};function it(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=function(e){return ut.define.apply(ut,[e].concat(t))},u=r;return u[tt]=function(){return ut.all.apply(ut,t)},r}var ot=new n("component-context"),at=new n("component-event-dispatcher",{byDefault:function(e){var t=e.get(ot),n=new N(t.element);return j(n).needs(t),{dispatch:function(e){return n.dispatch(e)},on:function(e){return n.on(e)}}}}),ct=new n("content-root",{byDefault:function(e){return e.get(ot).element}}),st=new q("state-updater",{byDefault:y(F)}),ft=Symbol("component-context"),lt=function(e){function t(){var e;return u(this,t),(e=c(this,s(t).apply(this,arguments))).updateState=ht.bind(v(e)),e}return a(t,e),f(t,[{key:"on",value:function(e){return this.get(at).on(e)}},{key:"dispatchEvent",value:function(e){this.get(at).dispatch(e)}},{key:"contentRoot",get:function(){return this.get(ct)}}],[{key:"of",value:function(e){var t=e[ft];if(!t)throw TypeError("No component context found in ".concat(e));return t}},{key:p,get:function(){return ot}}]),t}(d);function ht(e,t,n){this.get(st)(e,t,n)}var vt=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"context",get:function(){return lt.of(this.target)}}]),t}(z(Event)),pt=function(){function e(){u(this,e)}return f(e,[{key:"component",get:function(){return this.context.component}},{key:"element",get:function(){return this.context.element}}]),e}(),dt=Symbol("anonymous-component-property");function yt(e){var n=function(n){var r=n.get,u=n.set,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt,o=arguments.length>2?arguments[2]:void 0;return it(t({},tt,(function(t){var n=e({type:t,key:i,readable:!0,writable:o,enumerable:!1,configurable:!1,get:function(e){return r(e,i)},set:function(e,t){return u(e,t,i)}});return n&&n.componentDef||{}})))},r=function(e,t){return n({get:function(t,n){return e(t,n)}},t,!1)},u=function(t,n,r){return ze(t,n,r,(function(r){var u=r.get,i=r.set,o=t.constructor,a=e({type:o,key:n,readable:!!r.get,writable:!!r.set,enumerable:!!r.enumerable,configurable:!!r.configurable,get:u?function(e){return u.call(e)}:gt(n),set:i?function(e,t){return i.call(e,t)}:mt(n)})||{},c=a.get,s=a.set,f=a.configurable,l=a.enumerable,h=a.componentDef,v=void 0===h?{}:h;ut.define(o,v);var p=Object.assign(Object.assign({},r),{configurable:null!=f?f:r.configurable,enumerable:null!=l?l:r.enumerable});return(c||s)&&(p.get=c&&function(){return c(this,n)},p.set=s&&function(e){s(this,e,n)}),p}))};return u.With=function(e,t){return n(e,t,!0)},u.By=r,u.As=function(e,t){return r(y(e),t)},u.Bind=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt,r=Symbol("".concat(String(t),":accessor")),u=function(n){var u=n[r];if(u)return u;var i=e(n,t);return n[r]={get:i.get?i.get.bind(i):gt(t),set:i.set?i.set.bind(i):mt(t)}};return n({get:function(e){return u(e).get()},set:function(e,t){return u(e).set(t)}},t,!0)},u}function gt(e){return function(){throw new TypeError('"'.concat(String(e),'" is not readable'))}}function mt(e){return function(){throw new TypeError('"'.concat(String(e),'" is not writable'))}}function wt(e){return e[ft]}var bt=new(function(e){function t(){var e;return u(this,t),(e=c(this,s(t).call(this,"element-adapter"))).upKey=e.createUpKey((function(e){return e.seed.keepThru((function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var u=n.reduce((function(e,t){return function(n){return e(n)||t(n)}}),wt),i=function(){return w(wt)};return u!==wt?u:x(e.byDefault(i)||i())}))})),e}return a(t,e),f(t,[{key:"grow",value:function(e){var t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?w(e.or):e.or}:void 0).to((function(e){return t=e})),function(e){return t(e)}}}]),t}(C)),kt=new q("element-observer",{byDefault:Te((function(e){var t=e.get(bt),n=function(e){function n(e){var r;return u(this,n),r=c(this,s(n).call(this,(function(n){n.forEach((function(e){X(Y(e.removedNodes),(function(e){var t;return null===(t=function(e){var t;return null===(t=e[ft])||void 0===t?void 0:t.mount}(e))||void 0===t?void 0:t.checkConnected()})),X(R(Y(e.addedNodes),Ve),(function(e){var n,r;return null===(r=null===(n=t(e))||void 0===n?void 0:n.mount)||void 0===r?void 0:r.checkConnected()}))})),e(n,v(r))})))}return a(n,e),f(n,[{key:"observe",value:function(e,t){J(s(n.prototype),"observe",this).call(this,e,Object.assign(Object.assign({},t),{childList:!0}))}}]),n}(z(MutationObserver));return function(e){return new n(e)}}))});var _t=Symbol("component-factory");function xt(e){var t=e[_t];if(!t)throw new TypeError("Component is not defined: ".concat(e));return t}var Ot=new n("custom-elements",{byDefault:function(e){var t=e.get(Ue).customElements,n=e.get(qe);return new(function(e){function r(){return u(this,r),c(this,s(r).apply(this,arguments))}return a(r,e),f(r,[{key:"define",value:function(e,r){if(V(e))t.define(Z.name(e,n),r);else{var u=xt(e).elementDef,i=u.name,o=u.extend;i?o&&o.name?t.define(Z.name(i,n),r,{extends:o.name}):t.define(Z.name(i,n),r):Ct(e).resolve(void 0)}}},{key:"whenDefined",value:function(e){if(V(e))return t.whenDefined(Z.name(e,n));var r=xt(e).elementDef.name;return r?t.whenDefined(Z.name(r,n)):Ct(e).promise}}]),r}(St))}}),St=function(){function e(){u(this,e)}return f(e,null,[{key:p,get:function(){return Ot}}]),e}();var Dt=Symbol("component-resolver");function Ct(e){return e[Dt]||(e[Dt]=new We)}var Rt=new n("definition-context"),Et=new n("element-def",{byDefault:function(e){var t=e.get(Rt).componentType,n=ut.of(t),r=n.name,u=n.extend,i={get type(){return u&&u.type||e.get(Ue).HTMLElement},get name(){return u&&u.name}};return{get name(){return r},get extend(){return i}}}}),At=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"elementDef",get:function(){return this.get(Et)}}],[{key:p,get:function(){return Rt}}]),t}(d),Tt=new n("bootstrap-context-registry"),jt=function(e){function t(){var e;return u(this,t),(e=c(this,s(t).call(this))).provide({a:t,is:v(e)}),e.values=e.newValues(),e}return a(t,e),f(t,null,[{key:"create",value:function(){return new t}},{key:p,get:function(){return Tt}}]),t}(g),Pt=new n("component-context-registry",{byDefault:Te((function(){return new Ut}))}),Ut=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,null,[{key:p,get:function(){return Pt}}]),t}(g),Ft=new n("definition-context-registry",{byDefault:Te((function(e){return new qt(e)}))}),qt=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,null,[{key:p,get:function(){return Ft}}]),t}(g);var Lt=Symbol("post-def-setup");function Nt(e){if(e.hasOwnProperty(Lt))return e[Lt];var t=i(),n=new Q,r=t.read().thru((function(e){return e?k(e):D()})),u=G(r,n),o=Be(e,(function(e){return tt in e}));if(o){var a=Nt(o);u.to((function(e){return a.send(e)}))}var c={on:u,send:function(e){n.send(e)},setup:function(e){t.it=e}};return Object.defineProperty(e,Lt,{value:c}),c}var Mt=function e(){u(this,e);var t=i(0),n=new Q;this.onCreated=$((function(e){var r=t.it+1;n.on({supply:e.supply,receive:function(t,n,u){u<r&&e.receive({onRecurrent:function(e){t.onRecurrent((function(t){return e(t)}))}},n)}}),++t.it})),this.readNotifier=t.read().keepThru_((function(e){return function(t,r){return n.send(t,r),e}}))},Kt=new n("element-builder",{byDefault:Te((function(e){var t=e.get(qt),n=e.get(Ut),r=new Q,o=new Q;return{definitions:r,components:o,buildElement:function(e){var o,h,p,d=ut.of(e),g=new Mt,m=i(!1),w=m.read().thru((function(e){return e?k():D()}));function b(){return n.append(h)}var _=new(function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"mountTo",value:function(e){if(e[ft])throw new Error("Element ".concat(e," already bound to component"));var t=l({definitionContext:p,whenComponent:g,registry:b(),element:e,elementSuper:function(t){return e[t]},createMount:function(t){return new(function(n){function r(){return u(this,r),c(this,s(r).apply(this,arguments))}return a(r,n),f(r,[{key:"checkConnected",value:function(){var t=e,n=t.ownerDocument;return this.connected=null!=n&&n.contains(t)}},{key:"context",get:function(){return t}},{key:"connected",get:function(){return 3===zt(e).it},set:function(t){zt(e).it=t?3:2}}]),r}(pt))}}).mount;return t.checkConnected(),It(t.context),t}},{key:"componentType",get:function(){return p.componentType}},{key:"elementType",get:function(){return p.elementType}},{key:"elementDef",get:function(){return p.elementDef}}]),t}(Pe));p=new(function(n){function r(){var n,i;u(this,r),n=c(this,s(r).call(this));var o=new qt(t.seedIn(v(n)));o.provide({a:At,is:v(n)}),o.provide({a:Pe,is:_}),n.get=o.newValues().get,h=new Ut(o.seedIn(v(n)));var a=n.whenReady().F,f=n.whenComponent().F,l={get componentType(){return e},get whenReady(){return a},get whenComponent(){return f},perDefinition:function(e){return o.provide(e)},perComponent:function(e){return h.provide(e)}};return null===(i=d.setup)||void 0===i||i.call(d,l),Nt(e).setup(l),n}return a(r,n),f(r,[{key:"whenReady",value:function(e){return(this.whenReady=w.thru_(y(this)).once().F)(e)}},{key:"whenComponent",value:function(e){return(this.whenComponent=g.onCreated.F)(e)}},{key:"perComponent",value:function(e){return h.provide(e)}},{key:"componentType",get:function(){return e}},{key:"elementType",get:function(){throw new Error("Custom element class is not constructed yet. Consider to use a `whenReady()` callback")}}]),r}(At)),null===(o=d.define)||void 0===o||o.call(d,p),r.send(p);var x=function(e,t,n){return function(r){function i(){var r;return u(this,i),r=c(this,s(i).call(this)),It(l({definitionContext:e,whenComponent:t,registry:n(),element:v(r),createMount:F,elementSuper:function(e){return J(s(i.prototype),e,v(r))}})),r}return a(i,r),f(i,[{key:"connectedCallback",value:function(){zt(this).it=3}},{key:"disconnectedCallback",value:function(){zt(this).it=2}}]),i}(e.get(Et).extend.type)}(p,g,b);return Object.defineProperty(p,"elementType",{configurable:!0,enumerable:!0,value:x}),m.it=!0,_}};function l(e){var t,n=e.definitionContext,r=e.whenComponent,l=e.registry,h=e.element,v=e.createMount,p=e.elementSuper,d=i(0),y=i();j(d).whenOff((function(e){return y.it=[e]}));var g=l.newValues(),m=new(function(e){function r(){var e;return u(this,r),(e=c(this,s(r).apply(this,arguments))).get=g.get,e.elementSuper=p,e}return a(r,e),f(r,[{key:"whenReady",value:function(e){var t=this;return(this.whenReady=d.read().thru((function(e){return e?k(t):D()})).once().F)(e)}},{key:"whenOn",value:function(e){var t=this;return(this.whenOn=d.read().thru_((function(e){if(3!==e)return D();var n=T();return t.whenOff().once((function(){return n.off()})).cuts(n),k(n)})).F)(e)}},{key:"whenOff",value:function(e){return(this.whenOff=d.read().thru_((function(e){return 2===e?k():D()})).F)(e)}},{key:"whenDestroyed",value:function(e){return(this.whenDestroyed=y.read().thru((function(e){return e?k(e[0]):D()})).once().F)(e)}},{key:"destroy",value:function(e){d.done(e)}},{key:"componentType",get:function(){return n.componentType}},{key:"element",get:function(){return h}},{key:"component",get:function(){throw new Error("The component is not constructed yet. Consider to use a `whenReady()` callback")}},{key:"mount",get:function(){return t||(t=v(this))}},{key:"connected",get:function(){return 3===d.it}},{key:U,get:function(){return j(d)}}]),r}(lt)),w=0;m.whenDestroyed((function(){return function(e){var t=e.element,n=e.mount;n&&(n.connected=!1);var r=t.parentElement;r&&r.removeChild(t)}(m)})),l.provide({a:lt,is:m}),Object.defineProperty(h,ft,{value:m}),Object.defineProperty(h,Bt,{writable:!0,value:d}),r.readNotifier.once((function(e){return w=e(m,w)})),m.whenOn((function(e){r.readNotifier.to({supply:e,receive:function(e,t){w=t(m,w)}})})),o.send(m);var b=function(e,t){var n=e.prototype,r=n[ft];n[ft]=t;try{var u=new e(t);return Object.defineProperty(u,ft,{value:t}),u}finally{n[ft]=r}}(n.componentType,m);return Object.defineProperty(m,"component",{configurable:!0,enumerable:!0,value:b}),d.it=1,m}}))}),Bt=Symbol("component-status");function zt(e){return e[Bt]}function It(e){e.whenOn().once((function(){return e.dispatchEvent(new vt("wesib:component",{bubbles:!0}))}))}var Vt=y(F);var Ht=function(){function e(t){var n=this;u(this,e),this._context=t,this._definitionQueue=[],t.whenReady((function(){n._definitionQueue.forEach((function(e){return e()})),delete n._definitionQueue}))}return f(e,[{key:"define",value:function(e){var t=this;this._definitionQueue.push((function(){var n=t._context.get(Kt).buildElement(e);e[_t]=n,t.customElements.define(e,n.elementType)}))}},{key:"customElements",get:function(){return this._context.get(St)}}]),e}(),Wt=Symbol("feature-key"),$t=function(e){function t(e){return u(this,t),c(this,s(t).call(this,"feature:".concat(e.name)))}return a(t,e),f(t,[{key:"upKey",get:function(){return this}}],[{key:"of",value:function(e){return e.hasOwnProperty(Wt)?e[Wt]:e[Wt]=new t(e)}}]),f(t,[{key:"grow",value:function(e){return Gt(e.context.get(Ae),e.seed.keepThru(Qt))}}]),t}(C);function Qt(){for(var e,t=!1,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];for(var i=0,o=r;i<o.length;i++){var a=o[i];switch(a[1]){case"is":t=!0,e||(e=a);break;case"has":e=a;break;case"needs":t=!0}}return t?e:void 0}function Gt(e,t){return m((function(n){var r,u=w(),i=Promise.resolve("idle");return b({clause:t,deps:Jt(e,t)}).keepThru_((function(t){var n=_(t.clause,1)[0],o=t.deps;if(!n)return k();var a=_(n,3),c=a[0],s=a[2];if(c.feature===r)return x(u);if(s!==(r=c.feature))return x(u=e.get($t.of(r)).keepThru_((function(e){return e.to(i),i=e.stage,e})));var f=new Yt(e,c,o).to(i),l=w(f);return x(u=m((function(e){return l.to(e).whenOff((function(){i=f.unload()}))})).share())})).to(n)})).keepThru((n=null,function(e){return n===e?D():(n=e,e?k(e):k())}));var n}function Jt(e,t){return t.keepThru_((function(t){if(!t)return k();var n=_(t,1)[0].def,r=new Ke(n.needs);return r.size?x(O.apply(void 0,l(S(r,(function(t){return e.get($t.of(t))})))).keepThru_(Xt)):k()}))}function Xt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return k.apply(void 0,l(R(S(t,(function(e){return e[0]})),M)))}var Yt=function(){function e(t,n,r){var o=this;u(this,e),this.bsContext=t,this.request=n,this.deps=r,this.state=i(!1),this.down=new Promise((function(e){return o._down=e})),this._stage=Promise.resolve(new en(this))}var t,n,r;return f(e,[{key:"to",value:function(e){var t=this._stage;return this._stage=e.then((function(e){return t.then((function(t){return t[e]()}))})),this}},{key:"setup",value:(r=H(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._stage=this._stage.then((function(e){return e.setup()}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"init",value:(n=H(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._stage=this._stage.then((function(e){return e.init()}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"unload",value:(t=H(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._stage,delete this._stage,e.next=4,t;case 4:return n=e.sent,e.next=7,n.stop();case 7:return r=e.sent,this._down(),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stage",get:function(){return this._stage.then((function(e){return e.after}))}},{key:"ready",get:function(){return this.state.it}}]),e}(),Zt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return Promise.resolve()};u(this,e),this.loader=t,this._stop=n}return f(e,[{key:"idle",value:function(){return Promise.resolve(this)}},{key:"stop",value:function(){var e=this;return this._stop().then((function(){return e.after}))}},{key:"perDep",value:function(e){var t=this.loader.deps;return Promise.all(t.map((function(t){return e(t)})))}}]),e}(),en=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}var n;return a(t,e),f(t,[{key:"setup",value:(n=H(regeneratorRuntime.mark((function e(){var t,n,r,u,i,o,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.perDep((function(e){return e.setup()}));case 2:return n=this.loader,r=n.bsContext,u=n.request.def,i=rn(r,this.loader),o=_(i,2),a=o[0],c=o[1],null===(t=u.setup)||void 0===t||t.call(u,a),e.abrupt("return",new tn(this.loader,a,(function(){return Promise.resolve(c.off())})));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"init",value:function(){return this.setup().then((function(e){return e.init()}))}},{key:"after",get:function(){return"idle"}}]),t}(Zt),tn=function(e){function t(e,n,r){var i;return u(this,t),(i=c(this,s(t).call(this,e,r)))._context=n,i}var n;return a(t,e),f(t,[{key:"setup",value:function(){return Promise.resolve(this)}},{key:"init",value:(n=H(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.perDep((function(e){return e.init()}));case 2:return n=this.loader.request.def,null===(t=n.init)||void 0===t||t.call(n,this._context),e.abrupt("return",new nn(this));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"after",get:function(){return"setup"}}]),t}(Zt),nn=function(e){function t(e){var n;return u(this,t),n=c(this,s(t).call(this,e.loader,(function(){return e.stop()}))),e.loader.state.it=!0,n}return a(t,e),f(t,[{key:"after",get:function(){return"init"}}]),f(t,[{key:"setup",value:function(){return Promise.resolve(this)}},{key:"init",value:function(){return Promise.resolve(this)}}]),t}(Zt);function rn(e,t){var n,r,o,l=(n=[],r=function(e){var t=e();return n.push(t),t},{supply:T((function(){r=Vt,X(Y(n).reverse(),(function(e){return e()})),n.length=0})),add:function(e){return r(e)}}),h=e.get(qt),p=e.get(Ut),d=new g(e),y=e.get(Kt);return[new(function(n){function r(){var e;return u(this,r),(e=c(this,s(r).call(this))).get=d.newValues().get,d.provide({a:Ye,is:v(e)}),o=new Ht(v(e)),e}return a(r,n),f(r,[{key:"whenReady",value:function(n){var r=this;return(this.whenReady=b({st:t.state,bs:i().by(e.whenReady())}).thru((function(e){var t=_(e.st,1)[0];return _(e.bs,1)[0]&&t?W(r):D()})).once().F)(n)}},{key:"onDefinition",value:function(e){return(this.onDefinition=y.definitions.on().tillOff(l.supply).F)(e)}},{key:"onComponent",value:function(e){return(this.onComponent=y.components.on().tillOff(l.supply).F)(e)}},{key:"provide",value:function(t){return l.add((function(){return e.get(jt).provide(t)}))}},{key:"perDefinition",value:function(e){return l.add((function(){return h.provide(e)}))}},{key:"perComponent",value:function(e){return l.add((function(){return p.provide(e)}))}},{key:"setupDefinition",value:function(e){return function(e,t){var n=Nt(e).on;return $((function(e){n.to({supply:e.supply.needs(t.supply),receive:function(n,r){var u=r.whenReady().tillOff(t.supply).F,i=r.whenComponent().tillOff(t.supply).F;e.receive(n,{get componentType(){return r.componentType},get whenReady(){return u},get whenComponent(){return i},perDefinition:function(e){return t.add((function(){return r.perDefinition(e)}))},perComponent:function(e){return t.add((function(){return r.perComponent(e)}))}})}})}))}(e,l)}},{key:"define",value:function(e){o.define(e)}},{key:"feature",get:function(){return t.request.feature}}]),r}(Ye)),l.supply]}var un=function(){function e(t,n,r){u(this,e),this._requester=t,this.feature=n,this._revoke=r,this._uses=0,this.def=function(e){var t=Je.of(e);if(tt in e){t=Je.merge(t,{init:function(t){t.define(e)}});var n=ut.of(e).feature;n&&(t=Je.merge(t,n))}return t}(n)}return f(e,[{key:"request",value:function(e){var t=this,n=this._requester,r=n.registry,u=[this,"is",this.feature];return this._revokeBy(r.provide({a:$t.of(this.feature),is:u})),new Ke(this.def.has).forEach((function(u){var i=[t,"has",u];t._revokeBy(r.provide({a:$t.of(u),is:i}));var o=n.request(u,[].concat(l(e),[i]));t._revokeBy((function(){return o.unuse()}))})),new Ke(this.def.needs).forEach((function(u){var i=[t,"needs",u],o=n.request(u,[].concat(l(e),[i]));t._revokeBy((function(){return o.unuse()})),t._revokeBy(r.provide({a:$t.of(u),is:i}))})),this._uses=1,this}},{key:"reuse",value:function(e){if(!this._uses)throw new Ze(e.map((function(e){var t=_(e,3);return[t[0].feature,t[1],t[2]]})));return++this._uses,this}},{key:"unuse",value:function(){--this._uses||this._revoke()}},{key:"_revokeBy",value:function(e){this._revoke=Ie(e,this._revoke)}}]),e}();var on=new n("feature-requester",{byDefault:Te((function(e){return new an(e)}))}),an=function(){function e(t){u(this,e),this._map=new Map,this.registry=t.get(jt)}return f(e,[{key:"request",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this._map.get(e);if(r)return r.reuse(n);var u=new un(this,e,(function(){return t._map.delete(e)}));return this._map.set(e,u),u.request(n)}}],[{key:p,get:function(){return on}}]),e}();function cn(e){return Je.define((function e(){u(this,e)}),{needs:e})}function sn(e){var t=i(0),n=e.values,r=new(function(o){function l(){var t;return u(this,l),(t=c(this,s(l).call(this))).get=n.get,e.provide({a:qe,by:E}),e.provide({a:Ae,is:v(t)}),t}var h;return a(l,o),f(l,[{key:"whenDefined",value:(h=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.whenReady();case 2:return e.next=4,this.get(St).whenDefined(t);case 4:return e.abrupt("return",xt(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"whenReady",value:function(e){var n=this;return(this.whenReady=t.read().thru((function(e){return e?k(n):D()})).once().F)(e)}},{key:"load",value:function(e){var t,n=this,o=m((function(t){var u=r.get(an).request(e),o=i({status:{feature:e,ready:!1}});n.get($t.of(e)).to({supply:t.supply,receive:function(e,t){var n=t;o.it={status:{feature:n.request.feature,ready:n.ready},down:n.down},n.ready||n.init().then((function(){o.it={status:{feature:n.request.feature,ready:!0},down:n.down}}))}}).whenOff((function(){u.unuse()})),o.read(t)})).share(),l=o.to((function(e){var n=e.down;t=n}));return new(function(e){function n(){return u(this,n),c(this,s(n).apply(this,arguments))}return a(n,e),f(n,[{key:"read",value:function(e){return(this.read=o.tillOff(l).keepThru((function(e){return e.status})).F)(e)}},{key:"dismiss",value:function(e){return l.off(e),t}},{key:"down",get:function(){return t}}]),n}(et))}}]),l}(Ae));return{bootstrapContext:r,complete:function(){t.it=1}}}var fn=new A("attribute-descriptor"),ln=Symbol("attribute");function hn(e){return[ln,e]}function vn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!1===t)return F;if(!0===t||"function"==typeof t){var n=hn(e),r=!0===t?pn:t;return function(e,t,u){return r(e,n,t,u)}}return function(e,n,r){return pn(e,t,n,r)}}function pn(e,t,n,r){lt.of(e).updateState(t,n,r)}var dn=new n("attribute-registry"),yn=function(){function e(t){u(this,e),this._context=t}return f(e,[{key:"define",value:function(e){var t=this.attrs,n=Array.from(t.keys());n.length&&(Object.defineProperty(e,"observedAttributes",{configurable:!0,enumerable:!0,value:n}),Object.defineProperty(e.prototype,"attributeChangedCallback",{configurable:!0,enumerable:!0,value:function(e,n,r){t.get(e)(lt.of(this).component,r,n)}}))}},{key:"mount",value:function(e){var t=e.element,n=this.attrs,r=Array.from(n.keys());r.length&&new(0,this._context.get(Ue).MutationObserver)((function(e){return e.forEach((function(e){var r=e.attributeName;return n.get(r)(lt.of(t).component,t.getAttribute(r),e.oldValue)}))})).observe(t,{attributes:!0,attributeFilter:r,attributeOldValue:!0})}},{key:"attrs",get:function(){if(this._attrs)return this._attrs;var e=new Map;return this._context.get(fn).forEach((function(t){var n=t.name,r=t.change;e.set(n,Ie(e.get(n),r))})),this._attrs=e}}],[{key:p,get:function(){return dn}}]),e}(),gn={setup:function(e){e.perDefinition({as:yn}),e.onDefinition((function(e){e.whenReady((function(t){var n=t.elementType;return e.get(yn).define(n)}))})),e.onComponent((function(e){var t=e.mount;t&&e.get(yn).mount(t)}))}},mn=function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return gn}}]),e}();var wn,bn=new n("component-state"),kn=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,null,[{key:p,get:function(){return bn}}]),t}(K),_n={setup:function(e){e.perComponent({a:kn,by:function(e){var t=new kn;return e.whenDestroyed((function(e){return t.done(e)})),t}}),e.perComponent({a:st,by:function(e){return e.update},with:[kn]})}},xn=function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return _n}}]),e}(),On=function(e){function t(e,n,r){var i;return u(this,t),(i=c(this,s(t).call(this)))._context=e,i._name=n,i._path=r,i[wn]=T(),i}return a(t,e),f(t,[{key:"on",value:function(e){return(this.on=this._context.get(kn).track(this._path).onUpdate().thru((function(e,t,n){return k(t,n)})).tillOff(this).F)(e)}},{key:"it",get:function(){return this._context.element.getAttribute(this._name)},set:function(e){j(this).isOff||(null==e?this._context.element.removeAttribute(this._name):this._context.element.setAttribute(this._name,e))}}]),t}(P);wn=U;var Sn=Symbol("dom-property");var Dn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.offline,u=n.path,i=void 0===u?[]:u,o=e.get(kn).track(i),a=e.get(Ne)(),c=0,s=o.onUpdate((function(){r||e.connected?f():c=0}));function f(){c=1,a(h)}function l(){1===c&&(a(F),c=-1)}function h(e){if(!(c<0))for(c=2;;){var n=t(e);if(n===t||"function"!=typeof n)break;t=n}}r?f():e.whenOn((function(e){e.whenOff(l),c<=0&&f()})).whenOff((function(e){l(),s.off(e)}))};var Cn=new n("shadow-content-root"),Rn=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"shadowRoot",get:function(){return this.target.shadowRoot}}]),t}(z(Event)),En=new q("shadow-root-builder"),An={setup:function(e){e.provide({a:En,is:jn})}},Tn=function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return An}}]),e}();function jn(e,t){var n=function(e,t){var n=e.shadowRoot;if(n)return n;if("attachShadow"in e)return e.attachShadow(t);return}(e.element,t);return n&&(n[ft]=e,e.whenOn().once((function(){return e.dispatchEvent(new Rn("wesib:shadowAttached",{bubbles:!0}))}))),n}var Pn={mode:"open"};var Un=e("W",new o("https://wesib.github.io/ns","b","wesib")),Fn=function(e){function t(e){var n;return u(this,t),(n=c(this,s(t).call(this,e))).upKey=n.createUpKey((function(e){return e.seed.keepThru((function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length)return W(Ln(n));var u=function(){return w(qn)};return x(e.byDefault(u)||u())}))})),n}return a(t,e),f(t,[{key:"grow",value:function(e){var t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?w(e.or):e.or}:void 0).to((function(e){return t=e})),function(e,n){return t(e,n)}}}]),t}(C);function qn(e,t){return e(t)}function Ln(e){return function(t,n){return function n(r,u){var i=e[r];return i?le(i((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u;return n(r+1,e)}),u)):t(u)}(0,n)}}var Nn=new Fn("http-fetch-agent"),Mn={};var Kn=new q("http-fetch",{byDefault:Te((function(e){var t=e.get(Ue),n=e.get(Nn);return function(e,t){return n(r,new Request(e,t))};function r(e){return $((function(n){var r,u=new Q;if("AbortController"in t){var i=new t.AbortController,o=i.signal;r=T((function(e){e===Mn&&i.abort()})),n.supply.whenOff((function(){return r.off(Mn)})).needs(r),u.on({supply:r,receive:function(e,t){n.receive(e,t)}});var a=e.signal;a&&(new N(a).on("abort").once((function(){return i.abort()})),a.aborted&&i.abort()),e=new Request(e,{signal:o})}else r=u.on(n);t.fetch(e).then((function(e){u.send(e),r.off()})).catch((function(e){return r.off(e)}))}))}}))});var Bn=new n("hierarchy-root",{byDefault:function(e){var t=e.get(Fe);return new N(t).on("wesib:component").to((function(e){return e.context.get(In).issue()})),i()}}),zn=new n("hierarchy-updates",{byDefault:function(e){return new In(e.get(lt))}}),In=function(){function e(t){u(this,e);var n=new Q,r=t.get(Ae).get(Bn);this.on=n.on(),this.send=function(){return n.send(t)},this.issue=function(){var n=Vn(t);n?n[0].get(e).send():r.it=t}}return f(e,null,[{key:p,get:function(){return zn}}]),e}();function Vn(e){var t=e.get(Ae).get(Fe),n=e.element,r=!0;if(n!==t)for(;;){var u=n.parentNode;if(!u)return;var i=u[ft];if(i)return[i,r];if(u===t)return;r=!1,n=u}}var Hn=new n("hierarchy-context",{byDefault:function(e){return new $n(e.get(lt))}}),Wn=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,null,[{key:p,get:function(){return Hn}}]),t}(d),$n=function(e){function t(e){var n;u(this,t),(n=c(this,s(t).call(this))).context=e;var r,i=n._registry=(r=n.up(),new g((function(e){return r.keepThru((function(t){return t?x(t.get(e)):k()}))})));return n.get=i.newValues().get,n}return a(t,e),f(t,[{key:"provide",value:function(e){return this._registry.provide(e)}},{key:"up",value:function(e){var t=this;return(this.up=m((function(e){var n=i(),r=T().needs(e.supply),u=T().needs(e.supply),o=function(){var e=Vn(t.context);if(e){var i=_(e,2),o=i[0],a=i[1];n.it=o.get(Wn),r.off(),a&&u.off()}else n.it=void 0};t.context.get(Ae).get(Bn).read({supply:r,receive:function(){return t.context.connected&&o()}}),n.read().tillOff(u).consume((function(e){return e&&e.context.get(In).on.to(o)})),n.read(e),t.context.whenOn({supply:e.supply,receive:function(e,r){o(),r.whenOff((function(){Promise.resolve().then((function(){return t.context.connected||(n.it=void 0)}))}))}})})).share().F)(e)}}]),t}(Wn),Qn=e("j",new n("component-node")),Gn=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:ne,value:function(){return this.onUpdate()}},{key:I,value:function(){return this.read()}}]),t}(h),Jn={subtree:!0};function Xn(e,t,n,r,i){var o,l,v=i.deep,p=i.all,d=new Q,y=v?Jn:void 0,g=new Set,w=v?Yn:Y;return"string"==typeof n?l=n:e.whenDefined(n).then((function(t){var n=t.elementDef.name;if(o=void 0,n&&(l=Z.name(n,e.get(qe)),d.size)){var u=b();if(u.size){var i=Array.from(R(S(u,(function(e){return r(e)})),M));i.length&&d.send(i,[])}}})),p||t.addEventListener("wesib:component",(function(e){var t=e.target;if(g.has(t)){var n=r(t);d.send([n],[])}})),new(function(n){function i(){return u(this,i),c(this,s(i).apply(this,arguments))}return a(i,n),f(i,[{key:"onUpdate",value:function(n){var r=e.get(kt)(_);return(this.onUpdate=$((function(e){var n=!d.size,u=d.on(e);return n&&(b(),r.observe(t,y)),u.whenOff((function(){d.size||r.disconnect()}))})).F)(n)}},{key:"read",value:function(e){var t=this;return(this.read=pe(this.onUpdate().thru((function(){return t})),de(this)).F)(e)}},{key:"track",value:function(e){var t=this,n=this.onUpdate().thru((function(e,t){return k(h.of(e),h.of(t))}));return(this.track=m((function(e){var r=new Q;r.on(e),r.send(t,h.of([])),n.to(e)})).F)(e)}},{key:"first",value:function(e){return(this.first=ee(this.read()).keepThru((function(e){return W(fe(e))})).F)(e)}},{key:Symbol.iterator,value:function(){return re(o||(o=R(S(d.size?g:b(),(function(e){return r(e)})),M)))}}]),i}(Gn));function b(){return o=void 0,g=function(){var e=l;if(!e)return new Set;if(v)return new Set(Y(t.querySelectorAll(e)));return new Set(R(Y(t.children),(function(t){return t.matches(e)})))}()}function _(e){var t=[],n=[];e.forEach((function(e){X(R(S(w(e.removedNodes),O),M),(function(e){return n.push(e)})),X(R(S(w(e.addedNodes),x),M),(function(e){return t.push(e)}))})),(t.length||n.length)&&d.send(t,n)}function x(e){if(Ve(e))return l&&e.matches(l)&&!g.has(e)?(g.add(e),r(e)):void 0}function O(e){if(Ve(e)&&g.delete(e))return r(e,!0)}}function Yn(e){return B(Y(e),(function(e){return[e].concat(l(Yn(e.childNodes)))}))}var Zn=function(){function e(t,n){u(this,e),this._bs=t,this.element=n,this._emitters=new Map}return f(e,[{key:"observe",value:function(e,t){var n=this,r=this,u=this.observer,i=this._emitter(e),o=ue(t),a=i.on({supply:T((function(){n._emitters.delete(e),u.disconnect(),n._emitters.size?c():n._observer=void 0})).needs(o.supply),receive:function(e,t,n){return o.receive(e,t,n)}});return u.disconnect(),c(),a;function c(){r._update(u.takeRecords()),u.observe(r.element,{attributes:!0,attributeOldValue:!0,attributeFilter:Array.from(r._emitters.keys())})}}},{key:"_update",value:function(e){var t=this;e.forEach((function(e){var n=e.attributeName,r=t._emitters.get(n);r&&r.send(t.element.getAttribute(n),e.oldValue)}))}},{key:"_emitter",value:function(e){var t=new Q;return this._emitters.set(e,t),t}},{key:"observer",get:function(){var e=this;if(this._observer)return this._observer;var t=this._bs.get(Ue).MutationObserver;return this._observer=new t((function(t){return e._update(t)}))}}]),e}(),er=function(e){function t(e,n){var r;return u(this,t),(r=c(this,s(t).call(this)))._observer=e,r._name=n,r._updates=new Q,r}return a(t,e),f(t,[{key:"on",value:function(e){var t=this,n=ve();return(this.on=$((function(e){t._updates.size||(n=t._observer.observe(t._name,(function(e,n){return t._updates.send(e,n)}))),e.supply.needs(n),t._updates.on(e).whenOff((function(e){t._updates.size||n.off(e)}))})).F)(e)}},{key:U,get:function(){return j(this._updates)}},{key:"it",get:function(){return this._observer.element.getAttribute(this._name)},set:function(e){null!=e?this._observer.element.setAttribute(this._name,e):this._observer.element.removeAttribute(this._name)}}]),t}(P),tr=function(){function e(t,n){u(this,e),this._attrs=new Map,this._observer=new Zn(t,n)}return f(e,[{key:"get",value:function(e){var t=this._attrs.get(e);if(t)return t;var n=new er(this._observer,e);return this._attrs.set(e,n),n}}]),e}(),nr=function(e){function t(e,n){var r;return u(this,t),(r=c(this,s(t).call(this)))._element=e,r._key=n,r._updates=new Q,r}return a(t,e),f(t,[{key:"on",value:function(e){return(this.on=this._updates.on().F)(e)}},{key:"bind",value:function(e){var t,n=this;e.get(kn).track((t=this._key,[Sn,t])).onUpdate().to({supply:j(this),receive:function(e,t,r,u){return n._updates.send(r,u)}})}},{key:U,get:function(){return j(this._updates)}},{key:"it",get:function(){return this._element[this._key]},set:function(e){this._element[this._key]=e}}]),t}(P),rr=function(){function e(t){u(this,e),this._element=t,this._props=new Map}return f(e,[{key:"bind",value:function(e){this._context=e,this._props.forEach((function(t){return t.bind(e)}))}},{key:"get",value:function(e){var t=this._props.get(e);if(t)return t;var n=new nr(this._element,e);return this._context&&n.bind(this._context),this._props.set(e,n),n}}]),e}(),ur=Symbol("element-node"),ir=function(){function e(t,n){var r=this;u(this,e),this._bs=t,this.element=n,this._attrs=new tr(t,n),this._props=new rr(n),n[ur]=this;var i=n[ft];i?this._bind(i):n.addEventListener("wesib:component",(function(e){return r._bind(e.context)}))}return f(e,[{key:"select",value:function(e,t){return function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(r.all)return Xn(e,t,n,(function(t,n){return or(e,t,n)}),r);var u=e.get(bt);return Xn(e,t,n,(function(t,n){return u(t)&&or(e,t,n)}),r)}(this._bs,this.element,e,t)}},{key:"attribute",value:function(e){return this._attrs.get(e)}},{key:"property",value:function(e){return this._props.get(e)}},{key:"_bind",value:function(e){this._props.bind(e)}},{key:"context",get:function(){return this.element[ft]}},{key:"parent",get:function(){var e=this.element.parentNode;return e&&or(this._bs,e)}}]),e}();function or(e,t,n){var r=t[ur];return r||n?r:new ir(e,t)}var ar={needs:xn,setup:function(e){e.perComponent({a:Qn,by:function(e){return or(e.get(Ae),e.element)}})}},cr=e("b",function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return ar}}]),e}());function sr(e){return new URL(e.hash.substring(1),e.origin)}var fr=Symbol("page-param"),lr=function(){function e(){u(this,e)}return f(e,[{key:"byDefault",value:function(e,t){}},{key:fr,get:function(){return this}}]),e}();function hr(e,t,n,r){e(r)}var vr=new(function(e){function t(e){var n;return u(this,t),(n=c(this,s(t).call(this,e))).upKey=n.createUpKey((function(e){var t=e.context.get(Ue).document;return e.seed.keepThru((function(){for(var n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];if(r.length)return W(o);var i=function(){return w(hr)};return x(e.byDefault(i)||i());function o(e,n,u,i){return function i(o,a){var c=r[o];if(!c)return e(a);c((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,n=e.url,r=void 0===n?a.url:n,u=e.title,c=void 0===u?a.title:u,s=e.data,f=void 0===s?a.data:s;return i(o+1,{url:new URL(String(r),t.baseURI),title:c,data:f,get visited(){return a.visited},get current(){return a.current},get:function(e){return a.get(e)},put:function(e,t){a.put(e,t)}})}),n,u,a)}(0,i)}}))})),n}return a(t,e),f(t,[{key:"grow",value:function(e){var t;return e.context.get(this.upKey,"or"in e?{or:null!=e.or?w(e.or):e.or}:void 0).to((function(e){return t=e})),function(e,n,r,u){return t(e,n,r,u)}}}]),t}(C))("navigation-agent"),pr=new n("navigation"),dr=function(){function e(){u(this,e)}return f(e,[{key:ne,value:function(){return this.on()}},{key:I,value:function(){return this.read()}},{key:"back",value:function(){this.go(-1)}},{key:"forward",value:function(){this.go(1)}},{key:"reload",value:function(){this.go()}}],[{key:p,get:function(){return pr}}]),e}(),yr=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),t}(d),gr=new n("nav-history",{byDefault:Te((function(e){return new wr(e)}))});function mr(e){return null==e||"object"!==he(e)?{data:e}:e["wesib:navigation:data"]}var wr=function(){function e(t){u(this,e),this._context=t,this._entries=new Map,this._lastId=0;var n=t.get(Ue);this._document=n.document,this._location=n.location,this._history=n.history,this._uid=btoa(String(Math.random()))}return f(e,[{key:"init",value:function(){var e=this,t=mr(this._history.state).data,n=this.newEntry({url:new URL(this._location.href),data:t,title:this._document.title});return this._entries.set(n.id,n),n.schedule((function(){n.enter("init"),e._history.replaceState(e._historyState(n),"")})),n}},{key:"newEntry",value:function(e){return new br(this._context,++this._lastId,e)}},{key:"open",value:function(e,t){var n=e.page,r=n.title,u=void 0===r?"":r,i=n.url;this._history.pushState(this._historyState(e),u,i.href),this._enter("open",e,t)}},{key:"_enter",value:function(e,t,n){var r=n.it;this._entries.set(t.id,t);try{for(var u=r.next;u;u=u.next)this._forget(u)}finally{t.prev=r,r.next=t,t.schedule((function(){try{r.leave()}finally{t.enter(e)}})),n.it=t}}},{key:"replace",value:function(e,t){var n=this,r=t.it,u=e.page,i=u.title,o=void 0===i?"":i,a=u.url;this._history.replaceState(this._historyState(e),o,a.href),this._entries.set(e.id,e);var c=r.prev;c&&(e.prev=c,c.next=e),e.schedule((function(){try{r.leave()}finally{try{n._forget(r)}finally{e.enter("replace")}}})),t.it=e}},{key:"popState",value:function(e,t){var n=e.state;if(null==n)return null==this._history.state?this._changeHash(t):void 0;var r,u=t.it,i=mr(n),o=i.uid,a=i.data,c=i.id,s=o===this._uid&&null!=c?this._entries.get(c):void 0;return s?r=s:(r=this.newEntry({url:new URL(this._location.href),data:a,title:this._document.title}),u.transfer(r,"return"),this._entries.set(r.id,r),this._history.replaceState(this._historyState(r),"")),r.schedule((function(){try{u.leave()}finally{r.enter("return")}})),t.it=r,r}},{key:"hashChange",value:function(e){if(null==this._history.state)return this._changeHash(e)}},{key:"update",value:function(e,t){var n=e.it,r=new br(this._context,++this._lastId,Object.assign(Object.assign({},n.page),{url:t}),n);return this._entries.set(r.id,r),this._history.replaceState(this._historyState(r),"",t.href),this._entries.delete(n.id),e.it=r}},{key:"_changeHash",value:function(e){var t=e.it,n=this.newEntry({url:new URL(this._location.href),data:null,title:this._document.title});try{t.transfer(n,"enter")}finally{this._history.replaceState(this._historyState(n),""),this._enter("enter",n,e)}return n}},{key:"_forget",value:function(e){this._entries.delete(e.id),e.forget()}},{key:"_historyState",value:function(e){var n=e.id,r=e.page.data;return t({},"wesib:navigation:data",{uid:this._uid,id:n,data:r})}}],[{key:p,get:function(){return gr}}]),e}(),br=function(){function e(t,n,r,i){u(this,e),this._bsContext=t,this.id=n,this._status=0,this._update=F,this._params=i?i._params:new Map;var o=this;this.page={get url(){return r.url},get title(){return r.title},get data(){return r.data},get visited(){return!!o._status},get current(){return 2===o._status},get:function(e){return o.get(e)},put:function(e,t){o.put(e,t)}}}return f(e,[{key:"get",value:function(e){var t=e[fr],n=this._params.get(t);if(n)return n.get();var r=t.byDefault(this.page,this._newContext());return r&&this._init(t,r)}},{key:"put",value:function(e,t){var n=e[fr],r=this._params.get(n);return r?(r.put(t),r.get()):this._init(n,n.create(this.page,t,this._newContext()))}},{key:"_newContext",value:function(){var e=new g(this._bsContext);return new(function(t){function n(){var t;return u(this,n),(t=c(this,s(n).apply(this,arguments))).get=e.newValues().get,t}return a(n,t),n}(yr))}},{key:"_init",value:function(e,t){return this._params.set(e,t),this.page.current&&t.enter&&t.enter(this.page,"init"),t.get()}},{key:"transfer",value:function(e,t){X(this._params.entries(),(function(n){var r=_(n,2),u=r[0],i=r[1];if(i.transfer){var o=i.transfer(e.page,t);o&&e._params.set(u,o)}}))}},{key:"stay",value:function(e){X(this._params.values(),(function(t){return t.stay&&t.stay(e)}))}},{key:"enter",value:function(e){var t=this;this._status=2,X(this._params.values(),(function(n){return n.enter&&n.enter(t.page,e)}))}},{key:"leave",value:function(){this._status=1,X(this._params.values(),(function(e){return e.leave&&e.leave()}))}},{key:"forget",value:function(){X(this._params.values(),(function(e){return e.forget&&e.forget()})),this._params.clear()}},{key:"schedule",value:function(e){this._update=e}},{key:"apply",value:function(){var e=this._update;this._update=F,e()}}]),e}(),kr=function(e){function t(e,n){var r;return u(this,t),(r=c(this,s(t).call(this,e,Object.assign(Object.assign({},n),{cancelable:!1})))).when=n.when,r.to=n.to,r}return a(t,e),t}(z(Event)),_r=function(e){function t(e,n){var r;return u(this,t),(r=c(this,s(t).call(this,e,Object.assign(Object.assign({},n),{cancelable:!0})))).when=n.when,r.from=n.from,r.to=n.to,r}return a(t,e),t}(z(Event)),xr=function(e){function t(e,n){var r;return u(this,t),(r=c(this,s(t).call(this,e,Object.assign(Object.assign({},n),{cancelable:!0})))).from=n.from,r.to=n.to,r.reason=n.reason,r}return a(t,e),f(t,[{key:"when",get:function(){return"stay"}}]),t}(z(Event));function Or(e){var t=e.get(Ue),n=t.document,r=t.history,o=new N(t),l=e.get(wr),h=e.get(vr),v=i(l.init());v.read((function(e){return e.apply()}));var p=Promise.resolve();return o.on("popstate").to((function(e){var t=l.popState(e,v);t&&o.dispatch(new kr("wesib:enterPage",{when:null!=e.state?"return":"enter",to:t.page}))})),o.on("hashchange").to((function(){var e=l.hashChange(v);e&&o.dispatch(new kr("wesib:enterPage",{when:"enter",to:e.page}))})),new(function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"onEnter",value:function(e){return(this.onEnter=o.on("wesib:enterPage").F)(e)}},{key:"onLeave",value:function(e){return(this.onLeave=o.on("wesib:leavePage").F)(e)}},{key:"onStay",value:function(e){return(this.onStay=o.on("wesib:stayOnPage").F)(e)}},{key:"on",value:function(e){return(this.on=G(this.onEnter(),this.onLeave(),this.onStay()).F)(e)}},{key:"read",value:function(e){return(this.read=v.read().keepThru((function(e){return e.page})).F)(e)}},{key:"go",value:function(e){r.go(e)}},{key:"open",value:function(e){return g("pre-open","open",e)}},{key:"replace",value:function(e){return g("pre-replace","replace",e)}},{key:"update",value:function(e){return l.update(v,d(e)).page}},{key:"with",value:function(e,t){return function e(t){return{with:function(n,r){return e(Ie(t,(function(e){return e.put(n,r)})))},open:function(e){return g("pre-open","open",e,t)},replace:function(e){return g("pre-replace","replace",e,t)},pretend:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return t};"function"==typeof e?(r=e,n=void 0):n=e;var u=y(n),i=v.it,o=m("pretend",i,u,t);try{return w("pretend",i,u,o)?r(i.page,o.page):void 0}finally{o.stay(v.it.page)}}}}((function(n){return n.put(e,t)}))}},{key:"page",get:function(){return v.it.page}},{key:"length",get:function(){return r.length}}]),t}(dr));function d(e){return"string"==typeof e?new URL(e,n.baseURI):e||v.it.page.url}function y(e){return null==e||"string"==typeof e||e instanceof URL?{url:d(e)}:e.url instanceof URL?e:Object.assign(Object.assign({},e),{url:d(e.url)})}function g(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F,u=y(n),i=p=p.then(a,a);return i;function a(){var e=void 0;try{var n=c();return n?(e=n,l[t](e,v),o.dispatch(new kr("wesib:enterPage",{when:t,to:e.page})),e.page):n}catch(t){throw s(e,t),t}}function c(){if(p!==i)return s();var t=v.it,n=m(e,t,u,r),a=new _r("wesib:leavePage",{when:e,from:t.page,to:n.page});return o.dispatch(a)&&p===i&&w(e,t,u,n)?n:s(n)}function s(e,t){return e&&e.stay(v.it.page),o.dispatch(new xr("wesib:stayOnPage",{from:v.it.page,to:u,reason:t})),null}}function m(e,t,n,r){var u=l.newEntry(n);try{t.transfer(u,e),r(u.page)}catch(e){throw u.stay(v.it.page),e}return u}function w(e,t,n,r){var u=!1;return h((function(e){var t=e.url,r=e.data,i=e.title;u=!0,n.url=t,n.data=r,n.title=i}),e,t.page,r.page),u}}var Sr={setup:function(e){e.provide({a:dr,by:Or})}},Dr=function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return Sr}}]),e}();function Cr(e){var t=0,n=[];return e.forEach((function(e){var r=_(e,2),u=r[0],i=r[1];i>t?(t=i,n=[u]):i===t&&n.push(u)})),n}function Rr(e){return e.weigh?function(t){var n=e.weigh(t);if("number"==typeof n)return w(t.node,n);var r=ee(n).keepThru_((function(e){return k(t.node,e)}));return m((function(e){r.to({supply:T().needs(e.supply).whenOff((function(){(r=w(t.node,0)).to(e)})),receive:e.receive.bind(e)})}))}:Er}function Er(e){var t=e.node,n=e.page,r=t.element,u=r.getAttribute("href");if(null==u)return w(t,-1);var i=new URL(u,r.ownerDocument.baseURI);return w(t,function e(t,n){if(t.origin!==n.origin)return-1;var r=Ar(t),u=Ar(n);if(t.hash){if(r!==u)return-1;var i=Tr(t,n);return i<0||Tr(n,t)<0?-1:t.pathname.length+i+e(sr(t),sr(n))}var o=Tr(t,n);if(o)return o<0||r!==u?-1:t.pathname.length+o;if(!u.startsWith(r))return-1;return t.pathname.length}(i,n.url))}function Ar(e){var t=e.pathname;return t.endsWith("/")?t:t+"/"}function Tr(e,t){var n=e.searchParams,r=t.searchParams,u=0;return n.forEach((function(e,t){if(!function(e){return e.startsWith("__")&&e.endsWith("__")}(t)){var i=new Set(r.getAll(t));u>=0&&(n.getAll(t).every((function(e){return i.has(e)}))?u+=1:u=-1)}})),u}var jr=Symbol("nav-link-render-schedule"),Pr=["active",Un];function Ur(e,t){var n=e.get(Ne),r=t.active,u=void 0===r?Pr:r,i=te.name(u,e.get(qe)),o=t.activate?t.activate.bind(t):F;return function(e){var t,r=e.node.element,u=r[jr]||(r[jr]=n({node:r})),a=function(t){u((function(){return function(e,t){var n=t.node.element.classList;e?n.add(i):n.remove(i)}(t,e)})),o(t,e)};return a(!0),{supply:function(){var e=t=T((function(){t===e&&a(!1)}));return e}}}}function Fr(e){return e.target.getAttribute("href")}function qr(e){var t=e.href?e.href.bind(e):Fr;return function(e){var n=e.event,r=e.page,u=e.navigation,i=t(n);if(null!=i){var o=n.target,a=r.url,c=new URL(i,o.ownerDocument.baseURI);c.origin===a.origin&&(n.preventDefault(),a.href!==c.href&&u.open(i))}}}function Lr(e,t,n){var r,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Nr;"function"==typeof n?(u=n,r=null):r=n||null;var i=t.ownerDocument;if(Ve(e)){var o=i.createElement(e.tagName.toLowerCase());return e.getAttributeNames().forEach((function(t){return o.setAttribute(t,e.getAttribute(t))})),u(e,o),t.insertBefore(o,r),o}var a=i.importNode(e,!1);return t.insertBefore(a,r),a}function Nr(e,t){X(Y(e.childNodes),(function(e){return Lr(e,t)}))}function Mr(e){var t;return function(n){var r,u=function(e){return new URL("",e.url).href}(n);if(t){if(t.url===u)return t.on;t.sup.off()}var o=T().whenOff((function(){t=void 0,r=void 0})),a=$((function(t){if(!r){var u=e(n),a=i(),c=u.to((function(e){a.it=e})).whenOff((function(e){null!=e&&o.off(e)}));o.cuts(c).cuts(a),r={on:a.read().thru_((function(e){return e?k(e):D()})),num:0}}var s=r;return++s.num,s.on.tillOff(o).to(t).whenOff((function(e){--s.num||Promise.resolve().then((function(){s.num||s!==r||o.off(e)}))}))}));return t={url:u,on:a,sup:o},a}}var Kr=function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),t}(z(Error)),Br=new(function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"create",value:function(e,t){return{get:function(){return t},put:F}}}]),t}(lr)),zr=function(){function e(t,n){u(this,e),this._navigation=t,this._loader=n,this._map=new Map}return f(e,[{key:Symbol.iterator,value:function(){return re(B(this._map.values()))}},{key:"handle",value:function(){var e=this,t=T(),n=ve();return{get:function(){},put:function(t){e._add(t)},transfer:function(t,n){if("pretend"!==n){var r=e._transfer();return t.put(Br,r),r.handle()}},enter:function(r,u){if("init"!==u){n=T().needs(t);var i=$((function(t){var u=new Q,i=u.on(t);return e._loader(r).tillOff(n).to((function(e){return u.send(e)})).whenOff((function(e){void 0===e||e instanceof Kr||u.send({ok:!1,page:r,error:e})})),i})).share();X(e,(function(e){var t=e.fragment,n=e.receiver;return function(e,t){return t?e.thru_((function(e){return e.ok?Object.assign(Object.assign({},e),{fragment:(null!=t.tag?e.document.getElementsByTagName(t.tag)[0]:e.document.getElementById(t.id))||void 0}):e})):e}(i,t).to({supply:T().needs(n.supply),receive:function(e,t){n.receive(e,t)}})}))}},leave:function(){n.off(new Kr("page left"))},stay:function(){t.off(new Kr("navigation cancelled"))},forget:function(){t.off(new Kr("page forgotten"))}}}},{key:"_add",value:function(e){var t=this,n=Object.assign(Object.assign({},e),{receiver:ue(e.receiver)}),r=n.receiver.supply,u=this._map.get(r);u?u.push(n):(this._map.set(r,[n]),r.whenOff((function(){return t._map.delete(r)})))}},{key:"_transfer",value:function(){var t=new e(this._navigation,this._loader),n=!0,r=!1,u=void 0;try{for(var i,o=this._map.entries()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var a=_(i.value,2),c=a[0],s=a[1];t._map.set(c,Array.from(s))}}catch(e){r=!0,u=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw u}}return t}},{key:"fragments",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var u,i=this[Symbol.iterator]();!(t=(u=i.next()).done);t=!0){var o=u.value;if(!o.fragment)return[];e.push(o.fragment)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}}]),e}();var Ir=new Fn("page-load-agent"),Vr=new q("page-load-url",{byDefault:y(F)}),Hr=new n("page-loader",{byDefault:Te((function(e){var t=e.get(Ue),n=e.get(Kn),u=e.get(Vr),i=e.get(Ir),o=new t.DOMParser;return function(e){var t=new URL(e.url.href);u(t);var a=new Request(t.href,{mode:"same-origin",credentials:"same-origin",headers:new Headers({Accept:"text/html"})});return $((function(e){return i(c,a).to(e)}));function c(u){return function(e,t){var n,u=null===(n=e.get(Br))||void 0===n?void 0:n.fragments;u&&u.length&&t.headers.set("Accept-Fragment",r(u,(function(e,t){return(e?e+", ":"")+(null!=t.tag?"tag="+ce(t.tag):"id="+ce(t.id))}),""))}(e,u),$((function(r){var i=new ie;i.on(r),i.send({page:e}),oe(n(u).thru_((function(e){return Promise.all([e,e.text()])}))).thru_((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ae(t)}),(function(n){var r=_(n,2),u=r[0],i=r[1];if(!u.ok)return{ok:!1,page:e,response:u,error:u.status};try{return{ok:!0,page:e,response:u,document:Wr(o,t,u,i)}}catch(t){return{ok:!1,page:e,response:u,error:t}}})).to(r)}))}}}))});function Wr(e,t,n,r){var u=e.parseFromString(r,se(n.headers.get("Content-Type")||"text/html")[0].v);if(u.head){var i=u.head.querySelector("base");if(i)i.href=new URL(i.getAttribute("href"),t).href;else{var o=u.createElement("base");o.href=t.href,u.head.appendChild(o)}}return u}var $r=new(function(e){function t(){return u(this,t),c(this,s(t).apply(this,arguments))}return a(t,e),f(t,[{key:"create",value:function(e,t,n){var r=new zr(n.get(dr),Mr(n.get(Hr))),u=r.handle();return e.put(Br,r),u.put(t),u}}]),t}(lr)),Qr=new n("page-cache-buster",{byDefault:Te((function(e){return new Gr(e)}))}),Gr=function(){function e(t){u(this,e);var n=Jr(t.get(Ue).document);if(n){var r=t.get(dr);this.urlModifier=w((function(e){return e.searchParams.set("__wesib_app_rev__",n)})),this.agent=w((function(e,t){return e(new Request(t.url,t)).thru_((function(e){if(e.ok){var t=Jr(e.document);if(t&&t!==n){var u=new URL(e.page.url.href);u.searchParams.set("__wesib_app_rev__",t),r.update(u),r.reload()}}return e}))}))}else this.urlModifier=w(),this.agent=w()}return f(e,null,[{key:p,get:function(){return Qr}}]),e}();function Jr(e){var t;return null===(t=e.querySelector("meta[name=wesib-app-rev]"))||void 0===t?void 0:t.getAttribute("content")}function Xr(e){var t=e.get(Ue).document;return function(e){return e().thru_((function(e){if(e.ok){var n=new Set(S(Yr(t,Y(t.scripts)),(function(e){return _(e,1)[0]})));X(R(Yr(e.document,Y(e.document.querySelectorAll("script"))),(function(e){var t=_(e,1)[0];return!n.has(t)})),(function(e){var r=_(e,2),u=r[0];Lr(r[1],t.head,(function(e,t){return t.src=u})),n.add(u)}))}return e}))}}function Yr(e,t){return S(R(t,(function(e){return!!e.src})),(function(t){return[new URL(t.src,e.baseURI).href,t]}))}function Zr(e){var t=e.get(Ue).document;return function(e){return e().thru_((function(e){if(!e.ok)return e;var n=e.document.querySelectorAll("link[rel=stylesheet]");if(!n.length)return e;var r=t.head,u=null,i=t.querySelectorAll("link[rel=stylesheet]"),o=new Map,a=i.item(0);return a&&(r=a.parentNode,u=a,X(Y(i),(function(e){return o.set(new URL(e.href,t.baseURI).href,e)}))),X(Y(n),(function(e){var n=new URL(e.href,t.baseURI).href,i=o.get(n);i?(fe(o.keys())===n?(r=i.parentNode,u=i.nextSibling):r.insertBefore(i,u),o.delete(n)):Lr(e,r,u,(function(e,t){return t.href=n}))})),X(o.values(),(function(e){return e.parentNode.removeChild(e)})),e}))}}function eu(e){var t=e.get(Ue).document;return function(e){return e().thru_((function(e){if(e.ok){var n=e.document.getElementsByTagName("title").item(0);n&&n.textContent&&(t.title=n.textContent)}return e}))}}var tu={needs:Dr,setup:function(e){e.provide({a:Vr,by:function(e){return e.urlModifier},with:[Gr]}),e.provide({a:Ir,by:function(e){return e.agent},with:[Gr]}),e.provide({a:Ir,by:Xr}),e.provide({a:Ir,by:Zr}),e.provide({a:Ir,by:eu})}},nu=e("e",function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return tu}}]),e}());function ru(e){var t=e.url;return new URL("",t).href}var uu=new n("component-style-producer"),iu=new A("component-styp-renderer"),ou=new o("https://wesib.github.io/ns/element-id-class","elic","element-id-class"),au=new n("unique-element-class",{byDefault:function(e){var t=e.get(qe),n=e.get(lt),r=n.get(Et),u=r.name?Z.name(r.name,t):"component",i="".concat(u,"#").concat(++cu),o=ou.name(t(ou),i,te);return n.element.classList.add(o),o}}),cu=0;var su=new n("component-style-producer:impl"),fu=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xe;u(this,e),this._context=t,this._produce=n}return f(e,[{key:"produce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this._context,r=n.get(Cn,{or:null});return this._produce(e,Object.assign(Object.assign({},t),{document:t.document||n.get(Ue).document,parent:t.parent||n.contentRoot,rootSelector:[],scheduler:t.scheduler||n.get(Ne),nsAlias:t.nsAlias||n.get(qe),renderer:u()}));function u(){var e,u=t.renderer,i=(e=new Ke(u)).add.apply(e,l(n.get(iu))),o=t.hostSelector?be(t.hostSelector)[0]:void 0;return i.add(r?lu(o):hu(o||{c:[n.get(au)]})),i.value}}}],[{key:p,get:function(){return su}}]),e}();function lu(e){return{order:-100,render:function(t,n){var r=t.selector;if(r.length){if(e){var u=vu(r),i=_(u,2),o=i[0],a=i[1];a&&(r=a.length?[{u:[[":","host",pu(a,e)]]}].concat(l(o)):[{u:[[":","host",[e]]]}].concat(l(o)))}}else r=[e||{u:[[":","host"]]}];t.render(n,{selector:r})}}}function hu(e){return{order:-100,render:function(t,n){var r=t.selector;if(r.length){var u=vu(r),i=_(u,2),o=i[0],a=i[1];r=a&&a.length?[].concat(l(pu(a,e)),l(o)):[e].concat(l(o))}else r=[e];t.render(n,{selector:r})}}}function vu(e){if("string"!=typeof e[0]){var t=ke(e),n=t[0],r=n.ns,u=n.e,i=n.i,o=n.c,a=n.u,c=n.s,s=n.$,f=t.slice(1);if(!r&&!u&&!i&&!o&&!c&&a){var l,h=_(a,1),v=ke(h[0]),p=v[0],d=v[1],y=v.slice(2);if(":"===p&&"host"===d)return y.length?(l=Array.from(y[0]))[0].$=s:l=s?[{$:s}]:[],[f,l]}}return[e]}function pu(e,t){var n=t.ns,r=t.e,u=t.i,i=t.c,o=t.u,a=t.s,c=ke(e),s=c[0],f=c.slice(1);return[{ns:s.e||s.ns?s.ns:n,e:s.e||s.ns?s.e:r,i:s.i||u,c:s.c?i?[].concat(l(s.c),l(i)):s.c:i,u:s.u?o?[].concat(l(s.u),l(o)):s.u:o,s:(s.s||"")+(a||"")||void 0,$:s.$}].concat(l(f))}var du={setup:function(e){e.perComponent({as:fu}),e.perComponent({a:uu,by:function(e){return function(t,n){return e.produce(t,n)}},with:[fu]})}},yu=function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return du}}]),e}(),gu=function(e,t,n){var r,u=ye(t),i=n&&n.offline,o=e.get(uu),a=ve(),c=T((function(){r=F})).cuts(a);switch(r=function(){a=o(u,n).needs(c)},i){case"always":e.whenReady(r);break;case!1:e.whenOn((function(e){r(),a.needs(e)}));break;default:e.whenOn().once(r)}return e.whenDestroyed((function(e){return c.off(e)})),c};var mu={has:yu,setup:function(e){e.perComponent({a:fu,by:function(e){return new fu(e,we)}}),e.perComponent({a:uu,by:function(e){return function(t,n){return e.produce(t,n)}},with:[fu]})}},wu=(e("S",function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return mu}}]),e}()),new n("theme")),bu=e("T",function(){function e(){u(this,e)}return f(e,[{key:"ref",value:function(e){return e(this.root)}}],[{key:p,get:function(){return wu}}]),e}()),ku=new n("theme-factory"),_u=function(){function e(){u(this,e)}return f(e,null,[{key:p,get:function(){return ku}}]),e}(),xu=new(function(e){function t(){return u(this,t),c(this,s(t).call(this,"theme-style"))}return a(t,e),f(t,[{key:"grow",value:function(e){var t=new Map;return e.seed.forEach((function(e){var n,r,u;"function"==typeof e?(n=r=e,u=!0):(n=e.style,r=e.provide.bind(e),u=!1);var i=t.get(n);if(i){var o=_(i,2),a=o[0],c=o[1];t.set(n,[u?Ou(r,a):Ou(a,r),u||c])}else t.set(n,[r,u])})),t.size?n:e.byDefault((function(){return n}));function n(e){var n=t.get(e);if(!n)return e;var r=_(n,2),u=r[0];return r[1]?u:Ou(e,u)}}}]),t}(me));function Ou(e,t){return function(n){return ge(e(n),t(n))}}var Su=function(e){function t(e){var n;return u(this,t),(n=c(this,s(t).call(this)))._styles=e,n.root=_e(),n._rules=new Map,n}return a(t,e),f(t,[{key:"style",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ye.apply(void 0,l(n.reduce(u,[])));function u(t,n){var r=e._rules.get(n);if(r)t.push(r);else{var u=e._styles(n)(e);e._rules.set(n,u),t.push(u)}return t}}}]),t}(bu),Du=function(e){function t(e){var n;return u(this,t),(n=c(this,s(t).call(this)))._styles=e,n}return a(t,e),f(t,[{key:"newTheme",value:function(){return new Su(this._styles)}}]),t}(_u),Cu={needs:yu,setup:function(e){e.provide({a:_u,as:Du,with:[xu]}),e.provide({a:bu,by:function(e){return e.newTheme()},with:[_u]})}},Ru=(e("c",function(){function e(){u(this,e)}return f(e,null,[{key:$e,get:function(){return Cu}}]),e}()),e("D",new(function(e){function t(){return u(this,t),c(this,s(t).call(this,"default-in-aspects"))}return a(t,e),f(t,[{key:"upKey",get:function(){return this}}]),f(t,[{key:"grow",value:function(e){var t=e.context.get(qe);return b({scheduler:e.context.get(Ne[p].upKey),fns:e.seed}).keepThru((function(e){var n=_(e.scheduler,1)[0],r=e.fns;return De.apply(void 0,l(r).concat([Ce.to(n),Re.to(t)]))}))}}]),t}(C)))),Eu=new Se("input-from-control",{byDefault:function(){return{}}});function Au(e,t){var n=e.get(Wn).provide({a:Eu,by:function(){return{root:e,control:t}}});return T(n).needs(t)}}}}));//# sourceMappingURL=wesib.d0a0705b.s.js.map
