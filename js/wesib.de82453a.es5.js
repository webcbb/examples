System.register(["./lib.96c0b9c8.es5.js"],function($t){"use strict";var en,tn,nn,rn,un,on,an,sn,cn,fn,ln,hn,vn,pn,dn,yn,gn,mn,wn,kn,_n,bn,xn,Sn,Rn,En,On,Dn,Cn,An,jn,Tn,Pn,qn,Mn,Ln,Un,Nn,Bn,Vn,zn,In,Fn,Hn,Qn,Gn,Jn,Kn,Wn,Xn,Yn,Zn,$n,er,tr,nr,rr,ur,ir,or,ar,sr,cr,fr;return{setters:[function(e){en=e.S,tn=e._,nn=e.a,rn=e.F,un=e.v,on=e.b,an=e.c,sn=e.d,cn=e.e,fn=e.C,ln=e.f,hn=e.g,vn=e.n,pn=e.h,dn=e.i,yn=e.t,gn=e.j,mn=e.k,wn=e.l,kn=e.m,_n=e.o,bn=e.p,xn=e.q,Sn=e.r,Rn=e.s,En=e.u,On=e.w,Dn=e.x,Cn=e.y,An=e.A,jn=e.D,Tn=e.E,Pn=e.z,qn=e.B,Mn=e.G,Ln=e.H,Un=e.N,Nn=e.I,Bn=e.J,Vn=e.K,zn=e.L,In=e.O,Fn=e.M,Hn=e.P,Qn=e.Q,Gn=e.R,Jn=e.T,Kn=e.U,Wn=e.V,Xn=e.W,Yn=e.X,Zn=e.Y,$n=e.Z,er=e.$,tr=e.a0,nr=e.a1,rr=e.a2,ur=e.a3,ir=e.a4,or=e.a5,ar=e.a6,sr=e.a7,cr=e.a8,fr=e.a9}],execute:function(){$t({A:function(s){return function(e,t,n){var r=function(e,t,n){var r,u;if("string"==typeof n)u=le(r=n);else{if(n&&n.name)r=n.name;else{if("string"!=typeof t)throw new TypeError("Attribute name is required, as property key is not a string: "+"".concat(e.constructor.name,".").concat(t.toString()));r=t}u=le(r,n&&n.updateState)}return{name:r,updateState:u}}(e,t,s),u=r.name,i=r.updateState,o=e.constructor;f.define(o,{needs:ge}),k.define(o,{define:function(e){e.get(ve)(u,i)}});var a={get:function(){return E.of(this).element.getAttribute(u)},set:function(e){E.of(this).element.setAttribute(u,e)}};if(null!=n)return a;Object.defineProperty(e,t,a)}},C:function(t){return function(e){return k.define(e,"string"==typeof t?{name:t}:t)}},F:function(t){return function(e){return f.define(e,t)}},P:function(u){return function(e,r){var t=e.constructor;k.define(t,{define:function(e){e.onComponent(function(n){n.whenReady(function(e){var t=e[r];Ot.produce(n,"function"==typeof t?t.bind(e):t,u)})})},feature:{needs:[Et]}})}},R:function(u){return function(e,r){var t=e.constructor;k.define(t,{define:function(e){e.onComponent(function(n){n.whenReady(function(){var e=n.component,t=e[r].bind(e);Re.render(n,t,u)})})},feature:{needs:[be,Oe]}})}},f:function(){for(var e=function(n){var e=yn(0),r=e.read.thru(function(e){return e?gn():mn()}),u=n.values,i=new(function(){function t(){var e;return an(this,t),(e=sn(this,cn(t).call(this))).get=u.get,n.provide({a:s,by:Dn}),n.provide({a:a,is:wn(e)}),e}return tn(t,a),on(t,[{key:"whenDefined",value:function(t){var n=this;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(new Promise(function(e){return n.whenReady(e)}));case 2:return e.next=4,regeneratorRuntime.awrap(this.get(P).whenDefined(t));case 4:return e.abrupt("return",j(t));case 5:case"end":return e.stop()}},null,this)}},{key:"whenReady",value:function(e){r.once(e)}},{key:"load",value:function(n){var u=this;return kn(function(e){var t=i.get(ce).request(n),r=yn({feature:n,ready:!1});u.get(Z.of(n))({supply:e.supply,receive:function(e,t){var n=t;r.it={feature:n.request.feature,ready:n.ready},n.ready||n.init().then(function(){r.it={feature:n.request.feature,ready:!0}})}}).whenOff(function(){t.unuse()}),r.read(e)}).share()}},{key:"onDefinition",get:function(){return this.get(K).definitions.on}},{key:"onComponent",get:function(){return this.get(K).components.on}}]),t}());return{bootstrapContext:i,complete:function(){e.it=1}}}(V.create()),t=e.bootstrapContext,n=e.complete,r=arguments.length,u=new Array(r),i=0;i<r;i++)u[i]=arguments[i];var o=1===u.length?u[0]:function(e){return f.define(function e(){an(this,e)},{needs:e})}(u);return t.get(ce).request(o),t.get(Z.of(o))(function(e){e.init().then(n)}),t},g:function(t){return function(e){k.define(e,qe.componentDef(t))}},i:pt});var n=new en("bootstrap-context"),a=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,ln),on(e,null,[{key:fn,get:function(){return n}}]),e}();function e(r){return function(e,t){var n=e.get(a);return e===n?r(n,t):n.get(t)}}var t=new en("component-factory"),l=function(){function e(){an(this,e)}return on(e,[{key:"connectTo",value:function(e){var t=this.mountTo(e);return t.connected=!0,t}}],[{key:fn,get:function(){return t}}]),e}(),w=$t("B",new en("window",{byDefault:function(){return window}})),s=(new en("bootstrap-root",{byDefault:function(e){return e.get(w).document.body}}),$t("D",new en("default-namespace-aliaser")));function r(e){return Array.isArray(e)}var h=function(){function n(e){var t;return an(this,n),(t=sn(this,cn(n).call(this))).items=null==e?new Set:r(e)?new Set(e):new Set([e]),t}return tn(n,An),on(n,[{key:Symbol.iterator,value:function(){return this.items[Symbol.iterator]()}},{key:"add",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.items.add(e)}),this}},{key:"merge",value:function(e){return null==e?this:r(e)?this.add.apply(this,Sn(e)):this.add(e)}},{key:"value",get:function(){switch(this.items.size){case 0:return;case 1:return this.items[Symbol.iterator]().next().value;default:return Sn(this.items)}}},{key:"size",get:function(){return this.items.size}}]),n}();function y(r,u,e){var i=2<arguments.length&&void 0!==e?e:function(e,t){return t};return r?u?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i(r.apply(this,t),u.apply(this,t))}:r:u}var u=function(){function t(e){an(this,t),this.symbol=e}return on(t,[{key:"of",value:function(e){var t=this,n=e[this.symbol],r=function e(t,n){var r=1<arguments.length&&void 0!==n?n:function(){return!0},u=Object.getPrototypeOf(t.prototype);if(null!=u){var i=u.constructor;return r(i)?i:e(i,r)}}(e,function(e){return t.symbol in e}),u=r&&this.of(r);if(n)return u&&u!==n?this.merge(u,n):n}},{key:"define",value:function(e){for(var t,n=this.of(e),r=arguments.length,u=new Array(1<r?r-1:0),i=1;i<r;i++)u[i-1]=arguments[i];return t=n?this.merge.apply(this,[n].concat(u)):this.merge.apply(this,u),Object.defineProperty(e,this.symbol,{configurable:!0,value:t}),e}}]),t}(),i=function(){function e(){var n=this;an(this,e),this.promise=new Promise(function(e,t){n._resolve=e,n._reject=t})}return on(e,[{key:"resolve",value:function(e){this._resolve(e)}},{key:"reject",value:function(e){this._reject(e)}}]),e}(),o=Symbol("feature-def"),c=new(function(){function e(){return an(this,e),sn(this,cn(e).call(this,o))}return tn(e,u),on(e,[{key:"merge",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return{set:new h(e.set).merge(t.set).value,needs:new h(e.needs).merge(t.needs).value,has:new h(e.has).merge(t.has).value,init:y(e.init,t.init),perDefinition:new h(e.perDefinition).merge(t.perDefinition).value,perComponent:new h(e.perComponent).merge(t.perComponent).value}},{})}}]),e}()),f={of:function(e){return c.of(e)||{}},merge:function(){return c.merge.apply(c,arguments)},define:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return c.define.apply(c,[e].concat(n))}};var v=new en("feature-context"),p=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,a),on(e,[{key:"whenDefined",value:function(e){return this.get(a).whenDefined(e)}},{key:"load",value:function(e){return this.get(a).load(e)}},{key:"onDefinition",get:function(){return this.get(a).onDefinition}},{key:"onComponent",get:function(){return this.get(a).onComponent}}],[{key:fn,get:function(){return v}}]),e}(),d=function(e){function n(e){var t;return an(this,n),(t=sn(this,cn(n).call(this,"Circular feature needs: "+e.reduce(function(e,t){var n=hn(t,3),r=n[0],u=n[1],i=n[2];return(e||r.name)+" ".concat(u," ").concat(i.name)},"")))).needs=e,t}return tn(n,e),n}(nn(Error)),g=Symbol("component-def"),m=new(function(){function e(){return an(this,e),sn(this,cn(e).call(this,g))}return tn(e,u),on(e,[{key:"merge",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{set:new h(e.set).merge(t.set).value,define:y(e.define,t.define),perComponent:new h(e.perComponent).merge(t.perComponent).value,feature:e.feature?t.feature?f.merge(e.feature,t.feature):e.feature:t.feature})},{})}}]),e}()),k=$t("b",{of:function(e){return m.of(e)||{}},merge:function(){return m.merge.apply(m,arguments)},define:function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var u=this.merge.apply(this,n),i=m.of(e);m.define(e,u);var o=u.feature;return o&&f.define(e,o),i?e:f.define(e,{init:function(e){e.define(this)}})}});var _=new en("component-context"),b=new en("component-event-dispatcher",{byDefault:function(){return{dispatch:function(e,t){return e.element.dispatchEvent(t)},on:function(e,t){return new jn(e.element).on(t)}}}}),x=new en("content-root",{byDefault:function(e){return e.get(_).element}}),S=new rn("state-updater",{byDefault:un(vn)}),R=Symbol("component-context"),E=function(){function t(){var e;return an(this,t),(e=sn(this,cn(t).apply(this,arguments))).updateState=function(e,t,n){this.get(S)(e,t,n)}.bind(wn(e)),e}return tn(t,ln),on(t,[{key:"on",value:function(e){return this.get(b).on(this,e)}},{key:"dispatchEvent",value:function(e){this.get(n).get(b).dispatch(this,e)}},{key:"contentRoot",get:function(){return this.get(x)}}],[{key:"of",value:function(e){var t=e[R];if(!t)throw TypeError("No component context found in ".concat(e));return t}},{key:fn,get:function(){return _}}]),t}();var O=function(e){function n(e,t){return an(this,n),sn(this,cn(n).call(this,e,t))}return tn(n,e),on(n,[{key:"context",get:function(){return E.of(this.target)}}]),n}(nn(Event)),D=function(){function e(){an(this,e)}return on(e,[{key:"component",get:function(){return this.context.component}},{key:"element",get:function(){return this.context.element}}]),e}(),C=new(function(){function e(){return an(this,e),sn(this,cn(e).call(this,"element-adapter"))}return tn(e,pn),on(e,[{key:"grow",value:function(u){function i(e){return e[R]}var o;return u.seed(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(t,n){return function(e){return t(e)||n(e)}},i);o=r!==i?r:u.byDefault(function(){return i})||i}),function(e){return o(e)}}}]),e}()),A=Symbol("component-factory");function j(e){var t=e[A];if(!t)throw new TypeError("Component is not defined: ".concat(e));return t}var T=new en("custom-elements",{byDefault:function(e){var i=e.get(w).customElements,o=e.get(s);return new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,P),on(e,[{key:"define",value:function(e,t){if(Mn(e))i.define(Ln.name(e,o),t);else{var n=j(e).elementDef,r=n.name,u=n.extend;r?u&&u.name?i.define(Ln.name(r,o),t,{extends:u.name}):i.define(Ln.name(r,o),t):M(e).resolve(void 0)}}},{key:"whenDefined",value:function(e){if(Mn(e))return i.whenDefined(Ln.name(e,o));var t=j(e).elementDef.name;return t?i.whenDefined(Ln.name(t,o)):M(e).promise}}]),e}())}}),P=function(){function e(){an(this,e)}return on(e,null,[{key:fn,get:function(){return T}}]),e}();var q=Symbol("component-resolver");function M(e){return e[q]||(e[q]=new i)}var L=new en("definition-context"),U=new en("element-def",{byDefault:function(e){var t=e.get(L).componentType,n=k.of(t),r=n.name,u=n.extend,i={get type(){return u&&u.type||e.get(w).HTMLElement},get name(){return u&&u.name}};return{get name(){return r},get extend(){return i}}}}),N=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,ln),on(e,[{key:"elementDef",get:function(){return this.get(U)}}],[{key:fn,get:function(){return L}}]),e}(),B=new en("bootstrap-value-registry"),V=function(){function t(){var e;return an(this,t),(e=sn(this,cn(t).call(this))).provide({a:t,is:wn(e)}),e.values=e.newValues(),e}return tn(t,dn),on(t,null,[{key:"create",value:function(){return new t}},{key:fn,get:function(){return B}}]),t}(),z=new en("component-value-registry",{byDefault:e(function(){return new I})}),I=function(){function t(e){return an(this,t),sn(this,cn(t).call(this,e))}return tn(t,dn),on(t,null,[{key:fn,get:function(){return z}}]),t}(),F=new en("definition-value-registry",{byDefault:e(function(e){return new H(e)})}),H=function(){function t(e){return an(this,t),sn(this,cn(t).call(this,e))}return tn(t,dn),on(t,null,[{key:fn,get:function(){return F}}]),t}();var Q=Symbol("component-status");function G(e){return e[Q]}var J=new en("element-builder",{byDefault:e(function(e){return new K(e)})}),K=function(){function t(e){an(this,t),this.definitions=new Tn,this.components=new Tn,this._definitionValueRegistry=e.get(H),this._componentValueRegistry=e.get(I)}return on(t,[{key:"buildElement",value:function(e){var r,t,u=k.of(e),i=this,o=new Tn,n=yn(!1),a=n.read.thru(function(e){return e?gn():mn()});function s(){return i._componentValueRegistry.append(r)}var c=new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,l),on(e,[{key:"mountTo",value:function(n){if(n[R])throw new Error("Element ".concat(n," already bound to component"));var e=i._createComponent({definitionContext:t,onComponent:o,valueRegistry:s(),element:n,elementSuper:function(e){return n[e]},createMount:function(t){return new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,D),on(e,[{key:"checkConnected",value:function(){var e=n.ownerDocument;return this.connected=null!=e&&e.contains(n)}},{key:"context",get:function(){return t}},{key:"connected",get:function(){return 3===G(n).it},set:function(e){G(n).it=e?3:2}}]),e}())}}).mount;return e.checkConnected(),W(e.context),e}},{key:"componentType",get:function(){return t.componentType}},{key:"elementType",get:function(){return t.elementType}},{key:"elementDef",get:function(){return t.elementDef}}]),e}());t=new(function(){function n(){var e;an(this,n),e=sn(this,cn(n).call(this));var t=new H(i._definitionValueRegistry.seedIn(wn(e)));return t.provide({a:N,is:wn(e)}),t.provide({a:l,is:c}),e.get=t.newValues().get,new h(u.set).forEach(function(e){return t.provide(e)}),r=new I(t.seedIn(wn(e))),new h(u.perComponent).forEach(function(e){return r.provide(e)}),e}return tn(n,N),on(n,[{key:"whenReady",value:function(e){var t=this;a.once(function(){return e(t.elementType)})}},{key:"perComponent",value:function(e){r.provide(e)}},{key:"componentType",get:function(){return e}},{key:"onComponent",get:function(){return o.on}},{key:"elementType",get:function(){throw new Error("Custom element class is not constructed yet. Consider to use a `whenReady()` callback")}}]),n}()),u.define&&u.define.call(e,t),this.definitions.send(t);var f=this._elementType(t,o,s());return Object.defineProperty(t,"elementType",{configurable:!0,enumerable:!0,value:f}),n.it=!0,c}},{key:"_elementType",value:function(r,u,i){var o=this;return function(e){function n(){var t;return an(this,n),t=sn(this,cn(n).call(this)),W(o._createComponent({definitionContext:r,onComponent:u,valueRegistry:i,element:wn(t),createMount:vn,elementSuper:function(e){return Pn(cn(n.prototype),e,wn(t))}})),t}return tn(n,e),on(n,[{key:"connectedCallback",value:function(){G(this).it=3}},{key:"disconnectedCallback",value:function(){G(this).it=2}}]),n}(r.get(U).extend.type)}},{key:"_createComponent",value:function(e){var n,r=e.definitionContext,t=e.onComponent,u=e.valueRegistry,i=e.element,o=e.createMount,a=e.elementSuper,s=yn(0),c=s.on(vn),f=s.read.thru(function(e){return e?gn():mn()}),l=s.read.thru(function(e){return 2===e?gn():mn()}),h=s.read.thru(function(e){if(3!==e)return mn();var t=qn();return l.once(function(){return t.off()}),gn(t)}),v=u.newValues(),p=new(function(){function t(){var e;return an(this,t),(e=sn(this,cn(t).apply(this,arguments))).get=v.get,e.elementSuper=a,e}return tn(t,E),on(t,[{key:"whenReady",value:function(e){var t=this;f.once(function(){return e(t.component)})}},{key:"whenDestroyed",value:function(e){c.whenOff(e)}},{key:"destroy",value:function(e){s.done(e)}},{key:"componentType",get:function(){return r.componentType}},{key:"element",get:function(){return i}},{key:"component",get:function(){throw new Error("The component is not constructed yet. Consider to use a `whenReady()` callback")}},{key:"mount",get:function(){return n=n||o(this)}},{key:"connected",get:function(){return 3===s.it}},{key:"whenOn",get:function(){return h}},{key:"whenOff",get:function(){return l}}]),t}());p.whenDestroyed(function(){return function(e){var t=e.element,n=e.mount;n&&(n.connected=!1);var r=t.parentElement;r&&r.removeChild(t)}(p)}),u.provide({a:E,is:p}),Object.defineProperty(i,R,{value:p}),Object.defineProperty(i,Q,{writable:!0,value:s}),this.components.send(p),t.send(p);var d=function(e,t){var n=e.prototype,r=n[R];n[R]=t;try{var u=new e(t);return Object.defineProperty(u,R,{value:t}),u}finally{n[R]=r}}(r.componentType,p);return Object.defineProperty(p,"component",{configurable:!0,enumerable:!0,value:d}),s.it=1,p}}],[{key:fn,get:function(){return J}}]),t}();function W(e){e.dispatchEvent(new O("wesib:component",{bubbles:!0}))}var X=function(){function n(e){var t=this;an(this,n),this._context=e,this._definitionQueue=[],e.whenReady(function(){t._definitionQueue.forEach(function(e){return e()}),delete t._definitionQueue})}return on(n,[{key:"define",value:function(t){var n=this;this._definitionQueue.push(function(){var e=n._context.get(K).buildElement(t);t[A]=e,n.customElements.define(t,e.elementType)})}},{key:"customElements",get:function(){return this._context.get(P)}}]),n}(),Y=Symbol("feature-key"),Z=function(){function t(e){return an(this,t),sn(this,cn(t).call(this,"feature:".concat(e.name)))}return tn(t,pn),on(t,null,[{key:"of",value:function(e){return e[Y]||(e[Y]=new t(e))}}]),on(t,[{key:"grow",value:function(e){return l=e.context.get(a),t=e.seed.keep.thru($),kn(function(e){var s,r,c=_n(),f=Promise.resolve("idle");return bn({clause:t,deps:(r=l,t.keep.dig_(function(e){if(!e)return _n();var t=hn(e,1)[0].def,n=new h(t.needs);return n.size?xn.apply(void 0,Sn(n.map(function(e){return r.get(Z.of(e))}))).keep.thru_(ee):_n()}))}).dig_(function(e){var t=hn(e.clause,1)[0],n=e.deps;if(!t)return _n();var r=hn(t,3),u=r[0],i=r[2];if(u.feature===s)return c;if(i!==(s=u.feature))return c=l.get(Z.of(s)).thru_(function(e){return e.to(f),f=e.stage,e});var o=new te(l,u,n).to(f),a=_n(o);return c=kn(function(e){return a(e).whenOff(function(){f=o.unload()})}).share()})(e)}).keep.thru(function(){var t=null;return function(e){return t===e?mn():(t=e)?gn(e):gn()}}());var l,t}}]),t}();function $(){for(var e,t=!1,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];for(var i=0,o=r;i<o.length;i++){var a=o[i];switch(a[1]){case"is":t=!0,e=e||a;break;case"has":e=a;break;case"needs":t=!0}}return t?e:void 0}function ee(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gn.apply(void 0,Sn(Rn(On(t,function(e){return e[0]}),En)))}var te=function(){function u(e,t,n){var r=this;an(this,u),this.bsContext=e,this.request=t,this.deps=n,this.state=yn(!1),this.down=new Promise(function(e){return r._down=e}),this._stage=Promise.resolve(new re(this))}return on(u,[{key:"to",value:function(e){var n=this._stage;return this._stage=e.then(function(t){return n.then(function(e){return e[t]()})}),this}},{key:"setup",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this._stage=this._stage.then(function(e){return e.setup()}));case 2:case"end":return e.stop()}},null,this)}},{key:"init",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this._stage=this._stage.then(function(e){return e.init()}));case 2:case"end":return e.stop()}},null,this)}},{key:"unload",value:function(){var t,n,r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._stage,delete this._stage,e.next=4,regeneratorRuntime.awrap(t);case 4:return n=e.sent,e.next=7,regeneratorRuntime.awrap(n.stop());case 7:return r=e.sent,this._down(),e.abrupt("return",r);case 10:case"end":return e.stop()}},null,this)}},{key:"stage",get:function(){return this._stage.then(function(e){return e.after})}},{key:"ready",get:function(){return this.state.it}}]),u}(),ne=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return Promise.resolve()};an(this,n),this.loader=e,this._stop=t}return on(n,[{key:"idle",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}},null,this)}},{key:"stop",value:function(){var e=this;return this._stop().then(function(){return e.after})}},{key:"perDep",value:function(t){var e=this.loader.deps;return Promise.all(e.map(function(e){return t(e)}))}}]),n}(),re=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,ne),on(e,[{key:"setup",value:function(){var t,n,r,u,i,o,a,s,c,f,l;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.perDep(function(e){return e.setup()}));case 2:return t=this.loader,n=t.bsContext,r=t.request.def,u=r.set,i=r.perDefinition,o=r.perComponent,a=oe(n,this.loader),s=hn(a,2),c=s[0],f=s[1],l=n.get(V),new h(u).forEach(function(e){return f.push(l.provide(e))}),new h(i).forEach(function(e){return c.perDefinition(e)}),new h(o).forEach(function(e){return c.perComponent(e)}),e.abrupt("return",new ue(this.loader,c,function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f.forEach(function(e){return e()}));case 1:case"end":return e.stop()}})}));case 9:case"end":return e.stop()}},null,this)}},{key:"init",value:function(){return this.setup().then(function(e){return e.init()})}},{key:"after",get:function(){return"idle"}}]),e}(),ue=function(){function u(e,t,n){var r;return an(this,u),(r=sn(this,cn(u).call(this,e,n)))._context=t,r}return tn(u,ne),on(u,[{key:"setup",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}},null,this)}},{key:"init",value:function(){var t,n,r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.perDep(function(e){return e.init()}));case 2:return t=this.loader.request,n=t.feature,r=t.def.init,r&&r.call(n,this._context),e.abrupt("return",new ie(this));case 5:case"end":return e.stop()}},null,this)}},{key:"after",get:function(){return"setup"}}]),u}(),ie=function(){function n(e){var t;return an(this,n),t=sn(this,cn(n).call(this,e.loader,function(){return e.stop()})),e.loader.state.it=!0,t}return tn(n,ne),on(n,[{key:"after",get:function(){return"init"}}]),on(n,[{key:"setup",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}},null,this)}},{key:"init",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}},null,this)}}]),n}();function oe(n,e){var r,u=[],i=n.get(H),o=n.get(I),a=new dn(n),s=e.state.read.thru(function(e){return e?gn():mn()});return[new(function(){function t(){var e;return an(this,t),(e=sn(this,cn(t).call(this))).get=a.newValues().get,a.provide({a:p,is:wn(e)}),r=new X(wn(e)),e}return tn(t,p),on(t,[{key:"perDefinition",value:function(e){var t=i.provide(e);return u.push(t),t}},{key:"perComponent",value:function(e){var t=o.provide(e);return u.push(t),t}},{key:"define",value:function(e){r.define(e)}},{key:"whenReady",value:function(e){n.whenReady(function(){s.once(e)})}}]),t}()),u]}var ae=function(){function n(e,t){an(this,n),this._requester=e,this.feature=t,this._uses=0,this._revoke=vn,this.def=f.of(t)}return on(n,[{key:"request",value:function(r){var u=this,i=this._requester,o=i.registry,e=[this,"is",this.feature];return this._revokeBy(o.provide({a:Z.of(this.feature),is:e})),new h(this.def.has).forEach(function(e){var t=[u,"has",e];u._revokeBy(o.provide({a:Z.of(e),is:t}));var n=i.request(e,[].concat(Sn(r),[t]));u._revokeBy(function(){return n.unuse()})}),new h(this.def.needs).forEach(function(e){var t=[u,"needs",e],n=i.request(e,[].concat(Sn(r),[t]));u._revokeBy(function(){return n.unuse()}),u._revokeBy(o.provide({a:Z.of(e),is:t}))}),this._uses=1,this}},{key:"reuse",value:function(e){if(!this._uses)throw new d(e.map(function(e){var t=hn(e,3);return[t[0].feature,t[1],t[2]]}));return++this._uses,this}},{key:"unuse",value:function(){--this._uses||this._revoke()}},{key:"_revokeBy",value:function(e){this._revoke=y(e,this._revoke)}}]),n}(),se=new en("feature-requester",{byDefault:e(function(e){return new ce(e)})}),ce=function(){function t(e){an(this,t),this._map=new Map,this.registry=e.get(V)}return on(t,[{key:"request",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=this._map.get(e);if(n)return n.reuse(t);var r=new ae(this,e);return this._map.set(e,r),r.request(t)}}],[{key:fn,get:function(){return se}}]),t}();var fe=Symbol("attribute");function le(e,t){var n=!(1<arguments.length&&void 0!==t)||t;if(!1===n)return vn;if(!0!==n&&"function"!=typeof n)return function(e,t){E.of(this).updateState(n,e,t)};var r=[fe,e],u=!0===n?he:n;return function(e,t){u.call(this,r,e,t)}}function he(e,t,n){E.of(this).updateState(e,t,n)}var ve=new en("attribute-registrar"),pe=new en("attribute-registry"),de=function(){function t(e){an(this,t),this._attrs={},this._MutationObserver=e.get(w).MutationObserver}return on(t,[{key:"add",value:function(e,t){this._attrs[e]=y(this._attrs[e],t)}},{key:"define",value:function(e){var r=this._attrs,t=Object.keys(r);t.length&&(Object.defineProperty(e,"observedAttributes",{configurable:!0,enumerable:!0,value:t}),Object.defineProperty(e.prototype,"attributeChangedCallback",{configurable:!0,enumerable:!0,value:function(e,t,n){r[e].call(E.of(this).component,n,t)}}))}},{key:"mount",value:function(e){var n=e.element,r=this._attrs,t=Object.keys(r);t.length&&new this._MutationObserver(function(e){return e.forEach(function(e){var t=e.attributeName;return r[t].call(E.of(n).component,n.getAttribute(t),e.oldValue)})}).observe(n,{attributes:!0,attributeFilter:t,attributeOldValue:!0})}}],[{key:fn,get:function(){return pe}}]),t}(),ye={perDefinition:[{as:de},{a:ve,by:function(n){return function(e,t){return n.add(e,t)}},with:[de]}],init:function(e){e.onDefinition(function(t){t.whenReady(function(e){return t.get(de).define(e)})}),e.onComponent(function(e){var t=e.mount;t&&e.get(de).mount(t)})}},ge=function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return ye}}]),e}();var me=Symbol("dom-property");var we=new en("component-state"),ke=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,Cn),on(e,null,[{key:fn,get:function(){return we}}]),e}(),_e={perComponent:[{a:ke,by:function(e){var t=new ke;return e.whenDestroyed(function(e){return t.done(e)}),t}},{a:S,by:function(e){return e.update},with:[ke]}]},be=function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return _e}}]),e}(),xe=new en("render-scheduler"),Se=function(){function e(){an(this,e)}return on(e,null,[{key:fn,get:function(){return xe}}]),e}(),Re={render:function(e,t,n){var r=2<arguments.length&&void 0!==n?n:{},u=e.get(ke),i=e.get(Se).newSchedule(),o=r.offline,a=!1,s=u.onUpdate(function(){o||e.connected?c():a=!1});function c(){a=!0,i.schedule(f)}function f(){for(;;){var e=t();if(e===t||"function"!=typeof e)break;t=e}}o?c():e.whenOn(function(){a||c()}).whenOff(function(e){s.off(e),a=!0})}},Ee={set:{a:Se,by:function(r){return new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,Se),on(e,[{key:"newSchedule",value:function(){var n=vn;return new(function(){function e(){an(this,e)}return on(e,[{key:"schedule",value:function(e){var t=n;n=e,t===vn&&r.requestAnimationFrame(function(){n(),n=vn})}}]),e}())}}]),e}())},with:[w]}},Oe=function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return Ee}}]),e}();var De=new en("shadow-content-root"),Ce=function(e){function n(e,t){return an(this,n),sn(this,cn(n).call(this,e,t))}return tn(n,e),on(n,[{key:"shadowRoot",get:function(){return this.target.shadowRoot}}]),n}(nn(Event)),Ae=new rn("shadow-root-builder"),je={set:[{a:Ae,is:function(e,t){var n=function(e,t){var n=e.shadowRoot;if(n)return n;if("attachShadow"in e)return e.attachShadow(t);return}(e.element,t);if(n)return(n[R]=e).dispatchEvent(new Ce("wesib:shadowAttached",{bubbles:!0})),n;return}}]},Te=function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return je}}]),e}();var Pe={mode:"open"},qe={componentDef:function(e){var t=0<arguments.length&&void 0!==e?e:Pe;return{perComponent:[{a:De,by:function(e){return e.get(Ae)(e,t)}},{a:x,by:function(e){return e.get(De,{or:null})}}],feature:{needs:Te}}}};var Me=function(){function t(e){return an(this,t),sn(this,cn(t).call(this,e))}return tn(t,pn),on(t,[{key:"grow",value:function(e){var r;return e.seed(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i=t,r=function(u,e){return function e(t,n){var r=i[t];return r?er(r(function(){return e(t+1,0<arguments.length&&void 0!==arguments[0]?arguments[0]:n)},n)):u(n)}(0,e)};var i}),e.byDefault(function(){return function(e,t){return r(e,t)}})||Le}}]),t}();function Le(e,t){return e(t)}var Ue=new Me("http-fetch-agent"),Ne={};var Be=new rn("http-fetch",{byDefault:e(function(e){var a=e.get(w),n=e.get(Ue);return function(e,t){return n(r,new Request(e,t))};function r(o){return Nn(function(n){var t,r=new Tn;if("AbortController"in a){var u=new a.AbortController,e=u.signal;t=qn(function(e){e===Ne&&u.abort()}),n.supply.whenOff(function(){return t.off(Ne)}).needs(t),r.on({supply:t,receive:function(e,t){n.receive(e,t)}});var i=o.signal;i&&(new jn(i).on("abort").once(function(){return u.abort()}),i.aborted&&u.abort()),o=new Request(o,{signal:e})}else t=r.on(n);a.fetch(o).then(function(e){r.send(e),t.off()}).catch(function(e){return t.off(e)})})}})}),Ve=function(e){function r(e,t){var n;return an(this,r),(n=sn(this,cn(r).call(this,e,Object.assign(Object.assign({},t),{cancelable:!1})))).when=t.when,n.to=t.to,n}return tn(r,e),r}(nn(Event)),ze=function(e){function r(e,t){var n;return an(this,r),(n=sn(this,cn(r).call(this,e,Object.assign(Object.assign({},t),{cancelable:!0})))).when=t.when,n.from=t.from,n.to=t.to,n}return tn(r,e),r}(nn(Event)),Ie=function(e){function r(e,t){var n;return an(this,r),(n=sn(this,cn(r).call(this,e,Object.assign(Object.assign({},t),{cancelable:!0})))).from=t.from,n.to=t.to,n.reason=t.reason,n}return tn(r,e),on(r,[{key:"when",get:function(){return"stay"}}]),r}(nn(Event)),Fe=new en("navigation"),He=$t("N",function(){function e(){an(this,e)}return on(e,[{key:"back",value:function(){this.go(-1)}},{key:"forward",value:function(){this.go(1)}},{key:"reload",value:function(){this.go()}},{key:In,get:function(){return this.on}},{key:Fn,get:function(){return this.read}}],[{key:fn,get:function(){return Fe}}]),e}()),Qe=new(function(){function t(e){return an(this,t),sn(this,cn(t).call(this,e))}return tn(t,pn),on(t,[{key:"grow",value:function(i){var f=i.context.get(w).document;return function(e,t,n,r){var u=i.byDefault(function(){return o});return u?u(e,t,n,r):e(r)};function o(t,n,r,e){var u;return i.seed.once(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u=t}),function a(s,c){var e=u[s];if(!e)return t(c);e(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c,t=e.url,n=void 0===t?c.url:t,r=e.title,u=void 0===r?c.title:r,i=e.data,o=void 0===i?c.data:i;return a(s+1,{url:new URL(String(n),f.baseURI),title:u,data:o,get visited(){return c.visited},get current(){return c.current},get:function(e){return c.get(e)},put:function(e,t){c.put(e,t)}})},n,r,c)}(0,e)}}}]),t}())("navigation-agent"),Ge=Symbol("page-param"),Je=function(){function e(){an(this,e)}return on(e,[{key:Ge,get:function(){return this}}]),e}(),Ke=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,ln),e}(),We=new en("navigation-history",{byDefault:e(function(e){return new Xe(e)})}),Xe=function(){function n(e){an(this,n),this._context=e,this._entries=new Map,this._lastId=0;var t=e.get(w);this._document=t.document,this._location=t.location,this._history=t.history,this._uid=btoa(String(Math.random()))}return on(n,[{key:"init",value:function(){var e=this,t=Ze(this._history.state).data,n=this.newEntry({url:new URL(this._location.href),data:t,title:this._document.title});return this._entries.set(n.id,n),n.schedule(function(){n.enter("init"),e._history.replaceState(e._historyState(n),"")}),n}},{key:"newEntry",value:function(e){return new $e(this._context,++this._lastId,e)}},{key:"open",value:function(e,t){var n=e.page,r=n.title,u=void 0===r?"":r,i=n.url;this._history.pushState(this._historyState(e),u,i.href),this._enter("open",e,t)}},{key:"_enter",value:function(e,t,n){var r=n.it;this._entries.set(t.id,t);try{for(var u=r.next;u;u=u.next)this._forget(u)}finally{((t.prev=r).next=t).schedule(function(){try{r.leave()}finally{t.enter(e)}}),n.it=t}}},{key:"replace",value:function(e,t){var n=this,r=t.it,u=e.page,i=u.title,o=void 0===i?"":i,a=u.url;this._history.replaceState(this._historyState(e),o,a.href),this._entries.set(e.id,e);var s=r.prev;s&&((e.prev=s).next=e),e.schedule(function(){try{r.leave()}finally{try{n._forget(r)}finally{e.enter("replace")}}}),t.it=e}},{key:"popState",value:function(e,t){var n=e.state;if(null==n)return null==this._history.state?this._changeHash(t):void 0;var r,u=t.it,i=Ze(n),o=i.uid,a=i.data,s=i.id,c=o===this._uid&&null!=s?this._entries.get(s):void 0;return c?r=c:(r=this.newEntry({url:new URL(this._location.href),data:a,title:this._document.title}),u.transfer(r,"return"),this._entries.set(r.id,r),this._history.replaceState(this._historyState(r),"")),r.schedule(function(){try{u.leave()}finally{r.enter("return")}}),t.it=r}},{key:"hashChange",value:function(e){if(null==this._history.state)return this._changeHash(e)}},{key:"update",value:function(e,t){var n=e.it,r=new $e(this._context,++this._lastId,Object.assign(Object.assign({},n.page),{url:t}),n);return this._entries.set(r.id,r),this._history.replaceState(this._historyState(r),"",t.href),this._entries.delete(n.id),e.it=r}},{key:"_changeHash",value:function(e){var t=e.it,n=this.newEntry({url:new URL(this._location.href),data:null,title:this._document.title});try{t.transfer(n,"enter")}finally{this._history.replaceState(this._historyState(n),""),this._enter("enter",n,e)}return n}},{key:"_forget",value:function(e){this._entries.delete(e.id),e.forget()}},{key:"_historyState",value:function(e){var t=e.id,n=e.page.data;return fr({},Ye,{uid:this._uid,id:t,data:n})}}],[{key:fn,get:function(){return We}}]),n}(),Ye="wesib:navigation:data";function Ze(e){return null==e||"object"!==cr(e)?{data:e}:e[Ye]}var $e=function(){function i(e,t,n,r){an(this,i),this._context=e,this.id=t,this._status=0,this._update=vn,this._params=r?r._params:new Map;var u=this;this.page={url:n.url,title:n.title,data:n.data,get visited(){return!!u._status},get current(){return 2===u._status},get:function(e){return u.get(e)},put:function(e,t){u.put(e,t)}}}return on(i,[{key:"get",value:function(e){var t=this._params.get(e[Ge]);return t&&t.get()}},{key:"put",value:function(e,t){var n=e[Ge],r=this._params.get(n);if(r)return r.put(t),r.get();var u=new dn(this._context),i=function(){function t(){var e;return an(this,t),(e=sn(this,cn(t).apply(this,arguments))).get=u.newValues().get,e}return tn(t,Ke),t}(),o=n.create(this.page,t,new i);return this._params.set(n,o),this.page.current&&o.enter&&o.enter(this.page,"init"),o.get()}},{key:"transfer",value:function(i,o){Jn(this._params.entries(),function(e){var t=hn(e,2),n=t[0],r=t[1];if(r.transfer){var u=r.transfer(i.page,o);u&&i._params.set(n,u)}})}},{key:"stay",value:function(t){Jn(this._params.values(),function(e){return e.stay&&e.stay(t)})}},{key:"enter",value:function(t){var n=this;this._status=2,Jn(this._params.values(),function(e){return e.enter&&e.enter(n.page,t)})}},{key:"leave",value:function(){this._status=1,Jn(this._params.values(),function(e){return e.leave&&e.leave()})}},{key:"forget",value:function(){Jn(this._params.values(),function(e){return e.forget&&e.forget()}),this._params.clear()}},{key:"schedule",value:function(e){this._update=e}},{key:"apply",value:function(){var e=this._update;this._update=vn,e()}}]),i}();var et={set:{a:He,by:function(e){var t=e.get(w),n=t.document,r=t.history,f=new jn(t),l=e.get(Xe),h=e.get(Qe),u=f.on("wesib:enterPage"),i=f.on("wesib:leavePage"),o=f.on("wesib:stayOnPage"),a=ar(u,i,o),v=yn(l.init());v.read(function(e){return e.apply()});var s=v.read.keep.thru(function(e){return e.page}),p=Promise.resolve();return f.on("popstate")(function(e){var t=l.popState(e,v);t&&f.dispatch(new Ve("wesib:enterPage",{when:null!=e.state?"return":"enter",to:t.page}))}),f.on("hashchange")(function(){var e=l.hashChange(v);e&&f.dispatch(new Ve("wesib:enterPage",{when:"enter",to:e.page}))}),new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,He),on(e,[{key:"go",value:function(e){r.go(e)}},{key:"open",value:function(e){return c("pre-open","open",e)}},{key:"replace",value:function(e){return c("pre-replace","replace",e)}},{key:"update",value:function(e){return l.update(v,d(e)).page}},{key:"with",value:function(t,n){return function e(r){return{with:function(t,n){return e(y(r,function(e){return e.put(t,n)}))},open:function(e){return c("pre-open","open",e,r)},replace:function(e){return c("pre-replace","replace",e,r)}}}(function(e){return e.put(t,n)})}},{key:"length",get:function(){return r.length}},{key:"onEnter",get:function(){return u}},{key:"onLeave",get:function(){return i}},{key:"onStay",get:function(){return o}},{key:"on",get:function(){return a}},{key:"read",get:function(){return s}}]),e}());function d(e){return"string"==typeof e?new URL(e,n.baseURI):e||v.it.page.url}function c(u,n,e,t){var r,i=3<arguments.length&&void 0!==t?t:vn,o="string"==typeof(r=e)||r instanceof URL?{url:d(r)}:r.url instanceof URL?r:Object.assign(Object.assign({},r),{url:d(r.url)}),a=p=p.then(s,s);return a;function s(){var t;try{var e=function(){if(p!==a)return c();var e=v.it,t=l.newEntry(o);e.transfer(t,u);var n,r=new ze("wesib:leavePage",{when:u,from:e.page,to:t.page});return i(t.page),f.dispatch(r)&&p===a?(h(function(e){return n=e},u,r.from,r.to),n?t:c(t)):c(t)}();return e?(t=e,l[n](t,v),f.dispatch(new Ve("wesib:enterPage",{when:n,to:t.page})),t.page):e}catch(e){throw c(t,e),e}}function c(e,t){return e&&e.stay(v.it.page),f.dispatch(new Ie("wesib:stayOnPage",{from:v.it.page,to:o,reason:t})),null}}}}},tt=function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return et}}]),e}();function nt(s){var n;return function(i){var o,e=new URL("",i.url).href;if(n){if(n.url===e)return n.on;n.sup.off()}var a=qn().whenOff(function(){o=n=void 0}),t=Nn(function(e){if(!o){var t=s(i),n=yn(),r=t(function(e){n.it=e}).whenOff(function(e){null!=e&&a.off(e)});a.whenOff(function(e){r.off(e),n.done(e)}),o={on:n.read.thru_(function(e){return e?gn(e):mn()}),num:0}}var u=o;return++u.num,u.on(e).needs(a).whenOff(function(e){--u.num||Promise.resolve().then(function(){u.num||u!==o||a.off(e)})})});return n={url:e,on:t,sup:a},t}}var rt=function(e){function t(){return an(this,t),sn(this,cn(t).apply(this,arguments))}return tn(t,e),t}(nn(Error)),ut=function(){function c(e,t){an(this,c),this._navigation=e,this._loader=t,this._map=new Map}return on(c,[{key:Symbol.iterator,value:function(){return Hn(Qn(this._map.values(),Gn))}},{key:"handle",value:function(){var u=this,t=qn(),o=$n();return{get:function(){},put:function(e){u._add(e)},transfer:function(e){var t=u._transfer();return e.put(it,t),t.handle()},enter:function(r,e){if("init"!==e){o=qn().needs(t);var i=Nn(function(e){var t=new Tn,n=t.on(e);return u._loader(r)(function(e){return t.send(e)}).whenOff(function(e){void 0===e||e instanceof rt||t.send({ok:!1,page:r,error:e})}).needs(o),n}).share();Jn(u,function(e){var t,n,r=e.fragment,u=e.receiver;return t=i,((n=r)?t.thru_(function(e){return e.ok?Object.assign(Object.assign({},e),{fragment:(null!=n.tag?e.document.getElementsByTagName(n.tag)[0]:e.document.getElementById(n.id))||void 0}):e}):t)({supply:qn().needs(u.supply),receive:function(e,t){u.receive(e,t)}})})}},leave:function(){o.off(new rt("page left"))},stay:function(){t.off(new rt("navigation cancelled"))},forget:function(){t.off(new rt("page forgotten"))}}}},{key:"_add",value:function(e){var t=this,n=Object.assign(Object.assign({},e),{receiver:Kn(e.receiver)}),r=n.receiver.supply,u=this._map.get(r);u?u.push(n):(this._map.set(r,[n]),r.whenOff(function(){return t._map.delete(r)}))}},{key:"_transfer",value:function(){var e=new c(this._navigation,this._loader),t=!0,n=!1,r=void 0;try{for(var u,i=this._map.entries()[Symbol.iterator]();!(t=(u=i.next()).done);t=!0){var o=hn(u.value,2),a=o[0],s=o[1];e._map.set(a,Sn(s))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"fragments",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var u,i=this[Symbol.iterator]();!(t=(u=i.next()).done);t=!0){var o=u.value;if(!o.fragment)return[];e.push(o.fragment)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}}]),c}();var it=new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,Je),on(e,[{key:"create",value:function(e,t){return{get:function(){return t},put:vn}}}]),e}()),ot=new Me("page-load-agent"),at=new rn("page-load-url",{byDefault:un(vn)}),st=new en("page-loader",{byDefault:e(function(e){var t=e.get(w),s=e.get(Be),r=e.get(at),u=e.get(ot),c=new t.DOMParser;return function(a){var e=new URL(a.url.href);r(e);var t=new Request(e.href,{mode:"same-origin",credentials:"same-origin",headers:new Headers({Accept:"text/html"})});return Nn(function(e){return u(n,t)(e)});function n(e){var t,n,r;t=e,r=null===(n=a.get(it))||void 0===n?void 0:n.fragments,e=r&&r.length?new Request(t,{headers:{"Accept-Fragment":Xn(r,function(e,t){return(e?e+", ":"")+(null!=t.tag?"tag="+Yn(t.tag):"id="+Yn(t.id))},"")}}):t;var i=new Tn,o=i.on.thru_(function(t,e){if(!t.ok)return{ok:!1,page:a,response:t,error:t.status};try{return{ok:!0,page:a,response:t,document:c.parseFromString(e,Wn(t.headers.get("Content-Type")||"text/html")[0].v)}}catch(e){return{ok:!1,page:a,response:t,error:e}}});return Nn(function(n){var r=n.supply;_n({page:a}).once({supply:qn().needs(r),receive:function(e,t){n.receive(e,t)}});var u=s(e)(function(t){o(n),t.text().then(function(e){i.send(t,e),r.needs(u)}).catch(function(e){return r.off(e)})})})}}})});$t("p",new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,Je),on(e,[{key:"create",value:function(e,t,n){var r=new ut(n.get(He),nt(n.get(st))),u=r.handle();return e.put(it,r),u.put(t),u}}]),e}()));var ct=new en("page-cache-buster",{byDefault:e(function(e){return new lt(e)})}),ft="__wesib_app_rev__",lt=function(){function t(e){an(this,t);var r=ht(e.get(w).document);if(r){var u=e.get(He);this.urlModifier=_n(function(e){return e.searchParams.set(ft,r)}),this.agent=_n(function(e,t){return e(new Request(t.url,t)).thru_(function(e){if(e.ok){var t=ht(e.document);if(t&&t!==r){var n=new URLSearchParams(e.page.url.searchParams);n.set(ft,t),u.update("?"+n),u.reload()}}return e})})}else this.urlModifier=_n(),this.agent=_n()}return on(t,null,[{key:fn,get:function(){return ct}}]),t}();function ht(e){var t;return null===(t=e.querySelector("meta[name=wesib-app-rev]"))||void 0===t?void 0:t.getAttribute("content")}function vt(e,t,n,r){var u,i=3<arguments.length&&void 0!==r?r:pt;u="function"==typeof n?(i=n,null):n||null;var o=t.ownerDocument;if(e.nodeType!==Node.ELEMENT_NODE){var a=o.importNode(e,!1);return t.insertBefore(a,u),a}var s=e,c=o.createElement(s.tagName.toLowerCase());return s.getAttributeNames().forEach(function(e){return c.setAttribute(e,s.getAttribute(e))}),i(e,c),t.insertBefore(c,u),c}function pt(e,t){Jn(Zn(e.childNodes),function(e){return vt(e,t)})}function dt(t,e){return On(Rn(e,function(e){return!!e.src}),function(e){return[new URL(e.src,t.baseURI).href,e]})}var yt={needs:tt,set:[{a:at,by:function(e){return e.urlModifier},with:[lt]},{a:ot,by:function(e){return e.agent},with:[lt]},{a:ot,by:function(e){var u=e.get(w).document;return function(e){return e().thru_(function(e){if(e.ok){var r=new Set(On(dt(u,Zn(u.scripts)),function(e){return hn(e,1)[0]}));Jn(Rn(dt(e.document,Zn(e.document.querySelectorAll("script"))),function(e){var t=hn(e,1)[0];return!r.has(t)}),function(e){var t=hn(e,2),n=t[0];vt(t[1],u.head,function(e,t){return t.src=n}),r.add(n)})}return e})}}},{a:ot,by:function(e){var a=e.get(w).document;return function(e){return e().thru_(function(e){if(!e.ok)return e;var t=e.document.querySelectorAll("link[rel=stylesheet]");if(!t.length)return e;var r=a.head,u=null,n=a.querySelectorAll("link[rel=stylesheet]"),i=new Map,o=n.item(0);return o&&(r=o.parentNode,u=o,Jn(Zn(n),function(e){return i.set(new URL(e.href,a.baseURI).href,e)})),Jn(Zn(t),function(e){var n=new URL(e.href,a.baseURI).href,t=i.get(n);t?(tr(i.keys())===n?(r=t.parentNode,u=t.nextSibling):r.insertBefore(t,u),i.delete(n)):vt(e,r,u,function(e,t){return t.href=n})}),Jn(i.values(),function(e){return e.parentNode.removeChild(e)}),e})}}},{a:ot,by:function(e){var n=e.get(w).document;return function(e){return e().thru_(function(e){if(e.ok){var t=e.document.getElementsByTagName("title").item(0);t&&t.textContent&&(n.title=t.textContent)}return e})}}}]},gt=($t("d",function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return yt}}]),e}()),new en("component-style-producer")),mt=new nr("component-styp-render"),wt=new Un("https://wesib.github.io/ns/element-id-class","elic","element-id-class"),kt=new en("unique-element-class",{byDefault:function(e){var t=e.get(s),n=e.get(E),r=n.get(U),u=r.name?Ln.name(r.name,t):"component",i="".concat(u,"#").concat(++_t),o=wt.name(t(wt),i,rr);return n.element.classList.add(o),o}}),_t=0;var bt=new en("component-style-producer:impl"),xt=[{e:":host"}],St=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ir;an(this,n),this._context=e,this._produce=t}return on(n,[{key:"produce",value:function(e,t){var n,r=1<arguments.length&&void 0!==t?t:{},u=this._context,i=u.get(De,{or:null});return this._produce(e,Object.assign(Object.assign({},r),{document:r.document||u.get(w).document,parent:r.parent||u.get(x),rootSelector:r.rootSelector||(i?xt:[]),schedule:r.schedule||(n=u.get(Se),function(e){return n.newSchedule().schedule(e)}),nsAlias:r.nsAlias||u.get(s),render:function(){var e,t=r.render,n=(e=new h(t)).add.apply(e,Sn(u.get(mt)));i||n.add(function(n){return{order:-100,render:function(e,t){e.render(t,{selector:[{c:[n]}].concat(Sn(e.selector))})}}}(u.get(kt)));return n.value}()}))}}],[{key:fn,get:function(){return bt}}]),n}();var Rt={needs:Oe,perComponent:[{as:St},{a:gt,by:function(n){return function(e,t){return n.produce(e,t)}},with:[St]}]},Et=function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return Rt}}]),e}(),Ot={produce:function(e,t,n){var r,u=Bn(t),i=n&&n.offline,o=e.get(gt),a=$n(),s=qn(function(e){r=vn,a.off(e)});switch(r=function(){a=o(u,n).needs(s)},i){case"always":e.whenReady(r);break;case!1:e.whenOn(function(e){r(),a.needs(e)});break;default:e.whenOn.once(r)}return e.whenDestroyed(function(e){return s.off(e)}),s}};var Dt=new en("theme"),Ct=$t("T",function(){function e(){an(this,e)}return on(e,[{key:"ref",value:function(e){return e(this.root)}}],[{key:fn,get:function(){return Dt}}]),e}()),At=new en("theme-factory"),jt=function(){function e(){an(this,e)}return on(e,null,[{key:fn,get:function(){return At}}]),e}(),Tt=new(function(){function e(){return an(this,e),sn(this,cn(e).call(this,"theme-style"))}return tn(e,zn),on(e,[{key:"grow",value:function(e){var s=new Map;return e.seed.forEach(function(e){var t,n,r;r="function"==typeof e?(t=n=e,!0):(t=e.style,n=e.provide.bind(e),!1);var u=s.get(t);if(u){var i=hn(u,2),o=i[0],a=i[1];s.set(t,[r?Pt(n,o):Pt(o,n),r||a])}else s.set(t,[n,r])}),s.size?t:e.byDefault(function(){return t});function t(e){var t=s.get(e);if(!t)return e;var n=hn(t,2),r=n[0];return n[1]?r:Pt(e,r)}}}]),e}());function Pt(t,n){return function(e){return Vn(t(e),n(e))}}function qt(){an(this,qt)}var Mt=function(){function n(e){var t;return an(this,n),(t=sn(this,cn(n).call(this)))._styles=e,t.root=ur(),t._rules=new Map,t}return tn(n,Ct),on(n,[{key:"style",value:function(){for(var u=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Bn.apply(void 0,Sn(t.reduce(function(e,t){var n=u._rules.get(t);if(n)e.push(n);else{var r=u._styles(t)(u);u._rules.set(t,r),e.push(r)}return e},[])))}}]),n}(),Lt={needs:Et,set:[{a:jt,as:function(){function n(e){var t;return an(this,n),(t=sn(this,cn(n).call(this)))._styles=e,t}return tn(n,jt),on(n,[{key:"newTheme",value:function(){return new Mt(this._styles)}}]),n}(),with:[Tt]},{a:Ct,by:function(e){return e.newTheme()},with:[jt]}]},Ut=($t("e",function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return Lt}}]),e}()),$t("a",new en("component-node"))),Nt=function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,An),on(e,[{key:In,get:function(){return this.onUpdate}},{key:Fn,get:function(){return this.read}}]),e}(),Bt={childList:!0},Vt={childList:!0,subtree:!0};function zt(e,r,t,u,n){var i,o,a=n.deep,s=n.all,c=new(e.get(w).MutationObserver)(function(e){var t=[],n=[];e.forEach(function(e){Jn(Rn(On(Zn(e.removedNodes),m),Ft),function(e){return n.push(e)}),Jn(Rn(On(Zn(e.addedNodes),g),Ft),function(e){return t.push(e)})}),(t.length||n.length)&&f.send(t,n)}),f=new Tn,l=a?Vt:Bt,h=new Set,v=Nn(function(e){var t=!f.size,n=f.on(e);return t&&(y(),c.observe(r,l)),qn(function(e){n.off(e),f.size||c.disconnect()}).needs(n)}),p=kn(v.thru(function(){return o}),function(){return[o]}),d=or(p).keep.thru(tr);return s||r.addEventListener("wesib:component",function(e){var t=e.target;if(h.has(t)){var n=u(t);f.send([n],[n])}}),o=new(function(){function e(){return an(this,e),sn(this,cn(e).apply(this,arguments))}return tn(e,Nt),on(e,[{key:Symbol.iterator,value:function(){return Hn(i=i||Rn(On(f.size?h:y(),function(e){return u(e)}),Ft))}},{key:"onUpdate",get:function(){return v}},{key:"read",get:function(){return p}},{key:"first",get:function(){return d}}]),e}());function y(){return i=void 0,h=new Set(function(){if(a)return new Set(Zn(r.querySelectorAll(t)));return new Set(Rn(Zn(r.children),function(e){return e.matches(t)}))}())}function g(e){if(It(e))return e.matches(t)&&!h.has(e)?(h.add(e),u(e)):void 0}function m(e){if(It(e)&&h.delete(e))return u(e,!0)}}function It(e){return e.nodeType===Node.ELEMENT_NODE}function Ft(e){return null!=e}var Ht=function(){function n(e,t){an(this,n),this._bs=e,this.element=t,this._emitters=new Map}return on(n,[{key:"observe",value:function(e,t){var n=this,r=this,u=this.observer,i=this._emitter(e),o=Kn(t),a=i.on({supply:qn(function(){n._emitters.delete(e),u.disconnect(),n._emitters.size?s():n._observer=void 0}).needs(o.supply),receive:function(e,t,n){return o.receive(e,t,n)}});return u.disconnect(),s(),a;function s(){r._update(u.takeRecords()),u.observe(r.element,{attributes:!0,attributeOldValue:!0,attributeFilter:Sn(r._emitters.keys())})}}},{key:"_update",value:function(e){var r=this;e.forEach(function(e){var t=e.attributeName,n=r._emitters.get(t);n&&n.send(r.element.getAttribute(t),e.oldValue)})}},{key:"_emitter",value:function(e){var t=new Tn;return this._emitters.set(e,t),t}},{key:"observer",get:function(){var t=this;if(this._observer)return this._observer;var e=this._bs.get(w).MutationObserver;return this._observer=new e(function(e){return t._update(e)})}}]),n}(),Qt=function(){function u(e,t){var n;an(this,u),(n=sn(this,cn(u).call(this)))._observer=e,n._name=t,n._updates=new Tn;var r=$n();return n.on=Nn(function(e){n._updates.size||(r=n._observer.observe(t,function(e,t){return n._updates.send(e,t)})),e.supply.needs(r),n._updates.on(e).whenOff(function(e){n._updates.size||r.off(e)})}),n}return tn(u,sr),on(u,[{key:"done",value:function(e){return this._updates.done(e),this}},{key:"it",get:function(){return this._observer.element.getAttribute(this._name)},set:function(e){this._observer.element.setAttribute(this._name,e)}}]),u}(),Gt=function(){function n(e,t){an(this,n),this._attrs=new Map,this._observer=new Ht(e,t)}return on(n,[{key:"get",value:function(e){var t=this._attrs.get(e);if(t)return t;var n=new Qt(this._observer,e);return this._attrs.set(e,n),n}}]),n}(),Jt=function(){function r(e,t){var n;return an(this,r),(n=sn(this,cn(r).call(this)))._element=e,n._key=t,n._updates=new Tn,n._supply=$n(),n}return tn(r,sr),on(r,[{key:"bind",value:function(e){var t,u=this,n=e.get(ke).track((t=this._key,[me,t]));this._supply=n.onUpdate({supply:qn().whenOff(function(e){return u._updates.done(e)}),receive:function(e,t,n,r){return u._updates.send(n,r)}})}},{key:"done",value:function(e){return this._supply.off(e),this}},{key:"on",get:function(){return this._updates.on}},{key:"it",get:function(){return this._element[this._key]},set:function(e){this._element[this._key]=e}}]),r}(),Kt=function(){function t(e){an(this,t),this._element=e,this._props=new Map}return on(t,[{key:"bind",value:function(t){this._context=t,this._props.forEach(function(e){return e.bind(t)})}},{key:"get",value:function(e){var t=this._props.get(e);if(t)return t;var n=new Jt(this._element,e);return this._context&&n.bind(this._context),this._props.set(e,n),n}}]),t}(),Wt=Symbol("element-node"),Xt=function(){function u(e,t){var n;an(this,u),(n=sn(this,cn(u).call(this)))._bs=e,n.element=t,n._attrs=new Gt(e,t),n._props=new Kt(t),t[Wt]=wn(n);var r=t[R];return r?n._bind(r):t.addEventListener("wesib:component",function(e){return n._bind(e.context)}),n}return tn(u,qt),on(u,[{key:"select",value:function(e,t){return function(n,e,t){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},u=n.get(C);if(r.all)return zt(n,e,t,function(e,t){return Yt(n,e,t)},r);return zt(n,e,t,function(e,t){if(u(e))return Yt(n,e,t)},r)}(this._bs,this.element,e,t)}},{key:"attribute",value:function(e){return this._attrs.get(e)}},{key:"property",value:function(e){return this._props.get(e)}},{key:"_bind",value:function(e){this._props.bind(e)}},{key:"context",get:function(){return this.element[R]}},{key:"parent",get:function(){var e=this.element.parentElement;return null!=e?Yt(this._bs,e):null}}]),u}();function Yt(e,t,n){var r=t[Wt];return n||r?r:new Xt(e,t)}var Zt={needs:be,perComponent:{a:Ut,by:function(e){return Yt(e.get(a),e.element)}}};$t("c",function(){function e(){an(this,e)}return on(e,null,[{key:o,get:function(){return Zt}}]),e}())}}});
//# sourceMappingURL=wesib.de82453a.es5.js.map
